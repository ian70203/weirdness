;
//#region JSON2
if (!window.JSON) { JSON = function () { function f(n) { return n < 10 ? '0' + n : n; } Date.prototype.toJSON = function () { return this.getUTCFullYear() + '-' + f(this.getUTCMonth() + 1) + '-' + f(this.getUTCDate()) + 'T' + f(this.getUTCHours()) + ':' + f(this.getUTCMinutes()) + ':' + f(this.getUTCSeconds()) + 'Z'; }; var m = { '\b': '\\b', '\t': '\\t', '\n': '\\n', '\f': '\\f', '\r': '\\r', '"': '\\"', '\\': '\\\\' }; function stringify(value, whitelist) { var a, i, k, l, r = /["\\\x00-\x1f\x7f-\x9f]/g, v; switch (typeof value) { case 'string': return r.test(value) ? '"' + value.replace(r, function (a) { var c = m[a]; if (c) { return c; } c = a.charCodeAt(); return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16); }) + '"' : '"' + value + '"'; case 'number': return isFinite(value) ? String(value) : 'null'; case 'boolean': case 'null': return String(value); case 'object': if (!value) { return 'null'; } if (typeof value.toJSON === 'function') { return stringify(value.toJSON()); } a = []; if (typeof value.length === 'number' && !(value.propertyIsEnumerable('length'))) { l = value.length; for (i = 0; i < l; i += 1) { a.push(stringify(value[i], whitelist) || 'null'); } return '[' + a.join(',') + ']'; } if (whitelist) { l = whitelist.length; for (i = 0; i < l; i += 1) { k = whitelist[i]; if (typeof k === 'string') { v = stringify(value[k], whitelist); if (v) { a.push(stringify(k) + ':' + v); } } } } else { for (k in value) { if (typeof k === 'string') { v = stringify(value[k], whitelist); if (v) { a.push(stringify(k) + ':' + v); } } } } return '{' + a.join(',') + '}'; } } return { stringify: stringify, parse: function (text, filter) { var j; function walk(k, v) { var i, n; if (v && typeof v === 'object') { for (i in v) { if (Object.prototype.hasOwnProperty.apply(v, [i])) { n = walk(i, v[i]); if (n !== undefined) { v[i] = n; } } } } return filter(k, v); } if (/^[\],:{}\s]*$/.test(text.replace(/\\./g, '@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) { j = eval('(' + text + ')'); return typeof filter === 'function' ? walk('', j) : j; } throw new SyntaxError('parseJSON'); } }; }(); }
//#endregion

//#region Leaflet Core
/*
 Leaflet 1.0.0-beta.2 (c016634), a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2015 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*/
!function (t, e, i) {
    function n() { var e = t.L; o.noConflict = function () { return t.L = e, this }, t.L = o } var o = { version: "1.0.0-beta.2" }; "object" == typeof module && "object" == typeof module.exports ? module.exports = o : "function" == typeof define && define.amd && define(o), "undefined" != typeof t && n(), o.Util = { extend: function (t) { var e, i, n, o; for (i = 1, n = arguments.length; n > i; i++) { o = arguments[i]; for (e in o) t[e] = o[e] } return t }, create: Object.create || function () { function t() { } return function (e) { return t.prototype = e, new t } }(), bind: function (t, e) { var i = Array.prototype.slice; if (t.bind) return t.bind.apply(t, i.call(arguments, 1)); var n = i.call(arguments, 2); return function () { return t.apply(e, n.length ? n.concat(i.call(arguments)) : arguments) } }, stamp: function (t) { return t._leaflet_id = t._leaflet_id || ++o.Util.lastId, t._leaflet_id }, lastId: 0, throttle: function (t, e, i) { var n, o, s, r; return r = function () { n = !1, o && (s.apply(i, o), o = !1) }, s = function () { n ? o = arguments : (t.apply(i, arguments), setTimeout(r, e), n = !0) } }, wrapNum: function (t, e, i) { var n = e[1], o = e[0], s = n - o; return t === n && i ? t : ((t - o) % s + s) % s + o }, falseFn: function () { return !1 }, formatNum: function (t, e) { var i = Math.pow(10, e || 5); return Math.round(t * i) / i }, trim: function (t) { return t.trim ? t.trim() : t.replace(/^\s+|\s+$/g, "") }, splitWords: function (t) { return o.Util.trim(t).split(/\s+/) }, setOptions: function (t, e) { t.hasOwnProperty("options") || (t.options = t.options ? o.Util.create(t.options) : {}); for (var i in e) t.options[i] = e[i]; return t.options }, getParamString: function (t, e, i) { var n = []; for (var o in t) n.push(encodeURIComponent(i ? o.toUpperCase() : o) + "=" + encodeURIComponent(t[o])); return (e && -1 !== e.indexOf("?") ? "&" : "?") + n.join("&") }, template: function (t, e) { return t.replace(o.Util.templateRe, function (t, n) { var o = e[n]; if (o === i) throw new Error("No value provided for variable " + t); return "function" == typeof o && (o = o(e)), o }) }, templateRe: /\{ *([\w_]+) *\}/g, isArray: Array.isArray || function (t) { return "[object Array]" === Object.prototype.toString.call(t) }, indexOf: function (t, e) { for (var i = 0; i < t.length; i++) if (t[i] === e) return i; return -1 }, emptyImageUrl: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" }, function () { function e(e) { return t["webkit" + e] || t["moz" + e] || t["ms" + e] } function i(e) { var i = +new Date, o = Math.max(0, 16 - (i - n)); return n = i + o, t.setTimeout(e, o) } var n = 0, s = t.requestAnimationFrame || e("RequestAnimationFrame") || i, r = t.cancelAnimationFrame || e("CancelAnimationFrame") || e("CancelRequestAnimationFrame") || function (e) { t.clearTimeout(e) }; o.Util.requestAnimFrame = function (e, n, r) { return r && s === i ? void e.call(n) : s.call(t, o.bind(e, n)) }, o.Util.cancelAnimFrame = function (e) { e && r.call(t, e) } }(), o.extend = o.Util.extend, o.bind = o.Util.bind, o.stamp = o.Util.stamp, o.setOptions = o.Util.setOptions, o.Class = function () { }, o.Class.extend = function (t) { var e = function () { this.initialize && this.initialize.apply(this, arguments), this.callInitHooks() }, i = e.__super__ = this.prototype, n = o.Util.create(i); n.constructor = e, e.prototype = n; for (var s in this) this.hasOwnProperty(s) && "prototype" !== s && (e[s] = this[s]); return t.statics && (o.extend(e, t.statics), delete t.statics), t.includes && (o.Util.extend.apply(null, [n].concat(t.includes)), delete t.includes), n.options && (t.options = o.Util.extend(o.Util.create(n.options), t.options)), o.extend(n, t), n._initHooks = [], n.callInitHooks = function () { if (!this._initHooksCalled) { i.callInitHooks && i.callInitHooks.call(this), this._initHooksCalled = !0; for (var t = 0, e = n._initHooks.length; e > t; t++) n._initHooks[t].call(this) } }, e }, o.Class.include = function (t) { o.extend(this.prototype, t) }, o.Class.mergeOptions = function (t) { o.extend(this.prototype.options, t) }, o.Class.addInitHook = function (t) { var e = Array.prototype.slice.call(arguments, 1), i = "function" == typeof t ? t : function () { this[t].apply(this, e) }; this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(i) }, o.Evented = o.Class.extend({ on: function (t, e, i) { if ("object" == typeof t) for (var n in t) this._on(n, t[n], e); else { t = o.Util.splitWords(t); for (var s = 0, r = t.length; r > s; s++) this._on(t[s], e, i) } return this }, off: function (t, e, i) { if (t) if ("object" == typeof t) for (var n in t) this._off(n, t[n], e); else { t = o.Util.splitWords(t); for (var s = 0, r = t.length; r > s; s++) this._off(t[s], e, i) } else delete this._events; return this }, _on: function (t, e, i) { var n = this._events = this._events || {}, s = i && i !== this && o.stamp(i); if (s) { var r = t + "_idx", a = t + "_len", h = n[r] = n[r] || {}, l = o.stamp(e) + "_" + s; h[l] || (h[l] = { fn: e, ctx: i }, n[a] = (n[a] || 0) + 1) } else n[t] = n[t] || [], n[t].push({ fn: e }) }, _off: function (t, e, i) { var n = this._events, s = t + "_idx", r = t + "_len"; if (n) { if (!e) return delete n[t], delete n[s], void delete n[r]; var a, h, l, u, c, d = i && i !== this && o.stamp(i); if (d) c = o.stamp(e) + "_" + d, a = n[s], a && a[c] && (u = a[c], delete a[c], n[r]--); else if (a = n[t]) for (h = 0, l = a.length; l > h; h++) if (a[h].fn === e) { u = a[h], a.splice(h, 1); break } u && (u.fn = o.Util.falseFn) } }, fire: function (t, e, i) { if (!this.listens(t, i)) return this; var n = o.Util.extend({}, e, { type: t, target: this }), s = this._events; if (s) { var r, a, h, l, u = s[t + "_idx"]; if (s[t]) for (h = s[t].slice(), r = 0, a = h.length; a > r; r++) h[r].fn.call(this, n); for (l in u) u[l].fn.call(u[l].ctx, n) } return i && this._propagateEvent(n), this }, listens: function (t, e) { var i = this._events; if (i && (i[t] || i[t + "_len"])) return !0; if (e) for (var n in this._eventParents) if (this._eventParents[n].listens(t, e)) return !0; return !1 }, once: function (t, e, i) { if ("object" == typeof t) { for (var n in t) this.once(n, t[n], e); return this } var s = o.bind(function () { this.off(t, e, i).off(t, s, i) }, this); return this.on(t, e, i).on(t, s, i) }, addEventParent: function (t) { return this._eventParents = this._eventParents || {}, this._eventParents[o.stamp(t)] = t, this }, removeEventParent: function (t) { return this._eventParents && delete this._eventParents[o.stamp(t)], this }, _propagateEvent: function (t) { for (var e in this._eventParents) this._eventParents[e].fire(t.type, o.extend({ layer: t.target }, t), !0) } }); var s = o.Evented.prototype; s.addEventListener = s.on, s.removeEventListener = s.clearAllEventListeners = s.off, s.addOneTimeEventListener = s.once, s.fireEvent = s.fire, s.hasEventListeners = s.listens, o.Mixin = { Events: s }, function () { var i = navigator.userAgent.toLowerCase(), n = e.documentElement, s = "ActiveXObject" in t, r = -1 !== i.indexOf("webkit"), a = -1 !== i.indexOf("phantom"), h = -1 !== i.search("android [23]"), l = -1 !== i.indexOf("chrome"), u = -1 !== i.indexOf("gecko") && !r && !t.opera && !s, c = "undefined" != typeof orientation || -1 !== i.indexOf("mobile"), d = !t.PointerEvent && t.MSPointerEvent, _ = t.PointerEvent && navigator.pointerEnabled && navigator.maxTouchPoints || d, m = s && "transition" in n.style, p = "WebKitCSSMatrix" in t && "m11" in new t.WebKitCSSMatrix && !h, f = "MozPerspective" in n.style, g = "OTransition" in n.style, v = !t.L_NO_TOUCH && !a && (_ || "ontouchstart" in t || t.DocumentTouch && e instanceof t.DocumentTouch); o.Browser = { ie: s, ielt9: s && !e.addEventListener, webkit: r, gecko: u, android: -1 !== i.indexOf("android"), android23: h, chrome: l, safari: !l && -1 !== i.indexOf("safari"), ie3d: m, webkit3d: p, gecko3d: f, opera12: g, any3d: !t.L_DISABLE_3D && (m || p || f) && !g && !a, mobile: c, mobileWebkit: c && r, mobileWebkit3d: c && p, mobileOpera: c && t.opera, mobileGecko: c && u, touch: !!v, msPointer: !!d, pointer: !!_, retina: (t.devicePixelRatio || t.screen.deviceXDPI / t.screen.logicalXDPI) > 1 } }(), o.Point = function (t, e, i) { this.x = i ? Math.round(t) : t, this.y = i ? Math.round(e) : e }, o.Point.prototype = { clone: function () { return new o.Point(this.x, this.y) }, add: function (t) { return this.clone()._add(o.point(t)) }, _add: function (t) { return this.x += t.x, this.y += t.y, this }, subtract: function (t) { return this.clone()._subtract(o.point(t)) }, _subtract: function (t) { return this.x -= t.x, this.y -= t.y, this }, divideBy: function (t) { return this.clone()._divideBy(t) }, _divideBy: function (t) { return this.x /= t, this.y /= t, this }, multiplyBy: function (t) { return this.clone()._multiplyBy(t) }, _multiplyBy: function (t) { return this.x *= t, this.y *= t, this }, scaleBy: function (t) { return new o.Point(this.x * t.x, this.y * t.y) }, unscaleBy: function (t) { return new o.Point(this.x / t.x, this.y / t.y) }, round: function () { return this.clone()._round() }, _round: function () { return this.x = Math.round(this.x), this.y = Math.round(this.y), this }, floor: function () { return this.clone()._floor() }, _floor: function () { return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this }, ceil: function () { return this.clone()._ceil() }, _ceil: function () { return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this }, distanceTo: function (t) { t = o.point(t); var e = t.x - this.x, i = t.y - this.y; return Math.sqrt(e * e + i * i) }, equals: function (t) { return t = o.point(t), t.x === this.x && t.y === this.y }, contains: function (t) { return t = o.point(t), Math.abs(t.x) <= Math.abs(this.x) && Math.abs(t.y) <= Math.abs(this.y) }, toString: function () { return "Point(" + o.Util.formatNum(this.x) + ", " + o.Util.formatNum(this.y) + ")" } }, o.point = function (t, e, n) { return t instanceof o.Point ? t : o.Util.isArray(t) ? new o.Point(t[0], t[1]) : t === i || null === t ? t : new o.Point(t, e, n) }, o.Bounds = function (t, e) { if (t) for (var i = e ? [t, e] : t, n = 0, o = i.length; o > n; n++) this.extend(i[n]) }, o.Bounds.prototype = { extend: function (t) { return t = o.point(t), this.min || this.max ? (this.min.x = Math.min(t.x, this.min.x), this.max.x = Math.max(t.x, this.max.x), this.min.y = Math.min(t.y, this.min.y), this.max.y = Math.max(t.y, this.max.y)) : (this.min = t.clone(), this.max = t.clone()), this }, getCenter: function (t) { return new o.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, t) }, getBottomLeft: function () { return new o.Point(this.min.x, this.max.y) }, getTopRight: function () { return new o.Point(this.max.x, this.min.y) }, getSize: function () { return this.max.subtract(this.min) }, contains: function (t) { var e, i; return t = "number" == typeof t[0] || t instanceof o.Point ? o.point(t) : o.bounds(t), t instanceof o.Bounds ? (e = t.min, i = t.max) : e = i = t, e.x >= this.min.x && i.x <= this.max.x && e.y >= this.min.y && i.y <= this.max.y }, intersects: function (t) { t = o.bounds(t); var e = this.min, i = this.max, n = t.min, s = t.max, r = s.x >= e.x && n.x <= i.x, a = s.y >= e.y && n.y <= i.y; return r && a }, overlaps: function (t) { t = o.bounds(t); var e = this.min, i = this.max, n = t.min, s = t.max, r = s.x > e.x && n.x < i.x, a = s.y > e.y && n.y < i.y; return r && a }, isValid: function () { return !(!this.min || !this.max) } }, o.bounds = function (t, e) { return !t || t instanceof o.Bounds ? t : new o.Bounds(t, e) }, o.Transformation = function (t, e, i, n) { this._a = t, this._b = e, this._c = i, this._d = n }, o.Transformation.prototype = { transform: function (t, e) { return this._transform(t.clone(), e) }, _transform: function (t, e) { return e = e || 1, t.x = e * (this._a * t.x + this._b), t.y = e * (this._c * t.y + this._d), t }, untransform: function (t, e) { return e = e || 1, new o.Point((t.x / e - this._b) / this._a, (t.y / e - this._d) / this._c) } }, o.DomUtil = { get: function (t) { return "string" == typeof t ? e.getElementById(t) : t }, getStyle: function (t, i) { var n = t.style[i] || t.currentStyle && t.currentStyle[i]; if ((!n || "auto" === n) && e.defaultView) { var o = e.defaultView.getComputedStyle(t, null); n = o ? o[i] : null } return "auto" === n ? null : n }, create: function (t, i, n) { var o = e.createElement(t); return o.className = i, n && n.appendChild(o), o }, remove: function (t) { var e = t.parentNode; e && e.removeChild(t) }, empty: function (t) { for (; t.firstChild;) t.removeChild(t.firstChild) }, toFront: function (t) { t.parentNode.appendChild(t) }, toBack: function (t) { var e = t.parentNode; e.insertBefore(t, e.firstChild) }, hasClass: function (t, e) { if (t.classList !== i) return t.classList.contains(e); var n = o.DomUtil.getClass(t); return n.length > 0 && new RegExp("(^|\\s)" + e + "(\\s|$)").test(n) }, addClass: function (t, e) { if (t.classList !== i) for (var n = o.Util.splitWords(e), s = 0, r = n.length; r > s; s++) t.classList.add(n[s]); else if (!o.DomUtil.hasClass(t, e)) { var a = o.DomUtil.getClass(t); o.DomUtil.setClass(t, (a ? a + " " : "") + e) } }, removeClass: function (t, e) { t.classList !== i ? t.classList.remove(e) : o.DomUtil.setClass(t, o.Util.trim((" " + o.DomUtil.getClass(t) + " ").replace(" " + e + " ", " "))) }, setClass: function (t, e) { t.className.baseVal === i ? t.className = e : t.className.baseVal = e }, getClass: function (t) { return t.className.baseVal === i ? t.className : t.className.baseVal }, setOpacity: function (t, e) { "opacity" in t.style ? t.style.opacity = e : "filter" in t.style && o.DomUtil._setOpacityIE(t, e) }, _setOpacityIE: function (t, e) { var i = !1, n = "DXImageTransform.Microsoft.Alpha"; try { i = t.filters.item(n) } catch (o) { if (1 === e) return } e = Math.round(100 * e), i ? (i.Enabled = 100 !== e, i.Opacity = e) : t.style.filter += " progid:" + n + "(opacity=" + e + ")" }, testProp: function (t) { for (var i = e.documentElement.style, n = 0; n < t.length; n++) if (t[n] in i) return t[n]; return !1 }, setTransform: function (t, e, i) { var n = e || new o.Point(0, 0); t.style[o.DomUtil.TRANSFORM] = (o.Browser.ie3d ? "translate(" + n.x + "px," + n.y + "px)" : "translate3d(" + n.x + "px," + n.y + "px,0)") + (i ? " scale(" + i + ")" : "") }, setPosition: function (t, e) { t._leaflet_pos = e, o.Browser.any3d ? o.DomUtil.setTransform(t, e) : (t.style.left = e.x + "px", t.style.top = e.y + "px") }, getPosition: function (t) { return t._leaflet_pos } }, function () { o.DomUtil.TRANSFORM = o.DomUtil.testProp(["transform", "WebkitTransform", "OTransform", "MozTransform", "msTransform"]); var i = o.DomUtil.TRANSITION = o.DomUtil.testProp(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]); if (o.DomUtil.TRANSITION_END = "webkitTransition" === i || "OTransition" === i ? i + "End" : "transitionend", "onselectstart" in e) o.DomUtil.disableTextSelection = function () { o.DomEvent.on(t, "selectstart", o.DomEvent.preventDefault) }, o.DomUtil.enableTextSelection = function () { o.DomEvent.off(t, "selectstart", o.DomEvent.preventDefault) }; else { var n = o.DomUtil.testProp(["userSelect", "WebkitUserSelect", "OUserSelect", "MozUserSelect", "msUserSelect"]); o.DomUtil.disableTextSelection = function () { if (n) { var t = e.documentElement.style; this._userSelect = t[n], t[n] = "none" } }, o.DomUtil.enableTextSelection = function () { n && (e.documentElement.style[n] = this._userSelect, delete this._userSelect) } } o.DomUtil.disableImageDrag = function () { o.DomEvent.on(t, "dragstart", o.DomEvent.preventDefault) }, o.DomUtil.enableImageDrag = function () { o.DomEvent.off(t, "dragstart", o.DomEvent.preventDefault) }, o.DomUtil.preventOutline = function (e) { for (; -1 === e.tabIndex;) e = e.parentNode; e && e.style && (o.DomUtil.restoreOutline(), this._outlineElement = e, this._outlineStyle = e.style.outline, e.style.outline = "none", o.DomEvent.on(t, "keydown", o.DomUtil.restoreOutline, this)) }, o.DomUtil.restoreOutline = function () { this._outlineElement && (this._outlineElement.style.outline = this._outlineStyle, delete this._outlineElement, delete this._outlineStyle, o.DomEvent.off(t, "keydown", o.DomUtil.restoreOutline, this)) } }(), o.LatLng = function (t, e, n) { if (isNaN(t) || isNaN(e)) throw new Error("Invalid LatLng object: (" + t + ", " + e + ")"); this.lat = +t, this.lng = +e, n !== i && (this.alt = +n) }, o.LatLng.prototype = { equals: function (t, e) { if (!t) return !1; t = o.latLng(t); var n = Math.max(Math.abs(this.lat - t.lat), Math.abs(this.lng - t.lng)); return (e === i ? 1e-9 : e) >= n }, toString: function (t) { return "LatLng(" + o.Util.formatNum(this.lat, t) + ", " + o.Util.formatNum(this.lng, t) + ")" }, distanceTo: function (t) { return o.CRS.Earth.distance(this, o.latLng(t)) }, wrap: function () { return o.CRS.Earth.wrapLatLng(this) }, toBounds: function (t) { var e = 180 * t / 40075017, i = e / Math.cos(Math.PI / 180 * this.lat); return o.latLngBounds([this.lat - e, this.lng - i], [this.lat + e, this.lng + i]) }, clone: function () { return new o.LatLng(this.lat, this.lng, this.alt) } }, o.latLng = function (t, e, n) { return t instanceof o.LatLng ? t : o.Util.isArray(t) && "object" != typeof t[0] ? 3 === t.length ? new o.LatLng(t[0], t[1], t[2]) : 2 === t.length ? new o.LatLng(t[0], t[1]) : null : t === i || null === t ? t : "object" == typeof t && "lat" in t ? new o.LatLng(t.lat, "lng" in t ? t.lng : t.lon, t.alt) : e === i ? null : new o.LatLng(t, e, n) }, o.LatLngBounds = function (t, e) { if (t) for (var i = e ? [t, e] : t, n = 0, o = i.length; o > n; n++) this.extend(i[n]) }, o.LatLngBounds.prototype = { extend: function (t) { var e, i, n = this._southWest, s = this._northEast; if (t instanceof o.LatLng) e = t, i = t; else { if (!(t instanceof o.LatLngBounds)) return t ? this.extend(o.latLng(t) || o.latLngBounds(t)) : this; if (e = t._southWest, i = t._northEast, !e || !i) return this } return n || s ? (n.lat = Math.min(e.lat, n.lat), n.lng = Math.min(e.lng, n.lng), s.lat = Math.max(i.lat, s.lat), s.lng = Math.max(i.lng, s.lng)) : (this._southWest = new o.LatLng(e.lat, e.lng), this._northEast = new o.LatLng(i.lat, i.lng)), this }, pad: function (t) { var e = this._southWest, i = this._northEast, n = Math.abs(e.lat - i.lat) * t, s = Math.abs(e.lng - i.lng) * t; return new o.LatLngBounds(new o.LatLng(e.lat - n, e.lng - s), new o.LatLng(i.lat + n, i.lng + s)) }, getCenter: function () { return new o.LatLng((this._southWest.lat + this._northEast.lat) / 2, (this._southWest.lng + this._northEast.lng) / 2) }, getSouthWest: function () { return this._southWest }, getNorthEast: function () { return this._northEast }, getNorthWest: function () { return new o.LatLng(this.getNorth(), this.getWest()) }, getSouthEast: function () { return new o.LatLng(this.getSouth(), this.getEast()) }, getWest: function () { return this._southWest.lng }, getSouth: function () { return this._southWest.lat }, getEast: function () { return this._northEast.lng }, getNorth: function () { return this._northEast.lat }, contains: function (t) { t = "number" == typeof t[0] || t instanceof o.LatLng ? o.latLng(t) : o.latLngBounds(t); var e, i, n = this._southWest, s = this._northEast; return t instanceof o.LatLngBounds ? (e = t.getSouthWest(), i = t.getNorthEast()) : e = i = t, e.lat >= n.lat && i.lat <= s.lat && e.lng >= n.lng && i.lng <= s.lng }, intersects: function (t) { t = o.latLngBounds(t); var e = this._southWest, i = this._northEast, n = t.getSouthWest(), s = t.getNorthEast(), r = s.lat >= e.lat && n.lat <= i.lat, a = s.lng >= e.lng && n.lng <= i.lng; return r && a }, overlaps: function (t) { t = o.latLngBounds(t); var e = this._southWest, i = this._northEast, n = t.getSouthWest(), s = t.getNorthEast(), r = s.lat > e.lat && n.lat < i.lat, a = s.lng > e.lng && n.lng < i.lng; return r && a }, toBBoxString: function () { return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(",") }, equals: function (t) { return t ? (t = o.latLngBounds(t), this._southWest.equals(t.getSouthWest()) && this._northEast.equals(t.getNorthEast())) : !1 }, isValid: function () { return !(!this._southWest || !this._northEast) } }, o.latLngBounds = function (t, e) { return !t || t instanceof o.LatLngBounds ? t : new o.LatLngBounds(t, e) }, o.Projection = {}, o.Projection.LonLat = { project: function (t) { return new o.Point(t.lng, t.lat) }, unproject: function (t) { return new o.LatLng(t.y, t.x) }, bounds: o.bounds([-180, -90], [180, 90]) }, o.Projection.SphericalMercator = { R: 6378137, project: function (t) { var e = Math.PI / 180, i = 1 - 1e-15, n = Math.max(Math.min(Math.sin(t.lat * e), i), -i); return new o.Point(this.R * t.lng * e, this.R * Math.log((1 + n) / (1 - n)) / 2) }, unproject: function (t) { var e = 180 / Math.PI; return new o.LatLng((2 * Math.atan(Math.exp(t.y / this.R)) - Math.PI / 2) * e, t.x * e / this.R) }, bounds: function () { var t = 6378137 * Math.PI; return o.bounds([-t, -t], [t, t]) }() }, o.CRS = { latLngToPoint: function (t, e) { var i = this.projection.project(t), n = this.scale(e); return this.transformation._transform(i, n) }, pointToLatLng: function (t, e) { var i = this.scale(e), n = this.transformation.untransform(t, i); return this.projection.unproject(n) }, project: function (t) { return this.projection.project(t) }, unproject: function (t) { return this.projection.unproject(t) }, scale: function (t) { return 256 * Math.pow(2, t) }, getProjectedBounds: function (t) { if (this.infinite) return null; var e = this.projection.bounds, i = this.scale(t), n = this.transformation.transform(e.min, i), s = this.transformation.transform(e.max, i); return o.bounds(n, s) }, wrapLatLng: function (t) { var e = this.wrapLng ? o.Util.wrapNum(t.lng, this.wrapLng, !0) : t.lng, i = this.wrapLat ? o.Util.wrapNum(t.lat, this.wrapLat, !0) : t.lat, n = t.alt; return o.latLng(i, e, n) } }, o.CRS.Simple = o.extend({}, o.CRS, { projection: o.Projection.LonLat, transformation: new o.Transformation(1, 0, -1, 0), scale: function (t) { return Math.pow(2, t) }, distance: function (t, e) { var i = e.lng - t.lng, n = e.lat - t.lat; return Math.sqrt(i * i + n * n) }, infinite: !0 }), o.CRS.Earth = o.extend({}, o.CRS, { wrapLng: [-180, 180], R: 6378137, distance: function (t, e) { var i = Math.PI / 180, n = t.lat * i, o = e.lat * i, s = Math.sin(n) * Math.sin(o) + Math.cos(n) * Math.cos(o) * Math.cos((e.lng - t.lng) * i); return this.R * Math.acos(Math.min(s, 1)) } }), o.CRS.EPSG3857 = o.extend({}, o.CRS.Earth, { code: "EPSG:3857", projection: o.Projection.SphericalMercator, transformation: function () { var t = .5 / (Math.PI * o.Projection.SphericalMercator.R); return new o.Transformation(t, .5, -t, .5) }() }), o.CRS.EPSG900913 = o.extend({}, o.CRS.EPSG3857, { code: "EPSG:900913" }), o.CRS.EPSG4326 = o.extend({}, o.CRS.Earth, { code: "EPSG:4326", projection: o.Projection.LonLat, transformation: new o.Transformation(1 / 180, 1, -1 / 180, .5) }), o.Map = o.Evented.extend({
        options: { crs: o.CRS.EPSG3857, fadeAnimation: !0, trackResize: !0, markerZoomAnimation: !0, maxBoundsViscosity: 0 }, initialize: function (t, e) { e = o.setOptions(this, e), this._initContainer(t), this._initLayout(), this._onResize = o.bind(this._onResize, this), this._initEvents(), e.maxBounds && this.setMaxBounds(e.maxBounds), e.zoom !== i && (this._zoom = this._limitZoom(e.zoom)), e.center && e.zoom !== i && this.setView(o.latLng(e.center), e.zoom, { reset: !0 }), this._handlers = [], this._layers = {}, this._zoomBoundLayers = {}, this._sizeChanged = !0, this.callInitHooks(), this._addLayers(this.options.layers) }, setView: function (t, e) { return e = e === i ? this.getZoom() : e, this._resetView(o.latLng(t), e), this }, setZoom: function (t, e) { return this._loaded ? this.setView(this.getCenter(), t, { zoom: e }) : (this._zoom = t, this) }, zoomIn: function (t, e) { return this.setZoom(this._zoom + (t || 1), e) }, zoomOut: function (t, e) { return this.setZoom(this._zoom - (t || 1), e) }, setZoomAround: function (t, e, i) { var n = this.getZoomScale(e), s = this.getSize().divideBy(2), r = t instanceof o.Point ? t : this.latLngToContainerPoint(t), a = r.subtract(s).multiplyBy(1 - 1 / n), h = this.containerPointToLatLng(s.add(a)); return this.setView(h, e, { zoom: i }) }, _getBoundsCenterZoom: function (t, e) { e = e || {}, t = t.getBounds ? t.getBounds() : o.latLngBounds(t); var i = o.point(e.paddingTopLeft || e.padding || [0, 0]), n = o.point(e.paddingBottomRight || e.padding || [0, 0]), s = this.getBoundsZoom(t, !1, i.add(n)); s = e.maxZoom ? Math.min(e.maxZoom, s) : s; var r = n.subtract(i).divideBy(2), a = this.project(t.getSouthWest(), s), h = this.project(t.getNorthEast(), s), l = this.unproject(a.add(h).divideBy(2).add(r), s); return { center: l, zoom: s } }, fitBounds: function (t, e) { var i = this._getBoundsCenterZoom(t, e); return this.setView(i.center, i.zoom, e) }, fitWorld: function (t) { return this.fitBounds([[-90, -180], [90, 180]], t) }, panTo: function (t, e) { return this.setView(t, this._zoom, { pan: e }) }, panBy: function (t) { return this.fire("movestart"), this._rawPanBy(o.point(t)), this.fire("move"), this.fire("moveend") }, setMaxBounds: function (t) { return (t = o.latLngBounds(t)) ? (this.options.maxBounds && this.off("moveend", this._panInsideMaxBounds), this.options.maxBounds = t, this._loaded && this._panInsideMaxBounds(), this.on("moveend", this._panInsideMaxBounds)) : this.off("moveend", this._panInsideMaxBounds) }, setMinZoom: function (t) { return this.options.minZoom = t, this._loaded && this.getZoom() < this.options.minZoom ? this.setZoom(t) : this }, setMaxZoom: function (t) { return this.options.maxZoom = t, this._loaded && this.getZoom() > this.options.maxZoom ? this.setZoom(t) : this }, panInsideBounds: function (t, e) { var i = this.getCenter(), n = this._limitCenter(i, this._zoom, o.latLngBounds(t)); return i.equals(n) ? this : this.panTo(n, e) }, invalidateSize: function (t) { if (!this._loaded) return this; t = o.extend({ animate: !1, pan: !0 }, t === !0 ? { animate: !0 } : t); var e = this.getSize(); this._sizeChanged = !0, this._lastCenter = null; var i = this.getSize(), n = e.divideBy(2).round(), s = i.divideBy(2).round(), r = n.subtract(s); return r.x || r.y ? (t.animate && t.pan ? this.panBy(r) : (t.pan && this._rawPanBy(r), this.fire("move"), t.debounceMoveend ? (clearTimeout(this._sizeTimer), this._sizeTimer = setTimeout(o.bind(this.fire, this, "moveend"), 200)) : this.fire("moveend")), this.fire("resize", { oldSize: e, newSize: i })) : this }, stop: function () { return o.Util.cancelAnimFrame(this._flyToFrame), this._panAnim && this._panAnim.stop(), this }, addHandler: function (t, e) { if (!e) return this; var i = this[t] = new e(this); return this._handlers.push(i), this.options[t] && i.enable(), this }, remove: function () { this._initEvents(!0); try { delete this._container._leaflet } catch (t) { this._container._leaflet = i } o.DomUtil.remove(this._mapPane), this._clearControlPos && this._clearControlPos(), this._clearHandlers(), this._loaded && this.fire("unload"); for (var e in this._layers) this._layers[e].remove(); return this }, createPane: function (t, e) { var i = "leaflet-pane" + (t ? " leaflet-" + t.replace("Pane", "") + "-pane" : ""), n = o.DomUtil.create("div", i, e || this._mapPane); return t && (this._panes[t] = n), n }, getCenter: function () { return this._checkIfLoaded(), this._lastCenter && !this._moved() ? this._lastCenter : this.layerPointToLatLng(this._getCenterLayerPoint()) }, getZoom: function () { return this._zoom }, getBounds: function () { var t = this.getPixelBounds(), e = this.unproject(t.getBottomLeft()), i = this.unproject(t.getTopRight()); return new o.LatLngBounds(e, i) }, getMinZoom: function () { return this.options.minZoom === i ? this._layersMinZoom || 0 : this.options.minZoom }, getMaxZoom: function () { return this.options.maxZoom === i ? this._layersMaxZoom === i ? 1 / 0 : this._layersMaxZoom : this.options.maxZoom }, getBoundsZoom: function (t, e, i) { t = o.latLngBounds(t); var n, s = this.getMinZoom() - (e ? 1 : 0), r = this.getMaxZoom(), a = this.getSize(), h = t.getNorthWest(), l = t.getSouthEast(), u = !0; i = o.point(i || [0, 0]); do s++, n = this.project(l, s).subtract(this.project(h, s)).add(i).floor(), u = e ? n.x < a.x || n.y < a.y : a.contains(n); while (u && r >= s); return u && e ? null : e ? s : s - 1 }, getSize: function () { return (!this._size || this._sizeChanged) && (this._size = new o.Point(this._container.clientWidth, this._container.clientHeight), this._sizeChanged = !1), this._size.clone() }, getPixelBounds: function (t, e) { var i = this._getTopLeftPoint(t, e); return new o.Bounds(i, i.add(this.getSize())) }, getPixelOrigin: function () { return this._checkIfLoaded(), this._pixelOrigin }, getPixelWorldBounds: function (t) { return this.options.crs.getProjectedBounds(t === i ? this.getZoom() : t) }, getPane: function (t) { return "string" == typeof t ? this._panes[t] : t }, getPanes: function () { return this._panes }, getContainer: function () { return this._container }, getZoomScale: function (t, e) { var n = this.options.crs; return e = e === i ? this._zoom : e, n.scale(t) / n.scale(e) }, getScaleZoom: function (t, e) { return e = e === i ? this._zoom : e, e + Math.log(t) / Math.LN2 }, project: function (t, e) { return e = e === i ? this._zoom : e, this.options.crs.latLngToPoint(o.latLng(t), e) }, unproject: function (t, e) { return e = e === i ? this._zoom : e, this.options.crs.pointToLatLng(o.point(t), e) }, layerPointToLatLng: function (t) { var e = o.point(t).add(this.getPixelOrigin()); return this.unproject(e) }, latLngToLayerPoint: function (t) { var e = this.project(o.latLng(t))._round(); return e._subtract(this.getPixelOrigin()) }, wrapLatLng: function (t) { return this.options.crs.wrapLatLng(o.latLng(t)) }, distance: function (t, e) { return this.options.crs.distance(o.latLng(t), o.latLng(e)) }, containerPointToLayerPoint: function (t) { return o.point(t).subtract(this._getMapPanePos()) }, layerPointToContainerPoint: function (t) { return o.point(t).add(this._getMapPanePos()) }, containerPointToLatLng: function (t) { var e = this.containerPointToLayerPoint(o.point(t)); return this.layerPointToLatLng(e) }, latLngToContainerPoint: function (t) { return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t))) }, mouseEventToContainerPoint: function (t) { return o.DomEvent.getMousePosition(t, this._container) }, mouseEventToLayerPoint: function (t) { return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t)) }, mouseEventToLatLng: function (t) { return this.layerPointToLatLng(this.mouseEventToLayerPoint(t)) }, _initContainer: function (t) { var e = this._container = o.DomUtil.get(t); if (!e) throw new Error("Map container not found."); if (e._leaflet) throw new Error("Map container is already initialized."); o.DomEvent.addListener(e, "scroll", this._onScroll, this), e._leaflet = !0 }, _initLayout: function () { var t = this._container; this._fadeAnimated = this.options.fadeAnimation && o.Browser.any3d, o.DomUtil.addClass(t, "leaflet-container" + (o.Browser.touch ? " leaflet-touch" : "") + (o.Browser.retina ? " leaflet-retina" : "") + (o.Browser.ielt9 ? " leaflet-oldie" : "") + (o.Browser.safari ? " leaflet-safari" : "") + (this._fadeAnimated ? " leaflet-fade-anim" : "")); var e = o.DomUtil.getStyle(t, "position"); "absolute" !== e && "relative" !== e && "fixed" !== e && (t.style.position = "relative"), this._initPanes(), this._initControlPos && this._initControlPos() }, _initPanes: function () { var t = this._panes = {}; this._paneRenderers = {}, this._mapPane = this.createPane("mapPane", this._container), o.DomUtil.setPosition(this._mapPane, new o.Point(0, 0)), this.createPane("tilePane"), this.createPane("shadowPane"), this.createPane("overlayPane"), this.createPane("markerPane"), this.createPane("popupPane"), this.options.markerZoomAnimation || (o.DomUtil.addClass(t.markerPane, "leaflet-zoom-hide"), o.DomUtil.addClass(t.shadowPane, "leaflet-zoom-hide")) }, _resetView: function (t, e) { o.DomUtil.setPosition(this._mapPane, new o.Point(0, 0)); var i = !this._loaded; this._loaded = !0, e = this._limitZoom(e); var n = this._zoom !== e; this._moveStart(n)._move(t, e)._moveEnd(n), this.fire("viewreset"), i && this.fire("load") }, _moveStart: function (t) { return t && this.fire("zoomstart"), this.fire("movestart") }, _move: function (t, e, n) { e === i && (e = this._zoom); var o = this._zoom !== e; return this._zoom = e, this._lastCenter = t, this._pixelOrigin = this._getNewPixelOrigin(t), o && this.fire("zoom", n), this.fire("move", n) }, _moveEnd: function (t) { return t && this.fire("zoomend"), this.fire("moveend") }, _rawPanBy: function (t) { o.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(t)) }, _getZoomSpan: function () { return this.getMaxZoom() - this.getMinZoom() }, _panInsideMaxBounds: function () { this.panInsideBounds(this.options.maxBounds) }, _checkIfLoaded: function () { if (!this._loaded) throw new Error("Set map center and zoom first.") }, _initEvents: function (e) { if (o.DomEvent) { this._targets = {}, this._targets[o.stamp(this._container)] = this; var i = e ? "off" : "on"; o.DomEvent[i](this._container, "click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress", this._handleDOMEvent, this), this.options.trackResize && o.DomEvent[i](t, "resize", this._onResize, this) } }, _onResize: function () { o.Util.cancelAnimFrame(this._resizeRequest), this._resizeRequest = o.Util.requestAnimFrame(function () { this.invalidateSize({ debounceMoveend: !0 }) }, this) }, _onScroll: function () { this._container.scrollTop = 0, this._container.scrollLeft = 0 }, _findEventTargets: function (t, e, i) { for (var n, s = []; t && (n = this._targets[o.stamp(t)], n && n.listens(e, !0) && s.push(n), i) && t !== this._container;) t = t.parentNode; return s }, _handleDOMEvent: function (t) { if (this._loaded && !o.DomEvent._skipped(t)) { var e = "keypress" === t.type && 13 === t.keyCode ? "click" : t.type; if ("click" === t.type) { var i = o.Util.extend({}, t); i.type = "preclick", this._handleDOMEvent(i) } "mousedown" === e && o.DomUtil.preventOutline(t.target || t.srcElement), this._fireDOMEvent(t, e) } }, _fireDOMEvent: function (t, e, i) { var n = "mouseover" === e || "mouseout" === e; if (i = (i || []).concat(this._findEventTargets(t.target || t.srcElement, e, !n)), i.length) "contextmenu" === e && o.DomEvent.preventDefault(t); else if (i = [this], n && !o.DomEvent._checkMouse(this._container, t)) return; var s = i[0]; if ("click" !== t.type && "preclick" !== t.type || t._simulated || !this._draggableMoved(s)) { var r = { originalEvent: t }; if ("keypress" !== t.type) { var a = s instanceof o.Marker; r.containerPoint = a ? this.latLngToContainerPoint(s.getLatLng()) : this.mouseEventToContainerPoint(t), r.layerPoint = this.containerPointToLayerPoint(r.containerPoint), r.latlng = a ? s.getLatLng() : this.layerPointToLatLng(r.layerPoint) } for (var h = 0; h < i.length; h++) if (i[h].fire(e, r, !0), r.originalEvent._stopped || i[h].options.nonBubblingEvents && -1 !== o.Util.indexOf(i[h].options.nonBubblingEvents, e)) return } }, _draggableMoved: function (t) { return t = t.options.draggable ? t : this, t.dragging && t.dragging.moved() || this.boxZoom && this.boxZoom.moved() }, _clearHandlers: function () { for (var t = 0, e = this._handlers.length; e > t; t++) this._handlers[t].disable() }, whenReady: function (t, e) { return this._loaded ? t.call(e || this, { target: this }) : this.on("load", t, e), this }, _getMapPanePos: function () { return o.DomUtil.getPosition(this._mapPane) || new o.Point(0, 0) }, _moved: function () { var t = this._getMapPanePos(); return t && !t.equals([0, 0]) }, _getTopLeftPoint: function (t, e) { var n = t && e !== i ? this._getNewPixelOrigin(t, e) : this.getPixelOrigin(); return n.subtract(this._getMapPanePos()) }, _getNewPixelOrigin: function (t, e) { var i = this.getSize()._divideBy(2); return this.project(t, e)._subtract(i)._add(this._getMapPanePos())._round() }, _latLngToNewLayerPoint: function (t, e, i) { var n = this._getNewPixelOrigin(i, e); return this.project(t, e)._subtract(n) }, _getCenterLayerPoint: function () { return this.containerPointToLayerPoint(this.getSize()._divideBy(2)) }, _getCenterOffset: function (t) { return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint()) }, _limitCenter: function (t, e, i) { if (!i) return t; var n = this.project(t, e), s = this.getSize().divideBy(2), r = new o.Bounds(n.subtract(s), n.add(s)), a = this._getBoundsOffset(r, i, e); return this.unproject(n.add(a), e) }, _limitOffset: function (t, e) {
            if (!e) return t; var i = this.getPixelBounds(), n = new o.Bounds(i.min.add(t), i.max.add(t));
            return t.add(this._getBoundsOffset(n, e))
        }, _getBoundsOffset: function (t, e, i) { var n = this.project(e.getNorthWest(), i).subtract(t.min), s = this.project(e.getSouthEast(), i).subtract(t.max), r = this._rebound(n.x, -s.x), a = this._rebound(n.y, -s.y); return new o.Point(r, a) }, _rebound: function (t, e) { return t + e > 0 ? Math.round(t - e) / 2 : Math.max(0, Math.ceil(t)) - Math.max(0, Math.floor(e)) }, _limitZoom: function (t) { var e = this.getMinZoom(), i = this.getMaxZoom(); return o.Browser.any3d || (t = Math.round(t)), Math.max(e, Math.min(i, t)) }
    }), o.map = function (t, e) { return new o.Map(t, e) }, o.Layer = o.Evented.extend({ options: { pane: "overlayPane", nonBubblingEvents: [] }, addTo: function (t) { return t.addLayer(this), this }, remove: function () { return this.removeFrom(this._map || this._mapToAdd) }, removeFrom: function (t) { return t && t.removeLayer(this), this }, getPane: function (t) { return this._map.getPane(t ? this.options[t] || t : this.options.pane) }, addInteractiveTarget: function (t) { return this._map._targets[o.stamp(t)] = this, this }, removeInteractiveTarget: function (t) { return delete this._map._targets[o.stamp(t)], this }, isPopupOpen: function () { return this._popup.isOpen() }, _layerAdd: function (t) { var e = t.target; e.hasLayer(this) && (this._map = e, this._zoomAnimated = e._zoomAnimated, this.onAdd(e), this.getAttribution && this._map.attributionControl && this._map.attributionControl.addAttribution(this.getAttribution()), this.getEvents && e.on(this.getEvents(), this), this.fire("add"), e.fire("layeradd", { layer: this })) } }), o.Map.include({ addLayer: function (t) { var e = o.stamp(t); return this._layers[e] ? t : (this._layers[e] = t, t._mapToAdd = this, t.beforeAdd && t.beforeAdd(this), this.whenReady(t._layerAdd, t), this) }, removeLayer: function (t) { var e = o.stamp(t); return this._layers[e] ? (this._loaded && t.onRemove(this), t.getAttribution && this.attributionControl && this.attributionControl.removeAttribution(t.getAttribution()), t.getEvents && this.off(t.getEvents(), t), delete this._layers[e], this._loaded && (this.fire("layerremove", { layer: t }), t.fire("remove")), t._map = t._mapToAdd = null, this) : this }, hasLayer: function (t) { return !!t && o.stamp(t) in this._layers }, eachLayer: function (t, e) { for (var i in this._layers) t.call(e, this._layers[i]); return this }, _addLayers: function (t) { t = t ? o.Util.isArray(t) ? t : [t] : []; for (var e = 0, i = t.length; i > e; e++) this.addLayer(t[e]) }, _addZoomLimit: function (t) { (isNaN(t.options.maxZoom) || !isNaN(t.options.minZoom)) && (this._zoomBoundLayers[o.stamp(t)] = t, this._updateZoomLevels()) }, _removeZoomLimit: function (t) { var e = o.stamp(t); this._zoomBoundLayers[e] && (delete this._zoomBoundLayers[e], this._updateZoomLevels()) }, _updateZoomLevels: function () { var t = 1 / 0, e = -(1 / 0), n = this._getZoomSpan(); for (var o in this._zoomBoundLayers) { var s = this._zoomBoundLayers[o].options; t = s.minZoom === i ? t : Math.min(t, s.minZoom), e = s.maxZoom === i ? e : Math.max(e, s.maxZoom) } this._layersMaxZoom = e === -(1 / 0) ? i : e, this._layersMinZoom = t === 1 / 0 ? i : t, n !== this._getZoomSpan() && this.fire("zoomlevelschange") } }), o.Projection.Mercator = { R: 6378137, R_MINOR: 6356752.314245179, bounds: o.bounds([-20037508.34279, -15496570.73972], [20037508.34279, 18764656.23138]), project: function (t) { var e = Math.PI / 180, i = this.R, n = t.lat * e, s = this.R_MINOR / i, r = Math.sqrt(1 - s * s), a = r * Math.sin(n), h = Math.tan(Math.PI / 4 - n / 2) / Math.pow((1 - a) / (1 + a), r / 2); return n = -i * Math.log(Math.max(h, 1e-10)), new o.Point(t.lng * e * i, n) }, unproject: function (t) { for (var e, i = 180 / Math.PI, n = this.R, s = this.R_MINOR / n, r = Math.sqrt(1 - s * s), a = Math.exp(-t.y / n), h = Math.PI / 2 - 2 * Math.atan(a), l = 0, u = .1; 15 > l && Math.abs(u) > 1e-7; l++) e = r * Math.sin(h), e = Math.pow((1 - e) / (1 + e), r / 2), u = Math.PI / 2 - 2 * Math.atan(a * e) - h, h += u; return new o.LatLng(h * i, t.x * i / n) } }, o.CRS.EPSG3395 = o.extend({}, o.CRS.Earth, { code: "EPSG:3395", projection: o.Projection.Mercator, transformation: function () { var t = .5 / (Math.PI * o.Projection.Mercator.R); return new o.Transformation(t, .5, -t, .5) }() }), o.GridLayer = o.Layer.extend({ options: { pane: "tilePane", tileSize: 256, opacity: 1, updateWhenIdle: o.Browser.mobile, updateInterval: 200, attribution: null, zIndex: null, bounds: null, minZoom: 0 }, initialize: function (t) { t = o.setOptions(this, t) }, onAdd: function () { this._initContainer(), this._levels = {}, this._tiles = {}, this._resetView(), this._update() }, beforeAdd: function (t) { t._addZoomLimit(this) }, onRemove: function (t) { o.DomUtil.remove(this._container), t._removeZoomLimit(this), this._container = null, this._tileZoom = null }, bringToFront: function () { return this._map && (o.DomUtil.toFront(this._container), this._setAutoZIndex(Math.max)), this }, bringToBack: function () { return this._map && (o.DomUtil.toBack(this._container), this._setAutoZIndex(Math.min)), this }, getAttribution: function () { return this.options.attribution }, getContainer: function () { return this._container }, setOpacity: function (t) { return this.options.opacity = t, this._updateOpacity(), this }, setZIndex: function (t) { return this.options.zIndex = t, this._updateZIndex(), this }, isLoading: function () { return this._loading }, redraw: function () { return this._map && (this._removeAllTiles(), this._update()), this }, getEvents: function () { var t = { viewreset: this._resetAll, zoom: this._resetView, moveend: this._onMoveEnd }; return this.options.updateWhenIdle || (this._onMove || (this._onMove = o.Util.throttle(this._onMoveEnd, this.options.updateInterval, this)), t.move = this._onMove), this._zoomAnimated && (t.zoomanim = this._animateZoom), t }, createTile: function () { return e.createElement("div") }, getTileSize: function () { var t = this.options.tileSize; return t instanceof o.Point ? t : new o.Point(t, t) }, _updateZIndex: function () { this._container && this.options.zIndex !== i && null !== this.options.zIndex && (this._container.style.zIndex = this.options.zIndex) }, _setAutoZIndex: function (t) { for (var e, i = this.getPane().children, n = -t(-(1 / 0), 1 / 0), o = 0, s = i.length; s > o; o++) e = i[o].style.zIndex, i[o] !== this._container && e && (n = t(n, +e)); isFinite(n) && (this.options.zIndex = n + t(-1, 1), this._updateZIndex()) }, _updateOpacity: function () { if (this._map && !o.Browser.ielt9 && this._map._fadeAnimated) { o.DomUtil.setOpacity(this._container, this.options.opacity); var t = +new Date, e = !1, i = !1; for (var n in this._tiles) { var s = this._tiles[n]; if (s.current && s.loaded) { var r = Math.min(1, (t - s.loaded) / 200); o.DomUtil.setOpacity(s.el, r), 1 > r ? e = !0 : (s.active && (i = !0), s.active = !0) } } i && this._pruneTiles(), e && (o.Util.cancelAnimFrame(this._fadeFrame), this._fadeFrame = o.Util.requestAnimFrame(this._updateOpacity, this)) } }, _initContainer: function () { this._container || (this._container = o.DomUtil.create("div", "leaflet-layer"), this._updateZIndex(), this.options.opacity < 1 && this._updateOpacity(), this.getPane().appendChild(this._container)) }, _updateLevels: function () { var t = this._tileZoom, e = this.options.maxZoom; for (var i in this._levels) this._levels[i].el.children.length || i === t ? this._levels[i].el.style.zIndex = e - Math.abs(t - i) : (o.DomUtil.remove(this._levels[i].el), delete this._levels[i]); var n = this._levels[t], s = this._map; return n || (n = this._levels[t] = {}, n.el = o.DomUtil.create("div", "leaflet-tile-container leaflet-zoom-animated", this._container), n.el.style.zIndex = e, n.origin = s.project(s.unproject(s.getPixelOrigin()), t).round(), n.zoom = t, this._setZoomTransform(n, s.getCenter(), s.getZoom()), o.Util.falseFn(n.el.offsetWidth)), this._level = n, n }, _pruneTiles: function () { var t, e, i = this._map.getZoom(); if (i > this.options.maxZoom || i < this.options.minZoom) return this._removeAllTiles(); for (t in this._tiles) e = this._tiles[t], e.retain = e.current; for (t in this._tiles) if (e = this._tiles[t], e.current && !e.active) { var n = e.coords; this._retainParent(n.x, n.y, n.z, n.z - 5) || this._retainChildren(n.x, n.y, n.z, n.z + 2) } for (t in this._tiles) this._tiles[t].retain || this._removeTile(t) }, _removeAllTiles: function () { for (var t in this._tiles) this._removeTile(t) }, _resetAll: function () { for (var t in this._levels) o.DomUtil.remove(this._levels[t].el), delete this._levels[t]; this._removeAllTiles(), this._tileZoom = null, this._resetView() }, _retainParent: function (t, e, i, n) { var o = Math.floor(t / 2), s = Math.floor(e / 2), r = i - 1, a = o + ":" + s + ":" + r, h = this._tiles[a]; return h && h.active ? (h.retain = !0, !0) : (h && h.loaded && (h.retain = !0), r > n ? this._retainParent(o, s, r, n) : !1) }, _retainChildren: function (t, e, i, n) { for (var o = 2 * t; 2 * t + 2 > o; o++) for (var s = 2 * e; 2 * e + 2 > s; s++) { var r = o + ":" + s + ":" + (i + 1), a = this._tiles[r]; a && a.active ? a.retain = !0 : (a && a.loaded && (a.retain = !0), n > i + 1 && this._retainChildren(o, s, i + 1, n)) } }, _resetView: function (t) { var e = t && t.pinch; this._setView(this._map.getCenter(), this._map.getZoom(), e, e) }, _animateZoom: function (t) { this._setView(t.center, t.zoom, !0, t.noUpdate) }, _setView: function (t, e, i, n) { var s = Math.round(e), r = this._tileZoom !== s; !n && r && (this._abortLoading && this._abortLoading(), this._tileZoom = s, this._updateLevels(), this._resetGrid(), o.Browser.mobileWebkit || this._update(t, s), i || this._pruneTiles()), this._setZoomTransforms(t, e) }, _setZoomTransforms: function (t, e) { for (var i in this._levels) this._setZoomTransform(this._levels[i], t, e) }, _setZoomTransform: function (t, e, i) { var n = this._map.getZoomScale(i, t.zoom), s = t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e, i)).round(); o.Browser.any3d ? o.DomUtil.setTransform(t.el, s, n) : o.DomUtil.setPosition(t.el, s) }, _resetGrid: function () { var t = this._map, e = t.options.crs, i = this._tileSize = this.getTileSize(), n = this._tileZoom, o = this._map.getPixelWorldBounds(this._tileZoom); o && (this._globalTileRange = this._pxBoundsToTileRange(o)), this._wrapX = e.wrapLng && [Math.floor(t.project([0, e.wrapLng[0]], n).x / i.x), Math.ceil(t.project([0, e.wrapLng[1]], n).x / i.y)], this._wrapY = e.wrapLat && [Math.floor(t.project([e.wrapLat[0], 0], n).y / i.x), Math.ceil(t.project([e.wrapLat[1], 0], n).y / i.y)] }, _onMoveEnd: function () { this._map && (this._update(), this._pruneTiles()) }, _getTiledPixelBounds: function (t, e, i) { var n = this._map, s = n.getZoomScale(e, i), r = n.project(t, i).floor(), a = n.getSize().divideBy(2 * s); return new o.Bounds(r.subtract(a), r.add(a)) }, _update: function (t, n) { var s = this._map; if (s) { t === i && (t = s.getCenter()), n === i && (n = s.getZoom()); var r = Math.round(n); if (!(r > this.options.maxZoom || r < this.options.minZoom)) { var a = this._getTiledPixelBounds(t, n, r), h = this._pxBoundsToTileRange(a), l = h.getCenter(), u = []; for (var c in this._tiles) this._tiles[c].current = !1; for (var d = h.min.y; d <= h.max.y; d++) for (var _ = h.min.x; _ <= h.max.x; _++) { var m = new o.Point(_, d); if (m.z = r, this._isValidTile(m)) { var p = this._tiles[this._tileCoordsToKey(m)]; p ? p.current = !0 : u.push(m) } } if (u.sort(function (t, e) { return t.distanceTo(l) - e.distanceTo(l) }), 0 !== u.length) { this._loading || (this._loading = !0, this.fire("loading")); var f = e.createDocumentFragment(); for (_ = 0; _ < u.length; _++) this._addTile(u[_], f); this._level.el.appendChild(f) } } } }, _isValidTile: function (t) { var e = this._map.options.crs; if (!e.infinite) { var i = this._globalTileRange; if (!e.wrapLng && (t.x < i.min.x || t.x > i.max.x) || !e.wrapLat && (t.y < i.min.y || t.y > i.max.y)) return !1 } if (!this.options.bounds) return !0; var n = this._tileCoordsToBounds(t); return o.latLngBounds(this.options.bounds).overlaps(n) }, _keyToBounds: function (t) { return this._tileCoordsToBounds(this._keyToTileCoords(t)) }, _tileCoordsToBounds: function (t) { var e = this._map, i = this.getTileSize(), n = t.scaleBy(i), s = n.add(i), r = e.wrapLatLng(e.unproject(n, t.z)), a = e.wrapLatLng(e.unproject(s, t.z)); return new o.LatLngBounds(r, a) }, _tileCoordsToKey: function (t) { return t.x + ":" + t.y + ":" + t.z }, _keyToTileCoords: function (t) { var e = t.split(":"), i = new o.Point(+e[0], +e[1]); return i.z = +e[2], i }, _removeTile: function (t) { var e = this._tiles[t]; e && (o.DomUtil.remove(e.el), delete this._tiles[t], this.fire("tileunload", { tile: e.el, coords: this._keyToTileCoords(t) })) }, _initTile: function (t) { o.DomUtil.addClass(t, "leaflet-tile"); var e = this.getTileSize(); t.style.width = e.x + "px", t.style.height = e.y + "px", t.onselectstart = o.Util.falseFn, t.onmousemove = o.Util.falseFn, o.Browser.ielt9 && this.options.opacity < 1 && o.DomUtil.setOpacity(t, this.options.opacity), o.Browser.android && !o.Browser.android23 && (t.style.WebkitBackfaceVisibility = "hidden") }, _addTile: function (t, e) { var i = this._getTilePos(t), n = this._tileCoordsToKey(t), s = this.createTile(this._wrapCoords(t), o.bind(this._tileReady, this, t)); this._initTile(s), this.createTile.length < 2 && setTimeout(o.bind(this._tileReady, this, t, null, s), 0), o.DomUtil.setPosition(s, i), this._tiles[n] = { el: s, coords: t, current: !0 }, e.appendChild(s), this.fire("tileloadstart", { tile: s, coords: t }) }, _tileReady: function (t, e, i) { if (this._map) { e && this.fire("tileerror", { error: e, tile: i, coords: t }); var n = this._tileCoordsToKey(t); i = this._tiles[n], i && (i.loaded = +new Date, this._map._fadeAnimated ? (o.DomUtil.setOpacity(i.el, 0), o.Util.cancelAnimFrame(this._fadeFrame), this._fadeFrame = o.Util.requestAnimFrame(this._updateOpacity, this)) : (i.active = !0, this._pruneTiles()), o.DomUtil.addClass(i.el, "leaflet-tile-loaded"), this.fire("tileload", { tile: i.el, coords: t }), this._noTilesToLoad() && (this._loading = !1, this.fire("load"))) } }, _getTilePos: function (t) { return t.scaleBy(this.getTileSize()).subtract(this._level.origin) }, _wrapCoords: function (t) { var e = new o.Point(this._wrapX ? o.Util.wrapNum(t.x, this._wrapX) : t.x, this._wrapY ? o.Util.wrapNum(t.y, this._wrapY) : t.y); return e.z = t.z, e }, _pxBoundsToTileRange: function (t) { var e = this.getTileSize(); return new o.Bounds(t.min.unscaleBy(e).floor(), t.max.unscaleBy(e).ceil().subtract([1, 1])) }, _noTilesToLoad: function () { for (var t in this._tiles) if (!this._tiles[t].loaded) return !1; return !0 } }), o.gridLayer = function (t) { return new o.GridLayer(t) }, o.TileLayer = o.GridLayer.extend({ options: { maxZoom: 18, subdomains: "abc", errorTileUrl: "", zoomOffset: 0, maxNativeZoom: null, tms: !1, zoomReverse: !1, detectRetina: !1, crossOrigin: !1 }, initialize: function (t, e) { this._url = t, e = o.setOptions(this, e), e.detectRetina && o.Browser.retina && e.maxZoom > 0 && (e.tileSize = Math.floor(e.tileSize / 2), e.zoomOffset++, e.minZoom = Math.max(0, e.minZoom), e.maxZoom--), "string" == typeof e.subdomains && (e.subdomains = e.subdomains.split("")), o.Browser.android || this.on("tileunload", this._onTileRemove) }, setUrl: function (t, e) { return this._url = t, e || this.redraw(), this }, createTile: function (t, i) { var n = e.createElement("img"); return n.onload = o.bind(this._tileOnLoad, this, i, n), n.onerror = o.bind(this._tileOnError, this, i, n), this.options.crossOrigin && (n.crossOrigin = ""), n.alt = "", n.src = this.getTileUrl(t), n }, getTileUrl: function (t) { return o.Util.template(this._url, o.extend({ r: this.options.detectRetina && o.Browser.retina && this.options.maxZoom > 0 ? "@2x" : "", s: this._getSubdomain(t), x: t.x, y: this.options.tms ? this._globalTileRange.max.y - t.y : t.y, z: this._getZoomForUrl() }, this.options)) }, _tileOnLoad: function (t, e) { o.Browser.ielt9 ? setTimeout(o.bind(t, this, null, e), 0) : t(null, e) }, _tileOnError: function (t, e, i) { var n = this.options.errorTileUrl; n && (e.src = n), t(i, e) }, getTileSize: function () { var t = this._map, e = o.GridLayer.prototype.getTileSize.call(this), i = this._tileZoom + this.options.zoomOffset, n = this.options.maxNativeZoom; return null !== n && i > n ? e.divideBy(t.getZoomScale(n, i)).round() : e }, _onTileRemove: function (t) { t.tile.onload = null }, _getZoomForUrl: function () { var t = this.options, e = this._tileZoom; return t.zoomReverse && (e = t.maxZoom - e), e += t.zoomOffset, t.maxNativeZoom ? Math.min(e, t.maxNativeZoom) : e }, _getSubdomain: function (t) { var e = Math.abs(t.x + t.y) % this.options.subdomains.length; return this.options.subdomains[e] }, _abortLoading: function () { var t, e; for (t in this._tiles) e = this._tiles[t].el, e.onload = o.Util.falseFn, e.onerror = o.Util.falseFn, e.complete || (e.src = o.Util.emptyImageUrl, o.DomUtil.remove(e)) } }), o.tileLayer = function (t, e) { return new o.TileLayer(t, e) }, o.TileLayer.WMS = o.TileLayer.extend({ defaultWmsParams: { service: "WMS", request: "GetMap", version: "1.1.1", layers: "", styles: "", format: "image/jpeg", transparent: !1 }, options: { crs: null, uppercase: !1 }, initialize: function (t, e) { this._url = t; var i = o.extend({}, this.defaultWmsParams); for (var n in e) n in this.options || (i[n] = e[n]); e = o.setOptions(this, e), i.width = i.height = e.tileSize * (e.detectRetina && o.Browser.retina ? 2 : 1), this.wmsParams = i }, onAdd: function (t) { this._crs = this.options.crs || t.options.crs, this._wmsVersion = parseFloat(this.wmsParams.version); var e = this._wmsVersion >= 1.3 ? "crs" : "srs"; this.wmsParams[e] = this._crs.code, o.TileLayer.prototype.onAdd.call(this, t) }, getTileUrl: function (t) { var e = this._tileCoordsToBounds(t), i = this._crs.project(e.getNorthWest()), n = this._crs.project(e.getSouthEast()), s = (this._wmsVersion >= 1.3 && this._crs === o.CRS.EPSG4326 ? [n.y, i.x, i.y, n.x] : [i.x, n.y, n.x, i.y]).join(","), r = o.TileLayer.prototype.getTileUrl.call(this, t); return r + o.Util.getParamString(this.wmsParams, r, this.options.uppercase) + (this.options.uppercase ? "&BBOX=" : "&bbox=") + s }, setParams: function (t, e) { return o.extend(this.wmsParams, t), e || this.redraw(), this } }), o.tileLayer.wms = function (t, e) { return new o.TileLayer.WMS(t, e) }, o.ImageOverlay = o.Layer.extend({ options: { opacity: 1, alt: "", interactive: !1 }, initialize: function (t, e, i) { this._url = t, this._bounds = o.latLngBounds(e), o.setOptions(this, i) }, onAdd: function () { this._image || (this._initImage(), this.options.opacity < 1 && this._updateOpacity()), this.options.interactive && (o.DomUtil.addClass(this._image, "leaflet-interactive"), this.addInteractiveTarget(this._image)), this.getPane().appendChild(this._image), this._reset() }, onRemove: function () { o.DomUtil.remove(this._image), this.options.interactive && this.removeInteractiveTarget(this._image) }, setOpacity: function (t) { return this.options.opacity = t, this._image && this._updateOpacity(), this }, setStyle: function (t) { return t.opacity && this.setOpacity(t.opacity), this }, bringToFront: function () { return this._map && o.DomUtil.toFront(this._image), this }, bringToBack: function () { return this._map && o.DomUtil.toBack(this._image), this }, setUrl: function (t) { return this._url = t, this._image && (this._image.src = t), this }, setBounds: function (t) { return this._bounds = t, this._map && this._reset(), this }, getAttribution: function () { return this.options.attribution }, getEvents: function () { var t = { zoom: this._reset, viewreset: this._reset }; return this._zoomAnimated && (t.zoomanim = this._animateZoom), t }, getBounds: function () { return this._bounds }, getElement: function () { return this._image }, _initImage: function () { var t = this._image = o.DomUtil.create("img", "leaflet-image-layer " + (this._zoomAnimated ? "leaflet-zoom-animated" : "")); t.onselectstart = o.Util.falseFn, t.onmousemove = o.Util.falseFn, t.onload = o.bind(this.fire, this, "load"), this.options.crossOrigin && (t.crossOrigin = ""), t.src = this._url, t.alt = this.options.alt }, _animateZoom: function (t) { var e = this._map.getZoomScale(t.zoom), i = this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(), t.zoom, t.center); o.DomUtil.setTransform(this._image, i, e) }, _reset: function () { var t = this._image, e = new o.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()), this._map.latLngToLayerPoint(this._bounds.getSouthEast())), i = e.getSize(); o.DomUtil.setPosition(t, e.min), t.style.width = i.x + "px", t.style.height = i.y + "px" }, _updateOpacity: function () { o.DomUtil.setOpacity(this._image, this.options.opacity) } }), o.imageOverlay = function (t, e, i) { return new o.ImageOverlay(t, e, i) }, o.Icon = o.Class.extend({ initialize: function (t) { o.setOptions(this, t) }, createIcon: function (t) { return this._createIcon("icon", t) }, createShadow: function (t) { return this._createIcon("shadow", t) }, _createIcon: function (t, e) { var i = this._getIconUrl(t); if (!i) { if ("icon" === t) throw new Error("iconUrl not set in Icon options (see the docs)."); return null } var n = this._createImg(i, e && "IMG" === e.tagName ? e : null); return this._setIconStyles(n, t), n }, _setIconStyles: function (t, e) { var i = this.options, n = o.point(i[e + "Size"]), s = o.point("shadow" === e && i.shadowAnchor || i.iconAnchor || n && n.divideBy(2, !0)); t.className = "leaflet-marker-" + e + " " + (i.className || ""), s && (t.style.marginLeft = -s.x + "px", t.style.marginTop = -s.y + "px"), n && (t.style.width = n.x + "px", t.style.height = n.y + "px") }, _createImg: function (t, i) { return i = i || e.createElement("img"), i.src = t, i }, _getIconUrl: function (t) { return o.Browser.retina && this.options[t + "RetinaUrl"] || this.options[t + "Url"] } }), o.icon = function (t) { return new o.Icon(t) }, o.Icon.Default = o.Icon.extend({ options: { iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41] }, _getIconUrl: function (t) { var e = t + "Url"; if (this.options[e]) return this.options[e]; var i = o.Icon.Default.imagePath; if (!i) throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually."); return i + "/marker-" + t + (o.Browser.retina && "icon" === t ? "-2x" : "") + ".png" } }), o.Icon.Default.imagePath = function () { var t, i, n, o, s = e.getElementsByTagName("script"), r = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/; for (t = 0, i = s.length; i > t; t++) if (n = s[t].src, n.match(r)) return o = n.split(r)[0], (o ? o + "/" : "") + "images" }(), o.Marker = o.Layer.extend({ options: { pane: "markerPane", nonBubblingEvents: ["click", "dblclick", "mouseover", "mouseout", "contextmenu"], icon: new o.Icon.Default, interactive: !0, keyboard: !0, zIndexOffset: 0, opacity: 1, riseOffset: 250 }, initialize: function (t, e) { o.setOptions(this, e), this._latlng = o.latLng(t) }, onAdd: function (t) { this._zoomAnimated = this._zoomAnimated && t.options.markerZoomAnimation, this._initIcon(), this.update() }, onRemove: function () { this.dragging && this.dragging.enabled() && (this.options.draggable = !0, this.dragging.removeHooks()), this._removeIcon(), this._removeShadow() }, getEvents: function () { var t = { zoom: this.update, viewreset: this.update }; return this._zoomAnimated && (t.zoomanim = this._animateZoom), t }, getLatLng: function () { return this._latlng }, setLatLng: function (t) { var e = this._latlng; return this._latlng = o.latLng(t), this.update(), this.fire("move", { oldLatLng: e, latlng: this._latlng }) }, setZIndexOffset: function (t) { return this.options.zIndexOffset = t, this.update() }, setIcon: function (t) { return this.options.icon = t, this._map && (this._initIcon(), this.update()), this._popup && this.bindPopup(this._popup, this._popup.options), this }, getElement: function () { return this._icon }, update: function () { if (this._icon) { var t = this._map.latLngToLayerPoint(this._latlng).round(); this._setPos(t) } return this }, _initIcon: function () { var t = this.options, e = "leaflet-zoom-" + (this._zoomAnimated ? "animated" : "hide"), i = t.icon.createIcon(this._icon), n = !1; i !== this._icon && (this._icon && this._removeIcon(), n = !0, t.title && (i.title = t.title), t.alt && (i.alt = t.alt)), o.DomUtil.addClass(i, e), t.keyboard && (i.tabIndex = "0"), this._icon = i, t.riseOnHover && this.on({ mouseover: this._bringToFront, mouseout: this._resetZIndex }); var s = t.icon.createShadow(this._shadow), r = !1; s !== this._shadow && (this._removeShadow(), r = !0), s && o.DomUtil.addClass(s, e), this._shadow = s, t.opacity < 1 && this._updateOpacity(), n && (this.getPane().appendChild(this._icon), this._initInteraction()), s && r && this.getPane("shadowPane").appendChild(this._shadow) }, _removeIcon: function () { this.options.riseOnHover && this.off({ mouseover: this._bringToFront, mouseout: this._resetZIndex }), o.DomUtil.remove(this._icon), this.removeInteractiveTarget(this._icon), this._icon = null }, _removeShadow: function () { this._shadow && o.DomUtil.remove(this._shadow), this._shadow = null }, _setPos: function (t) { o.DomUtil.setPosition(this._icon, t), this._shadow && o.DomUtil.setPosition(this._shadow, t), this._zIndex = t.y + this.options.zIndexOffset, this._resetZIndex() }, _updateZIndex: function (t) { this._icon.style.zIndex = this._zIndex + t }, _animateZoom: function (t) { var e = this._map._latLngToNewLayerPoint(this._latlng, t.zoom, t.center).round(); this._setPos(e) }, _initInteraction: function () { if (this.options.interactive && (o.DomUtil.addClass(this._icon, "leaflet-interactive"), this.addInteractiveTarget(this._icon), o.Handler.MarkerDrag)) { var t = this.options.draggable; this.dragging && (t = this.dragging.enabled(), this.dragging.disable()), this.dragging = new o.Handler.MarkerDrag(this), t && this.dragging.enable() } }, setOpacity: function (t) { return this.options.opacity = t, this._map && this._updateOpacity(), this }, _updateOpacity: function () { var t = this.options.opacity; o.DomUtil.setOpacity(this._icon, t), this._shadow && o.DomUtil.setOpacity(this._shadow, t) }, _bringToFront: function () { this._updateZIndex(this.options.riseOffset) }, _resetZIndex: function () { this._updateZIndex(0) } }), o.marker = function (t, e) { return new o.Marker(t, e) }, o.DivIcon = o.Icon.extend({ options: { iconSize: [12, 12], className: "leaflet-div-icon", html: !1 }, createIcon: function (t) { var i = t && "DIV" === t.tagName ? t : e.createElement("div"), n = this.options; return i.innerHTML = n.html !== !1 ? n.html : "", n.bgPos && (i.style.backgroundPosition = -n.bgPos.x + "px " + -n.bgPos.y + "px"), this._setIconStyles(i, "icon"), i }, createShadow: function () { return null } }), o.divIcon = function (t) { return new o.DivIcon(t) }, o.Map.mergeOptions({ closePopupOnClick: !0 }), o.Popup = o.Layer.extend({ options: { pane: "popupPane", minWidth: 50, maxWidth: 300, offset: [0, 7], autoPan: !0, autoPanPadding: [5, 5], closeButton: !0, autoClose: !0, zoomAnimation: !0 }, initialize: function (t, e) { o.setOptions(this, t), this._source = e }, onAdd: function (t) { this._zoomAnimated = this._zoomAnimated && this.options.zoomAnimation, this._container || this._initLayout(), t._fadeAnimated && o.DomUtil.setOpacity(this._container, 0), clearTimeout(this._removeTimeout), this.getPane().appendChild(this._container), this.update(), t._fadeAnimated && o.DomUtil.setOpacity(this._container, 1), t.fire("popupopen", { popup: this }), this._source && this._source.fire("popupopen", { popup: this }, !0) }, openOn: function (t) { return t.openPopup(this), this }, onRemove: function (t) { t._fadeAnimated ? (o.DomUtil.setOpacity(this._container, 0), this._removeTimeout = setTimeout(o.bind(o.DomUtil.remove, o.DomUtil, this._container), 200)) : o.DomUtil.remove(this._container), t.fire("popupclose", { popup: this }), this._source && this._source.fire("popupclose", { popup: this }, !0) }, getLatLng: function () { return this._latlng }, setLatLng: function (t) { return this._latlng = o.latLng(t), this._map && (this._updatePosition(), this._adjustPan()), this }, getContent: function () { return this._content }, setContent: function (t) { return this._content = t, this.update(), this }, getElement: function () { return this._container }, update: function () { this._map && (this._container.style.visibility = "hidden", this._updateContent(), this._updateLayout(), this._updatePosition(), this._container.style.visibility = "", this._adjustPan()) }, getEvents: function () { var t = { zoom: this._updatePosition, viewreset: this._updatePosition }; return this._zoomAnimated && (t.zoomanim = this._animateZoom), ("closeOnClick" in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) && (t.preclick = this._close), this.options.keepInView && (t.moveend = this._adjustPan), t }, isOpen: function () { return !!this._map && this._map.hasLayer(this) }, _close: function () { this._map && this._map.closePopup(this) }, _initLayout: function () { var t = "leaflet-popup", e = this._container = o.DomUtil.create("div", t + " " + (this.options.className || "") + " leaflet-zoom-" + (this._zoomAnimated ? "animated" : "hide")); if (this.options.closeButton) { var i = this._closeButton = o.DomUtil.create("a", t + "-close-button", e); i.href = "#close", i.innerHTML = "&#215;", o.DomEvent.on(i, "click", this._onCloseButtonClick, this) } var n = this._wrapper = o.DomUtil.create("div", t + "-content-wrapper", e); this._contentNode = o.DomUtil.create("div", t + "-content", n), o.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n, "contextmenu", o.DomEvent.stopPropagation), this._tipContainer = o.DomUtil.create("div", t + "-tip-container", e), this._tip = o.DomUtil.create("div", t + "-tip", this._tipContainer) }, _updateContent: function () { if (this._content) { var t = this._contentNode, e = "function" == typeof this._content ? this._content(this._source || this) : this._content; if ("string" == typeof e) t.innerHTML = e; else { for (; t.hasChildNodes() ;) t.removeChild(t.firstChild); t.appendChild(e) } this.fire("contentupdate") } }, _updateLayout: function () { var t = this._contentNode, e = t.style; e.width = "", e.whiteSpace = "nowrap"; var i = t.offsetWidth; i = Math.min(i, this.options.maxWidth), i = Math.max(i, this.options.minWidth), e.width = i + 1 + "px", e.whiteSpace = "", e.height = ""; var n = t.offsetHeight, s = this.options.maxHeight, r = "leaflet-popup-scrolled"; s && n > s ? (e.height = s + "px", o.DomUtil.addClass(t, r)) : o.DomUtil.removeClass(t, r), this._containerWidth = this._container.offsetWidth }, _updatePosition: function () { if (this._map) { var t = this._map.latLngToLayerPoint(this._latlng), e = o.point(this.options.offset); this._zoomAnimated ? o.DomUtil.setPosition(this._container, t) : e = e.add(t); var i = this._containerBottom = -e.y, n = this._containerLeft = -Math.round(this._containerWidth / 2) + e.x; this._container.style.bottom = i + "px", this._container.style.left = n + "px" } }, _animateZoom: function (t) { var e = this._map._latLngToNewLayerPoint(this._latlng, t.zoom, t.center); o.DomUtil.setPosition(this._container, e) }, _adjustPan: function () { if (this.options.autoPan) { var t = this._map, e = this._container.offsetHeight, i = this._containerWidth, n = new o.Point(this._containerLeft, -e - this._containerBottom); this._zoomAnimated && n._add(o.DomUtil.getPosition(this._container)); var s = t.layerPointToContainerPoint(n), r = o.point(this.options.autoPanPadding), a = o.point(this.options.autoPanPaddingTopLeft || r), h = o.point(this.options.autoPanPaddingBottomRight || r), l = t.getSize(), u = 0, c = 0; s.x + i + h.x > l.x && (u = s.x + i - l.x + h.x), s.x - u - a.x < 0 && (u = s.x - a.x), s.y + e + h.y > l.y && (c = s.y + e - l.y + h.y), s.y - c - a.y < 0 && (c = s.y - a.y), (u || c) && t.fire("autopanstart").panBy([u, c]) } }, _onCloseButtonClick: function (t) { this._close(), o.DomEvent.stop(t) } }), o.popup = function (t, e) { return new o.Popup(t, e) }, o.Map.include({ openPopup: function (t, e, i) { return t instanceof o.Popup || (t = new o.Popup(i).setContent(t)), e && t.setLatLng(e), this.hasLayer(t) ? this : (this._popup && this._popup.options.autoClose && this.closePopup(), this._popup = t, this.addLayer(t)) }, closePopup: function (t) { return t && t !== this._popup || (t = this._popup, this._popup = null), t && this.removeLayer(t), this } }), o.Layer.include({ bindPopup: function (t, e) { return t instanceof o.Popup ? (o.setOptions(t, e), this._popup = t, t._source = this) : ((!this._popup || e) && (this._popup = new o.Popup(e, this)), this._popup.setContent(t)), this._popupHandlersAdded || (this.on({ click: this._openPopup, remove: this.closePopup, move: this._movePopup }), this._popupHandlersAdded = !0), this._originalPopupOffset = this._popup.options.offset, this }, unbindPopup: function () { return this._popup && (this.off({ click: this._openPopup, remove: this.closePopup, move: this._movePopup }), this._popupHandlersAdded = !1, this._popup = null), this }, openPopup: function (t, e) { if (t instanceof o.Layer || (e = t, t = this), t instanceof o.FeatureGroup) for (var i in this._layers) { t = this._layers[i]; break } return e || (e = t.getCenter ? t.getCenter() : t.getLatLng()), this._popup && this._map && (this._popup.options.offset = this._popupAnchor(t), this._popup._source = t, this._popup.update(), this._map.openPopup(this._popup, e)), this }, closePopup: function () { return this._popup && this._popup._close(), this }, togglePopup: function (t) { return this._popup && (this._popup._map ? this.closePopup() : this.openPopup(t)), this }, setPopupContent: function (t) { return this._popup && this._popup.setContent(t), this }, getPopup: function () { return this._popup }, _openPopup: function (t) { var e = t.layer || t.target; if (this._popup && this._map) return e instanceof o.Path ? void this.openPopup(t.layer || t.target, t.latlng) : void (this._map.hasLayer(this._popup) && this._popup._source === e ? this.closePopup() : this.openPopup(e, t.latlng)) }, _popupAnchor: function (t) { var e = t._getPopupAnchor ? t._getPopupAnchor() : [0, 0], i = this._originalPopupOffset || o.Popup.prototype.options.offset; return o.point(e).add(i) }, _movePopup: function (t) { this._popup.setLatLng(t.latlng) } }), o.Marker.include({ _getPopupAnchor: function () { return this.options.icon.options.popupAnchor || [0, 0] } }), o.LayerGroup = o.Layer.extend({ initialize: function (t) { this._layers = {}; var e, i; if (t) for (e = 0, i = t.length; i > e; e++) this.addLayer(t[e]) }, addLayer: function (t) { var e = this.getLayerId(t); return this._layers[e] = t, this._map && this._map.addLayer(t), this }, removeLayer: function (t) { var e = t in this._layers ? t : this.getLayerId(t); return this._map && this._layers[e] && this._map.removeLayer(this._layers[e]), delete this._layers[e], this }, hasLayer: function (t) { return !!t && (t in this._layers || this.getLayerId(t) in this._layers) }, clearLayers: function () { for (var t in this._layers) this.removeLayer(this._layers[t]); return this }, invoke: function (t) { var e, i, n = Array.prototype.slice.call(arguments, 1); for (e in this._layers) i = this._layers[e], i[t] && i[t].apply(i, n); return this }, onAdd: function (t) { for (var e in this._layers) t.addLayer(this._layers[e]) }, onRemove: function (t) { for (var e in this._layers) t.removeLayer(this._layers[e]) }, eachLayer: function (t, e) { for (var i in this._layers) t.call(e, this._layers[i]); return this }, getLayer: function (t) { return this._layers[t] }, getLayers: function () { var t = []; for (var e in this._layers) t.push(this._layers[e]); return t }, setZIndex: function (t) { return this.invoke("setZIndex", t) }, getLayerId: function (t) { return o.stamp(t) } }), o.layerGroup = function (t) { return new o.LayerGroup(t) }, o.FeatureGroup = o.LayerGroup.extend({
        addLayer: function (t) { return this.hasLayer(t) ? this : (t.addEventParent(this), o.LayerGroup.prototype.addLayer.call(this, t), this.fire("layeradd", { layer: t })) },
        removeLayer: function (t) { return this.hasLayer(t) ? (t in this._layers && (t = this._layers[t]), t.removeEventParent(this), o.LayerGroup.prototype.removeLayer.call(this, t), this.fire("layerremove", { layer: t })) : this }, setStyle: function (t) { return this.invoke("setStyle", t) }, bringToFront: function () { return this.invoke("bringToFront") }, bringToBack: function () { return this.invoke("bringToBack") }, getBounds: function () { var t = new o.LatLngBounds; for (var e in this._layers) { var i = this._layers[e]; t.extend(i.getBounds ? i.getBounds() : i.getLatLng()) } return t }
    }), o.featureGroup = function (t) { return new o.FeatureGroup(t) }, o.Renderer = o.Layer.extend({ options: { padding: .1 }, initialize: function (t) { o.setOptions(this, t), o.stamp(this) }, onAdd: function () { this._container || (this._initContainer(), this._zoomAnimated && o.DomUtil.addClass(this._container, "leaflet-zoom-animated")), this.getPane().appendChild(this._container), this._update() }, onRemove: function () { o.DomUtil.remove(this._container) }, getEvents: function () { var t = { viewreset: this._reset, zoom: this._updateTransform, moveend: this._update }; return this._zoomAnimated && (t.zoomanim = this._animateZoom), t }, _animateZoom: function (t) { var e = this._map.getZoomScale(t.zoom, this._zoom), i = this._map._latLngToNewLayerPoint(this._topLeft, t.zoom, t.center); o.DomUtil.setTransform(this._container, i, e) }, _updateTransform: function () { var t = this._map.getZoom(), e = this._map.getCenter(), i = this._map.getZoomScale(t, this._zoom), n = this._map._latLngToNewLayerPoint(this._topLeft, t, e); o.DomUtil.setTransform(this._container, n, i) }, _reset: function () { this._update(), this._updateTransform() }, _update: function () { var t = this.options.padding, e = this._map.getSize(), i = this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round(); this._bounds = new o.Bounds(i, i.add(e.multiplyBy(1 + 2 * t)).round()), this._topLeft = this._map.layerPointToLatLng(i), this._zoom = this._map.getZoom() } }), o.Map.include({ getRenderer: function (t) { var e = t.options.renderer || this._getPaneRenderer(t.options.pane) || this.options.renderer || this._renderer; return e || (e = this._renderer = this.options.preferCanvas && o.canvas() || o.svg()), this.hasLayer(e) || this.addLayer(e), e }, _getPaneRenderer: function (t) { if ("overlayPane" === t || t === i) return !1; var e = this._paneRenderers[t]; return e === i && (e = o.SVG && o.svg({ pane: t }) || o.Canvas && o.canvas({ pane: t }), this._paneRenderers[t] = e), e } }), o.Path = o.Layer.extend({ options: { stroke: !0, color: "#3388ff", weight: 3, opacity: 1, lineCap: "round", lineJoin: "round", fillOpacity: .2, fillRule: "evenodd", interactive: !0 }, onAdd: function () { this._renderer = this._map.getRenderer(this), this._renderer._initPath(this), this._reset(), this._renderer._addPath(this) }, onRemove: function () { this._renderer._removePath(this) }, getEvents: function () { return { zoomend: this._project, moveend: this._update, viewreset: this._reset } }, redraw: function () { return this._map && this._renderer._updatePath(this), this }, setStyle: function (t) { return o.setOptions(this, t), this._renderer && this._renderer._updateStyle(this), this }, bringToFront: function () { return this._renderer && this._renderer._bringToFront(this), this }, bringToBack: function () { return this._renderer && this._renderer._bringToBack(this), this }, getElement: function () { return this._path }, _reset: function () { this._project(), this._update() }, _clickTolerance: function () { return (this.options.stroke ? this.options.weight / 2 : 0) + (o.Browser.touch ? 10 : 0) } }), o.LineUtil = { simplify: function (t, e) { if (!e || !t.length) return t.slice(); var i = e * e; return t = this._reducePoints(t, i), t = this._simplifyDP(t, i) }, pointToSegmentDistance: function (t, e, i) { return Math.sqrt(this._sqClosestPointOnSegment(t, e, i, !0)) }, closestPointOnSegment: function (t, e, i) { return this._sqClosestPointOnSegment(t, e, i) }, _simplifyDP: function (t, e) { var n = t.length, o = typeof Uint8Array != i + "" ? Uint8Array : Array, s = new o(n); s[0] = s[n - 1] = 1, this._simplifyDPStep(t, s, e, 0, n - 1); var r, a = []; for (r = 0; n > r; r++) s[r] && a.push(t[r]); return a }, _simplifyDPStep: function (t, e, i, n, o) { var s, r, a, h = 0; for (r = n + 1; o - 1 >= r; r++) a = this._sqClosestPointOnSegment(t[r], t[n], t[o], !0), a > h && (s = r, h = a); h > i && (e[s] = 1, this._simplifyDPStep(t, e, i, n, s), this._simplifyDPStep(t, e, i, s, o)) }, _reducePoints: function (t, e) { for (var i = [t[0]], n = 1, o = 0, s = t.length; s > n; n++) this._sqDist(t[n], t[o]) > e && (i.push(t[n]), o = n); return s - 1 > o && i.push(t[s - 1]), i }, clipSegment: function (t, e, i, n, o) { var s, r, a, h = n ? this._lastCode : this._getBitCode(t, i), l = this._getBitCode(e, i); for (this._lastCode = l; ;) { if (!(h | l)) return [t, e]; if (h & l) return !1; s = h || l, r = this._getEdgeIntersection(t, e, s, i, o), a = this._getBitCode(r, i), s === h ? (t = r, h = a) : (e = r, l = a) } }, _getEdgeIntersection: function (t, e, i, n, s) { var r, a, h = e.x - t.x, l = e.y - t.y, u = n.min, c = n.max; return 8 & i ? (r = t.x + h * (c.y - t.y) / l, a = c.y) : 4 & i ? (r = t.x + h * (u.y - t.y) / l, a = u.y) : 2 & i ? (r = c.x, a = t.y + l * (c.x - t.x) / h) : 1 & i && (r = u.x, a = t.y + l * (u.x - t.x) / h), new o.Point(r, a, s) }, _getBitCode: function (t, e) { var i = 0; return t.x < e.min.x ? i |= 1 : t.x > e.max.x && (i |= 2), t.y < e.min.y ? i |= 4 : t.y > e.max.y && (i |= 8), i }, _sqDist: function (t, e) { var i = e.x - t.x, n = e.y - t.y; return i * i + n * n }, _sqClosestPointOnSegment: function (t, e, i, n) { var s, r = e.x, a = e.y, h = i.x - r, l = i.y - a, u = h * h + l * l; return u > 0 && (s = ((t.x - r) * h + (t.y - a) * l) / u, s > 1 ? (r = i.x, a = i.y) : s > 0 && (r += h * s, a += l * s)), h = t.x - r, l = t.y - a, n ? h * h + l * l : new o.Point(r, a) } }, o.Polyline = o.Path.extend({ options: { smoothFactor: 1 }, initialize: function (t, e) { o.setOptions(this, e), this._setLatLngs(t) }, getLatLngs: function () { return this._latlngs }, setLatLngs: function (t) { return this._setLatLngs(t), this.redraw() }, isEmpty: function () { return !this._latlngs.length }, closestLayerPoint: function (t) { for (var e, i, n = 1 / 0, s = null, r = o.LineUtil._sqClosestPointOnSegment, a = 0, h = this._parts.length; h > a; a++) for (var l = this._parts[a], u = 1, c = l.length; c > u; u++) { e = l[u - 1], i = l[u]; var d = r(t, e, i, !0); n > d && (n = d, s = r(t, e, i)) } return s && (s.distance = Math.sqrt(n)), s }, getCenter: function () { var t, e, i, n, o, s, r, a = this._rings[0], h = a.length; if (!h) return null; for (t = 0, e = 0; h - 1 > t; t++) e += a[t].distanceTo(a[t + 1]) / 2; if (0 === e) return this._map.layerPointToLatLng(a[0]); for (t = 0, n = 0; h - 1 > t; t++) if (o = a[t], s = a[t + 1], i = o.distanceTo(s), n += i, n > e) return r = (n - e) / i, this._map.layerPointToLatLng([s.x - r * (s.x - o.x), s.y - r * (s.y - o.y)]) }, getBounds: function () { return this._bounds }, addLatLng: function (t, e) { return e = e || this._defaultShape(), t = o.latLng(t), e.push(t), this._bounds.extend(t), this.redraw() }, _setLatLngs: function (t) { this._bounds = new o.LatLngBounds, this._latlngs = this._convertLatLngs(t) }, _defaultShape: function () { return o.Polyline._flat(this._latlngs) ? this._latlngs : this._latlngs[0] }, _convertLatLngs: function (t) { for (var e = [], i = o.Polyline._flat(t), n = 0, s = t.length; s > n; n++) i ? (e[n] = o.latLng(t[n]), this._bounds.extend(e[n])) : e[n] = this._convertLatLngs(t[n]); return e }, _project: function () { this._rings = [], this._projectLatlngs(this._latlngs, this._rings); var t = this._clickTolerance(), e = new o.Point(t, -t); this._bounds.isValid() && (this._pxBounds = new o.Bounds(this._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(e), this._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(e))) }, _projectLatlngs: function (t, e) { var i, n, s = t[0] instanceof o.LatLng, r = t.length; if (s) { for (n = [], i = 0; r > i; i++) n[i] = this._map.latLngToLayerPoint(t[i]); e.push(n) } else for (i = 0; r > i; i++) this._projectLatlngs(t[i], e) }, _clipPoints: function () { var t = this._renderer._bounds; if (this._parts = [], this._pxBounds && this._pxBounds.intersects(t)) { if (this.options.noClip) return void (this._parts = this._rings); var e, i, n, s, r, a, h, l = this._parts; for (e = 0, n = 0, s = this._rings.length; s > e; e++) for (h = this._rings[e], i = 0, r = h.length; r - 1 > i; i++) a = o.LineUtil.clipSegment(h[i], h[i + 1], t, i, !0), a && (l[n] = l[n] || [], l[n].push(a[0]), (a[1] !== h[i + 1] || i === r - 2) && (l[n].push(a[1]), n++)) } }, _simplifyPoints: function () { for (var t = this._parts, e = this.options.smoothFactor, i = 0, n = t.length; n > i; i++) t[i] = o.LineUtil.simplify(t[i], e) }, _update: function () { this._map && (this._clipPoints(), this._simplifyPoints(), this._updatePath()) }, _updatePath: function () { this._renderer._updatePoly(this) } }), o.polyline = function (t, e) { return new o.Polyline(t, e) }, o.Polyline._flat = function (t) { return !o.Util.isArray(t[0]) || "object" != typeof t[0][0] && "undefined" != typeof t[0][0] }, o.PolyUtil = {}, o.PolyUtil.clipPolygon = function (t, e, i) { var n, s, r, a, h, l, u, c, d, _ = [1, 4, 2, 8], m = o.LineUtil; for (s = 0, u = t.length; u > s; s++) t[s]._code = m._getBitCode(t[s], e); for (a = 0; 4 > a; a++) { for (c = _[a], n = [], s = 0, u = t.length, r = u - 1; u > s; r = s++) h = t[s], l = t[r], h._code & c ? l._code & c || (d = m._getEdgeIntersection(l, h, c, e, i), d._code = m._getBitCode(d, e), n.push(d)) : (l._code & c && (d = m._getEdgeIntersection(l, h, c, e, i), d._code = m._getBitCode(d, e), n.push(d)), n.push(h)); t = n } return t }, o.Polygon = o.Polyline.extend({ options: { fill: !0 }, isEmpty: function () { return !this._latlngs.length || !this._latlngs[0].length }, getCenter: function () { var t, e, i, n, o, s, r, a, h, l = this._rings[0], u = l.length; if (!u) return null; for (s = r = a = 0, t = 0, e = u - 1; u > t; e = t++) i = l[t], n = l[e], o = i.y * n.x - n.y * i.x, r += (i.x + n.x) * o, a += (i.y + n.y) * o, s += 3 * o; return h = 0 === s ? l[0] : [r / s, a / s], this._map.layerPointToLatLng(h) }, _convertLatLngs: function (t) { var e = o.Polyline.prototype._convertLatLngs.call(this, t), i = e.length; return i >= 2 && e[0] instanceof o.LatLng && e[0].equals(e[i - 1]) && e.pop(), e }, _setLatLngs: function (t) { o.Polyline.prototype._setLatLngs.call(this, t), o.Polyline._flat(this._latlngs) && (this._latlngs = [this._latlngs]) }, _defaultShape: function () { return o.Polyline._flat(this._latlngs[0]) ? this._latlngs[0] : this._latlngs[0][0] }, _clipPoints: function () { var t = this._renderer._bounds, e = this.options.weight, i = new o.Point(e, e); if (t = new o.Bounds(t.min.subtract(i), t.max.add(i)), this._parts = [], this._pxBounds && this._pxBounds.intersects(t)) { if (this.options.noClip) return void (this._parts = this._rings); for (var n, s = 0, r = this._rings.length; r > s; s++) n = o.PolyUtil.clipPolygon(this._rings[s], t, !0), n.length && this._parts.push(n) } }, _updatePath: function () { this._renderer._updatePoly(this, !0) } }), o.polygon = function (t, e) { return new o.Polygon(t, e) }, o.Rectangle = o.Polygon.extend({ initialize: function (t, e) { o.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(t), e) }, setBounds: function (t) { this.setLatLngs(this._boundsToLatLngs(t)) }, _boundsToLatLngs: function (t) { return t = o.latLngBounds(t), [t.getSouthWest(), t.getNorthWest(), t.getNorthEast(), t.getSouthEast()] } }), o.rectangle = function (t, e) { return new o.Rectangle(t, e) }, o.CircleMarker = o.Path.extend({ options: { fill: !0, radius: 10 }, initialize: function (t, e) { o.setOptions(this, e), this._latlng = o.latLng(t), this._radius = this.options.radius }, setLatLng: function (t) { return this._latlng = o.latLng(t), this.redraw(), this.fire("move", { latlng: this._latlng }) }, getLatLng: function () { return this._latlng }, setRadius: function (t) { return this.options.radius = this._radius = t, this.redraw() }, getRadius: function () { return this._radius }, setStyle: function (t) { var e = t && t.radius || this._radius; return o.Path.prototype.setStyle.call(this, t), this.setRadius(e), this }, _project: function () { this._point = this._map.latLngToLayerPoint(this._latlng), this._updateBounds() }, _updateBounds: function () { var t = this._radius, e = this._radiusY || t, i = this._clickTolerance(), n = [t + i, e + i]; this._pxBounds = new o.Bounds(this._point.subtract(n), this._point.add(n)) }, _update: function () { this._map && this._updatePath() }, _updatePath: function () { this._renderer._updateCircle(this) }, _empty: function () { return this._radius && !this._renderer._bounds.intersects(this._pxBounds) } }), o.circleMarker = function (t, e) { return new o.CircleMarker(t, e) }, o.Circle = o.CircleMarker.extend({ initialize: function (t, e, i) { o.setOptions(this, i), this._latlng = o.latLng(t), this._mRadius = e }, setRadius: function (t) { return this._mRadius = t, this.redraw() }, getRadius: function () { return this._mRadius }, getBounds: function () { var t = [this._radius, this._radiusY]; return new o.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)), this._map.layerPointToLatLng(this._point.add(t))) }, setStyle: o.Path.prototype.setStyle, _project: function () { var t = this._latlng.lng, e = this._latlng.lat, i = this._map, n = i.options.crs; if (n.distance === o.CRS.Earth.distance) { var s = Math.PI / 180, r = this._mRadius / o.CRS.Earth.R / s, a = i.project([e + r, t]), h = i.project([e - r, t]), l = a.add(h).divideBy(2), u = i.unproject(l).lat, c = Math.acos((Math.cos(r * s) - Math.sin(e * s) * Math.sin(u * s)) / (Math.cos(e * s) * Math.cos(u * s))) / s; this._point = l.subtract(i.getPixelOrigin()), this._radius = isNaN(c) ? 0 : Math.max(Math.round(l.x - i.project([u, t - c]).x), 1), this._radiusY = Math.max(Math.round(l.y - a.y), 1) } else { var d = n.unproject(n.project(this._latlng).subtract([this._mRadius, 0])); this._point = i.latLngToLayerPoint(this._latlng), this._radius = this._point.x - i.latLngToLayerPoint(d).x } this._updateBounds() } }), o.circle = function (t, e, i) { return new o.Circle(t, e, i) }, o.SVG = o.Renderer.extend({ _initContainer: function () { this._container = o.SVG.create("svg"), this._container.setAttribute("pointer-events", "none"), this._rootGroup = o.SVG.create("g"), this._container.appendChild(this._rootGroup) }, _update: function () { if (!this._map._animatingZoom || !this._bounds) { o.Renderer.prototype._update.call(this); var t = this._bounds, e = t.getSize(), i = this._container; this._svgSize && this._svgSize.equals(e) || (this._svgSize = e, i.setAttribute("width", e.x), i.setAttribute("height", e.y)), o.DomUtil.setPosition(i, t.min), i.setAttribute("viewBox", [t.min.x, t.min.y, e.x, e.y].join(" ")) } }, _initPath: function (t) { var e = t._path = o.SVG.create("path"); t.options.className && o.DomUtil.addClass(e, t.options.className), t.options.interactive && o.DomUtil.addClass(e, "leaflet-interactive"), this._updateStyle(t) }, _addPath: function (t) { this._rootGroup.appendChild(t._path), t.addInteractiveTarget(t._path) }, _removePath: function (t) { o.DomUtil.remove(t._path), t.removeInteractiveTarget(t._path) }, _updatePath: function (t) { t._project(), t._update() }, _updateStyle: function (t) { var e = t._path, i = t.options; e && (i.stroke ? (e.setAttribute("stroke", i.color), e.setAttribute("stroke-opacity", i.opacity), e.setAttribute("stroke-width", i.weight), e.setAttribute("stroke-linecap", i.lineCap), e.setAttribute("stroke-linejoin", i.lineJoin), i.dashArray ? e.setAttribute("stroke-dasharray", i.dashArray) : e.removeAttribute("stroke-dasharray"), i.dashOffset ? e.setAttribute("stroke-dashoffset", i.dashOffset) : e.removeAttribute("stroke-dashoffset")) : e.setAttribute("stroke", "none"), i.fill ? (e.setAttribute("fill", i.fillColor || i.color), e.setAttribute("fill-opacity", i.fillOpacity), e.setAttribute("fill-rule", i.fillRule || "evenodd")) : e.setAttribute("fill", "none"), e.setAttribute("pointer-events", i.pointerEvents || (i.interactive ? "visiblePainted" : "none"))) }, _updatePoly: function (t, e) { this._setPath(t, o.SVG.pointsToPath(t._parts, e)) }, _updateCircle: function (t) { var e = t._point, i = t._radius, n = t._radiusY || i, o = "a" + i + "," + n + " 0 1,0 ", s = t._empty() ? "M0 0" : "M" + (e.x - i) + "," + e.y + o + 2 * i + ",0 " + o + 2 * -i + ",0 "; this._setPath(t, s) }, _setPath: function (t, e) { t._path.setAttribute("d", e) }, _bringToFront: function (t) { o.DomUtil.toFront(t._path) }, _bringToBack: function (t) { o.DomUtil.toBack(t._path) } }), o.extend(o.SVG, { create: function (t) { return e.createElementNS("http://www.w3.org/2000/svg", t) }, pointsToPath: function (t, e) { var i, n, s, r, a, h, l = ""; for (i = 0, s = t.length; s > i; i++) { for (a = t[i], n = 0, r = a.length; r > n; n++) h = a[n], l += (n ? "L" : "M") + h.x + " " + h.y; l += e ? o.Browser.svg ? "z" : "x" : "" } return l || "M0 0" } }), o.Browser.svg = !(!e.createElementNS || !o.SVG.create("svg").createSVGRect), o.svg = function (t) { return o.Browser.svg || o.Browser.vml ? new o.SVG(t) : null }, o.Browser.vml = !o.Browser.svg && function () { try { var t = e.createElement("div"); t.innerHTML = '<v:shape adj="1"/>'; var i = t.firstChild; return i.style.behavior = "url(#default#VML)", i && "object" == typeof i.adj } catch (n) { return !1 } }(), o.SVG.include(o.Browser.vml ? { _initContainer: function () { this._container = o.DomUtil.create("div", "leaflet-vml-container") }, _update: function () { this._map._animatingZoom || o.Renderer.prototype._update.call(this) }, _initPath: function (t) { var e = t._container = o.SVG.create("shape"); o.DomUtil.addClass(e, "leaflet-vml-shape " + (this.options.className || "")), e.coordsize = "1 1", t._path = o.SVG.create("path"), e.appendChild(t._path), this._updateStyle(t) }, _addPath: function (t) { var e = t._container; this._container.appendChild(e), t.options.interactive && t.addInteractiveTarget(e) }, _removePath: function (t) { var e = t._container; o.DomUtil.remove(e), t.removeInteractiveTarget(e) }, _updateStyle: function (t) { var e = t._stroke, i = t._fill, n = t.options, s = t._container; s.stroked = !!n.stroke, s.filled = !!n.fill, n.stroke ? (e || (e = t._stroke = o.SVG.create("stroke")), s.appendChild(e), e.weight = n.weight + "px", e.color = n.color, e.opacity = n.opacity, n.dashArray ? e.dashStyle = o.Util.isArray(n.dashArray) ? n.dashArray.join(" ") : n.dashArray.replace(/( *, *)/g, " ") : e.dashStyle = "", e.endcap = n.lineCap.replace("butt", "flat"), e.joinstyle = n.lineJoin) : e && (s.removeChild(e), t._stroke = null), n.fill ? (i || (i = t._fill = o.SVG.create("fill")), s.appendChild(i), i.color = n.fillColor || n.color, i.opacity = n.fillOpacity) : i && (s.removeChild(i), t._fill = null) }, _updateCircle: function (t) { var e = t._point.round(), i = Math.round(t._radius), n = Math.round(t._radiusY || i); this._setPath(t, t._empty() ? "M0 0" : "AL " + e.x + "," + e.y + " " + i + "," + n + " 0,23592600") }, _setPath: function (t, e) { t._path.v = e }, _bringToFront: function (t) { o.DomUtil.toFront(t._container) }, _bringToBack: function (t) { o.DomUtil.toBack(t._container) } } : {}), o.Browser.vml && (o.SVG.create = function () { try { return e.namespaces.add("lvml", "urn:schemas-microsoft-com:vml"), function (t) { return e.createElement("<lvml:" + t + ' class="lvml">') } } catch (t) { return function (t) { return e.createElement("<" + t + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">') } } }()), o.Canvas = o.Renderer.extend({ onAdd: function () { o.Renderer.prototype.onAdd.call(this), this._layers = this._layers || {}, this._draw() }, _initContainer: function () { var t = this._container = e.createElement("canvas"); o.DomEvent.on(t, "mousemove", o.Util.throttle(this._onMouseMove, 32, this), this).on(t, "click dblclick mousedown mouseup contextmenu", this._onClick, this).on(t, "mouseout", this._handleMouseOut, this), this._ctx = t.getContext("2d") }, _update: function () { if (!this._map._animatingZoom || !this._bounds) { this._drawnLayers = {}, o.Renderer.prototype._update.call(this); var t = this._bounds, e = this._container, i = t.getSize(), n = o.Browser.retina ? 2 : 1; o.DomUtil.setPosition(e, t.min), e.width = n * i.x, e.height = n * i.y, e.style.width = i.x + "px", e.style.height = i.y + "px", o.Browser.retina && this._ctx.scale(2, 2), this._ctx.translate(-t.min.x, -t.min.y) } }, _initPath: function (t) { this._layers[o.stamp(t)] = t }, _addPath: o.Util.falseFn, _removePath: function (t) { t._removed = !0, this._requestRedraw(t) }, _updatePath: function (t) { this._redrawBounds = t._pxBounds, this._draw(!0), t._project(), t._update(), this._draw(), this._redrawBounds = null }, _updateStyle: function (t) { this._requestRedraw(t) }, _requestRedraw: function (t) { this._map && (this._redrawBounds = this._redrawBounds || new o.Bounds, this._redrawBounds.extend(t._pxBounds.min).extend(t._pxBounds.max), this._redrawRequest = this._redrawRequest || o.Util.requestAnimFrame(this._redraw, this)) }, _redraw: function () { this._redrawRequest = null, this._draw(!0), this._draw(), this._redrawBounds = null }, _draw: function (t) { this._clear = t; var e; for (var i in this._layers) e = this._layers[i], (!this._redrawBounds || e._pxBounds.intersects(this._redrawBounds)) && e._updatePath(), t && e._removed && (delete e._removed, delete this._layers[i]) }, _updatePoly: function (t, e) { var i, n, o, s, r = t._parts, a = r.length, h = this._ctx; if (a) { for (this._drawnLayers[t._leaflet_id] = t, h.beginPath(), i = 0; a > i; i++) { for (n = 0, o = r[i].length; o > n; n++) s = r[i][n], h[n ? "lineTo" : "moveTo"](s.x, s.y); e && h.closePath() } this._fillStroke(h, t) } }, _updateCircle: function (t) { if (!t._empty()) { var e = t._point, i = this._ctx, n = t._radius, o = (t._radiusY || n) / n; 1 !== o && (i.save(), i.scale(1, o)), i.beginPath(), i.arc(e.x, e.y / o, n, 0, 2 * Math.PI, !1), 1 !== o && i.restore(), this._fillStroke(i, t) } }, _fillStroke: function (t, e) { var i = this._clear, n = e.options; t.globalCompositeOperation = i ? "destination-out" : "source-over", n.fill && (t.globalAlpha = i ? 1 : n.fillOpacity, t.fillStyle = n.fillColor || n.color, t.fill(n.fillRule || "evenodd")), n.stroke && 0 !== n.weight && (t.globalAlpha = i ? 1 : n.opacity, e._prevWeight = t.lineWidth = i ? e._prevWeight + 1 : n.weight, t.strokeStyle = n.color, t.lineCap = n.lineCap, t.lineJoin = n.lineJoin, t.stroke()) }, _onClick: function (t) { var e = this._map.mouseEventToLayerPoint(t); for (var i in this._layers) this._layers[i]._containsPoint(e) && (o.DomEvent._fakeStop(t), this._fireEvent(this._layers[i], t)) }, _onMouseMove: function (t) { if (this._map && !this._map.dragging._draggable._moving && !this._map._animatingZoom) { var e = this._map.mouseEventToLayerPoint(t); this._handleMouseOut(t, e), this._handleMouseHover(t, e) } }, _handleMouseOut: function (t, e) { var i = this._hoveredLayer; !i || "mouseout" !== t.type && i._containsPoint(e) || (o.DomUtil.removeClass(this._container, "leaflet-interactive"), this._fireEvent(i, t, "mouseout"), this._hoveredLayer = null) }, _handleMouseHover: function (t, e) { var i, n; if (!this._hoveredLayer) for (i in this._drawnLayers) if (n = this._drawnLayers[i], n.options.interactive && n._containsPoint(e)) { o.DomUtil.addClass(this._container, "leaflet-interactive"), this._fireEvent(n, t, "mouseover"), this._hoveredLayer = n; break } this._hoveredLayer && this._fireEvent(this._hoveredLayer, t) }, _fireEvent: function (t, e, i) { this._map._fireDOMEvent(e, i || e.type, [t]) }, _bringToFront: o.Util.falseFn, _bringToBack: o.Util.falseFn }), o.Browser.canvas = function () { return !!e.createElement("canvas").getContext }(), o.canvas = function (t) { return o.Browser.canvas ? new o.Canvas(t) : null }, o.Polyline.prototype._containsPoint = function (t, e) { var i, n, s, r, a, h, l = this._clickTolerance(); if (!this._pxBounds.contains(t)) return !1; for (i = 0, r = this._parts.length; r > i; i++) for (h = this._parts[i], n = 0, a = h.length, s = a - 1; a > n; s = n++) if ((e || 0 !== n) && o.LineUtil.pointToSegmentDistance(t, h[s], h[n]) <= l) return !0; return !1 }, o.Polygon.prototype._containsPoint = function (t) { var e, i, n, s, r, a, h, l, u = !1; if (!this._pxBounds.contains(t)) return !1; for (s = 0, h = this._parts.length; h > s; s++) for (e = this._parts[s], r = 0, l = e.length, a = l - 1; l > r; a = r++) i = e[r], n = e[a], i.y > t.y != n.y > t.y && t.x < (n.x - i.x) * (t.y - i.y) / (n.y - i.y) + i.x && (u = !u); return u || o.Polyline.prototype._containsPoint.call(this, t, !0) }, o.CircleMarker.prototype._containsPoint = function (t) { return t.distanceTo(this._point) <= this._radius + this._clickTolerance() }, o.GeoJSON = o.FeatureGroup.extend({ initialize: function (t, e) { o.setOptions(this, e), this._layers = {}, t && this.addData(t) }, addData: function (t) { var e, i, n, s = o.Util.isArray(t) ? t : t.features; if (s) { for (e = 0, i = s.length; i > e; e++) n = s[e], (n.geometries || n.geometry || n.features || n.coordinates) && this.addData(n); return this } var r = this.options; if (r.filter && !r.filter(t)) return this; var a = o.GeoJSON.geometryToLayer(t, r); return a ? (a.feature = o.GeoJSON.asFeature(t), a.defaultOptions = a.options, this.resetStyle(a), r.onEachFeature && r.onEachFeature(t, a), this.addLayer(a)) : this }, resetStyle: function (t) { return t.options = t.defaultOptions, this._setLayerStyle(t, this.options.style), this }, setStyle: function (t) { return this.eachLayer(function (e) { this._setLayerStyle(e, t) }, this) }, _setLayerStyle: function (t, e) { "function" == typeof e && (e = e(t.feature)), t.setStyle && t.setStyle(e) } }), o.extend(o.GeoJSON, { geometryToLayer: function (t, e) { var i, n, s, r, a = "Feature" === t.type ? t.geometry : t, h = a ? a.coordinates : null, l = [], u = e && e.pointToLayer, c = e && e.coordsToLatLng || this.coordsToLatLng; if (!h && !a) return null; switch (a.type) { case "Point": return i = c(h), u ? u(t, i) : new o.Marker(i); case "MultiPoint": for (s = 0, r = h.length; r > s; s++) i = c(h[s]), l.push(u ? u(t, i) : new o.Marker(i)); return new o.FeatureGroup(l); case "LineString": case "MultiLineString": return n = this.coordsToLatLngs(h, "LineString" === a.type ? 0 : 1, c), new o.Polyline(n, e); case "Polygon": case "MultiPolygon": return n = this.coordsToLatLngs(h, "Polygon" === a.type ? 1 : 2, c), new o.Polygon(n, e); case "GeometryCollection": for (s = 0, r = a.geometries.length; r > s; s++) { var d = this.geometryToLayer({ geometry: a.geometries[s], type: "Feature", properties: t.properties }, e); d && l.push(d) } return new o.FeatureGroup(l); default: throw new Error("Invalid GeoJSON object.") } }, coordsToLatLng: function (t) { return new o.LatLng(t[1], t[0], t[2]) }, coordsToLatLngs: function (t, e, i) { for (var n, o = [], s = 0, r = t.length; r > s; s++) n = e ? this.coordsToLatLngs(t[s], e - 1, i) : (i || this.coordsToLatLng)(t[s]), o.push(n); return o }, latLngToCoords: function (t) { return t.alt !== i ? [t.lng, t.lat, t.alt] : [t.lng, t.lat] }, latLngsToCoords: function (t, e, i) { for (var n = [], s = 0, r = t.length; r > s; s++) n.push(e ? o.GeoJSON.latLngsToCoords(t[s], e - 1, i) : o.GeoJSON.latLngToCoords(t[s])); return !e && i && n.push(n[0]), n }, getFeature: function (t, e) { return t.feature ? o.extend({}, t.feature, { geometry: e }) : o.GeoJSON.asFeature(e) }, asFeature: function (t) { return "Feature" === t.type ? t : { type: "Feature", properties: {}, geometry: t } } }); var r = { toGeoJSON: function () { return o.GeoJSON.getFeature(this, { type: "Point", coordinates: o.GeoJSON.latLngToCoords(this.getLatLng()) }) } }; o.Marker.include(r), o.Circle.include(r), o.CircleMarker.include(r), o.Polyline.prototype.toGeoJSON = function () { var t = !o.Polyline._flat(this._latlngs), e = o.GeoJSON.latLngsToCoords(this._latlngs, t ? 1 : 0); return o.GeoJSON.getFeature(this, { type: (t ? "Multi" : "") + "LineString", coordinates: e }) }, o.Polygon.prototype.toGeoJSON = function () { var t = !o.Polyline._flat(this._latlngs), e = t && !o.Polyline._flat(this._latlngs[0]), i = o.GeoJSON.latLngsToCoords(this._latlngs, e ? 2 : t ? 1 : 0, !0); return t || (i = [i]), o.GeoJSON.getFeature(this, { type: (e ? "Multi" : "") + "Polygon", coordinates: i }) }, o.LayerGroup.include({ toMultiPoint: function () { var t = []; return this.eachLayer(function (e) { t.push(e.toGeoJSON().geometry.coordinates) }), o.GeoJSON.getFeature(this, { type: "MultiPoint", coordinates: t }) }, toGeoJSON: function () { var t = this.feature && this.feature.geometry && this.feature.geometry.type; if ("MultiPoint" === t) return this.toMultiPoint(); var e = "GeometryCollection" === t, i = []; return this.eachLayer(function (t) { if (t.toGeoJSON) { var n = t.toGeoJSON(); i.push(e ? n.geometry : o.GeoJSON.asFeature(n)) } }), e ? o.GeoJSON.getFeature(this, { geometries: i, type: "GeometryCollection" }) : { type: "FeatureCollection", features: i } } }), o.geoJson = function (t, e) { return new o.GeoJSON(t, e) }; var a = "_leaflet_events"; o.DomEvent = { on: function (t, e, i, n) { if ("object" == typeof e) for (var s in e) this._on(t, s, e[s], i); else { e = o.Util.splitWords(e); for (var r = 0, a = e.length; a > r; r++) this._on(t, e[r], i, n) } return this }, off: function (t, e, i, n) { if ("object" == typeof e) for (var s in e) this._off(t, s, e[s], i); else { e = o.Util.splitWords(e); for (var r = 0, a = e.length; a > r; r++) this._off(t, e[r], i, n) } return this }, _on: function (e, i, n, s) { var r = i + o.stamp(n) + (s ? "_" + o.stamp(s) : ""); if (e[a] && e[a][r]) return this; var h = function (i) { return n.call(s || e, i || t.event) }, l = h; return o.Browser.pointer && 0 === i.indexOf("touch") ? this.addPointerListener(e, i, h, r) : o.Browser.touch && "dblclick" === i && this.addDoubleTapListener ? this.addDoubleTapListener(e, h, r) : "addEventListener" in e ? "mousewheel" === i ? (e.addEventListener("DOMMouseScroll", h, !1), e.addEventListener(i, h, !1)) : "mouseenter" === i || "mouseleave" === i ? (h = function (i) { i = i || t.event, o.DomEvent._checkMouse(e, i) && l(i) }, e.addEventListener("mouseenter" === i ? "mouseover" : "mouseout", h, !1)) : ("click" === i && o.Browser.android && (h = function (t) { return o.DomEvent._filterClick(t, l) }), e.addEventListener(i, h, !1)) : "attachEvent" in e && e.attachEvent("on" + i, h), e[a] = e[a] || {}, e[a][r] = h, this }, _off: function (t, e, i, n) { var s = e + o.stamp(i) + (n ? "_" + o.stamp(n) : ""), r = t[a] && t[a][s]; return r ? (o.Browser.pointer && 0 === e.indexOf("touch") ? this.removePointerListener(t, e, s) : o.Browser.touch && "dblclick" === e && this.removeDoubleTapListener ? this.removeDoubleTapListener(t, s) : "removeEventListener" in t ? "mousewheel" === e ? (t.removeEventListener("DOMMouseScroll", r, !1), t.removeEventListener(e, r, !1)) : t.removeEventListener("mouseenter" === e ? "mouseover" : "mouseleave" === e ? "mouseout" : e, r, !1) : "detachEvent" in t && t.detachEvent("on" + e, r), t[a][s] = null, this) : this }, stopPropagation: function (t) { return t.stopPropagation ? t.stopPropagation() : t.originalEvent ? t.originalEvent._stopped = !0 : t.cancelBubble = !0, o.DomEvent._skipped(t), this }, disableScrollPropagation: function (t) { return o.DomEvent.on(t, "mousewheel MozMousePixelScroll", o.DomEvent.stopPropagation) }, disableClickPropagation: function (t) { var e = o.DomEvent.stopPropagation; return o.DomEvent.on(t, o.Draggable.START.join(" "), e), o.DomEvent.on(t, { click: o.DomEvent._fakeStop, dblclick: e }) }, preventDefault: function (t) { return t.preventDefault ? t.preventDefault() : t.returnValue = !1, this }, stop: function (t) { return o.DomEvent.preventDefault(t).stopPropagation(t) }, getMousePosition: function (t, e) { if (!e) return new o.Point(t.clientX, t.clientY); var i = e.getBoundingClientRect(); return new o.Point(t.clientX - i.left - e.clientLeft, t.clientY - i.top - e.clientTop) }, getWheelDelta: function (t) { var e = 0; return t.wheelDelta && (e = t.wheelDelta / 120), t.detail && (e = -t.detail / 3), e }, _skipEvents: {}, _fakeStop: function (t) { o.DomEvent._skipEvents[t.type] = !0 }, _skipped: function (t) { var e = this._skipEvents[t.type]; return this._skipEvents[t.type] = !1, e }, _checkMouse: function (t, e) { var i = e.relatedTarget; if (!i) return !0; try { for (; i && i !== t;) i = i.parentNode } catch (n) { return !1 } return i !== t }, _filterClick: function (t, e) { var i = t.timeStamp || t.originalEvent.timeStamp, n = o.DomEvent._lastClick && i - o.DomEvent._lastClick; return n && n > 100 && 500 > n || t.target._simulatedClick && !t._simulated ? void o.DomEvent.stop(t) : (o.DomEvent._lastClick = i, void e(t)) } }, o.DomEvent.addListener = o.DomEvent.on, o.DomEvent.removeListener = o.DomEvent.off, o.Draggable = o.Evented.extend({ statics: { START: o.Browser.touch ? ["touchstart", "mousedown"] : ["mousedown"], END: { mousedown: "mouseup", touchstart: "touchend", pointerdown: "touchend", MSPointerDown: "touchend" }, MOVE: { mousedown: "mousemove", touchstart: "touchmove", pointerdown: "touchmove", MSPointerDown: "touchmove" } }, initialize: function (t, e, i) { this._element = t, this._dragStartTarget = e || t, this._preventOutline = i }, enable: function () { this._enabled || (o.DomEvent.on(this._dragStartTarget, o.Draggable.START.join(" "), this._onDown, this), this._enabled = !0) }, disable: function () { this._enabled && (o.DomEvent.off(this._dragStartTarget, o.Draggable.START.join(" "), this._onDown, this), this._enabled = !1, this._moved = !1) }, _onDown: function (t) { if (this._moved = !1, !o.DomUtil.hasClass(this._element, "leaflet-zoom-anim") && !(o.Draggable._dragging || t.shiftKey || 1 !== t.which && 1 !== t.button && !t.touches) && this._enabled && (o.Draggable._dragging = !0, this._preventOutline && o.DomUtil.preventOutline(this._element), o.DomUtil.disableImageDrag(), o.DomUtil.disableTextSelection(), !this._moving)) { this.fire("down"); var i = t.touches ? t.touches[0] : t; this._startPoint = new o.Point(i.clientX, i.clientY), this._startPos = this._newPos = o.DomUtil.getPosition(this._element), o.DomEvent.on(e, o.Draggable.MOVE[t.type], this._onMove, this).on(e, o.Draggable.END[t.type], this._onUp, this) } }, _onMove: function (t) { if (t.touches && t.touches.length > 1) return void (this._moved = !0); var i = t.touches && 1 === t.touches.length ? t.touches[0] : t, n = new o.Point(i.clientX, i.clientY), s = n.subtract(this._startPoint); (s.x || s.y) && (o.Browser.touch && Math.abs(s.x) + Math.abs(s.y) < 3 || (o.DomEvent.preventDefault(t), this._moved || (this.fire("dragstart"), this._moved = !0, this._startPos = o.DomUtil.getPosition(this._element).subtract(s), o.DomUtil.addClass(e.body, "leaflet-dragging"), this._lastTarget = t.target || t.srcElement, o.DomUtil.addClass(this._lastTarget, "leaflet-drag-target")), this._newPos = this._startPos.add(s), this._moving = !0, o.Util.cancelAnimFrame(this._animRequest), this._lastEvent = t, this._animRequest = o.Util.requestAnimFrame(this._updatePosition, this, !0))) }, _updatePosition: function () { var t = { originalEvent: this._lastEvent }; this.fire("predrag", t), o.DomUtil.setPosition(this._element, this._newPos), this.fire("drag", t) }, _onUp: function () { o.DomUtil.removeClass(e.body, "leaflet-dragging"), this._lastTarget && (o.DomUtil.removeClass(this._lastTarget, "leaflet-drag-target"), this._lastTarget = null); for (var t in o.Draggable.MOVE) o.DomEvent.off(e, o.Draggable.MOVE[t], this._onMove, this).off(e, o.Draggable.END[t], this._onUp, this); o.DomUtil.enableImageDrag(), o.DomUtil.enableTextSelection(), this._moved && this._moving && (o.Util.cancelAnimFrame(this._animRequest), this.fire("dragend", { distance: this._newPos.distanceTo(this._startPos) })), this._moving = !1, o.Draggable._dragging = !1 } }), o.Handler = o.Class.extend({ initialize: function (t) { this._map = t }, enable: function () { this._enabled || (this._enabled = !0, this.addHooks()) }, disable: function () { this._enabled && (this._enabled = !1, this.removeHooks()) }, enabled: function () { return !!this._enabled } }), o.Map.mergeOptions({ dragging: !0, inertia: !o.Browser.android23, inertiaDeceleration: 3400, inertiaMaxSpeed: 1 / 0, easeLinearity: .2, worldCopyJump: !1 }), o.Map.Drag = o.Handler.extend({
        addHooks: function () {
            if (!this._draggable) {
                var t = this._map; this._draggable = new o.Draggable(t._mapPane, t._container), this._draggable.on({ down: this._onDown, dragstart: this._onDragStart, drag: this._onDrag, dragend: this._onDragEnd }, this), this._draggable.on("predrag", this._onPreDragLimit, this),
                t.options.worldCopyJump && (this._draggable.on("predrag", this._onPreDragWrap, this), t.on("zoomend", this._onZoomEnd, this), t.whenReady(this._onZoomEnd, this))
            } o.DomUtil.addClass(this._map._container, "leaflet-grab"), this._draggable.enable()
        }, removeHooks: function () { o.DomUtil.removeClass(this._map._container, "leaflet-grab"), this._draggable.disable() }, moved: function () { return this._draggable && this._draggable._moved }, _onDown: function () { this._map.stop() }, _onDragStart: function () { var t = this._map; if (this._map.options.maxBounds && this._map.options.maxBoundsViscosity) { var e = o.latLngBounds(this._map.options.maxBounds); this._offsetLimit = o.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1), this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())), this._viscosity = Math.min(1, Math.max(0, this._map.options.maxBoundsViscosity)) } else this._offsetLimit = null; t.fire("movestart").fire("dragstart"), t.options.inertia && (this._positions = [], this._times = []) }, _onDrag: function (t) { if (this._map.options.inertia) { var e = this._lastTime = +new Date, i = this._lastPos = this._draggable._absPos || this._draggable._newPos; this._positions.push(i), this._times.push(e), e - this._times[0] > 50 && (this._positions.shift(), this._times.shift()) } this._map.fire("move", t).fire("drag", t) }, _onZoomEnd: function () { var t = this._map.getSize().divideBy(2), e = this._map.latLngToLayerPoint([0, 0]); this._initialWorldOffset = e.subtract(t).x, this._worldWidth = this._map.getPixelWorldBounds().getSize().x }, _viscousLimit: function (t, e) { return t - (t - e) * this._viscosity }, _onPreDragLimit: function () { if (this._viscosity && this._offsetLimit) { var t = this._draggable._newPos.subtract(this._draggable._startPos), e = this._offsetLimit; t.x < e.min.x && (t.x = this._viscousLimit(t.x, e.min.x)), t.y < e.min.y && (t.y = this._viscousLimit(t.y, e.min.y)), t.x > e.max.x && (t.x = this._viscousLimit(t.x, e.max.x)), t.y > e.max.y && (t.y = this._viscousLimit(t.y, e.max.y)), this._draggable._newPos = this._draggable._startPos.add(t) } }, _onPreDragWrap: function () { var t = this._worldWidth, e = Math.round(t / 2), i = this._initialWorldOffset, n = this._draggable._newPos.x, o = (n - e + i) % t + e - i, s = (n + e + i) % t - e - i, r = Math.abs(o + i) < Math.abs(s + i) ? o : s; this._draggable._absPos = this._draggable._newPos.clone(), this._draggable._newPos.x = r }, _onDragEnd: function (t) { var e = this._map, i = e.options, n = !i.inertia || this._times.length < 2; if (e.fire("dragend", t), n) e.fire("moveend"); else { var s = this._lastPos.subtract(this._positions[0]), r = (this._lastTime - this._times[0]) / 1e3, a = i.easeLinearity, h = s.multiplyBy(a / r), l = h.distanceTo([0, 0]), u = Math.min(i.inertiaMaxSpeed, l), c = h.multiplyBy(u / l), d = u / (i.inertiaDeceleration * a), _ = c.multiplyBy(-d / 2).round(); _.x || _.y ? (_ = e._limitOffset(_, e.options.maxBounds), o.Util.requestAnimFrame(function () { e.panBy(_, { duration: d, easeLinearity: a, noMoveStart: !0, animate: !0 }) })) : e.fire("moveend") } }
    }), o.Map.addInitHook("addHandler", "dragging", o.Map.Drag), o.Map.mergeOptions({ doubleClickZoom: !0 }), o.Map.DoubleClickZoom = o.Handler.extend({ addHooks: function () { this._map.on("dblclick", this._onDoubleClick, this) }, removeHooks: function () { this._map.off("dblclick", this._onDoubleClick, this) }, _onDoubleClick: function (t) { var e = this._map, i = e.getZoom(), n = t.originalEvent.shiftKey ? Math.ceil(i) - 1 : Math.floor(i) + 1; "center" === e.options.doubleClickZoom ? e.setZoom(n) : e.setZoomAround(t.containerPoint, n) } }), o.Map.addInitHook("addHandler", "doubleClickZoom", o.Map.DoubleClickZoom), o.Map.mergeOptions({ scrollWheelZoom: !0, wheelDebounceTime: 40 }), o.Map.ScrollWheelZoom = o.Handler.extend({ addHooks: function () { o.DomEvent.on(this._map._container, { mousewheel: this._onWheelScroll, MozMousePixelScroll: o.DomEvent.preventDefault }, this), this._delta = 0 }, removeHooks: function () { o.DomEvent.off(this._map._container, { mousewheel: this._onWheelScroll, MozMousePixelScroll: o.DomEvent.preventDefault }, this) }, _onWheelScroll: function (t) { var e = o.DomEvent.getWheelDelta(t), i = this._map.options.wheelDebounceTime; this._delta += e, this._lastMousePos = this._map.mouseEventToContainerPoint(t), this._startTime || (this._startTime = +new Date); var n = Math.max(i - (+new Date - this._startTime), 0); clearTimeout(this._timer), this._timer = setTimeout(o.bind(this._performZoom, this), n), o.DomEvent.stop(t) }, _performZoom: function () { var t = this._map, e = this._delta, i = t.getZoom(); t.stop(), e = e > 0 ? Math.ceil(e) : Math.floor(e), e = Math.max(Math.min(e, 4), -4), e = t._limitZoom(i + e) - i, this._delta = 0, this._startTime = null, e && ("center" === t.options.scrollWheelZoom ? t.setZoom(i + e) : t.setZoomAround(this._lastMousePos, i + e)) } }), o.Map.addInitHook("addHandler", "scrollWheelZoom", o.Map.ScrollWheelZoom), o.extend(o.DomEvent, { _touchstart: o.Browser.msPointer ? "MSPointerDown" : o.Browser.pointer ? "pointerdown" : "touchstart", _touchend: o.Browser.msPointer ? "MSPointerUp" : o.Browser.pointer ? "pointerup" : "touchend", addDoubleTapListener: function (t, e, i) { function n(t) { var e; if (e = o.Browser.pointer ? o.DomEvent._pointersCount : t.touches.length, !(e > 1)) { var i = Date.now(), n = i - (r || i); a = t.touches ? t.touches[0] : t, h = n > 0 && l >= n, r = i } } function s() { if (h && !a.cancelBubble) { if (o.Browser.pointer) { var t, i, n = {}; for (i in a) t = a[i], n[i] = t && t.bind ? t.bind(a) : t; a = n } a.type = "dblclick", e(a), r = null } } var r, a, h = !1, l = 250, u = "_leaflet_", c = this._touchstart, d = this._touchend; return t[u + c + i] = n, t[u + d + i] = s, t.addEventListener(c, n, !1), t.addEventListener(d, s, !1), this }, removeDoubleTapListener: function (t, e) { var i = "_leaflet_", n = t[i + this._touchend + e]; return t.removeEventListener(this._touchstart, t[i + this._touchstart + e], !1), t.removeEventListener(this._touchend, n, !1), this } }), o.extend(o.DomEvent, { POINTER_DOWN: o.Browser.msPointer ? "MSPointerDown" : "pointerdown", POINTER_MOVE: o.Browser.msPointer ? "MSPointerMove" : "pointermove", POINTER_UP: o.Browser.msPointer ? "MSPointerUp" : "pointerup", POINTER_CANCEL: o.Browser.msPointer ? "MSPointerCancel" : "pointercancel", _pointers: {}, _pointersCount: 0, addPointerListener: function (t, e, i, n) { return "touchstart" === e ? this._addPointerStart(t, i, n) : "touchmove" === e ? this._addPointerMove(t, i, n) : "touchend" === e && this._addPointerEnd(t, i, n), this }, removePointerListener: function (t, e, i) { var n = t["_leaflet_" + e + i]; return "touchstart" === e ? t.removeEventListener(this.POINTER_DOWN, n, !1) : "touchmove" === e ? t.removeEventListener(this.POINTER_MOVE, n, !1) : "touchend" === e && (t.removeEventListener(this.POINTER_UP, n, !1), t.removeEventListener(this.POINTER_CANCEL, n, !1)), this }, _addPointerStart: function (t, i, n) { var s = o.bind(function (t) { o.DomEvent.preventDefault(t), this._handlePointer(t, i) }, this); if (t["_leaflet_touchstart" + n] = s, t.addEventListener(this.POINTER_DOWN, s, !1), !this._pointerDocListener) { var r = o.bind(this._globalPointerUp, this); e.documentElement.addEventListener(this.POINTER_DOWN, o.bind(this._globalPointerDown, this), !0), e.documentElement.addEventListener(this.POINTER_MOVE, o.bind(this._globalPointerMove, this), !0), e.documentElement.addEventListener(this.POINTER_UP, r, !0), e.documentElement.addEventListener(this.POINTER_CANCEL, r, !0), this._pointerDocListener = !0 } }, _globalPointerDown: function (t) { this._pointers[t.pointerId] = t, this._pointersCount++ }, _globalPointerMove: function (t) { this._pointers[t.pointerId] && (this._pointers[t.pointerId] = t) }, _globalPointerUp: function (t) { delete this._pointers[t.pointerId], this._pointersCount-- }, _handlePointer: function (t, e) { t.touches = []; for (var i in this._pointers) t.touches.push(this._pointers[i]); t.changedTouches = [t], e(t) }, _addPointerMove: function (t, e, i) { var n = o.bind(function (t) { (t.pointerType !== t.MSPOINTER_TYPE_MOUSE && "mouse" !== t.pointerType || 0 !== t.buttons) && this._handlePointer(t, e) }, this); t["_leaflet_touchmove" + i] = n, t.addEventListener(this.POINTER_MOVE, n, !1) }, _addPointerEnd: function (t, e, i) { var n = o.bind(function (t) { this._handlePointer(t, e) }, this); t["_leaflet_touchend" + i] = n, t.addEventListener(this.POINTER_UP, n, !1), t.addEventListener(this.POINTER_CANCEL, n, !1) } }), o.Map.mergeOptions({ touchZoom: o.Browser.touch && !o.Browser.android23, bounceAtZoomLimits: !0 }), o.Map.TouchZoom = o.Handler.extend({ addHooks: function () { o.DomEvent.on(this._map._container, "touchstart", this._onTouchStart, this) }, removeHooks: function () { o.DomEvent.off(this._map._container, "touchstart", this._onTouchStart, this) }, _onTouchStart: function (t) { var i = this._map; if (t.touches && 2 === t.touches.length && !i._animatingZoom && !this._zooming) { var n = i.mouseEventToContainerPoint(t.touches[0]), s = i.mouseEventToContainerPoint(t.touches[1]); this._centerPoint = i.getSize()._divideBy(2), this._startLatLng = i.containerPointToLatLng(this._centerPoint), "center" !== i.options.touchZoom && (this._pinchStartLatLng = i.containerPointToLatLng(n.add(s)._divideBy(2))), this._startDist = n.distanceTo(s), this._startZoom = i.getZoom(), this._moved = !1, this._zooming = !0, i.stop(), o.DomEvent.on(e, "touchmove", this._onTouchMove, this).on(e, "touchend", this._onTouchEnd, this), o.DomEvent.preventDefault(t) } }, _onTouchMove: function (t) { if (t.touches && 2 === t.touches.length && this._zooming) { var e = this._map, i = e.mouseEventToContainerPoint(t.touches[0]), n = e.mouseEventToContainerPoint(t.touches[1]), s = i.distanceTo(n) / this._startDist; if (this._zoom = e.getScaleZoom(s, this._startZoom), "center" === e.options.touchZoom) { if (this._center = this._startLatLng, 1 === s) return } else { var r = i._add(n)._divideBy(2)._subtract(this._centerPoint); if (1 === s && 0 === r.x && 0 === r.y) return; this._center = e.unproject(e.project(this._pinchStartLatLng).subtract(r)) } if (e.options.bounceAtZoomLimits || !(this._zoom <= e.getMinZoom() && 1 > s || this._zoom >= e.getMaxZoom() && s > 1)) { this._moved || (e._moveStart(!0), this._moved = !0), o.Util.cancelAnimFrame(this._animRequest); var a = o.bind(e._move, e, this._center, this._zoom, { pinch: !0, round: !1 }); this._animRequest = o.Util.requestAnimFrame(a, this, !0), o.DomEvent.preventDefault(t) } } }, _onTouchEnd: function () { if (!this._moved || !this._zooming) return void (this._zooming = !1); this._zooming = !1, o.Util.cancelAnimFrame(this._animRequest), o.DomEvent.off(e, "touchmove", this._onTouchMove).off(e, "touchend", this._onTouchEnd); var t = this._zoom; t = this._map._limitZoom(t - this._startZoom > 0 ? Math.ceil(t) : Math.floor(t)), this._map._animateZoom(this._center, t, !0, !0) } }), o.Map.addInitHook("addHandler", "touchZoom", o.Map.TouchZoom), o.Map.mergeOptions({ tap: !0, tapTolerance: 15 }), o.Map.Tap = o.Handler.extend({ addHooks: function () { o.DomEvent.on(this._map._container, "touchstart", this._onDown, this) }, removeHooks: function () { o.DomEvent.off(this._map._container, "touchstart", this._onDown, this) }, _onDown: function (t) { if (t.touches) { if (o.DomEvent.preventDefault(t), this._fireClick = !0, t.touches.length > 1) return this._fireClick = !1, void clearTimeout(this._holdTimeout); var i = t.touches[0], n = i.target; this._startPos = this._newPos = new o.Point(i.clientX, i.clientY), n.tagName && "a" === n.tagName.toLowerCase() && o.DomUtil.addClass(n, "leaflet-active"), this._holdTimeout = setTimeout(o.bind(function () { this._isTapValid() && (this._fireClick = !1, this._onUp(), this._simulateEvent("contextmenu", i)) }, this), 1e3), this._simulateEvent("mousedown", i), o.DomEvent.on(e, { touchmove: this._onMove, touchend: this._onUp }, this) } }, _onUp: function (t) { if (clearTimeout(this._holdTimeout), o.DomEvent.off(e, { touchmove: this._onMove, touchend: this._onUp }, this), this._fireClick && t && t.changedTouches) { var i = t.changedTouches[0], n = i.target; n && n.tagName && "a" === n.tagName.toLowerCase() && o.DomUtil.removeClass(n, "leaflet-active"), this._simulateEvent("mouseup", i), this._isTapValid() && this._simulateEvent("click", i) } }, _isTapValid: function () { return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance }, _onMove: function (t) { var e = t.touches[0]; this._newPos = new o.Point(e.clientX, e.clientY) }, _simulateEvent: function (i, n) { var o = e.createEvent("MouseEvents"); o._simulated = !0, n.target._simulatedClick = !0, o.initMouseEvent(i, !0, !0, t, 1, n.screenX, n.screenY, n.clientX, n.clientY, !1, !1, !1, !1, 0, null), n.target.dispatchEvent(o) } }), o.Browser.touch && !o.Browser.pointer && o.Map.addInitHook("addHandler", "tap", o.Map.Tap), o.Map.mergeOptions({ boxZoom: !0 }), o.Map.BoxZoom = o.Handler.extend({ initialize: function (t) { this._map = t, this._container = t._container, this._pane = t._panes.overlayPane }, addHooks: function () { o.DomEvent.on(this._container, "mousedown", this._onMouseDown, this) }, removeHooks: function () { o.DomEvent.off(this._container, "mousedown", this._onMouseDown, this) }, moved: function () { return this._moved }, _resetState: function () { this._moved = !1 }, _onMouseDown: function (t) { return !t.shiftKey || 1 !== t.which && 1 !== t.button ? !1 : (this._resetState(), o.DomUtil.disableTextSelection(), o.DomUtil.disableImageDrag(), this._startPoint = this._map.mouseEventToContainerPoint(t), void o.DomEvent.on(e, { contextmenu: o.DomEvent.stop, mousemove: this._onMouseMove, mouseup: this._onMouseUp, keydown: this._onKeyDown }, this)) }, _onMouseMove: function (t) { this._moved || (this._moved = !0, this._box = o.DomUtil.create("div", "leaflet-zoom-box", this._container), o.DomUtil.addClass(this._container, "leaflet-crosshair"), this._map.fire("boxzoomstart")), this._point = this._map.mouseEventToContainerPoint(t); var e = new o.Bounds(this._point, this._startPoint), i = e.getSize(); o.DomUtil.setPosition(this._box, e.min), this._box.style.width = i.x + "px", this._box.style.height = i.y + "px" }, _finish: function () { this._moved && (o.DomUtil.remove(this._box), o.DomUtil.removeClass(this._container, "leaflet-crosshair")), o.DomUtil.enableTextSelection(), o.DomUtil.enableImageDrag(), o.DomEvent.off(e, { contextmenu: o.DomEvent.stop, mousemove: this._onMouseMove, mouseup: this._onMouseUp, keydown: this._onKeyDown }, this) }, _onMouseUp: function (t) { if ((1 === t.which || 1 === t.button) && (this._finish(), this._moved)) { setTimeout(o.bind(this._resetState, this), 0); var e = new o.LatLngBounds(this._map.containerPointToLatLng(this._startPoint), this._map.containerPointToLatLng(this._point)); this._map.fitBounds(e).fire("boxzoomend", { boxZoomBounds: e }) } }, _onKeyDown: function (t) { 27 === t.keyCode && this._finish() } }), o.Map.addInitHook("addHandler", "boxZoom", o.Map.BoxZoom), o.Map.mergeOptions({ keyboard: !0, keyboardPanOffset: 80, keyboardZoomOffset: 1 }), o.Map.Keyboard = o.Handler.extend({ keyCodes: { left: [37], right: [39], down: [40], up: [38], zoomIn: [187, 107, 61, 171], zoomOut: [189, 109, 54, 173] }, initialize: function (t) { this._map = t, this._setPanOffset(t.options.keyboardPanOffset), this._setZoomOffset(t.options.keyboardZoomOffset) }, addHooks: function () { var t = this._map._container; -1 === t.tabIndex && (t.tabIndex = "0"), o.DomEvent.on(t, { focus: this._onFocus, blur: this._onBlur, mousedown: this._onMouseDown }, this), this._map.on({ focus: this._addHooks, blur: this._removeHooks }, this) }, removeHooks: function () { this._removeHooks(), o.DomEvent.off(this._map._container, { focus: this._onFocus, blur: this._onBlur, mousedown: this._onMouseDown }, this), this._map.off({ focus: this._addHooks, blur: this._removeHooks }, this) }, _onMouseDown: function () { if (!this._focused) { var i = e.body, n = e.documentElement, o = i.scrollTop || n.scrollTop, s = i.scrollLeft || n.scrollLeft; this._map._container.focus(), t.scrollTo(s, o) } }, _onFocus: function () { this._focused = !0, this._map.fire("focus") }, _onBlur: function () { this._focused = !1, this._map.fire("blur") }, _setPanOffset: function (t) { var e, i, n = this._panKeys = {}, o = this.keyCodes; for (e = 0, i = o.left.length; i > e; e++) n[o.left[e]] = [-1 * t, 0]; for (e = 0, i = o.right.length; i > e; e++) n[o.right[e]] = [t, 0]; for (e = 0, i = o.down.length; i > e; e++) n[o.down[e]] = [0, t]; for (e = 0, i = o.up.length; i > e; e++) n[o.up[e]] = [0, -1 * t] }, _setZoomOffset: function (t) { var e, i, n = this._zoomKeys = {}, o = this.keyCodes; for (e = 0, i = o.zoomIn.length; i > e; e++) n[o.zoomIn[e]] = t; for (e = 0, i = o.zoomOut.length; i > e; e++) n[o.zoomOut[e]] = -t }, _addHooks: function () { o.DomEvent.on(e, "keydown", this._onKeyDown, this) }, _removeHooks: function () { o.DomEvent.off(e, "keydown", this._onKeyDown, this) }, _onKeyDown: function (t) { if (!(t.altKey || t.ctrlKey || t.metaKey)) { var e = t.keyCode, i = this._map; if (e in this._panKeys) { if (i._panAnim && i._panAnim._inProgress) return; i.panBy(this._panKeys[e]), i.options.maxBounds && i.panInsideBounds(i.options.maxBounds) } else if (e in this._zoomKeys) i.setZoom(i.getZoom() + (t.shiftKey ? 3 : 1) * this._zoomKeys[e]); else { if (27 !== e) return; i.closePopup() } o.DomEvent.stop(t) } } }), o.Map.addInitHook("addHandler", "keyboard", o.Map.Keyboard), o.Handler.MarkerDrag = o.Handler.extend({ initialize: function (t) { this._marker = t }, addHooks: function () { var t = this._marker._icon; this._draggable || (this._draggable = new o.Draggable(t, t, !0)), this._draggable.on({ dragstart: this._onDragStart, drag: this._onDrag, dragend: this._onDragEnd }, this).enable(), o.DomUtil.addClass(t, "leaflet-marker-draggable") }, removeHooks: function () { this._draggable.off({ dragstart: this._onDragStart, drag: this._onDrag, dragend: this._onDragEnd }, this).disable(), this._marker._icon && o.DomUtil.removeClass(this._marker._icon, "leaflet-marker-draggable") }, moved: function () { return this._draggable && this._draggable._moved }, _onDragStart: function () { this._marker.closePopup().fire("movestart").fire("dragstart") }, _onDrag: function (t) { var e = this._marker, i = e._shadow, n = o.DomUtil.getPosition(e._icon), s = e._map.layerPointToLatLng(n); i && o.DomUtil.setPosition(i, n), e._latlng = s, t.latlng = s, e.fire("move", t).fire("drag", t) }, _onDragEnd: function (t) { this._marker.fire("moveend").fire("dragend", t) } }), o.Control = o.Class.extend({ options: { position: "topright" }, initialize: function (t) { o.setOptions(this, t) }, getPosition: function () { return this.options.position }, setPosition: function (t) { var e = this._map; return e && e.removeControl(this), this.options.position = t, e && e.addControl(this), this }, getContainer: function () { return this._container }, addTo: function (t) { this.remove(), this._map = t; var e = this._container = this.onAdd(t), i = this.getPosition(), n = t._controlCorners[i]; return o.DomUtil.addClass(e, "leaflet-control"), -1 !== i.indexOf("bottom") ? n.insertBefore(e, n.firstChild) : n.appendChild(e), this }, remove: function () { return this._map ? (o.DomUtil.remove(this._container), this.onRemove && this.onRemove(this._map), this._map = null, this) : this }, _refocusOnMap: function (t) { this._map && t && t.screenX > 0 && t.screenY > 0 && this._map.getContainer().focus() } }), o.control = function (t) { return new o.Control(t) }, o.Map.include({ addControl: function (t) { return t.addTo(this), this }, removeControl: function (t) { return t.remove(), this }, _initControlPos: function () { function t(t, s) { var r = i + t + " " + i + s; e[t + s] = o.DomUtil.create("div", r, n) } var e = this._controlCorners = {}, i = "leaflet-", n = this._controlContainer = o.DomUtil.create("div", i + "control-container", this._container); t("top", "left"), t("top", "right"), t("bottom", "left"), t("bottom", "right") }, _clearControlPos: function () { o.DomUtil.remove(this._controlContainer) } }), o.Control.Zoom = o.Control.extend({ options: { position: "topleft", zoomInText: "+", zoomInTitle: "Zoom in", zoomOutText: "-", zoomOutTitle: "Zoom out" }, onAdd: function (t) { var e = "leaflet-control-zoom", i = o.DomUtil.create("div", e + " leaflet-bar"), n = this.options; return this._zoomInButton = this._createButton(n.zoomInText, n.zoomInTitle, e + "-in", i, this._zoomIn), this._zoomOutButton = this._createButton(n.zoomOutText, n.zoomOutTitle, e + "-out", i, this._zoomOut), this._updateDisabled(), t.on("zoomend zoomlevelschange", this._updateDisabled, this), i }, onRemove: function (t) { t.off("zoomend zoomlevelschange", this._updateDisabled, this) }, disable: function () { return this._disabled = !0, this._updateDisabled(), this }, enable: function () { return this._disabled = !1, this._updateDisabled(), this }, _zoomIn: function (t) { this._disabled || this._map.zoomIn(t.shiftKey ? 3 : 1) }, _zoomOut: function (t) { this._disabled || this._map.zoomOut(t.shiftKey ? 3 : 1) }, _createButton: function (t, e, i, n, s) { var r = o.DomUtil.create("a", i, n); return r.innerHTML = t, r.href = "#", r.title = e, o.DomEvent.on(r, "mousedown dblclick", o.DomEvent.stopPropagation).on(r, "click", o.DomEvent.stop).on(r, "click", s, this).on(r, "click", this._refocusOnMap, this), r }, _updateDisabled: function () { var t = this._map, e = "leaflet-disabled"; o.DomUtil.removeClass(this._zoomInButton, e), o.DomUtil.removeClass(this._zoomOutButton, e), (this._disabled || t._zoom === t.getMinZoom()) && o.DomUtil.addClass(this._zoomOutButton, e), (this._disabled || t._zoom === t.getMaxZoom()) && o.DomUtil.addClass(this._zoomInButton, e) } }), o.Map.mergeOptions({ zoomControl: !0 }), o.Map.addInitHook(function () { this.options.zoomControl && (this.zoomControl = new o.Control.Zoom, this.addControl(this.zoomControl)) }), o.control.zoom = function (t) { return new o.Control.Zoom(t) }, o.Control.Attribution = o.Control.extend({ options: { position: "bottomright", prefix: '<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>' }, initialize: function (t) { o.setOptions(this, t), this._attributions = {} }, onAdd: function (t) { this._container = o.DomUtil.create("div", "leaflet-control-attribution"), o.DomEvent && o.DomEvent.disableClickPropagation(this._container); for (var e in t._layers) t._layers[e].getAttribution && this.addAttribution(t._layers[e].getAttribution()); return this._update(), this._container }, setPrefix: function (t) { return this.options.prefix = t, this._update(), this }, addAttribution: function (t) { return t ? (this._attributions[t] || (this._attributions[t] = 0), this._attributions[t]++, this._update(), this) : this }, removeAttribution: function (t) { return t ? (this._attributions[t] && (this._attributions[t]--, this._update()), this) : this }, _update: function () { if (this._map) { var t = []; for (var e in this._attributions) this._attributions[e] && t.push(e); var i = []; this.options.prefix && i.push(this.options.prefix), t.length && i.push(t.join(", ")), this._container.innerHTML = i.join(" | ") } } }), o.Map.mergeOptions({ attributionControl: !0 }), o.Map.addInitHook(function () { this.options.attributionControl && (this.attributionControl = (new o.Control.Attribution).addTo(this)) }), o.control.attribution = function (t) { return new o.Control.Attribution(t) }, o.Control.Scale = o.Control.extend({ options: { position: "bottomleft", maxWidth: 100, metric: !0, imperial: !0 }, onAdd: function (t) { var e = "leaflet-control-scale", i = o.DomUtil.create("div", e), n = this.options; return this._addScales(n, e + "-line", i), t.on(n.updateWhenIdle ? "moveend" : "move", this._update, this), t.whenReady(this._update, this), i }, onRemove: function (t) { t.off(this.options.updateWhenIdle ? "moveend" : "move", this._update, this) }, _addScales: function (t, e, i) { t.metric && (this._mScale = o.DomUtil.create("div", e, i)), t.imperial && (this._iScale = o.DomUtil.create("div", e, i)) }, _update: function () { var t = this._map, e = t.getSize().y / 2, i = t.distance(t.containerPointToLatLng([0, e]), t.containerPointToLatLng([this.options.maxWidth, e])); this._updateScales(i) }, _updateScales: function (t) { this.options.metric && t && this._updateMetric(t), this.options.imperial && t && this._updateImperial(t) }, _updateMetric: function (t) { var e = this._getRoundNum(t), i = 1e3 > e ? e + " m" : e / 1e3 + " km"; this._updateScale(this._mScale, i, e / t) }, _updateImperial: function (t) { var e, i, n, o = 3.2808399 * t; o > 5280 ? (e = o / 5280, i = this._getRoundNum(e), this._updateScale(this._iScale, i + " mi", i / e)) : (n = this._getRoundNum(o), this._updateScale(this._iScale, n + " ft", n / o)) }, _updateScale: function (t, e, i) { t.style.width = Math.round(this.options.maxWidth * i) + "px", t.innerHTML = e }, _getRoundNum: function (t) { var e = Math.pow(10, (Math.floor(t) + "").length - 1), i = t / e; return i = i >= 10 ? 10 : i >= 5 ? 5 : i >= 3 ? 3 : i >= 2 ? 2 : 1, e * i } }), o.control.scale = function (t) { return new o.Control.Scale(t) }, o.Control.Layers = o.Control.extend({ options: { collapsed: !0, position: "topright", autoZIndex: !0, hideSingleBase: !1 }, initialize: function (t, e, i) { o.setOptions(this, i), this._layers = {}, this._lastZIndex = 0, this._handlingClick = !1; for (var n in t) this._addLayer(t[n], n); for (n in e) this._addLayer(e[n], n, !0) }, onAdd: function () { return this._initLayout(), this._update(), this._container }, addBaseLayer: function (t, e) { return this._addLayer(t, e), this._update() }, addOverlay: function (t, e) { return this._addLayer(t, e, !0), this._update() }, removeLayer: function (t) { return t.off("add remove", this._onLayerChange, this), delete this._layers[o.stamp(t)], this._update() }, _initLayout: function () { var t = "leaflet-control-layers", e = this._container = o.DomUtil.create("div", t); e.setAttribute("aria-haspopup", !0), o.Browser.touch ? o.DomEvent.on(e, "click", o.DomEvent.stopPropagation) : o.DomEvent.disableClickPropagation(e).disableScrollPropagation(e); var i = this._form = o.DomUtil.create("form", t + "-list"); if (this.options.collapsed) { o.Browser.android || o.DomEvent.on(e, { mouseenter: this._expand, mouseleave: this._collapse }, this); var n = this._layersLink = o.DomUtil.create("a", t + "-toggle", e); n.href = "#", n.title = "Layers", o.Browser.touch ? o.DomEvent.on(n, "click", o.DomEvent.stop).on(n, "click", this._expand, this) : o.DomEvent.on(n, "focus", this._expand, this), o.DomEvent.on(i, "click", function () { setTimeout(o.bind(this._onInputClick, this), 0) }, this), this._map.on("click", this._collapse, this) } else this._expand(); this._baseLayersList = o.DomUtil.create("div", t + "-base", i), this._separator = o.DomUtil.create("div", t + "-separator", i), this._overlaysList = o.DomUtil.create("div", t + "-overlays", i), e.appendChild(i) }, _addLayer: function (t, e, i) { t.on("add remove", this._onLayerChange, this); var n = o.stamp(t); this._layers[n] = { layer: t, name: e, overlay: i }, this.options.autoZIndex && t.setZIndex && (this._lastZIndex++, t.setZIndex(this._lastZIndex)) }, _update: function () { if (!this._container) return this; o.DomUtil.empty(this._baseLayersList), o.DomUtil.empty(this._overlaysList); var t, e, i, n, s = 0; for (i in this._layers) n = this._layers[i], this._addItem(n), e = e || n.overlay, t = t || !n.overlay, s += n.overlay ? 0 : 1; return this.options.hideSingleBase && (t = t && s > 1, this._baseLayersList.style.display = t ? "" : "none"), this._separator.style.display = e && t ? "" : "none", this }, _onLayerChange: function (t) { this._handlingClick || this._update(); var e = this._layers[o.stamp(t.target)], i = e.overlay ? "add" === t.type ? "overlayadd" : "overlayremove" : "add" === t.type ? "baselayerchange" : null; i && this._map.fire(i, e) }, _createRadioElement: function (t, i) { var n = '<input type="radio" class="leaflet-control-layers-selector" name="' + t + '"' + (i ? ' checked="checked"' : "") + "/>", o = e.createElement("div"); return o.innerHTML = n, o.firstChild }, _addItem: function (t) { var i, n = e.createElement("label"), s = this._map.hasLayer(t.layer); t.overlay ? (i = e.createElement("input"), i.type = "checkbox", i.className = "leaflet-control-layers-selector", i.defaultChecked = s) : i = this._createRadioElement("leaflet-base-layers", s), i.layerId = o.stamp(t.layer), o.DomEvent.on(i, "click", this._onInputClick, this); var r = e.createElement("span"); r.innerHTML = " " + t.name; var a = e.createElement("div"); n.appendChild(a), a.appendChild(i), a.appendChild(r); var h = t.overlay ? this._overlaysList : this._baseLayersList; return h.appendChild(n), n }, _onInputClick: function () { var t, e, i, n = this._form.getElementsByTagName("input"), o = [], s = []; this._handlingClick = !0; for (var r = n.length - 1; r >= 0; r--) t = n[r], e = this._layers[t.layerId].layer, i = this._map.hasLayer(e), t.checked && !i ? o.push(e) : !t.checked && i && s.push(e); for (r = 0; r < s.length; r++) this._map.removeLayer(s[r]); for (r = 0; r < o.length; r++) this._map.addLayer(o[r]); this._handlingClick = !1, this._refocusOnMap() }, _expand: function () { o.DomUtil.addClass(this._container, "leaflet-control-layers-expanded"); var t = this._map._size.y - 4 * this._container.offsetTop; t < this._form.clientHeight && (o.DomUtil.addClass(this._form, "leaflet-control-layers-scrollbar"), this._form.style.height = t + "px") }, _collapse: function () { o.DomUtil.removeClass(this._container, "leaflet-control-layers-expanded") } }), o.control.layers = function (t, e, i) { return new o.Control.Layers(t, e, i) }, o.PosAnimation = o.Evented.extend({ run: function (t, e, i, n) { this.stop(), this._el = t, this._inProgress = !0, this._duration = i || .25, this._easeOutPower = 1 / Math.max(n || .5, .2), this._startPos = o.DomUtil.getPosition(t), this._offset = e.subtract(this._startPos), this._startTime = +new Date, this.fire("start"), this._animate() }, stop: function () { this._inProgress && (this._step(!0), this._complete()) }, _animate: function () { this._animId = o.Util.requestAnimFrame(this._animate, this), this._step() }, _step: function (t) { var e = +new Date - this._startTime, i = 1e3 * this._duration; i > e ? this._runFrame(this._easeOut(e / i), t) : (this._runFrame(1), this._complete()) }, _runFrame: function (t, e) { var i = this._startPos.add(this._offset.multiplyBy(t)); e && i._round(), o.DomUtil.setPosition(this._el, i), this.fire("step") }, _complete: function () { o.Util.cancelAnimFrame(this._animId), this._inProgress = !1, this.fire("end") }, _easeOut: function (t) { return 1 - Math.pow(1 - t, this._easeOutPower) } }), o.Map.include({ setView: function (t, e, n) { if (e = e === i ? this._zoom : this._limitZoom(e), t = this._limitCenter(o.latLng(t), e, this.options.maxBounds), n = n || {}, this.stop(), this._loaded && !n.reset && n !== !0) { n.animate !== i && (n.zoom = o.extend({ animate: n.animate }, n.zoom), n.pan = o.extend({ animate: n.animate }, n.pan)); var s = this._zoom !== e ? this._tryAnimatedZoom && this._tryAnimatedZoom(t, e, n.zoom) : this._tryAnimatedPan(t, n.pan); if (s) return clearTimeout(this._sizeTimer), this } return this._resetView(t, e), this }, panBy: function (t, e) { if (t = o.point(t).round(), e = e || {}, !t.x && !t.y) return this.fire("moveend"); if (e.animate !== !0 && !this.getSize().contains(t)) return this._resetView(this.unproject(this.project(this.getCenter()).add(t)), this.getZoom()), this; if (this._panAnim || (this._panAnim = new o.PosAnimation, this._panAnim.on({ step: this._onPanTransitionStep, end: this._onPanTransitionEnd }, this)), e.noMoveStart || this.fire("movestart"), e.animate !== !1) { o.DomUtil.addClass(this._mapPane, "leaflet-pan-anim"); var i = this._getMapPanePos().subtract(t); this._panAnim.run(this._mapPane, i, e.duration || .25, e.easeLinearity) } else this._rawPanBy(t), this.fire("move").fire("moveend"); return this }, _onPanTransitionStep: function () { this.fire("move") }, _onPanTransitionEnd: function () { o.DomUtil.removeClass(this._mapPane, "leaflet-pan-anim"), this.fire("moveend") }, _tryAnimatedPan: function (t, e) { var i = this._getCenterOffset(t)._floor(); return (e && e.animate) === !0 || this.getSize().contains(i) ? (this.panBy(i, e), !0) : !1 } }), o.Map.mergeOptions({ zoomAnimation: !0, zoomAnimationThreshold: 4 }); var h = o.DomUtil.TRANSITION && o.Browser.any3d && !o.Browser.mobileOpera; h && o.Map.addInitHook(function () { this._zoomAnimated = this.options.zoomAnimation, this._zoomAnimated && (this._createAnimProxy(), o.DomEvent.on(this._proxy, o.DomUtil.TRANSITION_END, this._catchTransitionEnd, this)) }), o.Map.include(h ? { _createAnimProxy: function () { var t = this._proxy = o.DomUtil.create("div", "leaflet-proxy leaflet-zoom-animated"); this._panes.mapPane.appendChild(t), this.on("zoomanim", function (e) { var i = o.DomUtil.TRANSFORM, n = t.style[i]; o.DomUtil.setTransform(t, this.project(e.center, e.zoom), this.getZoomScale(e.zoom, 1)), n === t.style[i] && this._animatingZoom && this._onZoomTransitionEnd() }, this), this.on("load moveend", function () { var e = this.getCenter(), i = this.getZoom(); o.DomUtil.setTransform(t, this.project(e, i), this.getZoomScale(i, 1)) }, this) }, _catchTransitionEnd: function (t) { this._animatingZoom && t.propertyName.indexOf("transform") >= 0 && this._onZoomTransitionEnd() }, _nothingToAnimate: function () { return !this._container.getElementsByClassName("leaflet-zoom-animated").length }, _tryAnimatedZoom: function (t, e, i) { if (this._animatingZoom) return !0; if (i = i || {}, !this._zoomAnimated || i.animate === !1 || this._nothingToAnimate() || Math.abs(e - this._zoom) > this.options.zoomAnimationThreshold) return !1; var n = this.getZoomScale(e), s = this._getCenterOffset(t)._divideBy(1 - 1 / n); return i.animate === !0 || this.getSize().contains(s) ? (o.Util.requestAnimFrame(function () { this._moveStart(!0)._animateZoom(t, e, !0) }, this), !0) : !1 }, _animateZoom: function (t, e, i, n) { i && (this._animatingZoom = !0, this._animateToCenter = t, this._animateToZoom = e, o.DomUtil.addClass(this._mapPane, "leaflet-zoom-anim")), this.fire("zoomanim", { center: t, zoom: e, noUpdate: n }) }, _onZoomTransitionEnd: function () { this._animatingZoom = !1, o.DomUtil.removeClass(this._mapPane, "leaflet-zoom-anim"), this._move(this._animateToCenter, this._animateToZoom)._moveEnd(!0) } } : {}), o.Map.include({ flyTo: function (t, e, n) { function s(t) { var e = (v * v - g * g + (t ? -1 : 1) * L * L * y * y) / (2 * (t ? v : g) * L * y); return Math.log(Math.sqrt(e * e + 1) - e) } function r(t) { return (Math.exp(t) - Math.exp(-t)) / 2 } function a(t) { return (Math.exp(t) + Math.exp(-t)) / 2 } function h(t) { return r(t) / a(t) } function l(t) { return g * (a(x) / a(x + P * t)) } function u(t) { return g * (a(x) * h(x + P * t) - r(x)) / L } function c(t) { return 1 - Math.pow(1 - t, 1.5) } function d() { var i = (Date.now() - b) / T, n = c(i) * w; 1 >= i ? (this._flyToFrame = o.Util.requestAnimFrame(d, this), this._move(this.unproject(_.add(m.subtract(_).multiplyBy(u(n) / y)), f), this.getScaleZoom(g / l(n), f))) : this._move(t, e)._moveEnd(!0) } if (n = n || {}, n.animate === !1 || !o.Browser.any3d) return this.setView(t, e, n); this.stop(); var _ = this.project(this.getCenter()), m = this.project(t), p = this.getSize(), f = this._zoom; t = o.latLng(t), e = e === i ? f : e; var g = Math.max(p.x, p.y), v = g * this.getZoomScale(f, e), y = m.distanceTo(_), P = 1.42, L = P * P, x = s(0), b = Date.now(), w = (s(1) - x) / P, T = n.duration ? 1e3 * n.duration : 1e3 * w * .8; return this._moveStart(!0), d.call(this), this }, flyToBounds: function (t, e) { var i = this._getBoundsCenterZoom(t, e); return this.flyTo(i.center, i.zoom, e) } }), o.Map.include({
        _defaultLocateOptions: {
            timeout: 1e4, watch: !1
        }, locate: function (t) { if (t = this._locateOptions = o.extend({}, this._defaultLocateOptions, t), !("geolocation" in navigator)) return this._handleGeolocationError({ code: 0, message: "Geolocation not supported." }), this; var e = o.bind(this._handleGeolocationResponse, this), i = o.bind(this._handleGeolocationError, this); return t.watch ? this._locationWatchId = navigator.geolocation.watchPosition(e, i, t) : navigator.geolocation.getCurrentPosition(e, i, t), this }, stopLocate: function () { return navigator.geolocation && navigator.geolocation.clearWatch(this._locationWatchId), this._locateOptions && (this._locateOptions.setView = !1), this }, _handleGeolocationError: function (t) { var e = t.code, i = t.message || (1 === e ? "permission denied" : 2 === e ? "position unavailable" : "timeout"); this._locateOptions.setView && !this._loaded && this.fitWorld(), this.fire("locationerror", { code: e, message: "Geolocation error: " + i + "." }) }, _handleGeolocationResponse: function (t) { var e = t.coords.latitude, i = t.coords.longitude, n = new o.LatLng(e, i), s = n.toBounds(t.coords.accuracy), r = this._locateOptions; if (r.setView) { var a = this.getBoundsZoom(s); this.setView(n, r.maxZoom ? Math.min(a, r.maxZoom) : a) } var h = { latlng: n, bounds: s, timestamp: t.timestamp }; for (var l in t.coords) "number" == typeof t.coords[l] && (h[l] = t.coords[l]); this.fire("locationfound", h) }
    })
}(window, document);
//#endregion

//#region Extensions
L.LatLng.prototype.toGeoPoint = function () {
  return WxMap.Gis.GeoPoint.fromDegrees(this.lng, this.lat);
}
//#endregion

//#region Data Visualization
/*
 @preserve Leaflet Data Visualization Framework, a JavaScript library for creating thematic maps using Leaflet
 (c) 2013-2014, Scott Fairgrieve, HumanGeo
 */
L.LinearFunction=L.Class.extend({initialize:function(t,e,i){this.setOptions(i),this.setRange(t,e)},_calculateParameters:function(t,e){0===this._xRange?(this._slope=0,this._b=t.y):(this._slope=(e.y-t.y)/this._xRange,this._b=t.y-this._slope*t.x)},_arrayToPoint:function(t){return{x:t[0],y:t[1]}},setOptions:function(t){L.Util.setOptions(this,t),this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},getBounds:function(){var t=Math.min(this._minPoint.x,this._maxPoint.x),e=Math.max(this._minPoint.x,this._maxPoint.x),i=Math.min(this._minPoint.y,this._maxPoint.y),n=Math.max(this._minPoint.y,this._maxPoint.y);return[new L.Point(t,i),new L.Point(e,n)]},setRange:function(t,e){return t=t instanceof Array?this._arrayToPoint(t):t,e=e instanceof Array?this._arrayToPoint(e):e,this._minPoint=t,this._maxPoint=e,this._xRange=e.x-t.x,this._calculateParameters(t,e),this},setMin:function(t){return this.setRange(t,this._maxPoint),this},setMax:function(t){return this.setRange(this._minPoint,t),this},setPreProcess:function(t){return this._preProcess=t,this},setPostProcess:function(t){return this._postProcess=t,this},evaluate:function(t){var e;return this._preProcess&&(t=this._preProcess(t)),e=Number((this._slope*t).toFixed(6))+Number(this._b.toFixed(6)),this._postProcess&&(e=this._postProcess(e)),e},random:function(){var t=Math.random()*this._xRange+this._minPoint.x;return this.evaluate(t)},sample:function(t){t=Math.max(t,2);for(var e=t-1,i=this._xRange/e,n=this._minPoint.x,a=[];n<=this._maxPoint.x;)a.push(this.evaluate(n)),n+=i;return a},samplePoints:function(t){t=Math.max(t,2);for(var e=t-1,i=this._xRange/e,n=this._minPoint.x,a=[];n<=this._maxPoint.x;)a.push(new L.Point(n,this.evaluate(n))),n+=i;return a},getIntersectionPoint:function(t){var e=null;if(this._slope!==t._slope){var i=(this._b-t._b)/(t._slope-this._slope),n=this.evaluate(i);e=new L.Point(i,n)}return e}}),L.ColorFunction=L.LinearFunction.extend({options:{alpha:1,includeAlpha:!1},initialize:function(t,e,i){L.Util.setOptions(this,i),this._parts=[],this._dynamicPart=null,this._outputPrecision=0,this._prefix=null,this._formatOutput=function(t){return t.toFixed(this._outputPrecision)},this._mapOutput=function(t){for(var e=[],i=0;i<this._parts.length;++i){var n=this._parts[i];e.push(t[n])}return this.options.includeAlpha&&e.push(this.options.alpha),e},this._getColorString=function(t){t=this._formatOutput(t),this.options[this._dynamicPart]=t;var e=this._mapOutput(this.options);return this._writeColor(this._prefix,e)},this._writeColor=function(t,e){return this.options.includeAlpha&&(t+="a"),t+"("+e.join(",")+")"},i=L.extend({},this.options);var n=function(){return function(t){i&&i.postProcess&&(t=i.postProcess.call(this,t));var e=this._getColorString(t);return(L.Browser.ie&&e.indexOf("hsl")>-1||i.rgb)&&(e=L.hslColor(e).toRGBString()),e}};L.LinearFunction.prototype.initialize.call(this,t,e,{preProcess:this.options.preProcess,postProcess:n(i)})}}),L.HSLColorFunction=L.ColorFunction.extend({initialize:function(t,e,i){L.ColorFunction.prototype.initialize.call(this,t,e,i),this._parts=["outputHue","outputSaturation","outputLuminosity"],this._prefix="hsl",this._outputPrecision=2}}),L.RGBColorFunction=L.ColorFunction.extend({initialize:function(t,e,i){L.ColorFunction.prototype.initialize.call(this,t,e,i),this._parts=["outputRed","outputBlue","outputGreen"],this._prefix="rgb",this._outputPrecision=0}}),L.RGBRedFunction=L.LinearFunction.extend({options:{outputGreen:0,outputBlue:0},initialize:function(t,e,i){L.RGBColorFunction.prototype.initialize.call(this,t,e,i),this._dynamicPart="outputRed"}}),L.RGBBlueFunction=L.LinearFunction.extend({options:{outputRed:0,outputGreen:0},initialize:function(t,e,i){L.RGBColorFunction.prototype.initialize.call(this,t,e,i),this._dynamicPart="outputBlue"}}),L.RGBGreenFunction=L.LinearFunction.extend({options:{outputRed:0,outputBlue:0},initialize:function(t,e,i){L.RGBColorFunction.prototype.initialize.call(this,t,e,i),this._dynamicPart="outputGreen"}}),L.RGBColorBlendFunction=L.LinearFunction.extend({initialize:function(t,e,i,n){i=new L.RGBColor(i),n=new L.RGBColor(n);var a=i.r(),o=n.r(),r=i.g(),s=n.g(),d=i.b(),l=n.b();this._minX=t,this._maxX=e,this._redFunction=new L.LinearFunction(new L.Point(t,a),new L.Point(e,o)),this._greenFunction=new L.LinearFunction(new L.Point(t,r),new L.Point(e,s)),this._blueFunction=new L.LinearFunction(new L.Point(t,d),new L.Point(e,l))},getBounds:function(){var t=this._redFunction.getBounds(),e=this._greenFunction.getBounds(),i=this._blueFunction.getBounds(),n=Math.min(t[0].y,e[0].y,i[0].y),a=Math.max(t[0].y,e[0].y,i[0].y);return[new L.Point(t[0].x,n),new L.Point(t[1].x,a)]},evaluate:function(t){return new L.RGBColor([this._redFunction.evaluate(t),this._greenFunction.evaluate(t),this._blueFunction.evaluate(t)]).toRGBString()}}),L.HSLHueFunction=L.HSLColorFunction.extend({options:{outputSaturation:"100%",outputLuminosity:"50%"},initialize:function(t,e,i){L.HSLColorFunction.prototype.initialize.call(this,t,e,i),this._dynamicPart="outputHue"}}),L.HSLSaturationFunction=L.LinearFunction.extend({options:{outputHue:0,outputLuminosity:"50%"},initialize:function(t,e,i){L.HSLColorFunction.prototype.initialize.call(this,t,e,i),this._formatOutput=function(t){return(100*t).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputSaturation"}}),L.HSLLuminosityFunction=L.LinearFunction.extend({options:{outputHue:0,outputSaturation:"100%"},initialize:function(t,e,i){L.HSLColorFunction.prototype.initialize.call(this,t,e,i),this._formatOutput=function(t){return(100*t).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputLuminosity"}}),L.HSLColorBlendFunction=L.LinearFunction.extend({initialize:function(t,e,i,n){i=new L.HSLColor(i),n=new L.HSLColor(n);var a=i.h(),o=n.h(),r=i.s(),s=n.s(),d=i.l(),l=n.l();this._minX=t,this._maxX=e,this._hueFunction=new L.LinearFunction(new L.Point(t,a),new L.Point(e,o)),this._saturationFunction=new L.LinearFunction(new L.Point(t,r),new L.Point(e,s)),this._luminosityFunction=new L.LinearFunction(new L.Point(t,d),new L.Point(e,l))},getBounds:function(){var t=this._hueFunction.getBounds(),e=this._saturationFunction.getBounds(),i=this._luminosityFunction.getBounds(),n=Math.min(t[0].y,e[0].y,i[0].y),a=Math.max(t[0].y,e[0].y,i[0].y);return[new L.Point(t[0].x,n),new L.Point(t[1].x,a)]},evaluate:function(t){return new L.HSLColor([this._hueFunction.evaluate(t),this._saturationFunction.evaluate(t),this._luminosityFunction.evaluate(t)]).toHSLString()}}),L.PiecewiseFunction=L.LinearFunction.extend({initialize:function(t,e){L.Util.setOptions(this,e),this._functions=t;var i,n;i=t[0].getBounds()[0],n=t[t.length-1].getBounds()[1],L.LinearFunction.prototype.initialize.call(this,i,n,{preProcess:this.options.preProcess,postProcess:this.options.postProcess})},_getFunction:function(t){for(var e,i,n,a,o=!1,r=0;r<this._functions.length;++r)if(a=this._functions[r],e=a.getBounds(),i=e[0],n=e[1],t>=i.x&&t<n.x){o=!0;break}return o?a:this._functions[this._functions.length-1]},evaluate:function(t){var e,i=null;return this._preProcess&&(t=this._preProcess(t)),e=this._getFunction(t),e&&(i=e.evaluate(t),this._postProcess&&(i=this._postProcess(i))),i}}),L.CustomColorFunction=L.PiecewiseFunction.extend({options:{interpolate:!0},initialize:function(t,e,i,n){var a,o=e-t,r=o/(i.length-1),s=[];L.Util.setOptions(this,n);for(var d=0;d<i.length;++d){var l=Math.min(d+1,i.length-1);a=this.options.interpolate?new L.RGBColorBlendFunction(t+r*d,t+r*l,i[d],i[l]):new L.RGBColorBlendFunction(t+r*d,t+r*l,i[d],i[d]),s.push(a)}L.PiecewiseFunction.prototype.initialize.call(this,s)}}),L.CategoryFunction=L.Class.extend({initialize:function(t,e){L.Util.setOptions(this,e),this._categoryKeys=Object.keys(t),this._categoryMap=t,this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},evaluate:function(t){var e;return this._preProcess&&(t=this._preProcess(t)),e=this._categoryMap[t],this._postProcess&&(e=this._postProcess(e)),e},getCategories:function(){return this._categoryKeys}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var i=e||0,n=this.length;n>i;i++)if(this[i]===t)return i;return-1}),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(a){var o,r,s;if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on non-object");o=[];for(r in a)t.call(a,r)&&o.push(r);if(e)for(s=0;n>s;s++)t.call(a,i[s])&&o.push(i[s]);return o}}()),L.Util.guid=function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},L.Util.getProperty=function(t,e,i){return e in t?t[e]:i},L.Util.setFieldValue=function(t,e,i){for(var n,a=e.split("."),o=t,r=0;r<a.length-1;++r)n=a[r],o[n]=o[n]||{},o=o[n];o[a[a.length-1]]=i},L.Util.getFieldValue=function(t,e){var i=null;if(e){for(var n,a,o,r,s,d,l,c=e.split("."),f=t,u=-1,h=0;h<c.length;++h)if(n=c[h],u=n.indexOf("["),u>-1){d=n.substring(u),n=n.substring(0,u),d=d.replace("[","").replace("]",""),a=d.split("="),o=a[0],r=a[1],f=f[n];for(var p=0;p<f.length;++p)s=f[p],l=s[o],l&&l===r&&(f=s)}else{if(!f||!f.hasOwnProperty(n)){f=null;break}f=f[n]}i=f}else i=t;return i},L.Util.getNumericRange=function(t,e){var i=Number.MAX_VALUE,n=Number.MIN_VALUE;for(var a in t)if(t.hasOwnProperty(a)){var o=t[a],r=L.Util.getFieldValue(o,e);i=Math.min(i,r),n=Math.max(n,r)}return[i,n]},L.Util.pointToGeoJSON=function(){var t={type:"Feature",geometry:{type:"Point",coordinates:[this._latlng[1],this._latlng[0]]},properties:{}};for(var e in this.options)if(this.options.hasOwnProperty(e)){var i=this.options[e];"function"!=typeof i&&(t.properties[e]=i)}return t},L.Util.updateLayer=function(t,e){t.eachLayer&&!t instanceof L.FeatureGroup?t.eachLayer(function(t){L.Util.updateLayer(t,e)}):e.call(this,t)},L.CategoryLegend=L.Class.extend({initialize:function(t){L.Util.setOptions(this,t)},generate:function(t){t=t||{};var e=document.createElement("div"),i=L.DomUtil.create("div","legend",e),n=t.className,a=this.options;n&&L.DomUtil.addClass(i,n),t.title&&(L.DomUtil.create("div","legend-title",i).innerHTML=t.title);for(var o in a){categoryOptions=a[o];var r=categoryOptions.displayName||o,s=L.DomUtil.create("div","data-layer-legend",i),d=L.DomUtil.create("div","legend-box",s);L.DomUtil.create("div","key",s).innerHTML=r,L.StyleConverter.applySVGStyle(d,categoryOptions)}return e.innerHTML}}),L.LegendIcon=L.DivIcon.extend({initialize:function(t,e,i){var n,a=document.createElement("div"),o=L.DomUtil.create("div","legend",a),r=L.DomUtil.create("div","title",o),s=L.DomUtil.create("div","legend-box",o),d=L.DomUtil.create("div","legend-values",o),l=e.title||e.name;l&&(r.innerHTML=l);for(var c in t)n=t[c],L.DomUtil.create("div","key",d).innerHTML=n.name||c,L.DomUtil.create("div","value",d).innerHTML=n.value;L.StyleConverter.applySVGStyle(s,e),s.style.height="5px",i.html=a.innerHTML,i.className=i.className||"legend-icon",L.DivIcon.prototype.initialize.call(this,i)}}),L.legendIcon=function(t,e,i){return new L.LegendIcon(t,e,i)},L.GeometryUtils={getName:function(t){var e=null;if(t&&t.features)for(var i=0;i<t.features.length;++i){var n=t.features[i];if(n.properties&&n.properties.name){e=n.properties.name;break}}return e},getGeoJSONLocation:function(t,e,i,n){var a=new L.GeoJSON(t,{pointToLayer:function(t,a){var o={location:a,text:i?L.Util.getFieldValue(e,i):[a.lat.toFixed(3),a.lng.toFixed(3)].join(", "),center:a};return n(o,e)}}),o=null;try{o=L.GeometryUtils.loadCentroid(t)}catch(r){console.log("Error loading centroid for "+JSON.stringify(t))}return{location:a,text:i?L.Util.getFieldValue(e,i):null,center:o}},mergeProperties:function(t,e,i){var n,a,o=e.features,r=L.GeometryUtils.indexFeatureCollection(o,i),s={type:"FeatureCollection",features:[]};for(var d in t)if(t.hasOwnProperty(d)&&(n=t[d],a=n[i])){var l=r[a];for(var c in n)l.properties[c]=n[c];s.features.push(l)}return s},indexFeatureCollection:function(t,e){for(var i,n,a,o=t.features,r={},s=0;s<o.length;++s)if(i=o[s],n=i.properties,a=n[e],a in r){var d=r[a];"GeometryCollection"!==d.geometry.type?r[a]={type:"Feature",geometry:{type:"GeometryCollection",geometries:[i.geometry,d.geometry]}}:d.geometry.geometries.push(i.geometry)}else r[a]=i;return r},arrayToMap:function(t,e,i){for(var n,a,o,r={},s=0;s<t.length;++s)n=t[s],a=n[e],o=i?n[i]:n,r[a]=o;return r},arrayToMaps:function(t,e){for(var i,n,a,o,r,s,d,l=[],c=0;c<e.length;++c)l.push({});for(var f=0;f<t.length;++f){n=t[f];for(var u=0;u<e.length;++u)i=l[u],r=e[u],s=r.from,d=r.to,a=n[s],o=d?n[d]:n,i[a]=o}return l},loadCentroid:function(t){var e,i,n,a=null;if(t.geometry&&"Point"===t.geometry.type)a=new L.LatLng(t.geometry.coordinates[1],t.geometry.coordinates[0]);else if("undefined"!=typeof jsts){var o=new jsts.io.GeoJSONParser,r=o.read(t);if(r.getCentroid)e=r.getCentroid(),i=e.coordinate.x,n=e.coordinate.y;else if(r.features){for(var s=0,d=0,l=0;l<r.features.length;++l)e=r.features[l].geometry.getCentroid(),s+=e.coordinate.x,d+=e.coordinate.y;i=s/r.features.length,n=d/r.features.length}else e=r.geometry.getCentroid(),i=e.coordinate.x,n=e.coordinate.y;a=new L.LatLng(n,i)}return a},loadCentroids:function(t){var e,i={};for(var n in t)e=t[n],i[n]=L.GeometryUtils.loadCentroid(e);return i}},L.SVGPathBuilder=L.Class.extend({initialize:function(t,e,i){this._points=t||[],this._innerPoints=e||[],L.Util.setOptions(this,i)},options:{closePath:!0},_getPathString:function(t,e){var i="";if(t.length>0){var n=t[0],e=null!==e?e:2,a="M",o="L",r="Z";L.Browser.vml&&(e=0,a="m",o="l",r="xe"),i=a+n.x.toFixed(e)+","+n.y.toFixed(e);for(var s=1;s<t.length;s++)n=t[s],i+=o+n.x.toFixed(e)+","+n.y.toFixed(e);this.options.closePath&&(i+=r)}return i},addPoint:function(t,e){e?this._innerPoints.push(t):this._points.push(t)},build:function(t){t=t||this.options.digits;var e=this._getPathString(this._points,t);return this._innerPoints&&(e+=this._getPathString(this._innerPoints,t)),e}}),L.StyleConverter={keyMap:{fillColor:{property:["background-color"],valueFunction:function(t){return t}},color:{property:["color","border-top-color","border-right-color","border-bottom-color","border-left-color"],valueFunction:function(t){return t}},weight:{property:["border-width"],valueFunction:function(t){return Math.ceil(t)+"px"}},stroke:{property:["border-style"],valueFunction:function(t){return t===!0?"solid":"none"}},dashArray:{property:["border-style"],valueFunction:function(t){var e="solid";return t&&(e="dashed"),e}},barThickness:{property:["height"],valueFunction:function(t){return t+"px"}},radius:{property:["height"],valueFunction:function(t){return 2*t+"px"}},fillOpacity:{property:["opacity"],valueFunction:function(t){return t}}},applySVGStyle:function(t,e,i){var n=L.StyleConverter.keyMap;i&&(n=L.Util.extend(n,i)),t.style.borderStyle="solid";for(var a in e)L.StyleConverter.setCSSProperty(t,a,e[a],n);return t},setCSSProperty:function(t,e,i,n){var n=n||L.StyleConverter.keyMap,a=n[e],o="";if(a)for(var r=a.property,s=0,d=r.length;d>s;++s)o+=r[s]+":"+a.valueFunction(i)+";";return t.style.cssText+=o,t}},L.StylesBuilder=L.Class.extend({initialize:function(t,e){this._categories=t,this._styleFunctionMap=e,this._buildStyles()},_buildStyles:function(){for(var t,e,i,n={},a=0;a<this._categories.length;++a){t=this._categories[a],n[t]={};for(var o in this._styleFunctionMap)e=this._styleFunctionMap[o],i=e.evaluate?e.evaluate(a):"function"==typeof e?e(a):e,n[t][o]=i}this._styleMap=n},getStyles:function(){return this._styleMap}}),L.PaletteBuilder=L.Class.extend({initialize:function(t){this._styleFunctionMap=t},generate:function(t){t=t||{};var e=document.createElement("div"),i=L.DomUtil.create("div","palette",e),n=t.count||10,a=function(t){for(var e=[],i=0;t>i;++i)e.push(i);return e}(n),o=new L.StylesBuilder(a,this._styleFunctionMap),r=o.getStyles();t.className&&L.DomUtil.addClass(i,t.className);for(var s in r){var d=L.DomUtil.create("i","palette-element",i),l=r[s];L.StyleConverter.applySVGStyle(d,l)}return e.innerHTML}}),L.HTMLUtils={buildTable:function(t,e,i){function n(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return!0;return!1}e=e||"table table-condensed table-striped table-bordered";var a=L.DomUtil.create("table",e),o=L.DomUtil.create("thead","",a),r=L.DomUtil.create("tbody","",a);o.innerHTML="<tr><th>Name</th><th>Value</th></tr>",i=i||[];for(var s in t)if(t.hasOwnProperty(s)&&!n(i,s)){var d=t[s];if("object"==typeof d){var l=document.createElement("div");l.appendChild(L.HTMLUtils.buildTable(d,i)),d=l.innerHTML}r.innerHTML+="<tr><td>"+s+"</td><td>"+d+"</td></tr>"}return a}},L.AnimationUtils={animate:function(t,e,i,n){var a=n.delay||0,o=n.frames||30,r=n.duration||500,s={},d=n.easeFunction||function(t){return t},l=n.complete,c=r/o;for(var f in e)"color"!=f&&"fillColor"!=f&&i[f]?s[f]=new L.LinearFunction([0,e[f]],[o-1,i[f]]):("color"==f||"fillColor"==f)&&(s[f]=new L.RGBColorBlendFunction(0,o-1,e[f],i[f]));var u={},h=0,p=function(){for(var e in s)u[e]=s[e].evaluate(h);t.options=L.extend({},t.options,u),t.setStyle(t.options).redraw(),h++,c=d(c),o>h?setTimeout(p,c):l()};setTimeout(p,a)}},L.Color=L.Class.extend({initialize:function(t){this._rgb=[0,0,0],this._hsl=[0,1,.5],this._a=1,t&&this.parseColorDef(t)},parseColorDef:function(){},rgbToHSL:function(t,e,i){t/=255,e/=255,i/=255;var n,a,o=Math.max(t,e,i),r=Math.min(t,e,i),s=(o+r)/2;if(o==r)n=a=0;else{var d=o-r;switch(a=s>.5?d/(2-o-r):d/(o+r),o){case t:n=(e-i)/d+(i>e?6:0);break;case e:n=(i-t)/d+2;break;case i:n=(t-e)/d+4}n/=6}return[n,a,s]},hslToRGB:function(t,e,i){function n(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var a,o,r;if(0==e)a=o=r=i;else{var s=.5>i?i*(1+e):i+e-i*e,d=2*i-s;a=n(d,s,t+1/3),o=n(d,s,t),r=n(d,s,t-1/3)}return[Math.floor(255*a),Math.floor(255*o),Math.floor(255*r)]},setRGB:function(t,e,i){return this._rgb=[t,e,i],this._hsl=this.rgbToHSL(t,e,i),this},setHSL:function(t,e,i){return this._hsl=[t,e,i],this._rgb=this.hslToRGB(t,e,i),this},toHSL:function(){return this._hsl},toHSLString:function(){var t="hsl";return this._a<1&&(t+="a"),t+"("+(360*this._hsl[0]).toFixed(1)+","+(100*this._hsl[1]).toFixed(0)+"%,"+(100*this._hsl[2]).toFixed(0)+"%)"},toRGB:function(){return this._rgb},toRGBString:function(){var t;if(this._a<1)t="rgba("+this._rgb[0].toFixed(0)+","+this._rgb[1].toFixed(0)+","+this._rgb[2].toFixed(0)+","+this._a.toFixed(1)+")";else{for(var e=[this._rgb[0].toString(16),this._rgb[1].toString(16),this._rgb[2].toString(16)],i=0;i<e.length;++i)1===e[i].length&&(e[i]="0"+e[i]);t="#"+e.join("")}return t},r:function(t){return arguments.length?this.setRGB(t,this._rgb[1],this._rgb[2]):this._rgb[0]},g:function(t){return arguments.length?this.setRGB(this._rgb[0],t,this._rgb[2]):this._rgb[1]},b:function(t){return arguments.length?this.setRGB(this._rgb[0],this._rgb[1],t):this._rgb[2]},h:function(t){return arguments.length?this.setHSL(t,this._hsl[1],this._hsl[2]):this._hsl[0]},s:function(t){return arguments.length?this.setHSL(this._hsl[0],t,this._hsl[2]):this._hsl[1]},l:function(t){return arguments.length?this.setHSL(this._hsl[0],this._hsl[1],t):this._hsl[2]},a:function(t){return arguments.length?(this._a=t,this):this._a}}),L.RGBColor=L.Color.extend({initialize:function(t){L.Color.prototype.initialize.call(this,t)},parseColorDef:function(t){var e,i,n,a,o=t instanceof Array,r=0===t.indexOf("#"),s=[];o?(e=Math.floor(t[0]),i=Math.floor(t[1]),n=Math.floor(t[2]),a=4===t.length?t[3]:1):r?(t=t.replace("#",""),e=parseInt(t.substring(0,2),16),i=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16),a=8===t.length?parseInt(t.substring(6,8),16):1):(s=t.replace("rgb","").replace("a","").replace(/\s+/g,"").replace("(","").replace(")","").split(","),e=parseInt(s[0]),i=parseInt(s[1]),n=parseInt(s[2]),a=4===s.length?parseInt(s[3]):1),this.setRGB(e,i,n),this._a=a}}),L.rgbColor=function(t){return new L.RGBColor(t)},L.HSLColor=L.Color.extend({initialize:function(t){L.Color.prototype.initialize.call(this,t)},parseColorDef:function(t){var e,i,n,a,o=t instanceof Array;if(o)e=t[0],i=t[1],n=t[2],a=4===t.length?t[3]:1;else{var r=t.replace("hsl","").replace("a","").replace("(","").replace(/\s+/g,"").replace(/%/g,"").replace(")","").split(",");e=Number(r[0])/360,i=Number(r[1])/100,n=Number(r[2])/100,a=4===r.length?parseInt(r[3]):1}this.setHSL(e,i,n),this._a=a}}),L.hslColor=function(t){return new L.HSLColor(t)},L.Animation=L.Class.extend({initialize:function(t,e){this._easeFunction=t,this._animateFrame=e},run:function(t,e){this.stop(),this._el=t,this._inProgress=!0,this._duration=e.duration||.25,this._animationOptions=e,this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeFunction(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){this._animateFrame(t),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")}}),L.ColorBrewer={Sequential:{YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]}},Diverging:{PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]}},Qualitative:{Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}}},L.Palettes={huePalette:function(t,e,i,n,a){return new L.HSLHueFunction(new L.Point(t,i),new L.Point(e,n),a)
},luminosityPalette:function(t,e,i,n,a){return new L.HSLLuminosityFunction(new L.Point(t,i),new L.Point(e,n),a)},saturationPalette:function(t,e,i,n,a){return new L.HSLSaturationFunction(new L.Point(t,i),new L.Point(e,n),a)},rgbBlendPalette:function(t,e,i,n,a){return new L.RGBColorBlendFunction(t,e,i,n,a)},hslBlendPalette:function(t,e,i,n,a){return new L.HSLColorBlendFunction(t,e,i,n,a)},customColorPalette:function(t,e,i,n){return new L.CustomColorFunction(t,e,i,n)}},L.DynamicColorPalettes={rainbow:{text:"Rainbow",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,0,300,i)}},greentored:{text:"Green - Red",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,120,0,i)}},yellowtored:{text:"Yellow - Red",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,60,0,i)}},orangetored:{text:"Orange - Red",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,30,0,i)}},redtopurple:{text:"Red - Purple",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,360,270,i)}},bluetored:{text:"Blue - Red",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,210,360,i)}},bluetored2:{text:"Blue - Red 2",getPalette:function(t,e,i){return L.Palettes.huePalette(t,e,180,0,i)}},whitetored:{text:"White - Red",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:0}))}},whitetoorange:{text:"White - Orange",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:30}))}},whitetoyellow:{text:"White - Yellow",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:60}))}},whitetogreen:{text:"White - Green",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:120}))}},whitetoltblue:{text:"White - Lt. Blue",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:180}))}},whitetoblue:{text:"White - Blue",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:240}))}},whitetopurple:{text:"White - Purple",getPalette:function(t,e){return L.Palettes.luminosityPalette(t,e,1,.5,L.Util.extend(option,{outputHue:270}))}},graytored:{text:"Gray - Red",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:0}))}},graytoorange:{text:"Gray - Orange",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:30}))}},graytoyellow:{text:"Gray - Yellow",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:60}))}},graytogreen:{text:"Gray - Green",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:120}))}},graytoltblue:{text:"Gray - Lt. Blue",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:180}))}},graytoblue:{text:"Gray - Blue",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:240}))}},graytopurple:{text:"Gray - Purple",getPalette:function(t,e){return L.Palettes.saturationPalette(t,e,0,1,L.Util.extend(option,{outputHue:270}))}}},L.DynamicPaletteElement=L.Class.extend({initialize:function(t,e){this._key=t,this._dynamicPalette=e},generate:function(t){var e=L.DomUtil.create("div","palette"),i=t.count,n=this._dynamicPalette.getPalette(0,i-1),a=t.width,o=!0;void 0!=t.showText&&(o=t.showText),e.setAttribute("data-palette-key",this._key),this._dynamicPalette.text&&o&&(L.DomUtil.create("div","palette-text",e).innerHTML='<i class="icon-ok hidden"></i>'+this._dynamicPalette.text);var r=a/i;t.className&&L.DomUtil.addClass(e,t.className);for(var s=0;i>s;++s){var s=L.DomUtil.create("i","palette-element");for(var d in n){var l=n[d],c=l.evaluate?l.evaluate(s):l;L.StyleConverter.setCSSProperty(s,d,c)}s.style.width=r+"px",e.appendChild(s)}return e}}),L.RegularPolygon=L.Polygon.extend({statics:{R:6378.137,M_PER_KM:1e3},initialize:function(t,e){this._centerLatLng=t,L.Util.setOptions(this,e),L.Polygon.prototype.initialize.call(this,this._getLatLngs(),e)},options:{fill:!0,radius:1e3,numberOfSides:4,rotation:0,maxDegrees:360},getLatLng:function(){return this._centerLatLng},setRadius:function(t){this.options.radius=t,this._latlngs=this._getLatLngs(),this.redraw()},_getLatLngs:function(){for(var t,e=this.options.maxDegrees||360,i=e/Math.max(this.options.numberOfSides,3),n=e+this.options.rotation,a=this.options.rotation,o=[];n>a;)t=this._getPoint(a),o.push(t),a+=i;return o},_getPoint:function(t){var e=function(t){return t*L.LatLng.DEG_TO_RAD},i=function(t){return t*L.LatLng.RAD_TO_DEG},n=e(t),a=this.options.radius/L.RegularPolygon.M_PER_KM/L.RegularPolygon.R,o=e(this._centerLatLng.lat),r=e(this._centerLatLng.lng),s=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(n)),d=r+Math.atan2(Math.sin(n)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(s));return s=i(s),d=i(d),new L.LatLng(s,d)},toGeoJSON:function(){for(var t={type:"Feature",geometry:{type:"Polygon",coordinates:[[],[]]},properties:this.options},e=0;e<this._latlngs.length;++e){var i=this._latlngs[e];t.coordinates[0].push([i[1],i[0]])}return t}}),L.regularPolygon=function(t,e){return new L.RegularPolygon(t,e)},L.Path.XLINK_NS="http://www.w3.org/1999/xlink";var TextFunctions=TextFunctions||{__addPath:L.SVG.prototype._addPath,_addPath:function(t){TextFunctions.__addPath.call(this,t),t.options.text&&this._createText(t)},__removePath:L.SVG.prototype._removePath,_removePath:function(t){TextFunctions.__removePath.call(this,t),t._text&&L.DomUtil.remove(t._text),t._pathDef&&L.DomUtil.remove(t._pathDef)},__updatePath:L.SVG.prototype._updatePath,_updatePath:function(t){this.__updatePath.call(this,t),t.options.text&&this._createText(t)},__setPath:L.SVG.prototype._setPath,_setPath:function(t,e){this.__setPath.call(this,t,e),t.options.text&&this._createText(t)},_initText:function(t){t.options.text&&this._createText(t)},getTextAnchor:function(t){return t._point?t._point:void 0},setTextAnchor:function(t,e){t._text&&(t._text.setAttribute("x",e.x),t._text.setAttribute("y",e.y))},_createText:function(t){var e=t.options.text||{},i=function(t,e){var i="";for(var n in e)i+=n+": "+e[n]+";";return t.setAttribute("style",i),t},n=function(t,e){for(var i in e)t.setAttribute(i,e[i]);return t};t._text&&(L.DomUtil.remove(t._text),t.text=null),t._pathDef&&(L.DomUtil.remove(t._pathDef),t._pathDef=null),t._text=L.SVG.create("text"),t._text.setAttribute("id",L.stamp(t._text));var a=document.createTextNode(e.text);if(e.path){var o=e.path,r=L.SVG.create("path");r.setAttribute("d",t._path.getAttribute("d")),r.setAttribute("id",L.stamp(r)),this._createDefs(),this._defs.appendChild(r),t._pathDef=r;var s=L.SVG.create("textPath");o.startOffset&&s.setAttribute("startOffset",o.startOffset),o.attr&&n(s,o.attr),o.style&&i(s,o.style),s.setAttributeNS(L.Path.XLINK_NS,"xlink:href","#"+L.stamp(r)),s.appendChild(a),t._text.appendChild(s)}else{t._text.appendChild(a),t._project();var d=t.getTextAnchor?t.getTextAnchor():this.getTextAnchor(t);this.setTextAnchor(t,d)}e.className?t._text.setAttribute("class",e.className):t._text.setAttribute("class","leaflet-svg-text"),e.attr&&n(t._text,e.attr),e.style&&i(t._text,e.style),this._container.appendChild(t._text)}},PathFunctions=PathFunctions||{__updateStyle:L.SVG.prototype._updateStyle,_createDefs:function(){this._defs||(this._defs=L.SVG.create("defs"),this._container.appendChild(this._defs))},_addPath:function(t){TextFunctions._addPath.call(this,t),t._gradient&&this._defs.appendChild(t._gradient),t._dropShadow&&this._defs.appendChild(t._dropShadow),t._fillPattern&&this._defs.appendChild(t._fillPattern),t._shapePattern&&this._defs.appendChild(t._shapePattern),t._shape&&this._container.insertBefore(t._shape,t._path.nextSibling),t._pathDef&&this._defs.appendChild(t._pathDef),t._text&&this._container.appendChild(t._text)},_updatePath:function(t){TextFunctions._updatePath.call(this,t)},_removePath:function(t){TextFunctions._removePath.call(this,t),t._gradient&&L.DomUtil.remove(t._gradient),t._dropShadow&&L.DomUtil.remove(t._dropShadow),t._fillPattern&&L.DomUtil.remove(t._fillPattern),t._shapePattern&&L.DomUtil.remove(t._shapePattern),t._shape&&L.DomUtil.remove(t._shape),t._g&&L.DomUtil.remove(t._g)},_createGradient:function(t){this._createDefs();var e,i,n,a=t.options!==!0?L.extend({},t.options):{};if(i=a.gradient||{},"radial"==i.gradientType)e=L.SVG.create("radialGradient"),n=i.radial||{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};else{e=L.SVG.create("linearGradient");var o=i.vector||[["0%","0%"],["100%","100%"]];n={x1:o[0][0],x2:o[1][0],y1:o[0][1],y2:o[1][1]}}var r=i.stops||[{offset:"0%",style:{color:"rgb(255, 255, 255)",opacity:1}},{offset:"60%",style:{color:a.fillColor||a.color,opacity:1}}];e.setAttribute("id",L.stamp(e));for(var s in n)e.setAttribute(s,n[s]);for(var d=0;d<r.length;++d){var l=r[d],c=L.SVG.create("stop");l.style=l.style||{};for(s in l){var f=l[s];if("style"===s){var u="";f.color=f.color||a.fillColor||a.color,f.opacity="undefined"==typeof f.opacity?1:f.opacity;for(var h in f)u+="stop-"+h+":"+f[h]+";";f=u}c.setAttribute(s,f)}e.appendChild(c)}return t._gradient&&L.DomUtil.remove(t._gradient),t._gradient=e,L.stamp(e)},_createDropShadow:function(t){this._createDefs();var e=L.SVG.create("filter"),i=L.SVG.create("feOffset"),n=L.SVG.create("feGaussianBlur"),a=L.SVG.create("feBlend"),o=t.options||{width:"200%",height:"200%"};o.id=L.stamp(e);for(var r in o)e.setAttribute(r,o[r]);var s={result:"offOut","in":"SourceAlpha",dx:"2",dy:"2"},d={result:"blurOut","in":"offOut",stdDeviation:"2"},l={"in":"SourceGraphic",in2:"blurOut",mode:"lighten"};for(r in s)i.setAttribute(r,s[r]);for(r in d)n.setAttribute(r,d[r]);for(r in l)a.setAttribute(r,l[r]);return e.appendChild(i),e.appendChild(n),e.appendChild(a),t._dropShadow&&L.DomUtil.remove(t._dropShadow),t._dropShadow=e,L.stamp(e)},_createCustomElement:function(t,e){var i=L.SVG.create(t);i.setAttribute("id",L.stamp(i));for(var n in e)e.hasOwnProperty(n)&&i.setAttribute(n,e[n]);return i},_createImage:function(t){var e=L.SVG.create("image");return e.setAttribute("id",L.stamp(e)),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e.setAttribute("x",t.x||0),e.setAttribute("y",t.y||0),e.setAttributeNS(L.Path.XLINK_NS,"xlink:href",t.url),e},_createPattern:function(t){var e=L.SVG.create("pattern");return e.setAttribute("id",L.stamp(e)),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e.setAttribute("x",t.x||0),e.setAttribute("y",t.y||0),e.setAttribute("patternUnits",t.patternUnits||"objectBoundingBox"),e},_createShape:function(t,e){var i=this._createCustomElement(t,e);return i},_createFillPattern:function(t){this._createDefs();var e=L.extend({},t.options.fillPattern),i=this._createPattern(e.pattern),n=L.extend({url:e.url},e.image),a=this._createImage(n);return i.appendChild(a),t._fillPattern&&L.DomUtil.remove(t._fillPattern),t._fillPattern=i,L.stamp(i)},_getDefaultDiameter:function(t){return 1.75*t},_createShapeImage:function(t){this._createDefs();var e=t.options.shapeImage||{},i=t.options.radius||Math.max(t.options.radiusX,t.options.radiusY),n=t._getDefaultDiameter?t._getDefaultDiameter(i):this._getDefaultDiameter(i),a=e.imageSize||new L.Point(n,n),o=e.radius||n/2,r=e.shape||{circle:{r:o,cx:0,cy:0}},s=e.pattern||{width:a.x,height:a.y,x:0,y:0};s.patternUnits=s.patternUnits||"objectBoundingBox";var d=this._createPattern(s);L.stamp(d);var l=Object.keys(r),c=l.length>0?l[0]:"circle";r[c].fill="url(#"+L.stamp(d)+")";var f=this._createShape(c,r[c]);t.options.clickable&&f.setAttribute("class","leaflet-clickable"),e=e.image||{width:a.x,height:a.y,x:0,y:0,url:t.options.imageCircleUrl};var u=this._createImage(e);return u.setAttributeNS(L.Path.XLINK_NS,"xlink:href",e.url),d.appendChild(u),t._shapePattern&&L.DomUtil.remove(t._shapePattern),t._shape&&L.DomUtil.remove(t._shape),t._shapePattern=d,t._shape=f,L.stamp(d)},_updateStyle:function(t){this.__updateStyle.call(this,t),t.options.text&&t._renderer._createText(t);var e,i=t?t:this;i.options.stroke&&(i.options.lineCap&&i._path.setAttribute("stroke-linecap",i.options.lineCap),i.options.lineJoin&&i._path.setAttribute("stroke-linejoin",i.options.lineJoin)),i.options.gradient?(e=this._createGradient(i),i._path.setAttribute("fill","url(#"+e+")")):i.options.fill||i._path.setAttribute("fill","none"),i.options.dropShadow?(e=this._createDropShadow(i),i._path.setAttribute("filter","url(#"+e+")")):i._path.removeAttribute("filter"),i.options.fillPattern&&(e=this._createFillPattern(i),i._path.setAttribute("fill","url(#"+e+")")),i._applyCustomStyles&&i._applyCustomStyles(),t._gradient&&this._defs.appendChild(t._gradient),t._dropShadow&&this._defs.appendChild(t._dropShadow),t._fillPattern&&this._defs.appendChild(t._fillPattern),t._shapePattern&&this._defs.appendChild(t._shapePattern),t._shape&&this._container.insertBefore(t._shape,t._path.nextSibling)}},PolylineFunctions={_getCenter:L.Polyline.prototype.getCenter,getCenter:function(){var t=this._getCenter.call(this);return t||(t=this._latlngs[0]),t}};L.extend(L.Polyline.prototype,PolylineFunctions),L.Polyline.prototype.getTextAnchor=function(){var t=this.getCenter();return this._map.latLngToLayerPoint(t)},L.extend(L.SVG.prototype,TextFunctions,PathFunctions),L.Point.prototype.rotate=function(t,e){var i=this.distanceTo(e),n=t*L.LatLng.DEG_TO_RAD+Math.atan2(this.y-e.y,this.x-e.x);this.x=e.x+i*Math.cos(n),this.y=e.y+i*Math.sin(n)},L.extend(L.GeoJSON,{asFeature:function(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}}),L.MapMarker=L.Path.extend({initialize:function(t,e){L.setOptions(this,e),this._latlng=t},options:{fill:!0,fillOpacity:1,opacity:1,radius:15,innerRadius:5,position:{x:0,y:0},rotation:0,numberOfSides:50,color:"#000000",fillColor:"#0000FF",weight:1,gradient:!0,dropShadow:!0,clickable:!0},setLatLng:function(t){return this._latlng=t,this.redraw()},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(),this.options.innerRadius>0&&(this._innerPoints=this._getPoints(!0).reverse())},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var t=this._map,e=3*this.options.radius,i=t.project(this._latlng),n=new L.Point(i.x-this.options.radius,i.y),a=new L.Point(i.x+this.options.radius,i.y-e);this._pxBounds=new L.Bounds(n,a)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var t=this._map,e=3*this.options.radius,i=t.project(this._latlng),n=new L.Point(i.x-this.options.radius,i.y),a=new L.Point(i.x+this.options.radius,i.y-e),o=t.unproject(n),r=t.unproject(a);return new L.LatLngBounds(o,r)},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=t,this.redraw()},setInnerRadius:function(t){return this.options.innerRadius=t,this.redraw()},setRotation:function(t){return this.options.rotation=t,this.redraw()},setNumberOfSides:function(t){return this.options.numberOfSides=t,this.redraw()},getPathString:function(){var t=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",t.x),this._shape.setAttribute("cy",t.y);else{var e=this._shape.getAttribute("width"),i=this._shape.getAttribute("height");this._shape.setAttribute("x",t.x-Number(e)/2),this._shape.setAttribute("y",t.y-Number(i)/2)}return this._path.setAttribute("shape-rendering","geometricPrecision"),new L.SVGPathBuilder(this._points,this._innerPoints).build(6)},getTextAnchor:function(){return new L.Point(this._point.x,this._point.y-2*this.options.radius)},_getPoints:function(t){var e,i,n=t?360:210,a=t?n/Math.max(this.options.numberOfSides,3):n/50,o=t?n+this.options.rotation:n,r=t?this.options.rotation:-30,s=[],d=this.options.radius,l=Math.sqrt(.75),c=function(t){return t*L.LatLng.DEG_TO_RAD},f=this._point;for(t||(s.push(f),s.push(new L.Point(f.x+l*d,f.y-1.5*d)));o>r;)i=c(r),e=this._getPoint(i,d,t),s.push(e),r+=a;return t||s.push(new L.Point(f.x-l*d,f.y-1.5*d)),s},_getPoint:function(t,e,i){var n=e;return e=i?this.options.innerRadius:e,new L.Point(this._point.x+this.options.position.x+e*Math.cos(t),this._point.y-2*n+this.options.position.y-e*Math.sin(t))},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._renderer._createShapeImage(this)},toGeoJSON:function(){var t=L.Marker.prototype.toGeoJSON.call(this);return t.properties=this.options,t}}),L.mapMarker=function(t,e){return new L.MapMarker(t,e)},L.extend(L.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),L.RegularPolygonMarker=L.Path.extend({includes:TextFunctions,initialize:function(t,e){L.setOptions(this,e),this._latlng=t,this.options.numberOfSides=Math.max(this.options.numberOfSides,3)},options:{fill:!0,radiusX:10,radiusY:10,rotation:0,numberOfSides:3,position:{x:0,y:0},maxDegrees:360,gradient:!0,dropShadow:!1,clickable:!0},setLatLng:function(t){return this._latlng=t,this.redraw()},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(),(this.options.innerRadius||this.options.innerRadiusX&&this.options.innerRadiusY)&&(this._innerPoints=this._getPoints(!0).reverse())},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var t=this._map,e=this.options.radius||this.options.radiusX,i=this.options.radius||this.options.radiusY,n=e*Math.cos(Math.PI/4),a=i*Math.sin(Math.PI/4),o=t.project(this._latlng),r=new L.Point(o.x-n,o.y+a),s=new L.Point(o.x+n,o.y-a);this._pxBounds=new L.Bounds(r,s)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var t=this._map,e=this.options.radius||this.options.radiusX,i=this.options.radius||this.options.radiusY,n=e*Math.cos(Math.PI/4),a=i*Math.sin(Math.PI/4),o=t.project(this._latlng),r=new L.Point(o.x-n,o.y+a),s=new L.Point(o.x+n,o.y-a),d=t.unproject(r),l=t.unproject(s);return new L.LatLngBounds(d,l)},setRadius:function(t){return this.options.radius=t,this.redraw()},setRadiusXY:function(t,e){return this.options.radius=null,this.options.radiusX=t,this.options.radiusY=e,this.redraw()},setInnerRadius:function(t){return this.options.innerRadius=t,this.redraw()},setInnerRadiusXY:function(t,e){return this.options.innerRadius=null,this.options.innerRadiusX=t,this.options.innerRadiusY=e,this.redraw()},setRotation:function(t){return this.options.rotation=t,this.redraw()},setNumberOfSides:function(t){return this.options.numberOfSides=t,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){var t=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",t.x),this._shape.setAttribute("cy",t.y);else{var e=this._shape.getAttribute("width"),i=this._shape.getAttribute("height");this._shape.setAttribute("x",t.x-Number(e)/2),this._shape.setAttribute("y",t.y-Number(i)/2)}return this._path.setAttribute("shape-rendering","geometricPrecision"),new L.SVGPathBuilder(this._points,this._innerPoints).build(6)},getTextAnchor:function(){return this._point},_getPoints:function(t){for(var e,i,n=this.options.maxDegrees||360,a=n/Math.max(this.options.numberOfSides,3),o=n,r=0,s=[],d=t?this.options.innerRadius||this.options.innerRadiusX:this.options.radius||this.options.radiusX,l=t?this.options.innerRadius||this.options.innerRadiusY:this.options.radius||this.options.radiusY,c=function(t){return t*L.LatLng.DEG_TO_RAD};o>r;)i=c(r),e=this._getPoint(i,d,l),s.push(e),r+=a;return s},_getPoint:function(t,e,i){var n=this.options.position?this._point.add(new L.Point(this.options.position.x,this.options.position.y)):this._point,a=new L.Point(n.x+e*Math.cos(t),n.y+i*Math.sin(t));return a.rotate(this.options.rotation,n),a},_getDefaultDiameter:function(t){var e=Math.PI/this.options.numberOfSides,i=t*Math.cos(e);return 1.75*i},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._renderer._createShapeImage(this)},toGeoJSON:function(){var t=L.Marker.prototype.toGeoJSON.call(this);return t.properties=this.options,t}}),L.regularPolygonMarker=function(t,e){return new L.RegularPolygonMarker(t,e)},L.StarMarker=L.RegularPolygonMarker.extend({options:{numberOfPoints:5,rotation:-15,maxDegrees:360,gradient:!0,dropShadow:!0},setNumberOfPoints:function(t){return this.options.numberOfPoints=t,this.redraw()},_getPoints:function(t){for(var e,i,n,a=this.options.maxDegrees||360,o=a/this.options.numberOfPoints,r=a,s=0,d=[],l=t?this.options.innerRadius||this.options.innerRadiusX:this.options.radius||this.options.radiusX,c=t?this.options.innerRadius||this.options.innerRadiusY:this.options.radius||this.options.radiusY,f=function(t){return t*L.LatLng.DEG_TO_RAD};r>s;)n=f(s),e=this._getPoint(n,l,c),i=this._getPoint(n+f(o)/2,l/2,c/2),d.push(e),d.push(i),s+=o;return d}}),L.starMarker=function(t,e){return new L.StarMarker(t,e)},L.TriangleMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:3,rotation:30,radius:5}}),L.triangleMarker=function(t,e){return new L.TriangleMarker(t,e)},L.DiamondMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:4,radiusX:5,radiusY:10}}),L.diamondMarker=function(t,e){return new L.DiamondMarker(t,e)},L.SquareMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:4,rotation:45,radius:5}}),L.squareMarker=function(t,e){return new L.SquareMarker(t,e)},L.PentagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:5,rotation:-18,radius:5}}),L.pentagonMarker=function(t,e){return new L.PentagonMarker(t,e)},L.HexagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:6,rotation:30,radius:5}}),L.hexagonMarker=function(t,e){return new L.HexagonMarker(t,e)},L.OctagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:8,rotation:22.5,radius:5}}),L.octagonMarker=function(t,e){return new L.OctagonMarker(t,e)},L.SVGMarker=L.Path.extend({initialize:function(t,e){L.setOptions(this,e),this._svg=e.svg||'<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"/>',0===this._svg.indexOf("<")&&(this._data=(new DOMParser).parseFromString(this._svg,"text/xml")),this._latlng=t},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var t=this._map,e=5,i=5,n=e*Math.cos(Math.PI/4),a=i*Math.sin(Math.PI/4),o=t.project(this._latlng),r=new L.Point(o.x-n,o.y+a),s=new L.Point(o.x+n,o.y-a);this._pxBounds=new L.Bounds(r,s)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},setLatLng:function(t){this._latlng=t,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){var t=this,e=function(){t._g&&L.DomUtil.remove(t._g);var e=L.SVG.create("g");t._renderer._container.appendChild(e),t._g=e,t.options.clickable&&e.setAttribute("class","leaflet-clickable");var i=t._data,n="svg"===i.nodeName.toLowerCase()?i.cloneNode(!0):i.querySelector("svg").cloneNode(!0);t.options.setStyle&&t.options.setStyle.call(t,n);var a=n.getAttribute("width"),o=n.getAttribute("height"),r=a?a.replace("px",""):"100%",s=o?o.replace("px",""):"100%";"100%"===r&&(r=t.options.size.x,s=t.options.size.y,n.setAttribute("width",r+(-1!==String(r).indexOf("%")?"":"px")),n.setAttribute("height",s+(-1!==String(s).indexOf("%")?"":"px")));var d=t.options.size||new L.Point(r,s),l=new L.Point(d.x/r,d.y/s),c=e.getElementsByTagName("svg");c.length>0&&c[0].parentNode.removeChild(c[0]),e.appendChild(n);var f=[],u=t.options.anchor||new L.Point(-d.x/2,-d.y/2),h=t._point.x+u.x,p=t._point.y+u.y;f.push("translate("+h+" "+p+")"),f.push("scale("+l.x+" "+l.y+")"),t.options.rotation&&f.push("rotate("+t.options.rotation+" "+r/2+" "+s/2+")"),e.setAttribute("transform",f.join(" "))};if(this._data)e();else{var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t._data=this.responseXML,e())},i.open("GET",this._svg,!0),i.send(null)}return"M0 0"},toGeoJSON:function(){var t=L.Marker.prototype.toGeoJSON.call(this);return t.properties=this.options,t}}),L.MarkerGroup=L.FeatureGroup.extend({initialize:function(t,e){L.FeatureGroup.prototype.initialize.call(this,e),this.setLatLng(t)},setStyle:function(){return this},setLatLng:function(t){return this._latlng=t,this.eachLayer(function(e){e.setLatLng&&e.setLatLng(t)}),this},getLatLng:function(){return this._latlng},toGeoJSON:function(){var t={type:"FeatureCollection",features:[]},e=function(t){return function(e){t.features.push(L.Util.pointToGeoJSON.call(e))}};return this.eachLayer(e(t)),t}}),L.BarMarker=L.Path.extend({initialize:function(t,e){L.setOptions(this,e),this._latlng=t},options:{fill:!0,width:2,maxHeight:10,position:{x:0,y:0},weight:1,color:"#000",opacity:1,gradient:!0,dropShadow:!1,lineCap:"square",lineJoin:"miter"},setLatLng:function(t){return this._latlng=t,this.redraw()},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_update:function(){this._map&&this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var t=this._map,e=t.project(this._latlng),i=this.options.width/2,n=new L.Point(e.x-i,e.y),a=new L.Point(e.x+i,e.y-this.options.maxHeight),o=t.unproject(n),r=t.unproject(a);return new L.LatLngBounds(o,r)},getLatLng:function(){return this._latlng},getPathString:function(){return this._path.setAttribute("shape-rendering","crispEdges"),new L.SVGPathBuilder(this._points).build()},_getPoints:function(){var t,e,i,n,a=[],o=this._point.x+this.options.position.x,r=this._point.y+this.options.position.y,s=this.options.width/2,d=this.options.value/this.options.maxValue*this.options.maxHeight;return t=new L.Point(o+s,r),e=new L.Point(o+s,r-d),i=new L.Point(o-s,r-d),n=new L.Point(o-s,r),a=[t,e,i,n]}}),L.barMarker=function(t,e){return new L.BarMarker(t,e)},L.ChartMarker=L.FeatureGroup.extend({initialize:function(t,e){L.Util.setOptions(this,e),this._layers={},this._latlng=t,this._loadComponents()},setLatLng:function(t){return this._latlng=t,this.redraw()},getLatLng:function(){return this._latlng},_loadComponents:function(){},_highlight:function(t){return t.weight&&(t.weight*=2),t},_unhighlight:function(t){return t.weight&&(t.weight/=2),t},_bindMouseEvents:function(t){var e=this,i=this.options.tooltipOptions;t.on("mouseover",function(t){var n,a=this.options,o=a.key,r=a.value,s=t.layerPoint,d=s.x-this._point.x,l=s.y-this._point.y,c=a.iconSize,f=d,u=l,h=5;f=0>d?c.x-d+h:-d-h,u=0>l?c.y-l+h:-l-h,n=new L.Point(f,u);var p={},b=a.displayText?a.displayText(r):r;p[o]={name:a.displayName,value:b};var g=new L.LegendIcon(p,a,{className:"leaflet-div-icon",iconSize:i?i.iconSize:c,iconAnchor:n});a.marker=new L.Marker(e._latlng,{icon:g}),a=e._highlight(a),this.initialize(e._latlng,a),this.redraw(),this.setStyle(a),e.addLayer(a.marker)}),t.on("mouseout",function(){var t=this.options;t=e._unhighlight(t),this.initialize(e._latlng,t),this.redraw(),this.setStyle(t),e.removeLayer(t.marker)})},bindPopup:function(t,e){this.eachLayer(function(i){i.bindPopup(t,e)})},openPopup:function(t){for(var e in this._layers){var i=this._layers[e];t=t||this._latlng,i.openPopup(t);break}},closePopup:function(){for(var t in this._layers){var e=this._layers[t];latlng=latlng||this._latlng,e.closePopup();break}},redraw:function(){this.clearLayers(),this._loadComponents()},toGeoJSON:function(){var t=L.Marker.prototype.toGeoJSON.call(this);return t.properties=this.options,t}}),L.BarChartMarker=L.ChartMarker.extend({initialize:function(t,e){L.Util.setOptions(this,e),L.ChartMarker.prototype.initialize.call(this,t,e)},options:{weight:1,opacity:1,color:"#000",fill:!0,position:{x:0,y:0},width:10,offset:0,iconSize:new L.Point(50,40)},_loadComponents:function(){var t,e,i,n,a,o,r,s=this.options,d=Object.keys(this.options.data),l=d.length,c=this.options.width,f=this.options.offset||0,u=this.options.data,h=this.options.chartOptions;a=-(c*l+f*(l-1))/2+c/2,o=0;for(var p in u)t=u[p],r=h[p],e=r.minValue||0,i=r.maxValue||100,s.fillColor=r.fillColor||this.options.fillColor,s.value=t,s.minValue=e,s.maxValue=i,s.position={x:a,y:o},s.width=c,s.maxHeight=r.maxHeight||10,s.key=p,s.value=t,s.displayName=r.displayName,s.opacity=this.options.opacity||1,s.fillOpacity=this.options.fillOpacity||.7,s.weight=this.options.weight||1,s.color=r.color||this.options.color,s.displayText=r.displayText,n=new L.BarMarker(this._latlng,s),this._bindMouseEvents(n),this.addLayer(n),a+=c+f}}),L.RadialBarMarker=L.Path.extend({initialize:function(t,e){L.setOptions(this,e),this._latlng=t},options:{fill:!0,radius:10,rotation:0,numberOfSides:30,position:{x:0,y:0},gradient:!0,dropShadow:!1},setLatLng:function(t){return this._latlng=t,this.redraw()},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_update:function(){this._map&&this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var t=this._map,e=this.options.radiusX||this.options.radius,i=this.options.radiusY||this.options.radius,n=e*Math.cos(Math.PI/4),a=i*Math.sin(Math.PI/4),o=t.project(this._latlng),r=new L.Point(o.x-n,o.y+a),s=new L.Point(o.x+n,o.y-a),d=t.unproject(r),l=t.unproject(s);return new L.LatLngBounds(d,l)},getLatLng:function(){return this._latlng},getPathString:function(){var t=this.options.endAngle-this.options.startAngle,e=t>=180?"1":"0",i=this.options.radiusX||this.options.radius,n=this.options.radiusY||this.options.radius,a="M"+this._points[0].x.toFixed(2)+","+this._points[0].y.toFixed(2)+"A"+i.toFixed(2)+","+n.toFixed(2)+" 0 "+e+",1 "+this._points[1].x.toFixed(2)+","+this._points[1].y.toFixed(2)+"L";return this._innerPoints?(a=a+this._innerPoints[0].x.toFixed(2)+","+this._innerPoints[0].y.toFixed(2),a=a+"A"+(i-this.options.barThickness).toFixed(2)+","+(n-this.options.barThickness).toFixed(2)+" 0 "+e+",0 "+this._innerPoints[1].x.toFixed(2)+","+this._innerPoints[1].y.toFixed(2)+"z"):a=a+this._point.x.toFixed(2)+","+this._point.y.toFixed(2)+"z",L.Browser.vml&&(a=Core.SVG.path(a)),this._path.setAttribute("shape-rendering","geometricPrecision"),a},_getPoints:function(){var t=this.options.endAngle-this.options.startAngle,e=this.options.endAngle+this.options.rotation,i=this.options.startAngle+this.options.rotation,n=[],a="radiusX"in this.options?this.options.radiusX:this.options.radius,o="radiusY"in this.options?this.options.radiusY:this.options.radius,r=function(t){return t*L.LatLng.DEG_TO_RAD};360===t&&(e-=.1);var s=r(i),d=r(e);return n.push(this._getPoint(s,a,o)),n.push(this._getPoint(d,a,o)),this.options.barThickness&&(this._innerPoints=[],this._innerPoints.push(this._getPoint(d,a-this.options.barThickness,o-this.options.barThickness)),this._innerPoints.push(this._getPoint(s,a-this.options.barThickness,o-this.options.barThickness))),n},_getPoint:function(t,e,i){return new L.Point(this._point.x+this.options.position.x+e*Math.cos(t),this._point.y+this.options.position.y+i*Math.sin(t))}}),L.radialBarMarker=function(t,e){return new L.RadialBarMarker(t,e)},L.PieChartMarker=L.ChartMarker.extend({initialize:function(t,e){L.Util.setOptions(this,e),L.ChartMarker.prototype.initialize.call(this,t,e)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new L.Point(50,40)},_highlight:function(t){var e=t.radiusX,i=t.radiusY,n=t.barThickness;return t.oldBarThickness=n,t.oldRadiusX=e,t.oldRadiusY=i,t.radiusX*=t.mouseOverExaggeration,t.radiusY*=t.mouseOverExaggeration,t.barThickness=t.radiusX-e+n,t},_unhighlight:function(t){return t.radiusX=t.oldRadiusX,t.radiusY=t.oldRadiusY,t.barThickness=t.oldBarThickness,t},_loadComponents:function(){var t,e,i,n,a=0,o=0,r=0,s=this.options.maxDegrees||360,d=this.options.rotation,l=this.options,c=this.options.data,f=this.options.chartOptions,u=function(t,e){var i=0;return t[e]&&(i=parseFloat(t[e])),i
};for(n in c)t=u(c,n),a+=t;if(a>0)for(n in c)t=parseFloat(c[n]),i=f[n],r=t/a,o=r*s,l.startAngle=d,l.endAngle=d+o,l.fillColor=i.fillColor,l.color=i.color||"#000",l.radiusX=this.options.radiusX||this.options.radius,l.radiusY=this.options.radiusY||this.options.radius,l.rotation=0,l.key=n,l.value=t,l.displayName=i.displayName,l.displayText=i.displayText,e=new L.RadialBarMarker(this._latlng,l),this._bindMouseEvents(e),d=l.endAngle,this.addLayer(e)}}),L.pieChartMarker=function(t,e){return new L.PieChartMarker(t,e)},L.CoxcombChartMarker=L.PieChartMarker.extend({statics:{SIZE_MODE_RADIUS:"radius",SIZE_MODE_AREA:"area"}}),L.CoxcombChartMarker=L.CoxcombChartMarker.extend({initialize:function(t,e){L.Util.setOptions(this,e),L.PieChartMarker.prototype.initialize.call(this,t,e)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new L.Point(50,40),sizeMode:L.CoxcombChartMarker.SIZE_MODE_AREA},_loadComponents:function(){var t,e,i,n,a,o=0,r=this.options.maxDegrees||360,s=this.options.rotation,d=this.options,l="radiusX"in this.options?this.options.radiusX:this.options.radius,c="radiusY"in this.options?this.options.radiusY:this.options.radius,f=Object.keys(this.options.data),u=f.length,h=this.options.data,p=this.options.chartOptions;o=r/u;for(var b in h){t=parseFloat(h[b]),a=p[b];var e=a.minValue||0,i=a.maxValue;if(this.options.sizeMode===L.CoxcombChartMarker.SIZE_MODE_RADIUS){var g=new L.LinearFunction(new L.Point(e,0),new L.Point(i,l)),y=new L.LinearFunction(new L.Point(e,0),new L.Point(i,c));d.radiusX=g.evaluate(t),d.radiusY=y.evaluate(t)}else{var _=Math.max(l,c),m=Math.PI*Math.pow(_,2)/u,v=new L.LinearFunction(new L.Point(e,0),new L.Point(i,m),{postProcess:function(t){return Math.sqrt(u*t/Math.PI)}});d.radiusX=v.evaluate(t),d.radiusY=d.radiusX}d.startAngle=s,d.endAngle=s+o,d.fillColor=a.fillColor,d.color=a.color||"#000",d.rotation=0,d.key=b,d.value=t,d.displayName=a.displayName,d.displayText=a.displayText,n=new L.RadialBarMarker(this._latlng,d),this._bindMouseEvents(n),s=d.endAngle,this.addLayer(n)}}}),L.coxcombChartMarker=function(t,e){return new L.CoxcombChartMarker(t,e)},L.RadialBarChartMarker=L.ChartMarker.extend({initialize:function(t,e){L.Util.setOptions(this,e),L.ChartMarker.prototype.initialize.call(this,t,e)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:30,offset:2,barThickness:5,maxDegrees:360,iconSize:new L.Point(50,40)},_loadComponents:function(){var t,e,i,n,a,o=this.options.rotation,r=this.options.maxDegrees||360,s=this.options,d=this.options.radiusX||this.options.radius,l=this.options.radiusY||this.options.radius,c=this.options.data,f=this.options.chartOptions,u=this.options.barThickness||4,h=this.options.offset||2;for(var p in c){t=parseFloat(c[p]),a=f[p],e=a.minValue||0,i=a.maxValue||100;var b=new L.LinearFunction(new L.Point(e,0),new L.Point(i,r));o=b.evaluate(t),s.startAngle=this.options.rotation,s.endAngle=this.options.rotation+o,s.fillColor=a.fillColor,s.radiusX=d,s.radiusY=l,s.barThickness=u,s.rotation=0,s.key=p,s.value=t,s.displayName=a.displayName,s.displayText=a.displayText,s.weight=this.options.weight||1,n=new L.RadialBarMarker(this._latlng,s),this._bindMouseEvents(n),this.addLayer(n),d+=u+h,l+=u+h}}}),L.radialBarChartMarker=function(t,e){return new L.RadialBarChartMarker(t,e)},L.StackedRegularPolygonMarker=L.ChartMarker.extend({options:{iconSize:new L.Point(50,40)},initialize:function(t,e){L.Util.setOptions(this,e),L.ChartMarker.prototype.initialize.call(this,t,e)},_loadComponents:function(){var t,e,i,n,a=0,o=0,r=this.options,s=this.options.data,d=this.options.chartOptions,l=[];for(n in s){t=parseFloat(s[n]),i=d[n],minValue=i.minValue||0,maxValue=i.maxValue||100,minRadius=i.minRadius||0,maxRadius=i.maxRadius||10,r.fillColor=i.fillColor||this.options.fillColor,r.value=t,r.minValue=minValue,r.maxValue=maxValue;var c=new L.LinearFunction(new L.Point(minValue,minRadius),new L.Point(maxValue,maxRadius)),f=c.evaluate(t);r.radiusX=a+f,r.radiusY=o+f,r.innerRadiusX=a,r.innerRadiusY=o,r.key=n,r.displayName=i.displayName,r.opacity=this.options.opacity||1,r.fillOpacity=this.options.fillOpacity||.7,r.weight=this.options.weight||1,r.color=i.color||this.options.color,r.displayText=i.displayText,e=new L.RegularPolygonMarker(this._latlng,r),this._bindMouseEvents(e),a=r.radiusX,o=r.radiusY,this.options.drawReverse?l.push(e):this.addLayer(e)}if(this.options.drawReverse)for(var u=l.pop();u;)this.addLayer(u),u=l.pop()}}),L.RadialMeterMarker=L.ChartMarker.extend({initialize:function(t,e){L.Util.setOptions(this,e),L.ChartMarker.prototype.initialize.call(this,t,e)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:180,numberOfSides:30,offset:2,barThickness:5,maxDegrees:180,iconSize:new L.Point(50,40),backgroundStyle:{fill:!0,fillColor:"#707070",fillOpacity:.2,opacity:.8,color:"#505050"}},_loadComponents:function(){var t,e,i,n,a,o,r=this.options.rotation,s=this.options.maxDegrees||360,d=this.options,l=this.options.radiusX||this.options.radius,c=this.options.radiusY||this.options.radius,f=this.options.data,u=this.options.chartOptions,h=this.options.barThickness||4,p=r,b=this.options.numSegments||10,g=s/b;for(var y in f){t=parseFloat(f[y]),a=u[y],o=this.options.displayOptions?this.options.displayOptions[y]:{},e=a.minValue||0,i=a.maxValue||100;for(var _=i-e,m=s/_*(t-e),v=r+m,P=r+s,x=new L.LinearFunction(new L.Point(r,e),new L.Point(P,i));v>p;){d.startAngle=p;var w=Math.min(g,v-p);d.endAngle=p+w,d.fillColor=a.fillColor,d.radiusX=l,d.radiusY=c,d.barThickness=h,d.rotation=0,d.key=y,d.value=t,d.displayName=a.displayName,d.displayText=a.displayText;var S=x.evaluate(p+w);for(var F in o)d[F]=o[F].evaluate?o[F].evaluate(S):o[F];n=new L.RadialBarMarker(this._latlng,d),this._bindMouseEvents(n),this.addLayer(n),p+=w}if(this.options.backgroundStyle&&P>p){var w=P-p;d.endAngle=p+w,d.radiusX=l,d.radiusY=c,d.barThickness=h,d.rotation=0,d.key=y,d.value=t,d.displayName=a.displayName,d.displayText=a.displayText,d.fillColor=null,d.fill=!1,d.gradient=!1;for(var C in this.options.backgroundStyle)d[C]=this.options.backgroundStyle[C];var S=x.evaluate(p+w);n=new L.RadialBarMarker(this._latlng,d),this.addLayer(n)}}}}),L.LocationModes={LATLNG:function(t,e){var i=function(e,i){var n=L.Util.getFieldValue(t,e),a=L.Util.getFieldValue(t,i),o=null;if(n&&a){var r=new L.LatLng(n,a);o={location:r,text:[r.lat.toFixed(3),r.lng.toFixed(3)].join(", "),center:r}}return o},n=i(this.options.latitudeField,this.options.longitudeField);if(!n&&this.options.fallbackLocationFields)for(var a,e=0;!n&&e<this.options.fallbackLocationFields.length;)a=this.options.fallbackLocationFields[e],n=i(a.latitudeField,a.longitudeField),e++;return n},GEOHASH:function(t,e){var i,n=this.options.geohashField?L.Util.getFieldValue(t,this.options.geohashField):e,a=decodeGeoHash(n);return a.latitude[2]&&a.longitude[2]&&(i=new L.LatLngBounds(new L.LatLng(a.latitude[0],a.longitude[0]),new L.LatLng(a.latitude[1],a.longitude[1]))),{location:i,text:n,center:i.getCenter()}},GWCOUNTRY:function(t,e){var i,n,a=this.options.codeField?L.Util.getFieldValue(t,this.options.codeField):e,o=L.gwNoLookup||{},r=L.countries||{},s=L.countryCentroids||{},d=a.toUpperCase();a=d;var l=d in o;l&&(a=o[d]||a),a?(i=r[a],n=s[a]):console.log("Code not found: "+d);var c=new L.GeoJSON(i);return{location:c,text:L.GeometryUtils.getName(i)||a,center:n}},COUNTRY:function(t,e){var i,n,a=this.options.codeField?L.Util.getFieldValue(t,this.options.codeField):e,o=L.codeLookup||{},r=L.alpha2Lookup||{},s=L.fips2Lookup||{},d=L.countries||{},l=L.countryCentroids||{},c=a.toUpperCase();a=c,2===a.length?a=r[c]||s[c]:3===a.length&&(a=o[c]||a),a?(i=d[a],n=l[a]):console.log("Code not found: "+c);var f=new L.GeoJSON(i);return{location:f,text:L.GeometryUtils.getName(i)||a,center:n}},STATE:function(t,e){var i,n,a=this.options.codeField?L.Util.getFieldValue(t,this.options.codeField):e,o=L.states||{},r=L.stateCentroids||{},s=a.toUpperCase();a=s,i=o[a],n=r[a];var d=new L.GeoJSON(i);return{location:d,text:L.GeometryUtils.getName(i)||a,center:n}},GEOJSON:function(t){var e=this.options.geoJSONField,i=e?L.Util.getFieldValue(t,e):t,n=null;if(i){var a=this,o=function(t,e){return a.recordToLayer(t,e)};n=L.GeometryUtils.getGeoJSONLocation(i,t,this.options.locationTextField,o)}return n},LOOKUP:function(t,e){var i=this.options.codeField?L.Util.getFieldValue(t,this.options.codeField):e;this._lookupIndex=this._lookupIndex||L.GeometryUtils.indexFeatureCollection(this.options.locationLookup,this.options.locationIndexField||this.options.codeField);var n=this._lookupIndex[i],a=null;if(n||0!==i.indexOf("0")||(n=this._lookupIndex[i.substring(1)]),n){var o=this,r=function(t,e){return o.recordToLayer(t,e)};a=L.GeometryUtils.getGeoJSONLocation(n,t,this.options.locationTextField,r)}return a},CUSTOM:function(t){var e,i=this.options.codeField,n=L.Util.getFieldValue(t,i),a={};if(a[n]=t,this.options.getLocation){var o=this,r=function(t,e){o.locationToLayer(e,a[t])};e=this.options.getLocation(a,i,[n],r)}return e}},L.DataLayer=L.LayerGroup.extend({includes:L.Mixin.Events,options:{recordsField:"features",locationMode:L.LocationModes.LATLNG,latitudeField:"geometry.coordinates.1",longitudeField:"geometry.coordinates.0",displayField:null,displayOptions:null,layerOptions:{numberOfSides:4,radius:10,weight:1,color:"#000"},showLegendTooltips:!0,tooltipOptions:{iconSize:new L.Point(60,50),iconAnchor:new L.Point(-5,50),mouseOverExaggeration:2},setHighlight:function(t){return t.weight=t.weight||1,t.fillOpacity=t.fillOpacity||.5,t.weight*=2,t.fillOpacity/=1.5,t},unsetHighlight:function(t){return t.weight=t.weight||1,t.fillOpacity=t.fillOpacity||.25,t.weight/=2,t.fillOpacity*=1.5,t}},initialize:function(t,e){L.setOptions(this,e),L.LayerGroup.prototype.initialize.call(this,e),t=t||{},this._includeFunction=this.options.filter||this.options.includeLayer,this._markerFunction=this.options.getMarker||this._getMarker,this._addChildLayers(),this.addData(t)},_addChildLayers:function(){this._boundaryLayer=new L.LayerGroup,this.addLayer(this._boundaryLayer),this._trackLayer=new L.LayerGroup,this.addLayer(this._trackLayer)},_zoomFunction:function(){var t=this._map,e=this,i=t.getZoom();if(this.options.maxZoom&&i>this.options.maxZoom)this.hiddenLayers=[],this.eachLayer(function(i){e.hiddenLayers.push(i),t.removeLayer(i)});else if(this.hiddenLayers){for(;this.hiddenLayers.length>0;){var n=this.hiddenLayers.pop();t.addLayer(n),this.options.backgroundLayer&&n.bringToBack&&n.bringToBack()}this.hiddenLayers=null}},onAdd:function(t){L.LayerGroup.prototype.onAdd.call(this,t),t.on("zoomend",this._zoomFunction,this)},onRemove:function(t){L.LayerGroup.prototype.onRemove.call(this,t),t.off("zoomend",this._zoomFunction,this)},bringToBack:function(){this.invoke("bringToBack"),this._trackLayer&&this._trackLayer.invoke("bringToBack"),this._boundaryLayer&&this._boundaryLayer.invoke("bringToBack")},bringToFront:function(){this._boundaryLayer&&this._boundaryLayer.invoke("bringToFront"),this._trackLayer&&this._trackLayer.invoke("bringToFront"),this.invoke("bringToFront")},getBounds:function(){var t;return this.eachLayer(function(e){e.getBounds&&(t?t.extend(e.getBounds()):t=e.getBounds())}),t},_getLocation:function(t,e){return this.options.locationMode.call(this,t,e)},_processLocation:function(t){var e=t.center;return e},_styleBoundary:function(t,e,i){if(t.setStyle){var n;this.options.boundaryStyle instanceof Function&&(n=this.options.boundaryStyle.call(this,i,t)),n=n||this.options.boundaryStyle||L.extend({},e,{fillOpacity:.2,clickable:!1}),t.setStyle(n)}return t},_addBoundary:function(t,e,i){var n,a=t.location;return this.options.includeBoundary&&(a instanceof L.LatLngBounds&&(a=new L.Rectangle(a)),a=this._styleBoundary(a,e,i),this._boundaryLayer.addLayer(a),n=a),n},_getLayer:function(t,e,i){var n=this._addBoundary(t,e,i);t=this._processLocation(t);var a;return t&&(a=this._markerFunction.call(this,t,e,i),a.boundaryLayer=n),a},_getMarker:function(t,e){var i;return t&&(i=e.numberOfSides>=30&&!(e.innerRadius||e.innerRadiusX&&e.innerRadiusY)?new L.CircleMarker(t,e):new L.RegularPolygonMarker(t,e)),i},_preProcessRecords:function(t){return t},_shouldLoadRecord:function(t){return this._includeFunction?this._includeFunction.call(this,t):!0},_loadRecords:function(t){var e;t=this._preProcessRecords(t);for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];n=this.options.deriveProperties?this.options.deriveProperties(n):n;var a=this._shouldLoadRecord(n);a&&(e=this._getLocation(n,i),this.locationToLayer(e,n))}},_preloadLocations:function(t){var e=this.options.codeField,i=[],n={};for(var a in t)if(t.hasOwnProperty(a)){var o=t[a],r=L.Util.getFieldValue(o,e);n[r]=o,i.push(r)}if(this.options.getLocation){var s=this,d=function(t,e){s.locationToLayer(e,n[t])};this.options.getLocation(n,e,i,d)}},setDisplayOptions:function(t){return this.options.displayOptions=t,this.reloadData(),this},setDisplayOption:function(t,e){if(this.options.displayOptions=this.options.displayOptions||{},t in this.options.displayOptions){var i=this.options.displayOptions[t];this.options.displayOptions[t]=L.extend({},i,e)}else this.options.displayOptions[t]=e;return this.reloadData(),this},setFilter:function(t){return this.options.filter=t,this.reloadData(),this},setData:function(t){this._data=t,this.reloadData()},reloadData:function(){return this._layerIndex||(this.clearLayers(),this._addChildLayers()),this._data&&this.addData(this._data),this.fire("legendChanged",this),this},addData:function(t){var e=null!==this.options.recordsField&&this.options.recordsField.length>0?L.Util.getFieldValue(t,this.options.recordsField):t;this.options.getIndexKey&&!this._layerIndex&&(this._layerIndex={},this._boundaryIndex={}),this.options.locationMode===L.LocationModes.CUSTOM&&this.options.preload?this._preloadLocations(e):this._loadRecords(e),this._data=t},locationToLayer:function(t,e){var i;i=this.recordToLayer(t,e),i&&this.addLayer(i)},_bindMouseEvents:function(t,e,i){var n=this,a=this.options,o=a.setHighlight,r=a.unsetHighlight,s=a.tooltipOptions,d=function(t){var e=t.target,a=this.options||e.options,r=new L.LegendIcon(i,a,{className:s.className||"leaflet-div-icon",iconSize:s.iconSize,iconAnchor:s.iconAnchor}),d=t.latlng||t.target._latlng,l=new L.Marker(d,{icon:r});n.addLayer(l),n.tooltip&&(n.removeLayer(n.tooltip),n.tooltip=null),n.tooltip=l,o&&(a=o(a)),e.setStyle&&e.setStyle(a),e.isHighlighted=!0},l=function(t){n.tooltip&&n.tooltip.setLatLng(t.latlng)},c=function(t){if(t.target.isHighlighted){t.target.isHighlighted=!1,n.tooltip&&(n.removeLayer(n.tooltip),n.tooltip=null);var e=t.target,i=this.options||e.options;r&&(i=r(i)),e.setStyle&&e.setStyle(i)}},f=function(t){t.off("mouseover"),t.off("mouseout"),t.off("mousemove"),t.on({mouseover:d,mouseout:c,mousemove:l})},u=function(t){t.eachLayer?t.eachLayer(function(t){u(t)}):f(t)};u(t)},_getDynamicOptions:function(t){var e=L.extend({},this.options.layerOptions),i=this.options.displayOptions,n={};if(i)for(var a in i){var o,r=i[a],s=L.Util.getFieldValue(t,a),d=r.displayText?r.displayText(s):s;if(n[a]={name:r.displayName,value:d},r.styles)e=L.extend(e,r.styles[s]),r.styles[s]=e;else for(var l in r)o=r[l],e[l]=o.evaluate?o.evaluate(s):o.call?o.call(this,s):o}return{layerOptions:e,legendDetails:n}},_getIndexedLayer:function(t,e,i,n){if(this.options.getIndexKey){var a=this.options.getIndexKey.call(this,e,n);if(a in t){layer=t[a];var o=function(t){i.radius&&t instanceof L.CircleMarker&&t.setRadius(i.radius),t.setStyle(i),t.setLatLng&&t.getLatLng()!==e.center?t.setLatLng(e.center):t.redraw()};L.Util.updateLayer(layer,o),layer.boundaryLayer&&(layer.boundaryLayer=this._styleBoundary(layer.boundaryLayer,i,n))}else layer=this._getLayer(e,i,n),t[a]=layer;if(this.options.getTrack){var r=!layer.trackLayer;layer.trackLayer=this.options.getTrack.call(this,layer,e,layer.trackLayer),r&&this._trackLayer.addLayer(layer.trackLayer)}}else layer=this._getLayer(e,i,n);return layer},recordToLayer:function(t,e){var i,n=L.extend({},this.options.layerOptions),a={},o=!0;if(this._includeFunction&&(o=this._includeFunction.call(this,e)),o){var r=this._getDynamicOptions(e);n=r.layerOptions,a=r.legendDetails,t&&n&&(n.title=t.text,i=this._getIndexedLayer(this._layerIndex,t,n,e),i&&(this.options.showLegendTooltips&&this._bindMouseEvents(i,n,a),this.options.onEachRecord&&this.options.onEachRecord.call(this,i,e,t,this)))}return i},getLegend:function(t){return this.options.getLegend?this.options.getLegend.call(this,t):this._getLegend(t)},_getLegendElement:function(t){var e,i,n=document.createElement("i"),a=t.displayProperties,o=t.layerOptions,r=t.ignoreProperties,s=t.displayTextFunction,d=t.index,l=t.numSegments,c=t.segmentWidth,f=t.minValue,u=t.maxValue;L.StyleConverter.applySVGStyle(n,o);for(var h in a)if(-1===r.indexOf(h)&&(valueFunction=a[h],valueFunction&&(valueFunction.getBounds||a.minValue&&a.maxValue))){var p=valueFunction.getBounds?valueFunction.getBounds():null,b=p?p[0].x:a.minValue,g=p?p[1].x:a.maxValue,y=new L.LinearFunction(new L.Point(0,b),new L.Point(l,g));e=b,i=g,s&&(e=s(b),i=s(g)),0===d&&(f.innerHTML=e,u.innerHTML=i);var _=(g-b)/l,m=y.evaluate(d),v=y.evaluate(d+1),P=valueFunction.evaluate?valueFunction.evaluate(m):valueFunction(m),x=valueFunction.evaluate?valueFunction.evaluate(v):valueFunction(v);L.StyleConverter.setCSSProperty(n,h,P),"fillColor"===h&&(n.style.cssText+=t.gradient?"background-image:linear-gradient(left , "+P+" 0%, "+x+" 100%);background-image:-ms-linear-gradient(left , "+P+" 0%, "+x+" 100%);background-image:-moz-linear-gradient(left , "+P+" 0%, "+x+" 100%);background-image:-webkit-linear-gradient(left , "+P+" 0%, "+x+" 100%);":"background-color:"+x+";"),"color"===h&&(n.style.cssText+="border-top-color:"+P+";border-bottom-color:"+x+";border-left-color:"+P+";border-right-color:"+x+";"),"weight"===h&&(n.style.cssText+="border-top-width:"+P+";border-bottom-width:"+x+";border-left-width:"+P+";border-right-width:"+x+";");var w=_*d+b,S=w+_;s&&valueFunction&&(w=s(w),S=s(S)),n.setAttribute("title",w+" - "+S)}return n.style.width=c+"px",n},_getLegend:function(t){t=t||this.options.legendOptions||{};var e,i=t.className,n=document.createElement("div"),a=L.DomUtil.create("div","legend",n),o=t.numSegments||10,r=t.width||100,s=this.options.layerOptions||{},d=s.weight||0,l=r/o-2*d,c=this.options.displayOptions||{};i&&L.DomUtil.addClass(a,i),t.title&&(L.DomUtil.create("legend","",a).innerHTML=t.title);var f=function(t){return t};for(var u in c){var h=c[u];if(!h.excludeFromLegend){var p=h.displayName||u;e=h.displayText;var b=e?e:f,g=h.styles;if(L.DomUtil.create("div","legend-title",a).innerHTML=p,g)a.innerHTML+=new L.CategoryLegend(g).generate();else{for(var y=L.DomUtil.create("div","data-layer-legend"),_=L.DomUtil.create("div","min-value",y),m=L.DomUtil.create("div","scale-bars",y),v=L.DomUtil.create("div","max-value",y),P=["displayName","displayText","minValue","maxValue"],x=0;o>x;++x){var w={displayProperties:h,layerOptions:s,ignoreProperties:P,displayTextFunction:b,index:x,numSegments:o,segmentWidth:l,minValue:_,maxValue:v,gradient:t.gradient},S=this._getLegendElement(w);m.appendChild(S)}a.appendChild(y)}}}return n.innerHTML},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();if("FeatureCollection"===n.type&&n.features)for(var a=0;a<n.features.length;++a)i.push(n.features[a]);else i.push(e?n.geometry:L.GeoJSON.asFeature(n))}}),e?L.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),L.dataLayer=function(t,e){return new L.DataLayer(t,e)},L.MapMarkerDataLayer=L.DataLayer.extend({_getMarker:function(t,e){return new L.MapMarker(t,e)}}),L.mapMarkerDataLayer=function(t,e){return new L.MapMarkerDataLayer(t,e)},L.MarkerDataLayer=L.DataLayer.extend({initialize:function(t,e){this._markerMap={},L.DataLayer.prototype.initialize.call(this,t,e)},options:{recordsField:"features",locationMode:L.LocationModes.LATLNG,latitudeField:"latitude",longitudeField:"longitude",layerOptions:{icon:null},showLegendTooltips:!1},_getMarker:function(t,e,i){return this.options.setIcon&&(e.icon=this.options.setIcon.call(this,i,e)),new L.Marker(t,e)},_getLegendElement:function(){},_getLegend:function(){return"<span>No legend available</span>"}}),L.markerDataLayer=function(t,e){return new L.MarkerDataLayer(t,e)},L.PanoramioLayer=L.MarkerDataLayer.extend({statics:{UPLOAD_DATE_FORMAT:"DD MMM YYYY",SIZE_BY_DATE:"date",SIZE_BY_POPULARITY:"popularity",SIZE_BY_NONE:"none",SIZES:{square:[60,60],mini_square:[32,32]},NUM_PHOTOS:50}}),L.PanoramioLayer=L.PanoramioLayer.extend({initialize:function(t){L.MarkerDataLayer.prototype.initialize.call(this,{},t),this._from=0,this._to=L.PanoramioLayer.NUM_PHOTOS,this._calls=[]},options:{recordsField:"photos",latitudeField:"latitude",longitudeField:"longitude",locationMode:L.LocationModes.LATLNG,showLegendTooltips:!1,sizeBy:L.PanoramioLayer.SIZE_BY_DATE,layerOptions:{opacity:1},onEachRecord:function(t,e){var i=e.photo_file_url,n=e.photo_title,a=this,o=e.width,r=e.height,s=2e4;t.on("click",function(d){var l=document.createElement("div"),c=L.DomUtil.create("div","",l),f=L.DomUtil.create("img","photo",c);f.setAttribute("onload","this.style.opacity=1;"),f.setAttribute("src",i),f.style.width=o+"px";var u=L.DomUtil.create("div","photo-info",c);u.style.width=o-20+"px",u.innerHTML="<span>"+n+'</span><a class="photo-link" target="_blank" href="'+e.photo_url+'"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 14px;"/></a>';var h=L.DomUtil.create("a","author-link",c);h.setAttribute("target","_blank"),h.setAttribute("href",e.owner_url),h.innerHTML="by "+e.owner_name;var p=new L.DivIcon({className:"photo-details",html:l.innerHTML,iconAnchor:[o/2,r/2]}),b=new L.Marker(d.target._latlng,{icon:p,zIndexOffset:s});b.on("click",function(t){a.removeLayer(t.target)}),t.viewedImage=b,a.viewedImage=b,a.addLayer(b)}),this.options.onEachPhoto&&this.options.onEachPhoto.call(this,t,e)},setIcon:function(t){var e=L.Util.getFieldValue(t,"photo_title"),i=null;this._sizeFunction&&(i=this._sizeFunction.evaluate(t.index));var n=i?new L.Point(i,i):L.PanoramioLayer.SIZES[this.options.size],a=t.photo_file_url.replace("/medium/","/"+this.options.size+"/"),o=new L.DivIcon({iconSize:n,className:"",html:'<img class="photo" onload="this.style.opacity=1" title="'+e+'" src="'+a+'"/>'});return o},updateInterval:3e5,size:"square",attributionText:'Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a>.  Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a> are under the copyright of their owners',refreshEvents:"moveend",photoSet:"public"},includes:L.Mixin.Events,onAdd:function(t){L.DataLayer.prototype.onAdd.call(this,t),t.attributionControl&&t.attributionControl.addAttribution(this.options.attributionText);var e=this,i=function(){e._from=0,e._to=L.PanoramioLayer.NUM_PHOTOS,e.fire("requestingPhotos"),e._call&&clearTimeout(e._call);var t=function(){e.requestPhotos()};e._call=setTimeout(t,1e3)};this.requestPhotos(),this._interval=setInterval(i,this.options.updateInterval),this._resetFunction=i,t.on(this.options.refreshEvents,i)},onRemove:function(t){L.DataLayer.prototype.onRemove.call(this,t),t.attributionControl&&t.attributionControl.removeAttribution(this.options.attributionText),this._interval&&(clearInterval(this._interval),this._interval=null),t.off(this.options.refreshEvents,this._resetFunction)},calculateSizeByDate:function(t){for(var e=t.photos,i=[],n=0;n<e.length;++n){var a=e[n],o=moment(a.upload_date,L.PanoramioLayer.UPLOAD_DATE_FORMAT);i.push(o),e[n].index=o}i.sort(function(t,e){return t-e});var r=L.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new L.LinearFunction([i[0],r/2],[i[i.length-1],r]),t},calculateSizeByPopularity:function(t){for(var e=t.photos,i=0;i<e.length;++i)e[i].index=i;var n=L.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new L.LinearFunction([0,n/2],[e.length,n]),t},next:function(){this._from=this._to,this._to=this._from+L.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},previous:function(){this._to=this._from,this._from=this._from-L.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},requestJsonp:function(t,e,i){var n=this,a="function"+(new Date).getTime(),o=[];e.callback="window.LeafletDvfJsonpCallbacks."+a;for(property in e)e.hasOwnProperty(property)&&o.push(property+"="+encodeURIComponent(e[property]));return t+=(t.indexOf("?")>0?"&":"?")+o.join("&"),"undefined"==typeof window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks={}),window.LeafletDvfJsonpCallbacks[a]=function(t){i.call(n,t),delete window.LeafletDvfJsonpCallbacks[a]},this.jsonpScript&&(document.head.removeChild(this.jsonpScript),this.jsonpScript=null),this.jsonpScript=document.createElement("script"),this.jsonpScript.setAttribute("type","text/javascript"),this.jsonpScript.setAttribute("async","true"),this.jsonpScript.setAttribute("src",t),document.head.appendChild(this.jsonpScript),{abort:function(){a in window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks[a]=function(){delete window.LeafletDvfJsonpCallbacks[a]})}}},requestPhotos:function(){for(var t=this,e=this._map.getBounds(),i=e.getSouthWest(),n=e.getNorthEast();t._calls.length>0;)t._calls.pop().abort();var a=this.requestJsonp("http://www.panoramio.com/map/get_panoramas.php",{set:this.options.photoSet,from:t._from,to:t._to,minx:i.lng,miny:i.lat,maxx:n.lng,maxy:n.lat,size:"medium",mapfilter:"true"},function(e){t._count=e.count,moment&&t.options.sizeBy===L.PanoramioLayer.SIZE_BY_DATE?e=t.calculateSizeByDate(e):t.options.sizeBy===L.PanoramioLayer.SIZE_BY_POPULARITY&&(e=t.calculateSizeByPopularity(e)),t.fire("photosAvailable",e),t.clearLayers(),t.addData(e)});t._calls.push(a)}}),L.panoramioLayer=function(t){return new L.PanoramioLayer(t)},L.GeohashDataLayer=L.DataLayer.extend({initialize:function(t,e){L.DataLayer.prototype.initialize.call(this,t,e)},options:{recordsField:"features",locationMode:L.LocationModes.GEOHASH,geohashField:"geohash",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},getIndexKey:function(t){return t.text}},_getLayer:function(t,e){return new L.Rectangle(t.location,e)}}),L.geohashDataLayer=function(t,e){return new L.GeohashDataLayer(t,e)},L.ChoroplethDataLayer=L.DataLayer.extend({initialize:function(t,e){L.DataLayer.prototype.initialize.call(this,t,e)},options:{recordsField:"features",locationMode:L.LocationModes.COUNTRY,codeField:"ISO",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},maxZoom:16,backgroundLayer:!0},_getLayer:function(t,e,i){return t.location instanceof L.LatLng&&(t.location=this._markerFunction.call(this,t.location,e,i)),t.location.setStyle&&(e.gradient=t.location instanceof L.Polyline?!1:e.gradient,t.location.setStyle(e)),t.location}}),L.choroplethDataLayer=function(t,e){return new L.ChoroplethDataLayer(t,e)},L.ChartDataLayer=L.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(t,e){L.DataLayer.prototype.initialize.call(this,t,e)},_getLayer:function(t,e,i){var n=this._addBoundary(t,e,i);t=this._processLocation(t);var a=this.options.chartOptions,o=this.options.tooltipOptions,r={};r=e,r.data={},r.chartOptions=a;for(var s in this.options.chartOptions)r.data[s]=this.options.getFieldValue?this.options.getFieldValue.call(this,i,s):L.Util.getFieldValue(i,s);for(var s in o)r[s]=o[s];var d;return t&&(d=this._getMarker(t,r),d.boundaryLayer=n),d},_getMarker:function(){},_getLegend:function(t){var e=(L.DataLayer.prototype._getLegend.call(this,t),new L.CategoryLegend(this.options.chartOptions));return t=t||this.options.legendOptions,e.generate(t)}}),L.BarChartDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.BarChartMarker(t,e)}}),L.barChartDataLayer=function(t,e){return new L.BarChartDataLayer(t,e)},L.RadialBarChartDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.RadialBarChartMarker(t,e)}}),L.radialBarChartDataLayer=function(t,e){return new L.RadialBarChartDataLayer(t,e)},L.PieChartDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.PieChartMarker(t,e)}}),L.pieChartDataLayer=function(t,e){return new L.PieChartDataLayer(t,e)},L.CoxcombChartDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.CoxcombChartMarker(t,e)}}),L.coxcombChartDataLayer=function(t,e){return new L.CoxcombChartDataLayer(t,e)},L.StackedRegularPolygonDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.StackedRegularPolygonMarker(t,e)}}),L.stackedRegularPolygonDataLayer=function(t,e){return new L.StackedRegularPolygonDataLayer(t,e)},L.StackedPieChartDataLayer=L.ChartDataLayer.extend({initialize:function(t,e){L.ChartDataLayer.prototype.initialize.call(this,t,e)},_getMarker:function(t,e){return new L.StackedPieChartMarker(t,e)}}),L.stackedPieChartDataLayer=function(t,e){return new L.StackedPieChartDataLayer(t,e)},L.RadialMeterMarkerDataLayer=L.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(t,e){L.DataLayer.prototype.initialize.call(this,t,e)},_getLayer:function(t,e,i){this._addBoundary(t,e),t=this._processLocation(t);var n=this.options.chartOptions,a=this.options.tooltipOptions,o=this.options.displayOptions,r={};r=e,r.data={},r.chartOptions=n,r.displayOptions=o;for(var s in this.options.chartOptions)r.data[s]=L.Util.getFieldValue(i,s);for(var s in a)r[s]=a[s];var d;return t&&(d=this._getMarker(t,r)),d},_getMarker:function(t,e){return new L.RadialMeterMarker(t,e)}}),L.radialMeterMarkerDataLayer=function(t,e){return new L.RadialMeterMarkerDataLayer(t,e)},L.CalloutLine=L.Path.extend({statics:{LINESTYLE:{ARC:"arc",ANGLE:"angle",STRAIGHT:"straight"},DIRECTION:{NE:"ne",NW:"nw",SE:"se",SW:"sw"}}}),L.CalloutLine=L.CalloutLine.extend({initialize:function(t,e){L.setOptions(this,e),this._latlng=t},options:{size:new L.Point(60,30),position:new L.Point(0,0),color:"#FFFFFF",opacity:1,weight:2,fillColor:"#000000",fill:!1,gradient:!1,dropShadow:!1,direction:L.CalloutLine.DIRECTION.NE,lineStyle:L.CalloutLine.LINESTYLE.ANGLE,lineCap:"butt",lineJoin:"miter",arrow:!1},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var t=this._map,e=t.project(this._latlng),i=new L.Point(e.x+this.options.position.x,e.y+this.options.position.y),n=new L.Point(i.x+this.options.size.x,i.y-this.options.size.y);this._pxBounds=new L.Bounds(i,n)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getEndPoint:function(){return this._project(),this._points[this._points.length-1]},_getPathAngle:function(){return new L.SVGPathBuilder(this._points,[],{closePath:!1}).build(6)},_getPathArc:function(){var t=(this.options.direction||L.CalloutLine.DIRECTION.NE).toLowerCase(),e=t[0],i="n"===e?-1:1,n=this._points[0],a=this._points[this._points.length-1],o=["M",n.x,",",n.y," Q",n.x,",",n.y+i*this.options.size.y," ",a.x,",",a.y];return o.join(" ")},_getPoints:function(){var t=this._point.x+this.options.position.x,e=this._point.y+this.options.position.y,i=this.options.size.x,n=this.options.size.y,a=(this.options.direction||L.CalloutLine.DIRECTION.NE).toLowerCase(),o=[],r=a[1],s=a[0],d="w"===r?-1:1,l="n"===s?-1:1;
    o.push(new L.Point(t, e)); var c = e + l * n, f = i / 2, u = Math.atan(n / f); if (this.options.lineStyle === L.CalloutLine.LINESTYLE.ARC ? u = Math.atan(Math.pow(n, 2) / f) : this.options.lineStyle === L.CalloutLine.LINESTYLE.STRAIGHT && (u = Math.atan(n / i)), this._angle = u, this.options.lineStyle !== L.CalloutLine.LINESTYLE.STRAIGHT) { var h = new L.Point(t + d * f, c); o.push(h) } var p = new L.Point(t + d * i, c); return o.push(p), o
}, getBounds: function () { var t = this._map, e = t.project(this._latlng), i = new L.Point(e.x + this.options.position.x, e.y + this.options.position.y), n = new L.Point(i.x + this.options.size.x, i.y - this.options.size.y), a = t.unproject(i), o = t.unproject(n); return new L.LatLngBounds(a, o) }, setLatLng: function (t) { this._latlng = t, this.redraw() }, getLatLng: function () { return this._latlng }, getPathString: function () { this._path.setAttribute("shape-rendering", "geometricPrecision"); var t = this.options.lineStyle || L.CalloutLine.LINESTYLE.ANGLE, e = ""; return e += t === L.CalloutLine.LINESTYLE.ANGLE || t === L.CalloutLine.LINESTYLE.STRAIGHT ? this._getPathAngle() : this._getPathArc() }
}), L.calloutLine = function (t, e) { return new L.CalloutLine(t, e) }, L.Callout = L.LayerGroup.extend({ options: { color: "#FFFFFF", fillColor: "#FFFFFF" }, initialize: function (t, e) { L.Util.setOptions(this, e), L.LayerGroup.prototype.initialize.call(this, e), this._latlng = t }, onAdd: function (t) { L.LayerGroup.prototype.onAdd.call(this, t), this.addLayers() }, addArrow: function (t, e, i) { if (this.options.arrow) { var t = L.LatLng.RAD_TO_DEG * t, n = this.options.numberOfSides || 3, a = this.options.radius || 6, o = 180 / n, r = { se: o + t, sw: 180 + o - t, nw: 180 + o + t, ne: o - t }, s = r[e], d = new L.RegularPolygonMarker(this._latlng, { position: i, numberOfSides: n, rotation: s, fillColor: this.options.fillColor, color: this.options.color, gradient: this.options.gradient, weight: this.options.weight, opacity: this.options.opacity, fillOpacity: this.options.fillOpacity, radius: a, lineCap: "butt", lineJoin: "miter" }); this.addLayer(d) } }, addLine: function () { var t = {}; for (var e in this.options) "icon" !== e && (t[e] = this.options[e]); var i = new L.CalloutLine(this._latlng, t); return this.addLayer(i), i }, addIcon: function (t, e) { var i = this.options.size, n = this.options.icon, a = n.options.iconSize, o = t[0], r = t[1], s = "w" === r ? a.x + i.x - e.x : -1 * (i.x + e.x), d = "n" === o ? a.y / 2 + i.y - e.y : -1 * (-a.y / 2 + i.y + e.y); n.options.iconAnchor = new L.Point(s, d); var l = new L.Marker(this._latlng, { icon: n }); this.addLayer(l) }, addLayers: function () { var t, e = (this.options.direction || "ne").toLowerCase(), i = this.options.position || new L.Point(0, 0); t = this.addLine(), this.addIcon(e, i), this.addArrow(t._angle, e, i) } }), L.callout = function (t, e) { return new L.Callout(t, e) }, L.FlowLine = L.DataLayer.extend({ statics: { LINE_FUNCTION: function (t, e, i) { return new L.Polyline([t, e], i) }, LINE_FUNCTION_INTERPOLATED: function (t, e, i) { { var n = this._map.latlngToLayerPoint(t), a = this._map.latlngToLayerPoint(e), o = new L.LinearFunction(n, a), r = Math.ceil(n.distanceTo(a) / i.interpolationOptions.segmentLength); o.samplePoints(r) } } } }), L.FlowLine = L.FlowLine.extend({ initialize: function (t, e) { L.Util.setOptions(this, e), L.DataLayer.prototype.initialize.call(this, t, e) }, options: { getLine: L.FlowLine.LINE_FUNCTION }, onEachSegment: function (t, e, i) { var n = {}; if (this.options.timeField) { var a = L.Util.getFieldValue(t, this.options.timeField), o = L.Util.getFieldValue(e, this.options.timeField), r = this.options.timeFormat, s = r ? moment(a, r) : moment(a), d = r ? moment(o, r) : moment(o), l = d.valueOf() - s.valueOf(); n.time = l } for (var c in this.options.displayOptions) { var f = L.Util.getFieldValue(t, c), u = L.Util.getFieldValue(e, c), h = u - f, p = h / f * 100; n[c] = { from: f, to: u, change: h, percentChange: p }, n.time && (n[c].changeOverTime = h / n.time) } var b, g = i.getLatLngs(), y = g[0].distanceTo(g[1]); n.time && (b = y / (1e3 * n.time)), this.options.onEachSegment && this.options.onEachSegment.call(this, t, e, i, n, y, b) }, _loadRecords: function (t) { var e = []; for (var i in t) if (t.hasOwnProperty(i)) { var n = t[i]; e = this._addRecord(n, i, e) } for (; e.length > 0;) this.addLayer(e.pop()) }, addRecord: function (t) { return this._addRecord(t), this }, _addRecord: function (t, e, i) { var n = this._getLocation(t, e), a = this.options.layerOptions; if (n) { var o, r = this._getLayer(n, a, t), s = !0; if (this.options.includeLayer && (s = this.options.includeLayer(t)), this._lastRecord && s) { var a = this._getDynamicOptions(this._lastRecord); o = this.options.getLine.call(this, this._lastMarker.getLatLng(), r.getLatLng(), a.layerOptions), this.addLayer(o), this.onEachSegment(this._lastRecord, t, o) } s && (this._lastRecord = t, this._lastMarker = r) } return i } }), L.flowLine = function (t, e) { return new L.FlowLine(t, e) }, L.ArcedFlowLine = L.FlowLine.extend({ options: { getLine: function (t, e, i) { return new L.ArcedPolyline([t, e], i) } }, initialize: function (t, e) { L.FlowLine.prototype.initialize.call(this, t, e) } }), L.arcedFlowLine = function (t, e) { return new L.ArcedFlowLine(t, e) }, L.ArcedPolyline = L.Path.extend({ includes: TextFunctions, initialize: function (t, e) { L.setOptions(this, e), this._latlngs = t }, options: { distanceToHeight: new L.LinearFunction([0, 5], [1e3, 200]), color: "#FFFFFF", opacity: 1, weight: 1, fillColor: "#000000", fill: !1, gradient: !1, dropShadow: !1, optimizeSpeed: !1 }, _project: function () { this._points = []; for (var t = 0; t < this._latlngs.length; ++t) this._points.push(this._map.latLngToLayerPoint(this._latlngs[t])) }, _update: function () { this._map && this._renderer._setPath(this, this.getPathString()) }, getBounds: function () { for (var t = new L.LatLngBounds, e = 0; e < this._latlngs.length; ++e) t.extend(this._latlngs[e]); return t }, setLatLngs: function (t) { this._latlngs = t, this.redraw() }, getLatLngs: function () { return this._latlngs }, drawSegment: function (t, e) { var i = Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)), n = this.options.distanceToHeight.evaluate(i), a = ["M", t.x, ",", t.y, " C", t.x, ",", t.y - n, " ", e.x, ",", e.y - n, " ", e.x, ",", e.y]; return a.join(" ") }, getPathString: function () { this.options.optimizeSpeed && this._path.setAttribute("shape-rendering", "optimizeSpeed"); for (var t = [], e = 0; e < this._points.length - 1; ++e) t.push(this.drawSegment(this._points[e], this._points[e + 1])); return t.join("") } }), L.arcedPolyline = function (t, e) { return new L.ArcedPolyline(t, e) }, L.Control.Legend = L.Control.extend({ options: { position: "bottomright", autoAdd: !0 }, onAdd: function (t) { var e = "leaflet-control-legend", i = L.DomUtil.create("div", e), n = this; return this.options.autoAdd && (t.on("layeradd", function (t) { var e = t.layer; n.addLayer(e) }), t.on("layerremove", function (t) { var e = t.layer; n.removeLayer(e) })), this.toggleSize = L.bind(this.toggleSize, this), L.DomEvent.addListener(i, "mouseover", this.toggleSize).addListener(i, "mouseout", this.toggleSize).addListener(i, "touchstart", this.toggleSize).addListener(i, "touchend", this.toggleSize).addListener(i, "click", L.DomEvent.stopPropagation).addListener(i, "click", L.DomEvent.preventDefault), i }, clear: function () { this._container.innerHTML = "" }, toggleSize: function () { L.DomUtil.hasClass(this._container, "larger") ? L.DomUtil.removeClass(this._container, "larger") : L.DomUtil.addClass(this._container, "larger") }, redrawLayer: function (t) { this.removeLayer(t), this.addLayer(t) }, addLayer: function (t) { var e = L.Util.stamp(t), i = this; t.getLegend && (this.addLegend(e, t.getLegend()), t.on("legendChanged", function () { i.redrawLayer(t) })) }, removeLayer: function (t) { var e = L.Util.stamp(t); if (t.getLegend) { var i = document.getElementById(e); i.parentNode.removeChild(i), t.off("legendChanged") } }, addLegend: function (t, e) { var i = this._container, n = document.getElementById(t); n || (n = L.DomUtil.create("div", "", i), n.id = t), n.innerHTML = e } }), L.control.legend = function (t) { return new L.Control.Legend(t) };
//#endregion

//#region ArcJS
var D2R = Math.PI / 180, R2D = 180 / Math.PI, Coord = function (a, b) { this.lon = a, this.lat = b, this.x = D2R * a, this.y = D2R * b }; Coord.prototype.view = function () { return (this.lon + "").slice(0, 4) + "," + (this.lat + "").slice(0, 4) }, Coord.prototype.antipode = function () { var a = -1 * this.lat; if (0 > this.lon) var b = 180 + this.lon; else var b = -1 * (180 - this.lon); return new Coord(b, a) }; var LineString = function () { this.coords = [], this.length = 0 }; LineString.prototype.move_to = function (a) { this.length++, this.coords.push(a) }; var Arc = function (a) { this.properties = a || {}, this.geometries = [] }; Arc.prototype.json = function () { if (0 >= this.geometries.length) return { geometry: { type: "LineString", coordinates: null }, type: "Feature", properties: this.properties }; if (1 == this.geometries.length) return { geometry: { type: "LineString", coordinates: this.geometries[0].coords }, type: "Feature", properties: this.properties }; var a = []; for (i = 0; this.geometries.length > i; i++) a.push(this.geometries[i].coords); return { geometry: { type: "MultiLineString", coordinates: a }, type: "Feature", properties: this.properties } }, Arc.prototype.wkt = function () { var a = ""; for (i = 0; this.geometries.length > i; i++) { if (0 === this.geometries[i].coords.length) return "LINESTRING(empty)"; var b = "LINESTRING("; this.geometries[i].coords.forEach(function (a) { b += a[0] + " " + a[1] + "," }), a += b.substring(0, b.length - 1) + ")" } return a }; var GreatCircle = function (a, b, c) { this.start = a, this.end = b, this.properties = c || {}; var d = this.start.x - this.end.x, e = this.start.y - this.end.y, f = Math.pow(Math.sin(e / 2), 2) + Math.cos(this.start.y) * Math.cos(this.end.y) * Math.pow(Math.sin(d / 2), 2); if (this.g = 2 * Math.asin(Math.sqrt(f)), this.g == Math.PI) throw Error("it appears " + a.view() + " and " + b.view() + " are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite"); if (isNaN(this.g)) throw Error("could not calculate great circle between " + a + " and " + b) }; if (GreatCircle.prototype.interpolate = function (a) { var b = Math.sin((1 - a) * this.g) / Math.sin(this.g), c = Math.sin(a * this.g) / Math.sin(this.g), d = b * Math.cos(this.start.y) * Math.cos(this.start.x) + c * Math.cos(this.end.y) * Math.cos(this.end.x), e = b * Math.cos(this.start.y) * Math.sin(this.start.x) + c * Math.cos(this.end.y) * Math.sin(this.end.x), f = b * Math.sin(this.start.y) + c * Math.sin(this.end.y), g = R2D * Math.atan2(f, Math.sqrt(Math.pow(d, 2) + Math.pow(e, 2))), h = R2D * Math.atan2(e, d); return [h, g] }, GreatCircle.prototype.Arc = function (a) { var c = []; if (2 >= a) c.push([this.start.lon, this.start.lat]), c.push([this.end.lon, this.end.lat]); else for (var d = 1 / (a - 1), e = 0; a > e; e++) { var f = d * e, g = this.interpolate(f); c.push(g) } for (var h = !1, i = 0, e = 1; c.length > e; e++) { var j = c[e - 1][0], k = c[e][0], l = Math.abs(k - j); l > 350 && (k > 170 && -170 > j || j > 170 && -170 > k) ? h = !0 : l > i && (i = l) } var m = []; if (h && 10 > i) { var n = []; m.push(n); for (var e = 0; c.length > e; e++) { var k = parseFloat(c[e][0]); if (e > 0 && Math.abs(k - c[e - 1][0]) > 350) { var o = parseFloat(c[e - 1][0]), p = parseFloat(c[e - 1][1]), q = parseFloat(c[e][0]), r = parseFloat(c[e][1]); if (o > -180 && -170 > o && 180 == q && c.length > e + 1 && c[e - 1][0] > -180 && -170 > c[e - 1][0]) { n.push([-180, c[e][1]]), e++, n.push([c[e][0], c[e][1]]); continue } if (o > 170 && 180 > o && -180 == q && c.length > e + 1 && c[e - 1][0] > 170 && 180 > c[e - 1][0]) { n.push([180, c[e][1]]), e++, n.push([c[e][0], c[e][1]]); continue } if (-170 > o && q > 170) { var s = o; o = q, q = s; var t = p; p = r, r = t } if (o > 170 && -170 > q && (q += 360), 180 >= o && q >= 180 && q > o) { var u = (180 - o) / (q - o), v = u * r + (1 - u) * p; n.push([c[e - 1][0] > 170 ? 180 : -180, v]), n = [], n.push([c[e - 1][0] > 170 ? -180 : 180, v]), m.push(n) } else n = [], m.push(n); n.push([k, c[e][1]]) } else n.push([c[e][0], c[e][1]]) } } else { var n = []; m.push(n); for (var e = 0; c.length > e; e++) n.push([c[e][0], c[e][1]]) } for (var w = new Arc(this.properties), e = 0; m.length > e; e++) { var x = new LineString; w.geometries.push(x); for (var y = m[e], z = 0; y.length > z; z++) x.move_to(y[z]) } return w }, "undefined" == typeof window) module.exports.Coord = Coord, module.exports.Arc = Arc, module.exports.GreatCircle = GreatCircle; else { var arc = {}; arc.Coord = Coord, arc.Arc = Arc, arc.GreatCircle = GreatCircle }
//#endregion

//#region Modernizr
var Modernizr = function (a, b, c) { function y(a) { i.cssText = a } function z(a, b) { return y(l.join(a + ";") + (b || "")) } function A(a, b) { return typeof a === b } function B(a, b) { return !!~("" + a).indexOf(b) } function C(a, b) { for (var d in a) { var e = a[d]; if (!B(e, "-") && i[e] !== c) return b == "pfx" ? e : !0 } return !1 } function D(a, b, d) { for (var e in a) { var f = b[a[e]]; if (f !== c) return d === !1 ? a[e] : A(f, "function") ? f.bind(d || b) : f } return !1 } function E(a, b, c) { var d = a.charAt(0).toUpperCase() + a.slice(1), e = (a + " " + n.join(d + " ") + d).split(" "); return A(b, "string") || A(b, "undefined") ? C(e, b) : (e = (a + " " + o.join(d + " ") + d).split(" "), D(e, b, c)) } var d = "2.6.1", e = {}, f = b.documentElement, g = "modernizr", h = b.createElement(g), i = h.style, j, k = {}.toString, l = " -webkit- -moz- -o- -ms- ".split(" "), m = "Webkit Moz O ms", n = m.split(" "), o = m.toLowerCase().split(" "), p = {}, q = {}, r = {}, s = [], t = s.slice, u, v = function (a, c, d, e) { var h, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body"); if (parseInt(d, 10)) while (d--) j = b.createElement("div"), j.id = e ? e[d] : g + (d + 1), k.appendChild(j); return h = ["&#173;", '<style id="s', g, '">', a, "</style>"].join(""), k.id = g, (l ? k : m).innerHTML += h, m.appendChild(k), l || (m.style.background = "", f.appendChild(m)), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i }, w = {}.hasOwnProperty, x; !A(w, "undefined") && !A(w.call, "undefined") ? x = function (a, b) { return w.call(a, b) } : x = function (a, b) { return b in a && A(a.constructor.prototype[b], "undefined") }, Function.prototype.bind || (Function.prototype.bind = function (b) { var c = this; if (typeof c != "function") throw new TypeError; var d = t.call(arguments, 1), e = function () { if (this instanceof e) { var a = function () { }; a.prototype = c.prototype; var f = new a, g = c.apply(f, d.concat(t.call(arguments))); return Object(g) === g ? g : f } return c.apply(b, d.concat(t.call(arguments))) }; return e }), p.canvas = function () { var a = b.createElement("canvas"); return !!a.getContext && !!a.getContext("2d") }, p.opacity = function () { return z("opacity:.55"), /^0.55$/.test(i.opacity) }, p.csstransforms = function () { return !!E("transform") }, p.csstransforms3d = function () { var a = !!E("perspective"); return a && "webkitPerspective" in f.style && v("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}", function (b, c) { a = b.offsetLeft === 9 && b.offsetHeight === 3 }), a }, p.csstransitions = function () { return E("transition") }; for (var F in p) x(p, F) && (u = F.toLowerCase(), e[u] = p[F](), s.push((e[u] ? "" : "no-") + u)); return e.addTest = function (a, b) { if (typeof a == "object") for (var d in a) x(a, d) && e.addTest(d, a[d]); else { a = a.toLowerCase(); if (e[a] !== c) return e; b = typeof b == "function" ? b() : b, enableClasses && (f.className += " " + (b ? "" : "no-") + a), e[a] = b } return e }, y(""), h = j = null, e._version = d, e._prefixes = l, e._domPrefixes = o, e._cssomPrefixes = n, e.testProp = function (a) { return C([a]) }, e.testAllProps = E, e.testStyles = v, e }(window, window.document);
//#endregion

;var WxMap;!function(a){function b(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)});return a}function c(a,b){if(a.getInterfaces)for(var c=a.getInterfaces(),d=0,e=c.length;e>d;d++){var f=c[d];if(f===b)return!0}return!1}function d(a,b){return-1!=a.constructor.toString().indexOf(b)}function e(a,b,c,d){var e=d||!1;a.addEventListener?a.addEventListener(b,c,e):(a["e"+b+c]=c,a[b+c]=function(){var d=window.event;try{d.target=a,a["e"+b+c](d)}catch(e){}},a.attachEvent("on"+b,a[b+c]))}function f(a,b,c,d){var e=d||!1;a.removeEventListener?a.removeEventListener(b,c,e):a[b+c]&&(a.detachEvent("on"+b,a[b+c]),a[b+c]=null)}function g(a,b){for(var c=(Array.prototype.slice.call(arguments).splice(2),a.split(".")),d=c.pop(),e=0;e<c.length;e++)b=b[c[e]];return b[d]}function h(b,c,d){var e=a.deriveFunctionFromName(b,c);return e.apply(this,d)}function i(a,b){for(var c=0;c<a.length;c++)b.call(a,a[c],c)}!function(a){a[a.Enabled=0]="Enabled",a[a.Disabled=1]="Disabled"}(a.Capability||(a.Capability={}));a.Capability;!function(a){a[a.Past=0]="Past",a[a.Present=1]="Present",a[a.Future=2]="Future"}(a.TimeMode||(a.TimeMode={}));a.TimeMode;!function(a){a[a.January=1]="January",a[a.February=2]="February",a[a.March=3]="March",a[a.April=4]="April",a[a.May=5]="May",a[a.June=6]="June",a[a.July=7]="July",a[a.August=8]="August",a[a.September=9]="September",a[a.October=10]="October",a[a.November=11]="November",a[a.December=12]="December"}(a.Months||(a.Months={}));a.Months;!function(a){a[a.Bmp=0]="Bmp",a[a.Gif=1]="Gif",a[a.Jpeg=2]="Jpeg",a[a.Png=3]="Png",a[a.Tiff=4]="Tiff"}(a.ImageFormat||(a.ImageFormat={}));a.ImageFormat;!function(a){a[a.None=0]="None",a[a.Normal=1]="Normal",a[a.Verbose=2]="Verbose"}(a.TraceMode||(a.TraceMode={}));a.TraceMode;!function(a){a[a.Down=0]="Down",a[a.None=1]="None",a[a.Up=2]="Up"}(a.VerticalDirection||(a.VerticalDirection={}));a.VerticalDirection;!function(a){a[a.Left=0]="Left",a[a.None=1]="None",a[a.Right=2]="Right"}(a.HorizontalDirection||(a.HorizontalDirection={}));a.HorizontalDirection;!function(a){a[a.Slow=0]="Slow",a[a.Normal=1]="Normal",a[a.Fast=2]="Fast",a[a.Custom=3]="Custom"}(a.PlayRate||(a.PlayRate={}));a.PlayRate;!function(a){a[a.Mouse=0]="Mouse",a[a.Keyboard=1]="Keyboard",a[a.Touch=2]="Touch"}(a.InputDevice||(a.InputDevice={}));a.InputDevice;a.isClosing=!1,a.createGuid=b,a.hasInterface=c,a.isTypeOf=d,a.addEventListener=e,a.removeEventListener=f,a.deriveFunctionFromName=g,a.executeFunctionFromName=h,a.forEach=i}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(a){this.value=a}return b.prototype.isDaylightSavings=function(){var a=function(a){var b=-a.getTimezoneOffset();return null!==b?b:0},b=function(a,b,c){var d=new Date;return void 0!==a&&d.setFullYear(a),d.setDate(c),d.setMonth(b),d},c=function(c){return a(b(c,0,2))},d=function(c){return a(b(c,5,2))},e=this.value.getMonth()>7?d(this.value.getFullYear()):c(this.value.getFullYear()),f=a(this.value);return e-f!==0},b.prototype.toFormatString=function(a){try{var b=a.match(/y{2,4}/),c=a.match(/M{1,4}/),d=a.match(/d{1,4}/g),e=a.match(/H{1,2}/),f=a.match(/h{1,2}/),g=a.match(/m{1,2}/),h=a.match(/s{1,2}/),i=a.match(/t{1,2}/),j=a.match(/z{1,4}/);if(b&&(a=a.replace(/y{2,4}/,"{0}")),c&&(a=a.replace(/M{1,4}/,"{1}")),d&&(a=a.replace(/d{1,4}/,"{2}"),a=a.replace(/d{1,4}/,"{3}")),(e||f)&&(a=a.replace(/h{1,2}/i,"{4}")),g&&(a=a.replace(/m{1,2}/,"{5}")),h&&(a=a.replace(/s{1,2}/,"{6}")),i&&(a=a.replace(/t{1,2}/,"{7}")),j&&(a=a.replace(/z{1,4}/,"{8}")),b&&(a=a.replace("{0}",this.value.getFullYear())),c){var k=c[0],l=this.value.getMonth();switch(k.length){case 4:case 3:var m=["January","February","March","April","May","June","July","August","September","October","November","December"];a=3==k.length?a.replace("{1}",m[l].substring(0,3)):a.replace("{1}",m[l]);break;default:var n=l+1;2==k.length&&10>n&&(n="0"+n),a=a.replace("{1}",n)}}if(d)for(var o=this.value.getDate(),p=this.value.getDay(),q=[],r=0;r<d.length&&2>r;r++){var s=d[r],t=0==r?"{2}":"{3}";switch(s.length){case 4:case 3:0==q.length&&(q=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),a=4==s.length?a.replace(t,q[p]):a.replace(t,q[p].substring(0,3));break;default:2==s.length&&10>o&&(o="0"+o),a=a.replace(t,o)}}if(e){var u=e[0],v=this.value.getHours();2==u.length&&10>v&&(v="0"+v),a=a.replace("{4}",v),i&&(a=a.replace("{7}",""))}else if(f){var w=f[0],x=this.value.getHours(),y="AM";x>=12?(y="PM",12!=x&&(x-=12)):0==x&&(x=12),2==w.length&&10>x&&(x="0"+x),a=a.replace("{4}",x),i&&(a=a.replace("{7}",y))}if(g){var z=this.value.getMinutes();10>z&&(z="0"+z),a=a.replace("{5}",z)}if(h){var A=this.value.getSeconds();10>A&&(A="0"+A),a=a.replace("{6}",A)}if(j){var B,C=(new Date).toTimeString();B=C.indexOf("(")>=0?C.substring(C.indexOf("(")):"("+C.substring(C.lastIndexOf(" ")+1)+")",a=a.replace("{8}",B)}return a}catch(D){return this.toPrintString()}},b.prototype.toPrintString=function(){try{var b=new a.StringBuilder,c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return b.append(a.StringUtility.padLeft(this.value.getDate(),2)).append(" ").append(c[this.value.getMonth()]).append(" ").append(this.value.getFullYear()).append(" ").append(a.StringUtility.padLeft(this.value.getHours(),2)).append(":").append(a.StringUtility.padLeft(this.value.getMinutes(),2)).append(":").append(a.StringUtility.padLeft(this.value.getSeconds(),2)),b.toString()}catch(d){return"Invalid Date"}},b.prototype.toChronoString=function(){var b=new a.StringBuilder;return b.append(this.value.getFullYear()).append(a.StringUtility.padLeft((this.value.getMonth()+1).toString(),2)).append(a.StringUtility.padLeft(this.value.getDate().toString(),2)).append(a.StringUtility.padLeft(this.value.getHours().toString(),2)).append(a.StringUtility.padLeft(this.value.getMinutes().toString(),2)).append(a.StringUtility.padLeft(this.value.getSeconds().toString(),2)),b.toString()},b.prototype.toShortDateString=function(){var b=new a.StringBuilder;return b.append(this.value.getFullYear().toString()).append("-").append(a.StringUtility.padLeft((this.value.getMonth()+1).toString(),2)).append("-").append(a.StringUtility.padLeft(this.value.getDate().toString(),2)),b.toString()},b.prototype.toShortTimeString=function(){var b=new a.StringBuilder;return b.append(a.StringUtility.padLeft(this.value.getHours(),2)).append(":").append(a.StringUtility.padLeft(this.value.getMinutes(),2)).append(":").append(a.StringUtility.padLeft(this.value.getSeconds(),2)),b.toString()},b.prototype.toUTC=function(){var a=new Date(this.value.getUTCFullYear(),this.value.getUTCMonth(),this.value.getUTCDate(),this.value.getUTCHours(),this.value.getUTCMinutes(),this.value.getUTCSeconds(),this.value.getUTCMilliseconds());return a},b.prototype.toLocal=function(){var a=this.value.getTime(),b=6e4*(new Date).getTimezoneOffset()*-1,c=new Date(a+b);return c},b.parseChrono=function(a){var b=parseInt(a.substr(0,4)),c=parseInt(a.substr(4,2),10),d=parseInt(a.substr(6,2),10),e=parseInt(a.substr(8,2),10),f=parseInt(a.substr(10,2),10),g=parseInt(a.substr(12,2),10),h=new Date(b,c-1,d,e,f,g,0);return h},b.utcFromNow=function(){var a=new Date,c=new b(a);return c.toUTC()},b.min=new Date(1e3,0,1,0,0,0),b.max=new Date(9999,11,31,23,59,59,999),b}();a.DateTime=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(){this.callback=null,this.thisContext=null,this.includeSender=null}return a}(),c=function(){function c(){this._listeners=new Array}return c.prototype.trigger=function(b,c){for(var d=0;d<this._listeners.length;d++)try{var e=this._listeners[d];e.includeSender?e.callback.apply(e.thisContext,arguments):e.callback.call(null,c)}catch(f){a.Console.log("EventTriggerException: "+f+" at "+e.callback)}},c.prototype.addListener=function(a,c,d){void 0===d&&(d=!0),c||(c=a,a=null);var e=new b;return e.callback=c,e.thisContext=a,null!=d&&(e.includeSender=d),this._listeners.push(e),c},c.prototype.removeListener=function(a){for(var b,c=0,d=this._listeners.length;d>c;c++){var e=this._listeners[c];e.callback===a&&(b=c)}void 0!==b&&this._listeners.splice(b,1)},c.prototype.clearListeners=function(){this._listeners=[]},c.deriveSourceElement=function(a){var b;if(!a)var a=window.event;return a.target?b=a.target:a.srcElement&&(b=a.srcElement),3==b.nodeType&&(b=b.parentNode),b},c.cancel=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},c.addEventListener=function(a,b,c,d){var e=d||!1;a.addEventListener?a.addEventListener(b,c,e):(a["e"+b+c]=c,a[b+c]=function(){var d=window.event;try{d.target=a,a["e"+b+c](d)}catch(e){}},a.attachEvent("on"+b,a[b+c]))},c.removeEventListener=function(a,b,c,d){var e=d||!1;a.removeEventListener?a.removeEventListener(b,c,e):a[b+c]&&(a.detachEvent("on"+b,a[b+c]),a[b+c]=null)},c}();a.Event=c}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(){throw new Error("Static class cannot be instantiated")}return a.getIsAccelerated=function(){var a,b,c=!0,d=this.getAgent(),e=this.getPlatform();if(void 0===this._isAccelerated){if(b=this.getName(),a=this.getVersion(),e===this._windows||e===this._macintel||e===this._macppc||e===this._linux)if(b===this._ie)9>a&&(c=!1);else{a=parseInt(a);try{(b===this._chrome&&18>a||b===this._firefox&&4>a||b===this._safari&&5>a||b===this._opera&&12>a)&&(c=!1)}catch(f){}}/ipad|ipod|iphone/gi.test(d)&&(c=/OS [2-4]_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)||/CPU like Mac OS X/i.test(navigator.userAgent)?!1:!0),/android/gi.test(e)&&(c=!1),this._isAccelerated=c}return this._isAccelerated},a.getVersion=function(){var a,b,c;if(this._version)return this._version;if(a=this.isIE(),b=navigator,a)this._version=this.getInternetExplorerVersion().toString();else if(c=this.getName(),c===this._chrome||this._name===this._android)this._version=b.appVersion.split(" "),this._version=this._version.slice(this._version.length-2,this._version.length-1),this._version=this._version.toString(),this._version=this._version.replace("Chrome/","");else if(c===this._safari)this._version=b.appVersion.split(" "),this._version=this._version.slice(this._version.length-2,this._version.length-1),this._version=this._version.toString(),this._version=this._version.replace("Version/","");else if(c===this._firefox)this._version=b.userAgent.split(" "),this._version=this._version.slice(this._version.length-1),this._version=this._version.toString(),this._version=this._version.replace("Firefox/","");else if(c===this._opera)if(/opr/gi.test(b.userAgent)){this._version=b.userAgent.split(" ");for(var d=this._version.length;d>0;d--)if(/opr/i.test(this._version[d])){this._version=this._version[d];break}this._version=this._version.replace("OPR/","")}else this._version=b.userAgent.split(" "),this._version=this._version.slice(this._version.length-1),this._version=this._version.toString(),this._version=this._version.replace("Version/","");else c===this._ipad?(this._version=b.userAgent.split(" "),this._version=this._version.slice(this._version.length-3,this._version.length-2),this._version=this._version.toString(),this._version=this._version.replace("Version/","")):c===this._iphone?(this._version=b.userAgent.split(" "),this._version=this._version.slice(this._version.length-3,this._version.length-2),this._version=this._version.toString(),this._version=this._version.replace("Version/","")):this._version=b.appVersion;return this._version},a.getName=function(){var a=this.isIE(),b=navigator,c=b.appVersion,d=b.userAgent;return this._name?this._name:(a?this._name=this._ie:/chrome/gi.test(c)?/opr/gi.test(c)?this._name=this._opera:this._name=this._chrome:/safari/gi.test(c)?/ipad/gi.test(d)?this._name=this._ipad:/iphone/gi.test(d)?this._name!==this._ipad&&(this._name=this._iphone):this._name=this._safari:/firefox/gi.test(d)?this._name=this._firefox:/opera|opr/gi.test(d)?this._name=this._opera:/ipad/gi.test(d)?this._name=this._ipad:/iphone/gi.test(d)?this._name!==this._ipad&&(this._name=this._iphone):/android/gi.test(d)?this._name=this._android:this._name=b.appName,this._name)},a.getPlatform=function(){return navigator.platform},a.getAgent=function(){return navigator.userAgent},a.getStylePrefix=function(){if(void 0===this._stylePrefix){var a=this.getName();switch(a){case"Microsoft Internet Explorer":this._stylePrefix="ms";break;case"Opera":this._stylePrefix="o";break;case"FireFox":this._stylePrefix="moz";break;case"Chrome":case"Safari":this._stylePrefix="webkit";break;default:this._stylePrefix=""}}return this._stylePrefix},a.getInternetExplorerVersion=function(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return a},a.isIE=function(){if("Microsoft Internet Explorer"==navigator.appName)return!0;if(void 0===this._isIE){for(var a=-1,b=document.createElement("b");b.innerHTML="<!--[if gt IE "+ ++a+"]>1<![endif]-->",+b.innerHTML;);this._isIE=1===a}return this._isIE},a._ie="Microsoft Internet Explorer",a._chrome="Chrome",a._safari="Safari",a._firefox="Firefox",a._opera="Opera",a._ipad="iPad",a._iphone="iPhone",a._android="Android",a._windows="Win32",a._macppc="MacPPC",a._macintel="MacIntel",a._linux="Linux i686",a.hasCanvas=Modernizr.canvas,a._ctor=function(){if(XMLHttpRequest){var b=new XMLHttpRequest;"withCredentials"in b?a.hasCors=!0:"undefined"!=typeof XDomainRequest?a.hasCors=!0:a.hasCors=!1}else a.hasCors=!1;return null}(),a}();a.Browser=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(){}return a.prototype.compareTo=function(a){return-1},a.prototype.isLessThan=function(a){return-1==this.compareTo(a)},a.prototype.isLessThanOrEqual=function(a){return 1!=this.compareTo(a)},a.prototype.isGreaterThan=function(a){return 1==this.compareTo(a)},a.prototype.isGreaterThanOrEqual=function(a){return-1!=this.compareTo(a)},a.prototype.equals=function(a){return null==a?!1:0==this.compareTo(a)},a.prototype.notEquals=function(a){return!this.equals(a)},a}();a.Comparable=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(){}return b.log=function(a,b,c){void 0===c&&(c=!1);try{!c&&window.console&&(b?console.log(a,b):console.log(a))}catch(d){alert(d)}var e={message:a.toString(),optionalParams:b};this.logged.trigger(this,e)},b.warn=function(a,b,c){void 0===c&&(c=!1);try{!c&&window.console&&(b?console.warn(a,b):console.warn(a))}catch(d){alert(d)}var e={message:a,optionalParams:b};this.warned.trigger(this,e)},b.error=function(a,b,c,d){void 0===d&&(d=!1);var e=b||"",f=a.message||a,g=f+e;try{!d&&window.console&&(c?console.error(g,c):console.error(g))}catch(h){alert(h)}var i={error:a,message:g,optionalParams:c};this.errored.trigger(this,i)},b.onWindowError=function(a){var c="";for(var d in a)c=c+d+"; ";b.log(a.message,null,!0)},b.logged=new a.Event,b.warned=new a.Event,b.errored=new a.Event,b._ctor=function(){return window.addEventListener?window.addEventListener("error",function(a){b.onWindowError(a)},!1):window.attachEvent&&window.attachEvent("onError",function(a){b.onWindowError(a)}),null}(),b}();a.Console=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(){throw new Error("Static class cannot be instantiated")}return a.logBase=function(a,b){return Math.log(a)/Math.log(b)},a.sign=function(a){return"number"!=typeof a?Number.NaN:a>0?1:1>a?-1:0},a}();a.MathUtility=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(){throw new Error("Static class cannot be instantiated")}return a.createCorsRequest=function(b,c,d){if(!XMLHttpRequest)return null;var e=new XMLHttpRequest;return"withCredentials"in e?e.open(b,c,d):"undefined"!=typeof XDomainRequest?(e=new XDomainRequest,e.open(b,c)):e=null,a.requestPool[c]=e,null!==e&&(e.onabort=function(){},e.onerror=function(){},e.onload=function(){},e.onloadend=function(){},e.onloadstart=function(){},e.onprogress=function(){},e.onreadystatechange=function(){},e.ontimeout=function(){}),e},a.createAjaxRequest=function(a,b){if(!XMLHttpRequest)return null;var c=new XMLHttpRequest;return c.open(a,b),null!==c&&(c.onabort=function(){},c.onerror=function(){},c.onload=function(){},c.onloadend=function(){},c.onloadstart=function(){},c.onprogress=function(){},c.onreadystatechange=function(){},c.ontimeout=function(){}),c},a.createPaddedRequest=function(a,b){var c={};return c.url=a,c.jsonp=b,c.send=function(){var a,b=document.getElementsByTagName("head")[0],d="__wxMap"+"xxxxxx_xxxxxx4xxxyx_xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)});window[d]=function(){c.callback(arguments[0])};var e=this.url+(this.url.indexOf("?")>=0?"&":"?")+this.jsonp+"="+d;a=document.createElement("script"),a.async=!0,a.src=e,a.onload=a.onreadystatechange=function(b,c){(c||!a.readyState||/loaded|complete/.test(a.readyState))&&(a.onload=a.onreadystatechange=null,a.parentNode&&a.parentNode.removeChild(a),a=null)},b.insertBefore(a,b.firstChild)},c.abort=function(){throw new Error("Abort not yet created")},c.callback=function(){},c},a.requestPool={},a}();a.Net=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},a.prototype.toString=function(){return[this.x,this.y].join()},a}();a.Point=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(a,b){this.width=a,this.height=b}return b.prototype.round=function(){this.width=Math.round(this.width),this.height=Math.round(this.height)},b.prototype.toString=function(){var b=new a.StringBuilder;return b.append(this.width),b.append("w x "),b.append(this.height),b.append("h"),b.toString()},b}();a.Size=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a){void 0===a&&(a=""),this.layers={},this.layerOrder=null,this.basemap=null,this.animation=null,this.location=null,this.scale=null,this.opacity=null,this.id=a}return a}();a.MapState=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.periodPerFrame=null,this.totalFrames=null,this.currentFrame=null,this.playRate=null,this.isSliding=null,this.dwell=null,this.enableLooping=null}return a}();a.AnimationState=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(){throw new Error("Static class cannot be instantiated")}return b.setMapNamespace=function(a){var c=b._savedMapsKey,d=a+c,e=a+c+b._versionKey;b._mapKey=a+b._savedMapsKey+b._versionKey;var f=b.retrieve(e)||b.retrieve(d)||b.retrieve(c)||[];b.sanitizeMaps(f);b.save(e,f),b.savedMaps=f},b.sanitizeMaps=function(a){for(var c,d,e=0,f=a.length,g=!1;f>e;e++)d=a[e],(!d||void 0==d.id&&null==d.id||d.Id)&&(g=!0,c=b.sanitizeMap(d),a[e]=c);return g},b.sanitizeMap=function(b){var c;if(b&&(void 0!=b.id||null!=b.id)&&!b.Id)return b;c=new a.Client.MapState(b.Id);for(var d in b.Layers)c.layers[d]={opacity:b.Layers[d].Opacity};return c.layerOrder=b.LayerOrder,c.basemap=b.Basemap,c.animation=new a.Client.AnimationState,c.animation.periodPerFrame=b.Animation.PeriodPerFrame,c.animation.totalFrames=b.Animation.TotalFrames,c.animation.currentFrame=b.Animation.CurrentFrame,c.animation.playRate=b.Animation.PlayRate,c.animation.isSliding=b.Animation.IsSliding,c.animation.dwell=b.Animation.Dwell,c.animation.enableLooping=b.Animation.EnableLooping,c.location={},c.location.latitude=b.Location.Latitude,c.location.longitude=b.Location.Longitude,c.scale=b.Scale,c.opacity=b.Opacity,c},b.save=function(a,c){var d=JSON.stringify(c);return b._cache.setItem(a,d)},b.retrieve=function(a){if(null===b._cache)return null;var c=b._cache.getItem(a);if(!c)return null;var d=JSON.parse(c);return d},b.remove=function(a){return b._cache.removeItem(a)},b.saveMap=function(a,c){c.id=a,b.savedMaps.push(c),b.save(b._mapKey,b.savedMaps)},b.retrieveMapIndex=function(a){var c=b.savedMaps,d=-1;if(null===c)return null;for(var e=0,f=c.length;f>e;e++)c[e].id===a&&(d=e);return d},b.retrieveMap=function(a){var c=b.savedMaps,d=b.retrieveMapIndex(a);return c[d]},b.retrieveMaps=function(){for(var a=[],c=0,d=b.savedMaps.length;d>c;c++){var e=b.savedMaps[c];/^\__[a-zA-Z]/.test(e.id)||a.push(e)}return a},b.removeMap=function(a){var c=b.retrieveMapIndex(a);b.savedMaps.splice(c,1),b.save(b._mapKey,b.savedMaps)},b.moveMap=function(a,c){for(var d=b.savedMaps,e=c,f=b.retrieveMap(a)[1];0>f;)f+=d.length;for(;0>e;)e+=d.length;if(e>=d.length)throw{name:"IndexOutOfBoundsException",message:"Index: "+c+" is beyond the bounds of the Saved Maps array"};d.splice(e,0,d.splice(f,1)[0])},b.moveMapUp=function(a){var c=b.retrieveMap(a)[1];b.moveMap(a,c++)},b.moveMapDown=function(a){var c=b.retrieveMap(a)[1];b.moveMap(a,c--)},b._savedMapsKey="__savedMaps",b._versionKey="__v3.5",b.savedMaps=new Array,b.isEnabled=!0,b._ctor=function(){try{if(!window.localStorage){var a=window.escape,c=window.unescape;window.browserStorage={getItem:function(b){return b&&this.hasOwnProperty(b)?c(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+a(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},key:function(a){return c(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[a])},setItem:function(b,c){b&&(document.cookie=a(b)+"="+a(c)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.length=document.cookie.match(/\=/g).length)},length:0,removeItem:function(b){b&&this.hasOwnProperty(b)&&(document.cookie=a(b)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--)},hasOwnProperty:function(b){return new RegExp("(?:^|;\\s*)"+a(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length}}catch(d){}try{var e=new Date;e.setTime(e.getTime()+2500),document.cookie="test=test; expires="+e.toUTCString()+"; path=/",""===document.cookie?b.isEnabled=!1:b.isEnabled=!0,b._cache=window.localStorage||window.browserStorage,b._mapKey=b._savedMapsKey+b._versionKey;var f=b.retrieve(b._mapKey);if(f)b.savedMaps=f;else if(f=b.retrieve(b._savedMapsKey)){b.sanitizeMaps(f);b.save(b._mapKey,f),b.savedMaps=f}}catch(d){b._cache=null,b.isEnabled=!1}return null}(),b}();a.Storage=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function a(a){return this._strings=new Array(""),this.append(a)}return a.prototype.append=function(a){if(void 0!=a&&null!=a)if("string"==typeof a)this._strings.push(a);else try{this._strings.push(a.toString())}catch(b){}return this},a.prototype.clear=function(){this._strings.length=1},a.prototype.toString=function(){return this._strings.join("")},a}();a.StringBuilder=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(){throw new Error("Static class cannot be instantiated")}return b.padLeft=function(b,c,d){void 0===d&&(d="0");try{for(var e=""+b;e.length<c;)e=d+e;return e}catch(f){a.Console.log(f)}},b.isDefined=function(a){return void 0!=a&&null!=a&&""!=a},b.format=function(a,c,d,e){var f=arguments;return a.replace(/(\{+)((\d+|[a-zA-Z_$]\w+(?:\.[a-zA-Z_$]\w+|\[\d+\])*)(?:\,(-?\d*))?(?:\:([^\}]*))?)(\}+)|(\{+)|(\}+)/g,function(){var a=arguments;return a[7]?b.unescapeBraces(a[7]):a[8]?b.unescapeBraces(a[8]):a[1].length%2==0||a[6].length%2==0?b.unescapeBraces(a[1])+a[2]+b.unescapeBraces(a[6]):b.unescapeBraces(a[1],1)+b.processFormatItem(a[3],a[4],a[5],f)+b.unescapeBraces(a[6],1)})},b.unescapeBraces=function(a,b){return a.substr(0,(a.length+1-(b||0))/2)},b.processFormatItem=function(a,c,d,e){var f,g,h=parseInt(a,10),i="";if(isNaN(h))f=b.resolvePath(a,e[1]);else{if(h>e.length-2)throw"Missing argument";f=e[h+1]}for(f=b.hasValue(f)?f.__Format?f.__Format(d):""+f:"",c=Number(c)||0,g=Math.abs(c)-f.length;g-->0;)i+=" ";return 0>c?f+i:i+f},b.resolvePath=function(a,c){if(b.hasValue(c)){var d=/(\.([a-zA-Z_$]\w+)|\[(\d+)\])/g,e=/^[a-zA-Z_$]\w+/.exec(a);for(c=c[e[0]];b.hasValue(c)&&(e=d.exec(a));)c=c[e[2]||Number(e[3])]}return c},b.hasValue=function(a){return null!==a&&void 0!==a},b}();a.StringUtility=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b=function(){function b(a,b,c,d,e){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),this._msPerSecond=1e3,this._msPerMinute=6e4,this._msPerHour=36e5,this._msPerDay=864e5,this._milliseconds=0,this._milliseconds+=e*this._msPerDay,this._milliseconds+=d*this._msPerHour,this._milliseconds+=c*this._msPerMinute,this._milliseconds+=b*this._msPerSecond,this._milliseconds+=a}return b.prototype.getTotalMilliseconds=function(a){var b=this._milliseconds;return a===!0&&(b=this._milliseconds>0?Math.floor(b):Math.ceil(b)),b},b.prototype.getTotalSeconds=function(a){var b=this._milliseconds/this._msPerSecond;return a===!0&&(b=this._milliseconds>0?Math.floor(b):Math.ceil(b)),b},b.prototype.getTotalMinutes=function(a){var b=this._milliseconds/this._msPerMinute;return a===!0&&(b=this._milliseconds>0?Math.floor(b):Math.ceil(b)),b},b.prototype.getTotalHours=function(a){var b=this._milliseconds/this._msPerHour;return a===!0&&(b=this._milliseconds>0?Math.floor(b):Math.ceil(b)),b},b.prototype.getTotalDays=function(a){var b=this._milliseconds/this._msPerDay;return a===!0&&(b=this._milliseconds>0?Math.floor(b):Math.ceil(b)),b},b.prototype.getMilliseconds=function(){return this._milliseconds%1e3},b.prototype.getSeconds=function(){var a=this._milliseconds>0?Math.floor(this._milliseconds/this._msPerSecond):Math.ceil(this._milliseconds/this._msPerSecond),b=a%60;return b},b.prototype.getMinutes=function(){var a=this._milliseconds>0?Math.floor(this._milliseconds/this._msPerMinute):Math.ceil(this._milliseconds/this._msPerMinute),b=a%60;return b},b.prototype.getHours=function(){var a=this._milliseconds>0?Math.floor(this._milliseconds/this._msPerHour):Math.ceil(this._milliseconds/this._msPerHour),b=a%24;return b},b.prototype.getDays=function(){var a=this._milliseconds>0?Math.floor(this._milliseconds/this._msPerDay):Math.ceil(this._milliseconds/this._msPerDay),b=a%24;return b},b.prototype.addMilliseconds=function(a){this._milliseconds+=a},b.prototype.addSeconds=function(a){this._milliseconds+=a*this._msPerSecond},b.prototype.addMinutes=function(a){this._milliseconds+=a*this._msPerMinute},b.prototype.addHours=function(a){this._milliseconds+=a*this._msPerHour},b.prototype.addDays=function(a){this._milliseconds+=a*this._msPerDay},b.prototype.subtractMilliseconds=function(a){this._milliseconds-=a},b.prototype.subtractSeconds=function(a){this._milliseconds-=a*this._msPerSecond},b.prototype.subtractMinutes=function(a){this._milliseconds-=a*this._msPerMinute},b.prototype.subtractHours=function(a){this._milliseconds-=a*this._msPerHour},b.prototype.subtractDays=function(a){this._milliseconds-=a*this._msPerDay},b.prototype.add=function(a){this._milliseconds+=a.getTotalMilliseconds()},b.prototype.subtract=function(a){this._milliseconds-=a.getTotalMilliseconds()},b.prototype.equals=function(a){return this._milliseconds===a.getTotalMilliseconds()},b.prototype.toString=function(){var b=this.getDays(),c=this.getHours(),d=this.getMinutes(),e=this.getSeconds(),f=this.getMilliseconds(),g=new a.StringBuilder;return g.append(b).append(".").append(c).append(":").append(d).append(":").append(e).append(":").append(f),g.toString()},b.fromSeconds=function(b){return new a.TimeSpan(0,b,0,0,0)},b.fromMinutes=function(b){return new a.TimeSpan(0,0,b,0,0)},b.fromHours=function(b){return new a.TimeSpan(0,0,0,b,0)},b.fromDays=function(b){return new a.TimeSpan(0,0,0,0,b)},b.fromDates=function(b,c,d){var e=c.valueOf()-b.valueOf();return d===!0&&(e=Math.abs(e)),new a.TimeSpan(e,0,0,0,0)},b.max=new b(Number.MAX_VALUE,0,0,0,0),b.min=new b(0,0,0,0,0),b.zero=new b(0,0,0,0,0),b}();a.TimeSpan=b}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){!function(a){a[a.Identity=0]="Identity",a[a.Translation=1]="Translation",a[a.Scaling=2]="Scaling",a[a.Unknown=4]="Unknown"}(a.MatrixTypes||(a.MatrixTypes={}));a.MatrixTypes}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(a,c,d,e,f,g){void 0===a&&(a=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0),this._m11=0,this._m12=0,this._m21=0,this._m22=0,this._offsetX=0,this._offsetY=0,this._matrixType=b.MatrixTypes.Identity,this._m11=a,this._m12=c,this._m21=d,this._m22=e,this._offsetX=f,this._offsetY=g,(a||c||d||e||f||g)&&this.deriveMatrixType()}return c.prototype.getDeterminant=function(){switch(this._matrixType){case b.MatrixTypes.Identity:case b.MatrixTypes.Translation:return 1;case b.MatrixTypes.Scaling:case b.MatrixTypes.Translation|b.MatrixTypes.Scaling:return this._m11*this._m22;default:return this._m11*this._m22-this._m12*this._m21}},c.prototype.getHasInverse=function(){var a=this.getDeterminant();return!this.isZero(a)},c.prototype.setMatrix=function(a,b,c,d,e,f,g){this._m11=a,this._m12=b,this._m21=c,this._m22=d,this._offsetX=e,this._offsetY=f,this._matrixType=g},c.prototype.getM11=function(){return this._matrixType===b.MatrixTypes.Identity?1:this._m11},c.prototype.setM11=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(a,0,0,1,0,0,b.MatrixTypes.Scaling):(this._m11=a,void(this._matrixType!=b.MatrixTypes.Unknown&&(this._matrixType|=b.MatrixTypes.Scaling)))},c.prototype.getM12=function(){return this._matrixType===b.MatrixTypes.Identity?0:this._m12},c.prototype.setM12=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,a,0,1,0,0,b.MatrixTypes.Unknown):(this._m12=a,void(this._matrixType=b.MatrixTypes.Unknown))},c.prototype.getM21=function(){return this._matrixType===b.MatrixTypes.Identity?0:this._m21},c.prototype.setM21=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,0,a,1,0,0,b.MatrixTypes.Unknown):(this._m21=a,void(this._matrixType=b.MatrixTypes.Unknown))},c.prototype.getM22=function(){return this._matrixType===b.MatrixTypes.Identity?1:this._m22},c.prototype.setM22=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,0,0,a,0,0,b.MatrixTypes.Scaling):(this._m22=a,void(this._matrixType!=b.MatrixTypes.Unknown&&(this._matrixType|=b.MatrixTypes.Scaling)))},c.prototype.getOffsetX=function(){return this._matrixType===b.MatrixTypes.Identity?0:this._offsetX},c.prototype.setOffsetX=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,0,0,1,a,0,b.MatrixTypes.Translation):(this._offsetX=a,void(this._matrixType!=b.MatrixTypes.Unknown&&(this._matrixType|=b.MatrixTypes.Translation)))},c.prototype.getOffsetY=function(){return this._matrixType===b.MatrixTypes.Identity?0:this._offsetY},c.prototype.setOffsetY=function(a){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,0,0,1,0,a,b.MatrixTypes.Translation):(this._offsetY=a,void(this._matrixType!=b.MatrixTypes.Unknown&&(this._matrixType=this._matrixType|b.MatrixTypes.Translation)))},c.prototype.getMatrixType=function(){return this._matrixType},c.prototype.setMatrixType=function(a){this._matrixType=a},c.prototype.isZero=function(a){return Math.abs(a)<2.220446049250313e-15},c.prototype.multiplyPoint=function(a){var c=a.x,d=a.y;switch(this._matrixType){case b.MatrixTypes.Identity:return a;case b.MatrixTypes.Translation:c+=this._offsetX,d+=this._offsetY;break;case b.MatrixTypes.Scaling:c*=this._m11,d*=this._m22;break;case b.MatrixTypes.Translation|b.MatrixTypes.Scaling:c*=this._m11,c+=this._offsetX,d*=this._m22,d+=this._offsetY;break;default:var e=d*this._m21+this._offsetX,f=c*this._m12+this._offsetY;c*=this._m11,c+=e,d*=this._m22,d+=f}a.x=c,a.y=d},c.prototype.deriveMatrixType=function(){return this._matrixType=b.MatrixTypes.Identity,0!=this._m21||0!=this._m12?void(this._matrixType=b.MatrixTypes.Unknown):((1!=this._m11||1!=this._m22)&&(this._matrixType=b.MatrixTypes.Scaling),(0!=this._offsetX||0!=this._offsetY)&&(this._matrixType|=b.MatrixTypes.Translation),void((this._matrixType&(b.MatrixTypes.Translation|b.MatrixTypes.Scaling))===b.MatrixTypes.Identity&&(this._matrixType=b.MatrixTypes.Identity)));
},c.prototype.isIdentity=function(){return this._matrixType===b.MatrixTypes.Identity||1===this._m11&&0===this._m12&&0===this._m21&&1===this._m22&&0===this._offsetX&&0===this._offsetY},c.prototype.invert=function(){var a=this.getDeterminant();if(this.isZero(a))throw{name:"InvalidOperationException",message:"TransformNotInvertible"};switch(this._matrixType){case b.MatrixTypes.Identity:break;case b.MatrixTypes.Translation:return this._offsetX=-this._offsetX,void(this._offsetY=-this._offsetY);case b.MatrixTypes.Scaling:return this._m11=1/this._m11,void(this._m22=1/this._m22);case b.MatrixTypes.Translation|b.MatrixTypes.Scaling:return this._m11=1/this._m11,this._m22=1/this._m22,this._offsetX=-this._offsetX*this._m11,void(this._offsetY=-this._offsetY*this._m22);default:var c=1/a;this.setMatrix(this._m22*c,-this._m12*c,this._m21*c,this._m11*c,(this._m21*this._offsetY-this._offsetX*this._m22)*c,(this._offsetX*this._m12-this._m11*this._offsetY)*c,b.MatrixTypes.Unknown)}},c.prototype.multiply=function(a){var c=this._matrixType,d=a.getMatrixType();if(d!==b.MatrixTypes.Identity){if(c===b.MatrixTypes.Identity)return void this.setMatrix(a.getM11(),a.getM12(),a.getM21(),a.getM22(),a.getOffsetX(),a.getOffsetY(),a.getMatrixType());if(d===b.MatrixTypes.Translation)return this._offsetX+=a.getOffsetX(),this._offsetY+=a.getOffsetY(),void(c!=b.MatrixTypes.Unknown&&(this._matrixType|=b.MatrixTypes.Unknown));if(c!=b.MatrixTypes.Translation){var e=Math.round(Math.round(c)<<4|d),f=e;switch(f){case 34:return this._m11*=a.getM11(),void(this._m22*=a.getM22());case 35:return this._m11*=a.getM11(),this._m22*=a.getM22(),this._offsetX=a.getOffsetX(),this._offsetY=a.getOffsetY(),void(this._matrixType=b.MatrixTypes.Translation|b.MatrixTypes.Scaling);case 36:break;default:switch(f){case 50:return this._m11*=a.getM11(),this._m22*=a.getM22(),this._offsetX*=a.getM11(),void(this._offsetY*=a.getM22());case 51:return this._m11*=a.getM11(),this._m22*=a.getM22(),this._offsetX=a.getM11()*this._offsetX+a.getOffsetX(),void(this._offsetY=a.getM22()*this._offsetY+a.getOffsetY());case 52:break;default:switch(f){case 66:case 67:case 68:break;default:return}}}return this.setMatrix(this._m11*a.getM11()+this._m12*a.getM21(),this._m11*a.getM12()+this._m12*a.getM22(),this._m21*a.getM11()+this._m22*a.getM21(),this._m21*a.getM12()+this._m22*a.getM22(),this._offsetX*a.getM11()+this._offsetY*a.getM21()+a.getOffsetX(),this._offsetX*a.getM12()+this._offsetY*a.getM22()+a.getOffsetY(),b.MatrixTypes.Identity),void this.deriveMatrixType()}var g=this._offsetX,h=this._offsetY;return this.setMatrix(a.getM11(),a.getM12(),a.getM21(),a.getM22(),a.getOffsetX(),a.getOffsetY(),a.getMatrixType()),this._offsetX=g*a.getM11()+h*a.getM21()+a.getOffsetX(),this._offsetY=g*a.getM12()+h*a.getM22()+a.getOffsetY(),d===b.MatrixTypes.Unknown?void(this._matrixType=b.MatrixTypes.Unknown):void(this._matrixType=b.MatrixTypes.Translation|b.MatrixTypes.Scaling)}},c.prototype.translate=function(a,c){return this._matrixType===b.MatrixTypes.Identity?void this.setMatrix(1,0,0,1,a,c,b.MatrixTypes.Translation):this._matrixType===b.MatrixTypes.Unknown?(this._offsetX+=a,void(this._offsetY+=c)):(this._offsetX+=a,this._offsetY+=c,void(this._matrixType|=b.MatrixTypes.Translation))},c.prototype.tranformPoint=function(b){var c=new a.Point(b.x,b.y);return this.multiplyPoint(c),c},c.prototype.transformPoints=function(a){for(var b=0,c=a.length;c>b;b++)this.multiplyPoint(a[b])},c.prototype.rotateAt=function(a,b,d){a%=360;var e=c.createRotationRadians(.017453292519943295*a,b,d);this.multiply(e)},c.prototype.scaleAt=function(a,b,d,e){var f=c.createScaling(a,b,d,e);this.multiply(f)},c.prototype.toString=function(){return this.isIdentity()?"Identity":[this._m11,this._m12,this._m21,this._m22,this._offsetX,this._offsetY].join()},c.createIdentity=function(){var a=new c;return a.setMatrix(1,0,0,1,0,0,b.MatrixTypes.Identity),a},c.createRotationRadians=function(a,d,e){var f=new c,g=Math.sin(a),h=Math.cos(a),i=d*(1-h)+e*g,j=e*(1-h)-d*g;return f.setMatrix(h,g,-g,h,i,j,b.MatrixTypes.Unknown),f},c.createScaling=function(a,d,e,f){var g=new c;return g.setMatrix(a,0,0,d,e-a*e,f-d*f,b.MatrixTypes.Translation|b.MatrixTypes.Scaling),g},c}();b.Matrix=c}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a){this._matrix=a}return a.prototype.getInverse=function(){var b=this.getMatrix();return b.getHasInverse()?(b.invert(),new a(b)):null},a.prototype.getMatrix=function(){return this._matrix},a.prototype.transform=function(a){return this.getMatrix().tranformPoint(a)},a}();a.MatrixTransform=b}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),this.degrees=a,this.centerX=b,this.centerY=c}return b.prototype.getInverse=function(){var b=this.getMatrix();return b.getHasInverse()?(b.invert(),new a.MatrixTransform(b)):null},b.prototype.getMatrix=function(){var b=new a.Matrix;return b.rotateAt(this.degrees,this.centerX,this.centerY),b},b.prototype.transform=function(a){return this.getMatrix().tranformPoint(a)},b}();a.RotateTransform=b}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d){void 0===a&&(a=1),void 0===b&&(b=1),void 0===c&&(c=0),void 0===d&&(d=0),this.scaleX=a,this.scaleY=b,this.centerX=c,this.centerY=d}return b.prototype.getInverse=function(){var b=this.getMatrix();return b.getHasInverse()?(b.invert(),new a.MatrixTransform(b)):null},b.prototype.getMatrix=function(){var b=new a.Matrix;return b.scaleAt(this.scaleX,this.scaleY,this.centerX,this.centerY),b},b.prototype.getIsIdentity=function(){return 1===this.scaleX&&1===this.scaleY},b.prototype.transform=function(a){return this.getMatrix().tranformPoint(a)},b}();a.ScaleTransform=b}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){this.transforms=new Array}return b.prototype.getInverse=function(){var b=this.getMatrix();return b.getHasInverse()?(b.invert(),new a.MatrixTransform(b)):null},b.prototype.getMatrix=function(){if(null===this.transforms||0===this.transforms.length)return new a.Matrix;for(var b=this.transforms[0].getMatrix(),c=1,d=this.transforms.length;d>c;c++){var e=this.transforms[c],f=e.getMatrix();b.multiply(f)}return b},b.prototype.transform=function(a){return this.getMatrix().tranformPoint(a)},b}();a.TransformGroup=b}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.x=a,this.y=b}return b.prototype.getInverse=function(){var b=this.getMatrix();return b.getHasInverse()?(b.invert(),new a.MatrixTransform(b)):null},b.prototype.getMatrix=function(){var b=a.Matrix.createIdentity();return b.translate(this.x,this.y),b},b.prototype.transform=function(a){return this.getMatrix().tranformPoint(a)},b.prototype.getIsIdentity=function(){return 0===this.x&&0===this.y},b}();a.TranslateTransform=b}(b=a.Transforms||(a.Transforms={}))}(WxMap||(WxMap={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},WxMap;!function(a){var b;!function(b){var c=function(a){function b(b){void 0===b&&(b=0),a.call(this),this._radians=b}return __extends(b,a),b.prototype.getRadians=function(){return this._radians},b.prototype.setRadians=function(a){this._radians=a},b.prototype.getDegrees=function(){return b.radiansToDegrees(this._radians)},b.prototype.setDegrees=function(a){this._radians=b.degreesToRadians(a)},b.prototype.compareTo=function(a){return this._radians==a.getRadians()?0:this._radians<a.getRadians()?-1:1},b.fromRadians=function(a){return new b(a)},b.fromDegrees=function(a){var c=b.degreesToRadians(a);return new b(c)},b.degreesToRadians=function(a){return.017453292519943295*a},b.radiansToDegrees=function(a){return 57.29577951308232*a},b}(a.Comparable);b.Angle=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(a){function c(b){void 0===b&&(b=0),a.call(this),this._meters=b}return __extends(c,a),c.prototype.getMeters=function(){return this._meters},c.prototype.getMiles=function(){return this._meters*(1/1609.344)},c.prototype.getNauticalMiles=function(){return this._meters*(1/1852)},c.prototype.getKilometers=function(){return.001*this._meters},c.prototype.getFeet=function(){return this._meters*(1/.3048)},c.prototype.getYards=function(){return this._meters*(1/.9144)},c.prototype.compareTo=function(a){return this._meters==a.getMeters()?0:this._meters<a.getMeters()?-1:1},c.prototype.add=function(a){return new c(this._meters+a.getMeters())},c.prototype.subtract=function(a){return new c(this._meters-a.getMeters())},c.prototype.toAngularDistance=function(){return b.Angle.fromRadians(this._meters/b.Geo.meanEarthRadius.getMeters())},c.fromMeters=function(a){return new c(a)},c.fromMiles=function(a){return new c(1609.344*a)},c.fromNauticalMiles=function(a){return new c(1852*a)},c.fromKilometers=function(a){return new c(1e3*a)},c.fromFeet=function(a){return new c(.3048*a)},c.fromYards=function(a){return new c(.9144*a)},c}(a.Comparable);b.Distance=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(a){c.call(this),this._angle=a}return __extends(d,c),d.prototype.getRadians=function(){return this._angle.getRadians()},d.prototype.setRadians=function(a){this._angle.setRadians(a)},d.prototype.getDegrees=function(){return this._angle.getDegrees()},d.prototype.setDegrees=function(a){this._angle.setDegrees(a)},d.prototype.getAngle=function(){return this._angle},d.prototype.addAngle=function(a){return d.fromRadians(this.getRadians()+a.getRadians())},d.prototype.subtractAngle=function(a){return d.fromRadians(this.getRadians()-a.getRadians())},d.prototype.normalize=function(){var a=this.getRadians();a%=Math.PI,a<-b.Geo.piOverTwo&&(a=-Math.PI-a),a>b.Geo.piOverTwo&&(a=Math.PI-a),this.setRadians(a)},d.prototype.compareTo=function(a){return this._angle.compareTo(a.getAngle())},d.prototype.toString=function(){var b=this.getDegrees();if(NaN==b)return"NaN";var c=new a.StringBuilder;return c.append(Math.abs(b).toString()),b>=0?c.append("N"):c.append("S"),c.toString()},d.fromRadians=function(a){return new d(b.Angle.fromRadians(a))},d.fromDegrees=function(a){return new d(b.Angle.fromDegrees(a))},d}(a.Comparable);b.Latitude=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(a){c.call(this),this._angle=a}return __extends(d,c),d.prototype.getRadians=function(){return this._angle.getRadians()},d.prototype.setRadians=function(a){this._angle.setRadians(a)},d.prototype.getDegrees=function(){return this._angle.getDegrees()},d.prototype.setDegrees=function(a){this._angle.setDegrees(a)},d.prototype.getAngle=function(){return this._angle},d.prototype.addAngle=function(a){return d.fromRadians(this.getRadians()+a.getRadians())},d.prototype.subtractAngle=function(a){return d.fromRadians(this.getRadians()-a.getRadians())},d.prototype.normalize=function(){for(var a=this.getRadians();a<-Math.PI;)a+=2*Math.PI;for(;a>Math.PI;)a-=2*Math.PI;this.setRadians(a)},d.prototype.compareTo=function(a){return this._angle.compareTo(a.getAngle())},d.prototype.toString=function(){var b=this.getDegrees();if(NaN==b)return"NaN";var c=new a.StringBuilder;return c.append(Math.abs(b).toString()),b>=0?c.append("E"):c.append("W"),c.toString()},d.fromRadians=function(a){return new d(b.Angle.fromRadians(a))},d.fromDegrees=function(a){return new d(b.Angle.fromDegrees(a))},d}(a.Comparable);b.Longitude=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){throw new Error("Static class cannot be instantiated")}return c.getDistance=function(a,d){var e=a.longitude.getRadians(),f=a.latitude.getRadians(),g=d.longitude.getRadians(),h=d.latitude.getRadians(),i=h-f,j=g-e,k=Math.sin(i/2)*Math.sin(i/2)+Math.cos(f)*Math.cos(h)*Math.sin(j/2)*Math.sin(j/2),l=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),m=c.meanEarthRadius.getMeters()*l;return b.Distance.fromMeters(m)},c.getDestination=function(b,d,e){var f=b.longitude.getRadians(),g=b.latitude.getRadians(),h=d.getRadians(),i=e.getMeters()/c.earthRadiaus.getMeters(),j=Math.sin(g),k=Math.cos(g),l=Math.sin(i),m=Math.cos(i),n=Math.asin(j*m+k*l*Math.cos(h)),o=f+Math.atan2(Math.sin(h)*l*k,m-j*Math.sin(n));return a.Gis.GeoPoint.fromRadians(o,n)},c.rangeBearingToGeoPoint=function(b,d,e){var f,g,h=0-e.getRadians(),i=c.degreesToRadians*d,j=b.latitude.getRadians(),k=b.longitude.getRadians();if(f=Math.asin(Math.sin(j)*Math.cos(i)+Math.cos(j)*Math.sin(i)*Math.cos(h)),0===Math.cos(f))f=k;else{var l=0;l=k-Math.asin(a.MathUtility.sign(h)*Math.sin(i)/Math.cos(f))+Math.PI,g=l-2*Math.PI*Math.floor(l/(2*Math.PI))-Math.PI}return new a.Gis.GeoPoint(a.Gis.Longitude.fromRadians(g),a.Gis.Latitude.fromRadians(f))},c.earthRadiaus=b.Distance.fromMeters(6378137),c.rMajor=b.Distance.fromMeters(6378137),c.rMinor=b.Distance.fromMeters(6356752.3142),c.meanEarthRadius=b.Distance.fromMeters(6371009),c.ratio=c.rMinor.getMeters()/c.rMajor.getMeters(),c.eccent=Math.sqrt(1-c.ratio*c.ratio),c.com=.5*c.eccent,c.minimumLatitude=b.Latitude.fromDegrees(-85.05112878),c.maximumLatitude=b.Latitude.fromDegrees(85.05112878),c.minimumLongitude=b.Longitude.fromDegrees(-180),c.maximumLongitude=b.Longitude.fromDegrees(180),c.degreesToRadians=Math.PI/180,c.radiansToDegrees=180/Math.PI,c.piOverTwo=Math.PI/2,c.oneOverPi=1/Math.PI,c.epsilon=1e-9,c}();b.Geo=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(a,c,d,e){this.north=a||b.Latitude.fromDegrees(90),this.west=c||b.Longitude.fromDegrees(-180),this.south=d||b.Latitude.fromDegrees(-90),this.east=e||b.Longitude.fromDegrees(180)}return c.prototype.getHeight=function(){var a=this.north.subtractAngle(this.south.getAngle());return a.getAngle()},c.prototype.getHeightInDegrees=function(){return this.getHeight().getDegrees()},c.prototype.getWidth=function(){var a=this.east.subtractAngle(this.west.getAngle());return a.getAngle()},c.prototype.getWidthInDegrees=function(){return this.getWidth().getDegrees()},c.prototype.getCenterPoint=function(){return b.GeoPoint.fromRadians((this.west.getRadians()+this.east.getRadians())/2,(this.north.getRadians()+this.south.getRadians())/2)},c.prototype.getTopLeftGeoPoint=function(){return new b.GeoPoint(this.west,this.north)},c.prototype.getTopRightGeoPoint=function(){return new b.GeoPoint(this.east,this.north)},c.prototype.getBottomLeftGeoPoint=function(){return new b.GeoPoint(this.west,this.south)},c.prototype.getBottomRightGeoPoint=function(){return new b.GeoPoint(this.east,this.south)},c.prototype.toString=function(){var b=new a.StringBuilder;return b.append(this.north.toString()),b.append(":"),b.append(this.west.toString()),b.append(":"),b.append(this.south.toString()),b.append(":"),b.append(this.east.toString()),b.toString()},c.prototype.invalidate=function(){this.north=b.Latitude.fromDegrees(-90),this.south=b.Latitude.fromDegrees(90),this.west=b.Longitude.fromDegrees(180),this.east=b.Longitude.fromDegrees(-180)},c.prototype.contains=function(a){var b=a.longitude,c=a.latitude;return b.isGreaterThanOrEqual(this.west)&&b.isLessThanOrEqual(this.east)&&c.isGreaterThanOrEqual(this.south)&&c.isLessThanOrEqual(this.north)},c.prototype.expand=function(a){var b=a.longitude,c=a.latitude;b.isLessThanOrEqual(this.west)&&(this.west=b),b.isGreaterThanOrEqual(this.east)&&(this.east=b),c.isLessThanOrEqual(this.south)&&(this.south=c),c.isGreaterThanOrEqual(this.north)&&(this.north=c)},c.prototype.intersects=function(a){return!(this.north.isLessThan(a.south)||this.south.isGreaterThan(a.north)||this.west.isGreaterThan(a.east)||this.east.isLessThan(a.west))},c.fromDegrees=function(a,d,e,f){var g=b.Latitude.fromDegrees(a),h=b.Latitude.fromDegrees(e),i=b.Longitude.fromDegrees(d),j=b.Longitude.fromDegrees(f);return new c(g,i,h,j)},c.world=c.fromDegrees(90,-180,-90,180),c}();b.GeoBoundingBox=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(a,c){this.longitude=a||b.Longitude.fromDegrees(0),this.latitude=c||b.Latitude.fromDegrees(0)}return c.prototype.normalize=function(){this.longitude.normalize(),this.latitude.normalize()},c.prototype.toLatLng=function(){var a=new L.LatLng(this.latitude.getDegrees(),this.longitude.getDegrees());return a},c.prototype.toString=function(){return[this.longitude.getDegrees(),this.latitude.getDegrees()].join()},c.prototype.toLatLonString=function(){var b=this.longitude.getDegrees(),c=this.latitude.getDegrees(),d=new a.StringBuilder;return NaN==c?d.append("NaN"):(d.append(Math.abs(c).toString()),c>=0?d.append("N"):d.append("S")),d.append(","),NaN==b?d.append("NaN"):(d.append(Math.abs(b).toString()),b>=0?d.append("E"):d.append("W")),d.toString()},c.prototype.equals=function(a){var b,c,d=a.longitude,e=a.latitude;b=this.longitude.isGreaterThan(d)?this.longitude.getDegrees()-d.getDegrees():d.getDegrees()-this.longitude.getDegrees(),c=this.latitude.isGreaterThan(e)?this.latitude.getDegrees()-e.getDegrees():e.getDegrees()-this.latitude.getDegrees();var f=1e-6;return f>b&&f>c},c.prototype.notEquals=function(a){return!this.equals(a)},c.fromRadians=function(a,d){return new c(b.Longitude.fromRadians(a),b.Latitude.fromRadians(d))},c.fromDegrees=function(a,d){return new c(b.Longitude.fromDegrees(a),b.Latitude.fromDegrees(d))},c}();b.GeoPoint=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){this.points=new Array,this.boundingBox=new a.GeoBoundingBox,this.boundingBox.invalidate()}return b.prototype.add=function(a){this.points.push(a),this.boundingBox.expand(a)},b.prototype.computeBoundingBox=function(){this.boundingBox.invalidate();for(var a=0,b=this.points.length;b>a;a++){var c=this.points[a];this.boundingBox.expand(c)}return this.boundingBox},b}();a.GeoPolyline=b}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a,b){this._isSlopeCalculated=!1,this._slope=void 0,this.a=a,this.b=b}return a.prototype.getSlope=function(){return void 0===this._slope&&(this.a.y===this.b.y?this._slope=0:this.a.x===this.b.x?this._slope=NaN:this._slope=(this.a.y-this.b.y)/(this.a.x-this.b.x)),this._slope},a.prototype.getXForY=function(a){var b=this.getSlope();if(0===b)return a!=this.a.y?NaN:this.a.x+(this.b.x-this.a.x)/2;if(NaN===b)return this.a.x;var c=a-this.a.y,d=c/b;return this.a.x+d},a.prototype.getYForX=function(a){var b=this.getSlope();if(NaN===b)return a!=this.a.x?NaN:this.a.y+(this.b.y-this.a.y)/2;if(0===b)return this.a.y;var c=a-this.a.x,d=c*b;return this.a.y+d},a}();a.LineSegment=b}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(a,c,d,e,f){void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=0),this._maxX=0,this._minX=0,this._maxY=0,this._minY=0,this._projection=a||new b.MercatorProjection,this.north=c,this.west=d,this.south=e,this.east=f}return c.prototype.getMapProjection=function(){return this._projection},c.prototype.setMapProjection=function(a){this._projection=a;var c=b.GeoPoint.fromDegrees(-180,90),d=b.GeoPoint.fromDegrees(180,-90),e=this._projection.geoToMap(c),f=this._projection.geoToMap(d);this._minY=f.y,this._maxY=e.y,this._minX=e.x,this._maxX=f.x},c.prototype.getCenter=function(){return new a.Point(this.west+(this.east-this.west)/2,this.south+(this.north-this.south)/2)},c.prototype.getWidth=function(){return this.east-this.west},c.prototype.getHeight=function(){return this.north-this.south},c.prototype.expand=function(a){a.x<=this.west&&(this.west=a.x),a.x>=this.east&&(this.east=a.x),a.y<=this.south&&(this.south=a.y),a.y>=this.north&&(this.north=a.y)},c.prototype.invalidate=function(){this.north=this._minY,this.south=this._maxY,this.west=this._maxX,this.east=this._minX},c.prototype.contains=function(a){var b=a.x,c=a.y;return b>=this.west&&b<=this.east&&c>=this.south&&c<=this.north},c.prototype.normalize=function(){var a=2*this._projection.geoToMap(new b.GeoPoint(b.Longitude.fromDegrees(180),b.Latitude.fromDegrees(0))).x;this.west>a/2&&(this.west-=a,this.east-=a),this.east<-a/2&&(this.west+=a,this.east+=a)},c}();b.MapBoundingBox=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(b){this.points=new Array,this.boundingBox=new a.MapBoundingBox(this._projection),this._projection=b||new a.MercatorProjection,this.boundingBox.invalidate()}return b.prototype.computeBoundingBox=function(){this.boundingBox.invalidate();for(var a=this.boundingBox.expand,b=0,c=this.points.length;c>b;b++){var d=this.points[b];a(d)}return this.boundingBox},b.prototype.add=function(a){this.points.push(a),this.boundingBox.expand(a)},b}();a.MapPolyline=b}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){}return c.prototype.longitudeToX=function(a){return b.Geo.rMajor.getMeters()*a},c.prototype.latitudeToY=function(a){return b.Geo.rMajor.getMeters()/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))},c.prototype.xToLongitude=function(a){return a/b.Geo.rMajor.getMeters()},c.prototype.yToLatitude=function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/b.Geo.rMajor.getMeters()))},c.prototype.geoToMap=function(b){var c=this.longitudeToX(b.longitude.getRadians()),d=this.latitudeToY(b.latitude.getRadians());return new a.Point(c,d)},c.prototype.mapToGeo=function(a){var c=this.xToLongitude(a.x),d=this.yToLatitude(a.y);return b.GeoPoint.fromRadians(c,d)},c}();b.MercatorProjection=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a,b,c){this.angularWidth=a,this.bins=b,this.azimuth=c}return b.parse=function(b){for(var c=b.split("#"),d=c[0].split(","),e=parseFloat(d[0]),f=parseFloat(d[3]),g=parseFloat(d[4]),h=new Array,i=c[1].split(":"),j=0;e>j;j++)"*"!=i[j]&&h.push(parseFloat(i[j]));var k=new a.Gis.Radial(g,h,f);return k},b}();b.Radial=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(a){function b(b,c,d){a.call(this),this.z=b,this.x=c,this.y=d}return __extends(b,a),b.prototype.getParent=function(){return new b(this.z-1,this.x>>1,this.y>>1)},b.prototype.getChildren=function(){var a=this.z+1,c=2*this.x,d=2*this.y;return{BottomLeft:new b(a,c,d),TopRight:new b(a,c+1,d+1),TopLeft:new b(a,c,d+1),BottomRight:new b(a,c+1,d)}},b.prototype.compareTo=function(a){return this.z<a.z?-1:this.z>a.z?1:this.x<a.x?-1:this.x>a.x?1:this.y<a.y?-1:(this.y>a.y,1)},b.prototype.toString=function(){return[this.z,this.x,this.y].join()},b.prototype.isParentTile=function(a){var c=a.z;if(c>=this.z)return!1;for(var d=new b(this.z,this.x,this.y),e=this.z;e!=c;--e)d=d.getParent();return d.equals(a)},b.world=new b(0,0,0),b}(a.Comparable);b.Tile=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){throw new Error("Static class cannot be instantiated")}return c.tmsToMap=function(b){return new a.Point(b.x*c.halfExtent,b.y*c.halfExtent)},c.mapToTms=function(b){return new a.Point(b.x/c.halfExtent,b.y/c.halfExtent)},c.geoToTms=function(a){return c.mapToTms(c.projection.geoToMap(a))},c.screenToTms=function(b,c,d){void 0===d&&(d=256);var e=Math.pow(2,c),f=2/(d*e),g=new a.Transforms.Matrix(f,0,0,-f,-1,1).tranformPoint(new a.Point(b.x+.5,b.y+.5));return g},c.tmsToGeo=function(a){var b=c.tmsToMap(a);return c.projection.mapToGeo(b)},c.tileToGeo=function(d,e){void 0===e&&(e=256);var f=Math.pow(2,d.z),g=e*d.x,h=e*(f-d.y-1),i=g+e,j=h+e,k=c.tmsToGeo(c.screenToTms(new a.Point(g,j),d.z,e)),l=c.tmsToGeo(c.screenToTms(new a.Point(i,h),d.z,e));return new b.GeoBoundingBox(l.latitude,k.longitude,k.latitude,l.longitude)},c.tmsToScreen=function(b,c,d){void 0===d&&(d=256);var e=d*Math.pow(2,c),f=e/2,g=new a.Transforms.Matrix(f,0,0,-f,f,f).tranformPoint(b);return g.x>=e&&(g.x-=1),g.y>=e&&(g.y-=1),g},c.tileToScreen=function(b,d){void 0===d&&(d=256);var e=new a.Point(b.x,b.y);return c.tmsToScreen(e,b.z,d)},c.deriveScale=function(a,b){return void 0===b&&(b=256),b*Math.pow(2,a)/c.extent},c.deriveZoomLevel=function(b,d){return void 0===d&&(d=256),Math.ceil(a.MathUtility.logBase(b*c.extent,2)-a.MathUtility.logBase(d,2))},c.deriveZoomLevelExact=function(b,d){return void 0===d&&(d=256),a.MathUtility.logBase(b*c.extent,2)-a.MathUtility.logBase(d,2)},c.tmsToTile=function(a,d,e){void 0===e&&(e=256);var f=c.tmsToScreen(a,d,e),g=Math.pow(2,d),h=Math.floor(f.x/e),i=g-Math.floor(f.y/e)-1;return new b.Tile(d,h,i)},c.mapToTile=function(a,b,d){void 0===d&&(d=256);var e=c.mapToTms(a);return c.tmsToTile(e,b,d)},c.geoToTile=function(a,b,d){void 0===d&&(d=256);var e=c.geoToTms(a);return c.tmsToTile(e,b,d)},c.deriveTopLeftTmsPoint=function(b){var c=Math.pow(2,b.z),d=2/c,e=new a.Transforms.Matrix(d,0,0,d,-1,-1).tranformPoint(new a.Point(b.x,b.y+1));return e},c.deriveBottomRightTmsPoint=function(b){var c=Math.pow(2,b.z),d=2/c,e=new a.Transforms.Matrix(d,0,0,d,-1,-1).tranformPoint(new a.Point(b.x+1,b.y));return e},c.tileXYToQuadkey=function(b,c,d){for(var e=new a.StringBuilder,f=d;f>0;f--){var g=48,h=1<<f-1;0!=(b&h)&&g++,0!=(c&h)&&(g++,g++);var i=String.fromCharCode(g);e.append(i)}return e.toString()},c.projection=new b.MercatorProjection,c.extent=c.projection.geoToMap(b.GeoPoint.fromRadians(Math.PI,0)).x-c.projection.geoToMap(b.GeoPoint.fromRadians(-Math.PI,0)).x,c.halfExtent=c.extent/2,c}();b.TmsTileSystem=c}(b=a.Gis||(a.Gis={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){this._projectionWidth=null,this.fields={},this.attributes={},this.computed={},this.details=null,this.index=0,this.name=null,this.visualStyle=null,this.isStyleApplied=null,this.tooltipTemplate=null,this.visualTemplate=null,this.isVisible=null,this.advancedHitArea=null,this.hitAreaTolerance=null,this.isTooltipEnabled=null,this.useGreatCircleLines=!1,this.isIdlCrosser=!1,this.visualRecipe=null,this.projection=a,this.reset()}return b.prototype.getType=function(){throw new Error("NotImplementedException: getType")},b.prototype.getScreenCenter=function(){throw new Error("NotImplementedException: getScreenCenter")},b.prototype.getGeoCenter=function(){throw new Error("NotImplementedException: getGeoCenter")},b.prototype.getMapCenter=function(){throw new Error("NotImplementedException: getMapCenter")},b.prototype.getBoundingBox=function(){throw new Error("NotImplementedException: getBoundingBox")},b.prototype.getProjectionWidth=function(){if(null===this._projectionWidth&&null!=this.projection){var b=this.projection.geoToMap(a.Gis.GeoPoint.fromDegrees(-180,0)),c=this.projection.geoToMap(a.Gis.GeoPoint.fromDegrees(180,0));this._projectionWidth=c.x-b.x}return this._projectionWidth},b.prototype.correctPointsForIDL=function(b){if(b.length<1)return!1;for(var c=!1,d=b[0].longitude.getDegrees(),e=!1,f=0,g=1,h=b.length;h>g;++g){var i=b[g],j=b[g].longitude;j.normalize();var k=j.getDegrees(),l=k-d;e?Math.abs(l)>180&&(f=0):Math.abs(l)>180&&(f=0>l?360:-360),0!=f?(i.longitude=a.Gis.Longitude.fromDegrees(k+f),b[g]=i,e=!0,c=!0):e=!1,d=k}if(c){var m,n;m=n=b[0].longitude.getDegrees();for(var g=1,o=b.length;o>g;g++){var p=b[g],q=p.longitude.getDegrees();m>q?m=q:q>n&&(n=q)}var r=m+(n-m)/2,s=0;if(r>180&&(s=-360),-180>r&&(s=360),0!=s)for(var g=0,t=b.length;t>g;g++){var p=b[g];p.longitude=a.Gis.Longitude.fromDegrees(p.longitude.getDegrees()+s),b[g]=p}}return c},b.prototype.scaleToMap=function(a,b){throw new Error("NotImplementedException: scaleToMap")},b.prototype.reset=function(){this.isStyleApplied=!1,this.computed={},this.tooltipTemplate=null,this.visualTemplate=null,this.advancedHitArea=null,this.isVisible=!0,this.hitAreaTolerance=2,this.isTooltipEnabled=!0},b.prototype.isPointInside=function(a,b){return!1},b.prototype.deriveIdlCorrectMapX=function(b){var c=b;if(this.isIdlCrosser){var d=this.getMapCenter().x,e=this.getProjectionWidth();Math.abs(b-d)>e/2&&(c+=a.MathUtility.sign(d)*e)}return c},b.prototype.correctForIdl=function(){},b.prototype.deriveWidth=function(a){return NaN},b.prototype.deriveHeight=function(a){return NaN},b}();b.Feature=c}(b=a.Geo||(a.Geo={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(){throw new Error("Static class cannot be instantiated")}return b.parse=function(a,c,d){var e=d||b.defaultProjection,f=new Array;switch(c){case"json":var g=JSON.parse(a);f=b.fromJson(g,e);case"shape":f=b.fromShape(a,e);default:f=b.fromGml(a,e)}for(var h=0,i=f.length;i>h;h++){var j=f[h];j.correctForIdl()}return f},b.fromJson=function(a,b){throw new Error("NotImplementedException: WxMap.Geo.fromJson")},b.fromGml=function(c,d){var e,f=/\S/g,g=[];try{if(DOMParser){var h=new DOMParser;e=h.parseFromString(c,"text/xml")}else e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(c)}catch(i){e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(c)}for(var j=e.childNodes[0],k=void 0!==j.getElementsByTagNameNS?j.getElementsByTagNameNS(this.gmlNamespace,"featureMember"):e.getElementsByTagName("gml:featureMember"),l=0,m=k.length;m>l;l++){var n,o=null,p=k[l];if(p.childNodes.length>1){for(var q=0;q<p.childNodes.length;q++)if(3!==p.childNodes[q].nodeType){n=p.childNodes[q];break}}else n=p.childNodes[0];if(3!==n.nodeType||f.test(n.nodeValue)){if(null===n)throw{name:"InvalidDocumentException",message:"Feature Node Structure Invalid"};var r={};if(null!=n.attributes)for(var s=0,t=n.attributes.length;t>s;s++){var u=n.attributes[s];r[u.name]=u.value}var v={};if(null!=n.childNodes)for(var w=0,x=n.childNodes.length;x>w;w++){var y=n.childNodes[w];if(3!==y.nodeType||f.test(y.nodeValue))if(y.namespaceURI===b.gmlNamespace){var z=y.localName||y.baseName;switch(z.toUpperCase()){case"POINTPROPERTY":var A=void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"Point")[0]:y.getElementsByTagName("gml:Point")[0],B=void 0!==A.getElementsByTagNameNS?A.getElementsByTagNameNS(this.gmlNamespace,"coord")[0]:A.getElementsByTagName("gml:coord")[0],C=void 0!==B.getElementsByTagNameNS?parseFloat(B.getElementsByTagNameNS(this.gmlNamespace,"X")[0].textContent):parseFloat(B.getElementsByTagName("gml:X")[0].text),D=void 0!==B.getElementsByTagNameNS?parseFloat(B.getElementsByTagNameNS(this.gmlNamespace,"Y")[0].textContent):parseFloat(B.getElementsByTagName("gml:Y")[0].text),E=a.Gis.GeoPoint.fromDegrees(C,D);o=new a.Geo.PointFeature(d),o.setGeoPoint(E);break;case"LINESTRINGPROPERTY":for(var F=(void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"LineString")[0]:y.getElementsByTagName("gml:LineString")[0],void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"coordinates")[0].textContent:y.getElementsByTagName("gml:coordinates")[0].text),G=F.split(" "),H=new a.Gis.GeoPolyline,I=0,J=G.length;J>I;I++){var A=G[I].split(","),C=parseFloat(A[0]),D=parseFloat(A[1]),E=a.Gis.GeoPoint.fromDegrees(C,D);H.add(E)}o=new a.Geo.LineFeature(d),o.setGeoPolyline(H);break;case"POLYGONPROPERTY":for(var F=(void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"Polygon")[0]:y.getElementsByTagName("gml:Polygon")[0],void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"outerBoundaryIs")[0]:y.getElementsByTagName("gml:outerBoundaryIs")[0],void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"LinearRing")[0]:y.getElementsByTagName("gml:LinearRing")[0],void 0!==y.getElementsByTagNameNS?y.getElementsByTagNameNS(this.gmlNamespace,"coordinates")[0].textContent:y.getElementsByTagName("gml:coordinates")[0].text),G=F.split(" "),H=new a.Gis.GeoPolyline,I=0,J=G.length;J>I;I++){
var A=G[I].split(","),C=parseFloat(A[0]),D=parseFloat(A[1]),E=a.Gis.GeoPoint.fromDegrees(C,D);H.add(E)}o=new a.Geo.PolygonFeature(d),o.setGeoPolygon(H)}}else v[y.tagName]=y.textContent||y.text}null!==o&&(o.fields=v,o.attributes=r,g.push(o))}}return g},b.fromShape=function(a,b){throw new Error("NotImplementedException: WxMap.Geo.fromJson")},b.fromStation=function(b,c){var d=[],e=b.conds;for(var f in e){var g=e[f],h=a.Gis.GeoPoint.fromDegrees(e.lon,e.lat),i=new a.Geo.PointFeature(c);i.setGeoPoint(h);for(var j in g){var k=g[j];i.fields[j]=k}d.push(i)}return d},b.defaultProjection=new a.Gis.MercatorProjection,b.gmlNamespace="http://www.opengis.net/gml",b}();b.Formatter=c}(b=a.Geo||(a.Geo={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this._screenPolyline=new Array}return __extends(c,b),c.prototype.getType=function(){return"Line"},c.prototype.getScreenCenter=function(){return this._centerScreenPoint},c.prototype.getGeoCenter=function(){var a=this.getBoundingBox();return a.getCenterPoint()},c.prototype.getMapCenter=function(){if(void 0===this._centerMapPoint){var a=this.getBoundingBox(),b=a.getCenterPoint();this._centerMapPoint=this.projection.geoToMap(b)}return this._centerMapPoint},c.prototype.getBoundingBox=function(){return this._geoPolyline.boundingBox},c.prototype.getGeoPolyline=function(){return this._geoPolyline},c.prototype.setGeoPolyline=function(a){this._geoPolyline=a},c.prototype.getMapPolyline=function(){if(void 0===this._mapPolyline){this._mapPolyline=new a.Gis.MapPolyline(this.projection);for(var b=0,c=this._geoPolyline.points.length;c>b;b++){var d=this._geoPolyline.points[b],e=this.projection.geoToMap(d);this._mapPolyline.add(e)}}return this._mapPolyline},c.prototype.getScreenPolyline=function(){return this._screenPolyline},c.prototype.correctForIdl=function(){this.correctPointsForIDL(this._geoPolyline.points)&&(this._geoPolyline.computeBoundingBox(),this.isIdlCrosser=!0)},c.prototype.scaleToMap=function(a,b){this._screenPolyline=[];for(var c=this.getMapPolyline(),d=0,e=c.points.length;e>d;d++){var f=c.points[d],g=a.transform(f);this._screenPolyline.push(g)}},c.prototype.isPointInside=function(a,b){if(!this.isTooltipEnabled)return!1;var c=!1,d=this.getMapPolyline();if(this.visualStyle.isRendered){var e=this.hitAreaTolerance/b.mapScale,f=this.deriveIdlCorrectMapX(a.x),g=a.y,h=!1,i=d.boundingBox.north+e,j=d.boundingBox.south-e,k=d.boundingBox.east+e,l=d.boundingBox.west-e;if(g>=j&&i>=g&&f>=l&&k>=f&&(h=!0),h){for(var m=0,n=d.points.length,o=0;n>o;o++){var p=o===n-1?0:o+1,q=d.points[o].y,r=d.points[p].y;if(g>=q&&r>g||q>g&&g>=r){var s=d.points[o].x,t=d.points[p].x,u=0,v=r-q;0!=v&&(u=(g-q)/v),s+u*(t-s)>f&&++m}}h=m%2===1}c=h}return c?!0:null!=this.advancedHitArea?this.advancedHitArea.isPointInside(a,this,b):!1},c.prototype.deriveWidth=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getTopRightGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=i.x-h.x;return j},c.prototype.deriveHeight=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getBottomLeftGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=h.y-i.y;return j},c}(b.Feature);b.LineFeature=c}(b=a.Geo||(a.Geo={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,c),this._centerScreenPoint=new a.Point(0,0),this._mapScaleTransform=new a.Transforms.ScaleTransform}return __extends(c,b),c.prototype.getType=function(){return"Point"},c.prototype.getScreenCenter=function(){return this._centerScreenPoint},c.prototype.getGeoCenter=function(){return this._geoPoint},c.prototype.getMapCenter=function(){return void 0===this._centerMapPoint&&(this._centerMapPoint=this.projection.geoToMap(this._geoPoint)),this._centerMapPoint},c.prototype.getBoundingBox=function(){return void 0===this._boundingBox&&void 0!=this._geoPoint&&(this._boundingBox=new a.Gis.GeoBoundingBox(this._geoPoint.latitude,this._geoPoint.longitude,this._geoPoint.latitude,this._geoPoint.longitude)),this._boundingBox},c.prototype.getGeoPoint=function(){return this._geoPoint},c.prototype.setGeoPoint=function(a){this._geoPoint=a},c.prototype.getMapScaleTransform=function(){return this._mapScaleTransform},c.prototype.setMapScaleTransform=function(a){this._mapScaleTransform=a},c.prototype.deriveWidth=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getTopRightGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=i.x-h.x;return j},c.prototype.deriveHeight=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getBottomLeftGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=h.y-i.y;return j},c.prototype.scaleToMap=function(a,b){this._centerScreenPoint=a.transform(this.getMapCenter()),this.getMapScaleTransform().scaleX=b.mapScale,this.getMapScaleTransform().scaleY=b.mapScale},c.prototype.isPointInside=function(a,b){if(!this.isTooltipEnabled)return!1;var c=!1,d=!1;if(this.visualStyle.isRendered){var e=this.hitAreaTolerance/b.mapScale,f=a.x,g=a.y,h=Math.abs(f-this.getMapCenter().x),i=Math.abs(g-this.getMapCenter().y);if(e>=h&&e>=i&&(d=!0),d){var j=Math.sqrt(Math.pow(h,2)+Math.pow(i,2));d=e>=j}}return c=d,c?!0:null!=this.advancedHitArea?this.advancedHitArea.isPointInside(a,this,b):!1},c}(b.Feature);b.PointFeature=c}(b=a.Geo||(a.Geo={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this._screenPolygon=[]}return __extends(c,b),c.prototype.getType=function(){return"Polygon"},c.prototype.getScreenCenter=function(){return this._centerScreenPoint},c.prototype.getGeoCenter=function(){var a=this.getBoundingBox();return a.getCenterPoint()},c.prototype.getMapCenter=function(){if(void 0===this._centerMapPoint){var a=this.getBoundingBox(),b=a.getCenterPoint();this._centerMapPoint=this.projection.geoToMap(b)}return this._centerMapPoint},c.prototype.getBoundingBox=function(){return this._geoPolygon.boundingBox},c.prototype.getGeoPolygon=function(){return this._geoPolygon},c.prototype.setGeoPolygon=function(a){this._geoPolygon=a},c.prototype.getMapPolygon=function(){if(void 0===this._mapPolygon){this._mapPolygon=new a.Gis.MapPolyline(this.projection);for(var b=0,c=this._geoPolygon.points.length;c>b;b++){var d=this._geoPolygon.points[b],e=this.projection.geoToMap(d);this._mapPolygon.add(e)}}return this._mapPolygon},c.prototype.getScreenPolygon=function(){return this._screenPolygon},c.prototype.deriveWidth=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getTopRightGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=i.x-h.x;return j},c.prototype.deriveHeight=function(b){var c=this.getBoundingBox(),d=c.getTopLeftGeoPoint(),e=c.getBottomLeftGeoPoint(),f=a.Gis.TmsTileSystem.geoToTms(d),g=a.Gis.TmsTileSystem.geoToTms(e),h=a.Gis.TmsTileSystem.tmsToScreen(f,b.mapZoom),i=a.Gis.TmsTileSystem.tmsToScreen(g,b.mapZoom),j=h.y-i.y;return j},c.prototype.correctForIdl=function(){this.correctPointsForIDL(this._geoPolygon.points)&&(this._geoPolygon.computeBoundingBox(),this.isIdlCrosser=!0)},c.prototype.ScaleToMap=function(a,b){this._screenPolygon=new Array;for(var c=this.getMapPolygon(),d=0,e=c.points.length;e>d;d++){var f=c.points[d],g=a.transform(f);this._screenPolygon.push(g)}},c.prototype.isPointInside=function(a,b){if(!this.isTooltipEnabled)return!1;var c=!1,d=this.getMapPolygon();if(this.visualStyle.isRendered){var e=this.hitAreaTolerance/b.mapScale,f=this.deriveIdlCorrectMapX(a.x),g=a.y,h=!1,i=d.boundingBox.north+e,j=d.boundingBox.south-e,k=d.boundingBox.east+e,l=d.boundingBox.west-e;if(g>=j&&i>=g&&f>=l&&k>=f&&(h=!0),h){for(var m=0,n=d.points.length,o=0;n>o;o++){var p=o===n-1?0:o+1,q=d.points[o].y,r=d.points[p].y;if(g>=q&&r>g||q>g&&g>=r){var s=d.points[o].x,t=d.points[p].x,u=0,v=r-q;0!=v&&(u=(g-q)/v),s+u*(t-s)>f&&++m}}h=m%2===1}c=h}return c?!0:null!=this.advancedHitArea?this.advancedHitArea.isPointInside(a,this,b):!1},c.prototype.deriveIdlCorrectMapX=function(b){var c=b;if(this.isIdlCrosser){var d=this.getMapCenter().x,e=this.getProjectionWidth();Math.abs(b-d)>e/2&&(c+=a.MathUtility.sign(d)*e)}return c},c}(b.Feature);b.PolygonFeature=c}(b=a.Geo||(a.Geo={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){function b(){var b=new a.Definition,c=new a.Rule;return c.id="Default",c.where=new a.AlwaysTrue,c.visualStyle=new a.VisualStyle,c.visualStyle.applyDefaults(),b.rules.push(c),b}function c(a){if(null!=a){var b=Math.floor(a.mapZoom+.5);for(var c in a.zoomRanges){var d=a.zoomRanges[c];if(d.start<=b&&d.end>=b)return c}}return null}!function(a){a[a.String=0]="String",a[a.Double=1]="Double",a[a.Integer=2]="Integer",a[a.Boolean=3]="Boolean",a[a.Date=4]="Date",a[a.Visibility=5]="Visibility",a[a.Object=6]="Object"}(a.TargetType||(a.TargetType={}));a.TargetType;!function(a){a[a.Visible=0]="Visible",a[a.Hidden=1]="Hidden",a[a.Collapsed=2]="Collapsed"}(a.Visibility||(a.Visibility={}));a.Visibility;!function(a){a[a.Counterclockwise=0]="Counterclockwise",a[a.Clockwise1=1]="Clockwise1"}(a.SweepDirection||(a.SweepDirection={}));a.SweepDirection;!function(a){a[a.Top=0]="Top",a[a.Center=1]="Center",a[a.Bottom=2]="Bottom",a[a.Radial=3]="Radial",a[a.ReverseRadial=4]="ReverseRadial"}(a.VerticalAlignment||(a.VerticalAlignment={}));a.VerticalAlignment;!function(a){a[a.Left=0]="Left",a[a.Center=1]="Center",a[a.Right=2]="Right",a[a.Radial=3]="Radial",a[a.ReverseRadial=4]="ReverseRadial"}(a.HorizontalAlignment||(a.HorizontalAlignment={}));a.HorizontalAlignment;!function(a){a[a.Top=0]="Top",a[a.Bottom=1]="Bottom"}(a.VerticalOrigin||(a.VerticalOrigin={}));a.VerticalOrigin;!function(a){a[a.TreatAsPositive=0]="TreatAsPositive",a[a.TreatAsNegative=1]="TreatAsNegative"}(a.NullBehavior||(a.NullBehavior={}));a.NullBehavior;!function(a){a[a.RelativeToStart=0]="RelativeToStart",a[a.RelativeToEnd=1]="RelativeToEnd"}(a.StartRelativeTo||(a.StartRelativeTo={}));a.StartRelativeTo;!function(a){a[a.RelativeToStart=0]="RelativeToStart",a[a.RelativeToEnd=1]="RelativeToEnd",a[a.AsLength=2]="AsLength"}(a.EndRelativeTo||(a.EndRelativeTo={}));a.EndRelativeTo;a.createDefaultStyle=b,a.deriveActiveZoomRange=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.hitArea=null,this.steps=new Array,this.decorations=new Array}return a}();a.AdvancedVisual=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(){this.source=null,this.isLoaded=!1,this.image=null,this.width=null,this.height=null,this.crossOrigin=null,this.loading=new a.Event,this.loaded=new a.Event}return b.prototype.getInterfaces=function(){return["ILoadable"]},b.prototype.load=function(){var b=this;this.isLoaded=!1,this.loading.trigger(this),this.image=new Image,null!=this.width&&(this.image.width=this.width),null!=this.height&&(this.image.height=this.height),a.addEventListener(this.image,"load",function(a){b.isLoaded=!0,b.loaded.trigger(b)},!1),null!=this.crossOrigin&&(this.image.crossOrigin=this.crossOrigin),this.image.src=this.source},b}();b.Bitmap=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){this.mapScale=null,this.mapZoom=null,this.maxZoom=null,this.styleInfo=null,this.zoomRanges=null,this.zIndex=null,this.opacity=null,this.assets={},this.layerInfo=a}return b.prototype.clone=function(){var b=new a.Style.Context(this.layerInfo);return b.mapScale=this.mapScale,b.mapZoom=this.mapZoom,b.maxZoom=this.maxZoom,b.styleInfo=this.styleInfo,b.zoomRanges=this.zoomRanges,b.assets=this.assets,b},b}();b.Context=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){this.balloonTemplate=null,this.tooltipTemplates={},this.rules=[],this.assets={},this.visualTemplates={},this.zoomRanges={},this.detailsUrl=null,this.assetLoaded=new a.Event}return c.prototype.bindTooltipTemplate=function(b,c){for(var d=0,e=!1,f={};!e;)if(d=c.indexOf("{{",d),-1!==d){d+=2;var g=c.indexOf("}}",d);if(-1!=g){var h=c.substring(d,g),i=h.split(":");if(2!=i.length)throw"InvalidBindingExpression: '{{Collection:Key}}' values not properly supplied";var j=i[0],k=i[1],l="";switch(j){case"computed":b.computed.hasOwnProperty(k)?l=b.computed[k]:a.Console.log("InvalidBindingKey: computed does not contain key '"+k+"'"),f.hasOwnProperty(h)||(f[h]=l);break;case"fields":b.fields.hasOwnProperty(k)?l=b.fields[k]:a.Console.log("InvalidBindingKey: fields does not contain key '"+k+"'"),f.hasOwnProperty(h)||(f[h]=l);break;case"attributes":b.attributes.hasOwnProperty(k)?l=b.attributes[k]:a.Console.log("InvalidBindingKey: attributes does not contain key '"+k+"'"),f.hasOwnProperty(h)||(f[h]=l);break;case"details":if(null!=b.details&&b.details.hasOwnProperty(k)){var m=b.details[k];l=m.replace(/\n/g,"<br/>")}else a.Console.log("InvalidBindingKey: details does not contain key '"+k+"'");f.hasOwnProperty(h)||(f[h]=l);break;default:throw"InvalidBindingCollection: Collection type '"+j+"' not supported"}}}else e=!0;for(var n in f){var o=f[n],p=new a.StringBuilder("{{").append(n).append("}}"),q=new RegExp(p.toString(),"g");c=c.replace(q,o)}return c},c.prototype.load=function(b){var c=this;if(null!=this.assets)for(var d in this.assets){var e=this.assets[d];a.hasInterface(e,"ILoadable")&&(e.loaded.addListener(this,function(a,b){c.onAssetLoaded(a,b)}),e.load())}b.assets=this.assets},c.prototype.apply=function(a,c,d,e){null!=this.zoomRanges&&null===c.zoomRanges&&(c.zoomRanges=this.zoomRanges);var f=d||0,g=e||a.length,h=f+g-1;h>=a.length&&(h=a.length-1);for(var i=f;h>=i;i++){var j=a[i];!j.isStyleApplied,j.reset();var k=new b.VisualStyle;k.applyDefaults(),j.visualStyle=k;for(var l=0,m=this.rules.length;m>l;l++){var n=this.rules[l];if(!n.hasOwnProperty("where")||null===n.where)throw"InvalidStyleDefinition: All style rules must have a 'where' clause";if(n.where.isTrue(j,c)){null!=n.visualStyle&&j.visualStyle.merge(n.visualStyle);for(var o in n.computedValues)j.computed[o]=n.computedValues[o].compute(j,c);null!=n.visualTemplate&&(j.visualTemplate=n.visualTemplate),null!=n.tooltipTemplate&&(j.tooltipTemplate=n.tooltipTemplate),null!=n.isTooltipEnabled&&(j.isTooltipEnabled=n.isTooltipEnabled),null!=n.isFeatureVisible&&(j.isVisible=n.isFeatureVisible),null!=n.useGreatCircleLines&&(j.useGreatCircleLines=n.useGreatCircleLines),null!=n.hitAreaTolerance&&(j.hitAreaTolerance=n.hitAreaTolerance)}}var p=[];if(j.visualStyle.isRendered&&p.push(new b.DefaultVisual),null!=j.visualTemplate){for(var q=this.visualTemplates[j.visualTemplate],r=0,s=q.steps.length;s>r;r++){var t=q.steps[r],u=t.deriveVisible(j,c);u===b.Visibility.Visible&&p.push(t.compute(j,c))}null!=q.hitArea&&(j.advancedHitArea=q.hitArea.applyToFeature(j,c))}j.visualRecipe=p}},c.prototype.deriveTooltips=function(c,d,e,f){void 0===f&&(f="");var g=[];if(null!=c)for(var h=0,i=c.length;i>h;h++){var j=c[h],k=j.isPointInside(e,d),l=a.StringUtility.isDefined(j.tooltipTemplate);k&&l&&g.push(j)}var m,n=[],o=this;return a.forEach(g,function(c,e){var g,h=c,i=h.tooltipTemplate;if(!o.tooltipTemplates.hasOwnProperty(i))throw"TemplateNotFound: "+i+" could not be applied because no match was found.";if(g=o.tooltipTemplates[i],null!=o.detailsUrl&&null===h.details){var j=a.createGuid(),k="<div id='"+j+"'><div style='background-color:rgba(204, 204, 204, 0.90);font:normal 11px/176px Tahoma, Verdana, Arial, Helvetica, Sans-Serif !important;display:block;min-width:239px;height:176px;white-space:nowrap !important;border:solid 1px #000;padding:1px 3px;text-align:center;'>Loading...</div></div>";m=new b.Tooltip(k,h,f),n.push(m);var l=b.DynamicValue.computePrimitiveValue(h,d,o.detailsUrl,b.TargetType.String),p=!0,q=a.Net.createCorsRequest("GET",l,!0);q.onprogress=function(){},q.onerror=function(){a.Console.log("Error: LoadSettings")},q.timeout=function(){a.Console.log("Timeout: LoadSettings")},q.onabort=function(){a.Console.log("Aborted: LoadSettings")},q.onprogress=function(){},q.onload=function(){if(h.details=JSON.parse(q.responseText),h.details.Location||h.details.id){var b=o.bindTooltipTemplate(h,g),c=document.getElementById(j);null!=c?c.innerHTML=b:m.html=b;try{for(var d=document.querySelectorAll(".leaflet-popup-content"),e=0;e<d.length;e++)d[e].style.width="initial"}catch(f){a.Console.log(f)}}else{var i=document.getElementById(j),k="<div style='background-color:rgba(204, 204, 204, 0.90);font:normal 11px/176px Tahoma, Verdana, Arial, Helvetica, Sans-Serif !important;display:block;min-width:200px;height:176px;white-space:nowrap !important;border:solid 1px #000;padding:1px 3px;text-align:center;'>Data Unavailable...</div>";i.innerHTML=k}},q.ontimeout=function(){p=!1},q.timeout=5e3,q.send()}else{var r=o.bindTooltipTemplate(h,g);m=new b.Tooltip(r,h,f),n.push(m)}}),n},c.prototype.requiresRestyle=function(b,c){if(null===b)return!1;var d=a.Style.deriveActiveZoomRange(b),e=a.Style.deriveActiveZoomRange(c);return d!=e},c.prototype.onAssetLoaded=function(a,b){this.assetLoaded.trigger(a,b)},c}();b.Definition=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(WxMap){var Style;!function(Style){var Formatter=function(){function Formatter(){throw new Error("Static class cannot be instantiated")}return Formatter.parse=function(a,b,c){var d=c||Formatter.defaultProjection;switch(b){case"xaml":return Formatter.fromXaml(a,d);case"xml":return Formatter.fromXml(a,d);default:var e=a.indexOf("{"),f=a.substr(e),g=JSON.parse(f);return Formatter.fromJson(g,d)}},Formatter.fromXml=function(a,b){throw new Error("NotImplementedException: fromXml")},Formatter.fromXaml=function(a,b){throw new Error("NotImplementedException: fromXaml")},Formatter.fromJson=function(a,b){var c=Formatter.fromLiteral(a);for(var d in c.tooltipTemplates){var e=c.tooltipTemplates[d];if(WxMap.isTypeOf(e,"Array")){for(var f=new WxMap.StringBuilder,g=0;g<e.length;g++)f.append(e[g]);c.tooltipTemplates[d]=f.toString()}}return c},Formatter.fromLiteral=function(literal){var type=typeof literal;if("number"===type||"string"===type||"boolean"==type)return literal;if(!literal.hasOwnProperty("_"))throw"InvalidArgumentExeption: literal argument must be object with '_' property defined.";type=literal._;var init=new WxMap.StringBuilder("new WxMap.Style.").append(type).append("();"),obj;if("Dictionary"===type){obj={};for(var field in literal)if("_"!=field)if(WxMap.isTypeOf(literal[field],"Array")){obj[field]=literal[field];for(var i=0;i<obj[field].length;i++)obj[field][i]=Formatter.fromLiteral(literal[field][i])}else obj[field]=Formatter.fromLiteral(literal[field]);return obj}try{obj=eval(init.toString())}catch(error){throw"UnknownTypeException: WxMap.Style."+type+" is Uknown."}for(var field in literal)if("_"!=field)if(obj.hasOwnProperty("Meta")&&obj.Meta.hasOwnProperty(field)&&obj.Meta[field].hasOwnProperty("ValueConverter"))obj[field]=obj.Meta[field].ValueConverter.ConvertFrom(literal[field]);else if(WxMap.isTypeOf(literal[field],"Array")){obj[field]=literal[field];for(var i=0;i<obj[field].length;i++)obj[field][i]=Formatter.fromLiteral(literal[field][i])}else"object"==typeof obj[field]?obj[field]=Formatter.fromLiteral(literal[field]):obj[field]=literal[field];return obj},Formatter.defaultProjection=new WxMap.Gis.MercatorProjection,Formatter}();Style.Formatter=Formatter}(Style=WxMap.Style||(WxMap.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.radius=0,this.isRadiusScaledWithMap=!1}return a.prototype.isPointInside=function(a,b,c){if(0===this.radius||null==this.radius)return!1;var d=this.radius;this.isRadiusScaledWithMap||(d/=c.mapScale);var e=b.getMapCenter(),f=Math.abs(e.x-a.x),g=Math.abs(e.y-a.y);if(d>=f&&d>=g){var h=Math.sqrt(Math.pow(f,2)+Math.pow(g,2));return d>=h}return!1},a}();a.RadiusHitArea=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){this.isRadiusScaledWithMap=!1,this.radius=null}return b.prototype.applyToFeature=function(b,c){var d=0;null!=this.radius&&(this.radius.as=a.TargetType.Double,d=this.radius.compute(b,c));var e=new a.RadiusHitArea;return e.isRadiusScaledWithMap=this.isRadiusScaledWithMap,e.radius=d,e},b}();a.RadiusHitAreaTemplate=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.isRendered=null,this.isStroked=null,this.isFilled=null,this.isClickable=null,this.strokeColor=null,this.strokeWidth=null,this.strokeOpacity=null,this.fillColor=null,this.fillOpacity=null,this.radius=null}return a.prototype.applyDefaults=function(){this.isRendered=!0,this.isStroked=!0,this.isFilled=!0,this.isClickable=!0,this.strokeColor="rgb(255, 255, 255)",this.strokeWidth=2,this.strokeOpacity=.5,this.fillColor="rgb(0, 255, 0)",this.fillOpacity=.2,this.radius=2},a.prototype.merge=function(a){null!=a.isRendered&&(this.isRendered=a.isRendered),null!=a.isStroked&&(this.isStroked=a.isStroked),null!=a.isFilled&&(this.isFilled=a.isFilled),null!=a.isClickable&&(this.isClickable=a.isClickable),null!=a.strokeColor&&(this.strokeColor=a.strokeColor),null!=a.strokeWidth&&(this.strokeWidth=a.strokeWidth),null!=a.strokeOpacity&&(this.strokeOpacity=a.strokeOpacity),null!=a.fillColor&&(this.fillColor=a.fillColor),null!=a.fillOpacity&&(this.fillOpacity=a.fillOpacity),null!=a.radius&&(this.radius=a.radius)},a}();a.VisualStyle=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.VisualTemplate=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.start=0,this.end=31}return a}();a.ZoomRange=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){this.as=b.TargetType.String,this.isScaledWithMap=!1}return c.prototype.compute=function(a,b){return null},c.convertToTargetType=function(c,d){if(void 0===c||null===c)return null;var e=typeof c;switch(e){case"string":switch(d){case b.TargetType.String:return c;case b.TargetType.Double:return parseFloat(c);case b.TargetType.Integer:return parseInt(c);case b.TargetType.Boolean:return"TRUE"===c.toUpperCase||1===parseInt(c);case b.TargetType.Date:return a.DateTime.parseChrono(c);case b.TargetType.Visibility:return b.Visibility[c]}case"number":switch(d){case b.TargetType.String:return c.toString();case b.TargetType.Double:return c;case b.TargetType.Integer:return Math.round(c);case b.TargetType.Boolean:return 1===c;case b.TargetType.Date:return new Date(c);case b.TargetType.Visibility:return 1===c}case"boolean":switch(d){case b.TargetType.String:return c.toString();case b.TargetType.Double:case b.TargetType.Integer:return c?1:0;case b.TargetType.Boolean:return c;case b.TargetType.Date:throw"InvalidConversionException: Boolean Cannot be Converted into a Date";case b.TargetType.Visibility:return c?b.Visibility.Visible:b.Visibility.Collapsed}default:if(e=c.constructor.toString(),-1==e.indexOf("Date"))return c;switch(d){case b.TargetType.String:return c.toString();case b.TargetType.Double:return c.getTime();case b.TargetType.Integer:return Math.round(c.getTime());case b.TargetType.Boolean:throw"InvalidConversionException: Date Cannot be Converted into a Boolean";case b.TargetType.Date:return c;case b.TargetType.Visibility:throw"InvalidConversionException: Date Cannot be Converted into a Visibility"}}},c.computePrimitiveValue=function(a,b,d,e){if(null===d)return d;if("object"==typeof d){var f=d.compute(a,b);return c.convertToTargetType(f,e)}return c.convertToTargetType(d,e)},c}();b.DynamicValue=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.compute=function(a,b){var c=null;if(null!=b){var d=Math.floor(b.mapZoom+.5);for(var e in b.zoomRanges){var f=b.zoomRanges[e];f.start<=d&&f.end>=d&&(c=e)}}return c},b}(a.DynamicValue);a.ActiveZoomRange=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.children=new Array,this.convertOperands=function(b,c,d,e,f){if(null===d)throw"ArgumentNullException: leftOperand";if(null===e)throw"ArgumentNullException: rightOperand";var g=d.compute(b,c),h=e.compute(b,c);try{g=a.DynamicValue.convertToTargetType(g,f),h=a.DynamicValue.convertToTargetType(h,f)}catch(i){throw"InvalidConversion: Unable to convert operands to the target type "+f}return{LeftOperand:g,RightOperand:h}}}return __extends(c,b),c}(a.DynamicValue);a.CompositeValue=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.as=a.TargetType.Double}return __extends(c,b),c.prototype.compute=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand+f.RightOperand;default:throw"InvalidComaprisonException: Addition cannot operate on the listed values for the target type "+this.as}},c}(a.CompositeValue);a.Addition=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.degrees=null,this.radians=null}return __extends(d,c),d.prototype.compute=function(c,d){if(null!=this.radians){var e=b.DynamicValue.computePrimitiveValue(c,d,this.radians,b.TargetType.Double);return a.Gis.Angle.fromRadians(e)}if(null!=this.degrees){var f=b.DynamicValue.computePrimitiveValue(c,d,this.degrees,b.TargetType.Double);return a.Gis.Angle.fromDegrees(f)}return null},d}(b.DynamicValue);b.Angle=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.r=null,this.g=null,this.b=null,this.a=null}return __extends(d,c),d.prototype.compute=function(c,d){var e=0;null!=this.r&&(this.r.as=b.TargetType.Integer,e=b.DynamicValue.convertToTargetType(this.r.compute(c,d),this.as),e>255&&(e=255),0>e&&(e=0));var f=0;null!=this.g&&(this.g.as=b.TargetType.Integer,f=b.DynamicValue.convertToTargetType(this.g.compute(c,d),this.as),f>255&&(f=255),0>f&&(f=0));var g=0;null!=this.b&&(this.b.as=b.TargetType.Integer,g=b.DynamicValue.convertToTargetType(this.b.compute(c,d),this.as),g>255&&(g=255),0>g&&(g=0));var h=1;null!=this.a&&(this.a.as=b.TargetType.Double,h=b.DynamicValue.convertToTargetType(this.a.compute(c,d),this.as),h>1&&(h=1),0>h&&(h=0));var i=new a.StringBuilder;a.Browser.isIE&&a.Browser.getVersion()<9?i.append("rgb(").append(e.toString()).append(",").append(f.toString()).append(",").append(g.toString()).append(")"):i.append("rgba(").append(e.toString()).append(",").append(f.toString()).append(",").append(g.toString()).append(",").append(h.toString()).append(")");var j=i.toString();return j},d}(b.DynamicValue);b.Color=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.key=null}return __extends(c,b),c.prototype.compute=function(b,c){try{var d=b.computed[this.key];return a.DynamicValue.convertToTargetType(d,this.as)}catch(e){throw"InvalidKeyException: Key "+this.key+"was not present in the geoFeature's Computed collection"}},c}(a.DynamicValue);a.Computed=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments),this.key=null}return __extends(b,a),b.prototype.compute=function(a,b){try{var c=a.computed[this.key];return c}catch(d){throw"ComputedBrush: Key not Found in Feature"}},b}(a.DynamicValue);a.ComputedBrush=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments),this.key=null}return __extends(b,a),b.prototype.compute=function(a,b){try{var c=a.computed[this.key];return c}catch(d){throw"ComputedPoint: Key not Found in Feature"}},b}(a.DynamicValue);a.ComputedPoint=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.value=null}return __extends(c,b),c.prototype.compute=function(b,c){return a.DynamicValue.convertToTargetType(this.value,this.as)},c}(a.DynamicValue);a.Constant=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.compute=function(a,b){return b.mapZoom},b}(a.DynamicValue);a.CurrentZoomLevel=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.field=null,this.ifNull=null}return __extends(c,b),c.prototype.compute=function(b,c){var d=null;return b.fields.hasOwnProperty(this.field)&&(d=b.fields[this.field]),null===d&&(d=this.ifNull),a.DynamicValue.convertToTargetType(d,this.as)},c}(a.DynamicValue);a.Data=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.origin=null,this.bearing=null,this.range=null}return __extends(c,b),c.prototype.compute=function(b,c){var d;null!=this.origin&&this.origin.compute&&(d=this.origin.compute(b,c));var e;null!=this.bearing&&this.bearing.compute&&(e=this.bearing.compute(b,c));var f;null!=this.range&&this.range.compute&&(f=this.range.compute(b,c));var g=null;return null!=d&&null!=e&&null!=f&&(g=a.Gis.Geo.getDestination(d,e,f)),g},c}(b.DynamicValue);b.Destination=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.meters=null,this.miles=null,this.nauticalMiles=null,this.kilometers=null,this.feet=null,this.yards=null}return __extends(d,c),d.prototype.compute=function(c,d){if(null!=this.meters){var e=b.DynamicValue.computePrimitiveValue(c,d,this.meters,b.TargetType.Double);return a.Gis.Distance.fromMeters(e)}if(null!=this.miles){var f=b.DynamicValue.computePrimitiveValue(c,d,this.miles,b.TargetType.Double);return a.Gis.Distance.fromMiles(f)}if(null!=this.nauticalMiles){var g=b.DynamicValue.computePrimitiveValue(c,d,this.nauticalMiles,b.TargetType.Double);return a.Gis.Distance.fromNauticalMiles(g)}if(null!=this.kilometers){var h=b.DynamicValue.computePrimitiveValue(c,d,this.kilometers,b.TargetType.Double);return a.Gis.Distance.fromKilometers(h)}if(null!=this.feet){var i=b.DynamicValue.computePrimitiveValue(c,d,this.feet,b.TargetType.Double);return a.Gis.Distance.fromFeet(i)}if(null!=this.yards){var j=b.DynamicValue.computePrimitiveValue(c,d,this.yards,b.TargetType.Double);return a.Gis.Distance.fromYards(j)}return null},d}(b.DynamicValue);b.Distance=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.as=a.TargetType.Double}return __extends(c,b),c.prototype.compute=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";
var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand/f.RightOperand;default:throw"InvalidComaprisonException: Division cannot operate on the listed values for the target type "+this.as}},c}(a.CompositeValue);a.Division=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.original=null,this.noDirectionText=null,this.directionOffset=0}return __extends(c,b),c.prototype.compute=function(b,c){if(null!=this.original){try{var d,e=this.original.compute(b,c);try{d=a.DynamicValue.convertToTargetType(e,a.TargetType.Double)}catch(f){return e}if(-1===d)return null===this.noDirectionText?e:this.noDirectionText;var g=d+this.directionOffset,h=["N","NE","E","SE","S","SW","W","NW"],i=Math.floor((g%360+22.5)/45);return i>7&&(i=7),h[i]}catch(j){}return""}},c}(a.DynamicValue);a.FilterDirection=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.format="{0}",this.params=new Array,this.nullText=null,this.applyFormatIfNull=!1}return __extends(d,c),d.prototype.compute=function(c,d){this.as=b.TargetType.String;for(var e=[],f=0,g=this.params.length;g>f;f++){var h=this.params[f],i=h.compute(c,d);e.push(i)}if(e.length>0){var j=e[0];if(null===j||""===j)return null===this.nullText?"":this.applyFormatIfNull?(e.splice(0,0,this.format),a.StringUtility.format.apply(this,e)):this.nullText}e.splice(0,0,this.format);var k=a.StringUtility.format.apply(this,e),l=b.DynamicValue.convertToTargetType(k,this.as);return l},d}(b.DynamicValue);b.FilterFormat=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.dateTimeUtc=null,this.outputFormat="dd MMM yyyy HH:mm:ss"}return __extends(c,b),c.prototype.compute=function(b,c){var d;if(null!=this.dateTimeUtc)try{var e=this.dateTimeUtc.compute(b,c),f=new a.DateTime(e);d=f.toLocal();var g=new a.DateTime(d);return g.toFormatString(this.outputFormat)}catch(h){a.Console.log(h)}if(null!=this.dateTimeJavaScriptFormat)try{return d=new a.DateTime(new Date(b.fields[this.dateTimeJavaScriptFormat.field])),isNaN(d.value)?"":d.toFormatString(this.outputFormat)}catch(h){a.Console.log(h)}if(null!=this.dateTimeSplitFormat&&null!=this.dateTimeSplitFormat.Date&&null!=this.dateTimeSplitFormat.Time)try{var i=b.fields[this.dateTimeSplitFormat.Date.field],j=b.fields[this.dateTimeSplitFormat.Time.field],k=i+" "+j;return d=new a.DateTime(new Date(k)),isNaN(d.value)?"NA":d.toFormatString(this.outputFormat)}catch(h){a.Console.log(h)}return null},c}(b.DynamicValue);b.FilterLocalDateTime=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.original=null,this.replace=new Array,this.noMatchText=null}return __extends(c,b),c.prototype.compute=function(b,c){var d=null,e=!1;if(null!=this.original){var f="",g=this.original.compute(b,c);null!=g&&(f=g.toString());for(var h=0,i=this.replace.length;i>h;h++){var j=this.replace[h];if(f===j.old){d=j["new"],e=!0;break}}e||null!==this.noMatchText||(d=f,e=!0),e||(d=this.noMatchText)}return a.DynamicValue.convertToTargetType(d,this.as)},c}(a.DynamicValue);a.FilterReplace=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.params=new Array,this.nullText=null,this.applyFormatIfNull=!1,this.treatAsNull=b.NullBehavior.TreatAsPositive,this.positiveFormat="{0}",this.negativeFormat="{0}"}return __extends(d,c),d.prototype.deriveFilterString=function(c,d){if(this.params.length>0)try{var e=this.params[0];try{var f=e.compute(c,d)}catch(g){}if((void 0===f||null===f)&&a.Console.log("Undefined"),null!=f){var h=b.DynamicValue.convertToTargetType(f,b.TargetType.Double),i=h>=0;return this.deriveFormattedString(c,d,f,i)}}catch(j){throw"FormattingException: FitlerSignedFormat was unable to Format the Parameter."}},d.prototype.deriveFormattedString=function(b,c,d,e){var f=d;try{var g=[];g.push(d),this.retrieveAdditionalFormatParams(b,c,g),e?g.splice(0,0,this.positiveFormat):g.splice(0,0,this.positiveFormat),f=a.StringUtility.format.apply(this,g)}catch(h){a.Console.log(h)}return f},d.prototype.retrieveAdditionalFormatParams=function(a,b,c){for(var d=1,e=this.params.length;e>d;d++){var f=this.params[d],g=f.compute(a,b);c.push(g)}},d.prototype.compute=function(a,c){var d=this.deriveFilterString(a,c);return b.DynamicValue.convertToTargetType(d,this.as),d},d}(b.DynamicValue);b.FilterSignedFormat=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.original=null,this.start=0,this.end=Number.MAX_VALUE,this.startFrom=b.StartRelativeTo.RelativeToStart,this.endFrom=b.EndRelativeTo.RelativeToStart}return __extends(d,c),d.prototype.compute=function(c,d){try{var e;return e=this.endFrom===b.EndRelativeTo.AsLength?this.computeWithLength(c,d):this.computeWithOffsets(c,d),b.DynamicValue.convertToTargetType(e,this.as)}catch(f){a.Console.log(f)}},d.prototype.computeWithOffsets=function(c,d){if(null!=this.original)try{var e=this.original.compute(c,d);if(null===e)return"";var f=b.DynamicValue.convertToTargetType(e,b.TargetType.String),g=this.start,h=this.end,i=this.startFrom,j=this.endFrom;return i===b.StartRelativeTo.RelativeToEnd&&(g=-1*Math.abs(g)),j===b.EndRelativeTo.RelativeToEnd&&(h=-1*Math.abs(h)),0>h&&(j=b.EndRelativeTo.RelativeToEnd,h=f.length+h),h>f.length&&(h=f.length-1),0>g&&(i=b.StartRelativeTo.RelativeToEnd,g=f.length+g),0>g&&(g=0),f.substr(g,h-g+1)}catch(k){a.Console.log(k)}return null},d.prototype.computeWithLength=function(a,c){if(null!=this.original){var d=this.original.compute(a,c),e=b.DynamicValue.convertToTargetType(d,b.TargetType.String),f=this.start,g=this.end,h=this.startFrom;this.endFrom;return h===b.StartRelativeTo.RelativeToEnd&&(f=-1*Math.abs(f)),0>f&&(h=b.StartRelativeTo.RelativeToEnd,f=e.length+f),0>f&&(f=0),f+g>e.length&&(g=e.length-f),e.substr(f,g)}return null},d}(b.DynamicValue);b.FilterSubString=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.latitude=null,this.longitude=null}return __extends(c,b),c.prototype.compute=function(b,c){var d;null!=this.latitude?this.latitude.compute?d=this.latitude.compute(b,c):"Number"==typeof this.latitude&&(d=a.Gis.Latitude.fromDegrees(this.latitude)):d=b.getGeoCenter().latitude;var e;return null!=this.longitude&&(e=this.longitude.compute?this.longitude.compute(b,c):"Number"==typeof this.longitude?a.Gis.Longitude.fromDegrees(this.longitude):b.getGeoCenter().longitude),new a.Gis.GeoPoint(e,d)},c}(b.DynamicValue);b.GeoPoint=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.as=a.TargetType.Double}return __extends(c,b),c.prototype.compute=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand*f.RightOperand;default:throw"InvalidComaprisonException: Multiplication cannot operate on the listed values for the target type "+this.as}},c}(a.CompositeValue);a.Multiplication=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.nautical=null}return __extends(c,b),c.prototype.compute=function(b,c){if(null==this.nautical)return-90;this.nautical.as=a.TargetType.Double;var d=this.nautical.compute(b,c);return d-90},c}(a.DynamicValue);a.NauticalToDegrees=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.old=null,this["new"]=null}return a}();a.Replace=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.color=null}return __extends(d,c),d.prototype.compute=function(c,d){if(this.color.compute)return this.color.compute(c,d);if(a.Browser.isIE&&a.Browser.getVersion()<9){var e=b.DynamicVisual.deriveRGB(this.color.toString());return e}return this.color},d}(b.DynamicValue);b.SolidColorBrush=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.as=a.TargetType.Double}return __extends(c,b),c.prototype.compute=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand-f.RightOperand;default:throw"InvalidComaprisonException: Subtraction cannot operate on the listed values for the target type "+this.as}},c}(a.CompositeValue);a.Subtraction=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(){b.apply(this,arguments),this.path=null}return __extends(c,b),c.prototype.compute=function(b,c){for(var d=this.path,e=0,f=!1,g={};!f;)if(e=d.indexOf("{{",e),-1!==e){e+=2;var h=d.indexOf("}}",e);if(-1!=h){var i=d.substring(e,h),j=i.split(":");if(2!=j.length)throw"InvalidBindingExpression: '{{Collection:Key}}' values not properly supplied";var k=j[0],l=j[1];switch(k){case"computed":if(!b.computed.hasOwnProperty(l))throw"InvalidBindingKey: Computed does not contain key '"+l+"'";var m=b.computed[l];g.hasOwnProperty(i)||(g[i]=m);break;case"fields":if(!b.fields.hasOwnProperty(l))throw"InvalidBindingKey: Fields does not contain key '"+l+"'";var m=b.fields[l];g.hasOwnProperty(i)||(g[i]=m);break;case"attributes":if(!b.attributes.hasOwnProperty(l))throw"InvalidBindingKey: Attributes does not contain key '"+l+"'";var m=b.attributes[l];g.hasOwnProperty(i)||(g[i]=m);break;case"map":var m=null;switch(l){case"zoom":m=c.mapZoom;break;case"longitude":m=b.getGeoCenter().longitude.getDegrees();break;case"latitude":m=b.getGeoCenter().latitude.getDegrees()}null==m||g.hasOwnProperty(i)||(g[i]=m);break;default:throw"InvalidBindingCollection: Collection type '"+k+"' not supported"}}}else f=!0;for(var n in g){var o=g[n],p=new a.StringBuilder("{{").append(n).append("}}");d=d.replace(p.toString(),o)}return d},c}(b.DynamicValue);b.Url=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.value=a.Visibility.Visible}return __extends(c,b),c.prototype.compute=function(a,b){return this.value},c}(a.DynamicValue);a.Visible=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(){this.visible=null}return c.prototype.deriveVisible=function(a,c){var d=b.Visibility.Visible;if(null!=this.visible){this.visible.as=b.TargetType.Visibility;var e=this.visible.compute(a,c);"number"==typeof e&&(d=e)}return d},c.prototype.render=function(a,b,c,d){},c.deriveRGB=function(a){var b,c;return b=a.substring(a.indexOf("(")+1,a.lastIndexOf(")")).split(/,\s*/),b.pop(),c="rgb("+b.join(",")+")"},c.deriveOpacity=function(a){var b,c;return b=a.substring(a.indexOf("(")+1,a.lastIndexOf(")")).split(/,\s*/),c=parseFloat(b.pop().toString())},c.convertRgbaToRgb=function(a){var b=a.fillColor,d=a.strokeColor,e=a.fillColor.indexOf("a")>-1,f=a.strokeColor.indexOf("a")>-1;e&&(a.fillColor=c.deriveRGB(b),a.fillOpacity=c.deriveOpacity(b)),f&&(a.strokeColor=c.deriveRGB(d),a.strokeOpacity=c.deriveOpacity(d))},c.deriveOptions=function(b){a.Browser.isIE()&&a.Browser.getVersion()<9&&c.convertRgbaToRgb(b);var d={stroke:b.isStroked,weight:b.strokeWidth,color:b.strokeColor,opacity:b.strokeOpacity,fill:b.isFilled,fillColor:b.fillColor,fillOpacity:b.fillOpacity,clickable:b.isClickable};return d},c}();b.DynamicVisual=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.isClickable=null}return __extends(d,c),d.prototype.deriveOptions=function(c){var d;null!=this.visualStyle?(d=new b.VisualStyle,d.isRendered=null!=this.visualStyle.isRendered?this.visualStyle.isRendered:c.isRendered,d.isStroked=null!=this.visualStyle.isStroked?this.visualStyle.isStroked:c.isStroked,d.isFilled=null!=this.visualStyle.isFilled?this.visualStyle.isFilled:c.isFilled,d.isClickable=null!=this.visualStyle.isClickable?this.visualStyle.isClickable:c.isClickable,d.strokeColor=null!=this.visualStyle.strokeColor?this.visualStyle.strokeColor:c.strokeColor,d.strokeWidth=null!=this.visualStyle.strokeWidth?this.visualStyle.strokeWidth:c.strokeWidth,d.strokeOpacity=null!=this.visualStyle.strokeOpacity?this.visualStyle.strokeOpacity:c.strokeOpacity,d.fillColor=null!=this.visualStyle.fillColor?this.visualStyle.fillColor:c.fillColor,d.fillOpacity=null!=this.visualStyle.fillOpacity?this.visualStyle.fillOpacity:c.fillOpacity,d.radius=null!=this.visualStyle.radius?this.visualStyle.radius:c.radius):d=c,a.Browser.isIE()&&a.Browser.getVersion()<9&&b.DynamicVisual.convertRgbaToRgb(d);var e={stroke:d.isStroked,weight:d.strokeWidth,color:d.strokeColor,opacity:d.strokeOpacity,fill:d.isFilled,fillColor:d.fillColor,fillOpacity:d.fillOpacity,clickable:d.isClickable};return e},d}(b.DynamicVisual);b.Shape=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.radius=null,this.geoPoint=null}return __extends(c,b),c.prototype.compute=function(b,c){var d={};return d.radius=a.DynamicValue.computePrimitiveValue(b,c,this.radius,a.TargetType.Double),d.isClickable=a.DynamicValue.computePrimitiveValue(b,c,this.isClickable,a.TargetType.Boolean),null!=this.geoPoint&&(d.GeoPoint=this.geoPoint.compute(b,c)),new a.FinalizedVisual(b,d,this)},c.prototype.render=function(a,b,c,d){var e=d.GeoPoint||a.getGeoCenter(),f=new L.LatLng(e.latitude.getDegrees(),e.longitude.getDegrees()),g=a.visualStyle;if(null!==g&&void 0!==g){var h=this.deriveOptions(g);h.radius=d.Radius||g.radius,h.clickable=null===d.isClickable?!0:d.isClickable;var i=new L.Circle(f,h);c.addLayer(i)}},c}(a.Shape);a.Circle=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.radius=null,this.geoPoint=null}return __extends(c,b),c.prototype.compute=function(b,c){var d={};return d.radius=a.DynamicValue.computePrimitiveValue(b,c,this.radius,a.TargetType.Double),d.isClickable=a.DynamicValue.computePrimitiveValue(b,c,this.isClickable,a.TargetType.Boolean),null!=this.geoPoint&&(d.geoPoint=this.geoPoint.compute(b,c)),new a.FinalizedVisual(b,d,this)},c.prototype.render=function(a,b,c,d){var e=d.geoPoint||a.getGeoCenter(),f=new L.LatLng(e.latitude.getDegrees(),e.longitude.getDegrees()),g=a.visualStyle;if(null!==g&&void 0!==g){var h=this.deriveOptions(g);h.radius=d.radius||g.radius,h.clickable=null===d.isClickable?!0:d.isClickable,h.zIndexOffset=b.zIndex;var i=new L.CircleMarker(f,h);c.addLayer(i)}},c}(a.Shape);a.CircleMarker=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.paintPointFeature=function(b,c){var d=b.getGeoCenter(),e=new L.LatLng(d.latitude.getDegrees(),d.longitude.getDegrees()),f=b.visualStyle;if(null!==f&&void 0!==f){var g=a.DynamicVisual.deriveOptions(f),h=new L.Circle(e,f.radius,g);c.addLayer(h)}},c.prototype.paintPolylineFeature=function(b,c){var d=b.getGeoPolyline(),e=b.visualStyle;if(null!==e&&void 0!==e){for(var f=[],g=0;g<d.points.length;g++){var h=d.points[g],i=new L.LatLng(h.latitude.getDegrees(),h.longitude.getDegrees());f.push(i)}var j=a.DynamicVisual.deriveOptions(e),k=new L.Polyline(f,j);c.addLayer(k)}},c.prototype.paintPolygonFeature=function(b,c){var d=b.getGeoPolygon(),e=b.visualStyle;if(null!==e&&void 0!==e){for(var f=[],g=0;g<d.points.length;g++){var h=d.points[g],i=new L.LatLng(h.latitude.getDegrees(),h.longitude.getDegrees());f.push(i)}var j=a.DynamicVisual.deriveOptions(e),k=new L.Polygon(f,j);c.addLayer(k)}},c.prototype.render=function(a,b,c,d){switch(a.getType()){case"Point":this.paintPointFeature(a,c);break;case"Line":this.paintPolylineFeature(a,c);break;case"Polygon":this.paintPolygonFeature(a,c)}},c}(a.DynamicVisual);a.DefaultVisual=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){a.call(this),this._geoFeature=b,this._sourceVisual=d,this.computedValues=c}return __extends(b,a),b.prototype.render=function(a,b,c){this._sourceVisual.render(this._geoFeature,b,c,this.computedValues)},b}(a.DynamicVisual);a.FinalizedVisual=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.assetId=null,this.source=null,this.height=null,this.width=null,this.crossOrigin=null,this.isClickable=null,this.iconAnchorX=null,this.iconAnchorY=null,this.popupAnchorX=null,this.popupAnchorY=null}return __extends(d,c),d.prototype.getInterfaces=function(){return["IMeasurable"]},d.prototype.compute=function(a,c){var d={};if(null!=this.source)d.source=b.DynamicValue.computePrimitiveValue(a,c,this.source,b.TargetType.String),null!=this.height&&(d.height=b.DynamicValue.computePrimitiveValue(a,c,this.height,b.TargetType.Double)),null!=this.width&&(d.width=b.DynamicValue.computePrimitiveValue(a,c,this.width,b.TargetType.Double));else if(null!=this.assetId){d.assetId=b.DynamicValue.computePrimitiveValue(a,c,this.assetId,b.TargetType.String);var e=c.assets[d.assetId];d.source=e.source,null!=this.height?d.height=b.DynamicValue.computePrimitiveValue(a,c,this.height,b.TargetType.Double):null!=e.height&&(d.height=b.DynamicValue.computePrimitiveValue(a,c,e.height,b.TargetType.Double)),null!=this.width?d.width=b.DynamicValue.computePrimitiveValue(a,c,this.width,b.TargetType.Double):null!=e.width&&(d.width=b.DynamicValue.computePrimitiveValue(a,c,e.width,b.TargetType.Double))}return d.isClickable=b.DynamicValue.computePrimitiveValue(a,c,this.isClickable,b.TargetType.Boolean),null!=this.iconAnchorX&&(d.iconAnchorX=b.DynamicValue.computePrimitiveValue(a,c,this.iconAnchorX,b.TargetType.Integer)),null!=this.iconAnchorY&&(d.iconAnchorY=b.DynamicValue.computePrimitiveValue(a,c,this.iconAnchorY,b.TargetType.Integer)),null!=this.popupAnchorX&&(d.popupAnchorX=b.DynamicValue.computePrimitiveValue(a,c,this.popupAnchorX,b.TargetType.Integer)),null!=this.popupAnchorY&&(d.popupAnchorY=b.DynamicValue.computePrimitiveValue(a,c,this.popupAnchorY,b.TargetType.Integer)),new b.FinalizedVisual(a,d,this)},d.prototype.render=function(a,b,c,d){var e={};e.iconUrl=d.source,e.iconSize=new L.Point(d.width,d.height),null!=d.iconAnchorX&&null!=d.iconAnchorY&&(e.iconAnchor=new L.Point(d.iconAnchorX,d.iconAnchorY)),null!=d.popupAnchorX&&null!=d.popupAnchorY&&(e.popupAnchor=new L.Point(d.popupAnchorX,d.popupAnchorY));var f=new L.Icon(e),g=a.getGeoCenter(),h=new L.LatLng(g.latitude.getDegrees(),g.longitude.getDegrees()),i={icon:f,clickable:null===d.isClickable?!0:d.isClickable},j=new L.Marker(h,i);c.addLayer(j)},d.prototype.measure=function(b,c,d){var e=new a.Size(d.computedValues.width,d.computedValues.height);return e},d}(b.DynamicVisual);b.Icon=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this._isRadialDirectionComputed=!1,this.horizontalAnchor=b.HorizontalAlignment.Left,this.verticalAnchor=b.VerticalAlignment.Top,this.child=null,this.radialDirection=null}return __extends(d,c),d.prototype.deriveRadialHorizontalAlignment=function(a,c,d){var e=b.HorizontalAlignment.Left,f=this.deriveRadialDirection(a,c,d);if(null!=f){var g=this.normalizeNauticalDirection(f+d);g>180&&(e=b.HorizontalAlignment.Right)}return e},d.prototype.deriveRadialVerticalAlignment=function(a,c,d){var e=b.VerticalAlignment.Top,f=this.deriveRadialDirection(a,c);if(null!=f){var g=this.normalizeNauticalDirection(f+d);(90>g||g>270)&&(e=b.VerticalAlignment.Bottom)}return e},d.prototype.deriveRadialDirection=function(a,c,d){return this._isRadialDirectionComputed?this._computedRadialDirection:(null!=this.radialDirection&&(this.radialDirection.as=b.TargetType.Double,this._computedRadialDirection=this.radialDirection.compute(a,c)),this._isRadialDirectionComputed=!0,this._computedRadialDirection)},d.prototype.normalizeNauticalDirection=function(a){var b=a%360;return 0>b&&(b+=360),b},d.prototype.compute=function(c,d){this._isRadialDirectionComputed=!1;var e={};if(null!=this.child){e.finalizedChild=this.child.compute(c,d);var f;switch(this.horizontalAnchor){case b.HorizontalAlignment.Radial:f=this.deriveRadialHorizontalAlignment(c,d);break;case b.HorizontalAlignment.ReverseRadial:f=this.deriveRadialHorizontalAlignment(c,d,180);break;default:f=this.horizontalAnchor}var g;switch(this.verticalAnchor){case b.VerticalAlignment.Radial:g=this.deriveRadialVerticalAlignment(c,d);break;case b.VerticalAlignment.ReverseRadial:g=this.deriveRadialVerticalAlignment(c,d,180);break;default:g=this.verticalAnchor}if(a.hasInterface(this.child,"IMeasurable")){var h,i=this.child.measure(c,d,e.finalizedChild);switch(g){case b.VerticalAlignment.Top:h=0;break;case b.VerticalAlignment.Center:h=-(i.Height/2);break;case b.VerticalAlignment.Bottom:h=-i.Height}var j;switch(f){case b.HorizontalAlignment.Left:j=0;break;case b.HorizontalAlignment.Center:j=-(i.Width/2);break;case b.HorizontalAlignment.Right:j=-i.Width}e.transform=new a.Transforms.TranslateTransform(j,h)}else e.transform=new a.Transforms.TranslateTransform(0,0)}return new b.FinalizedVisual(c,e,this)},d.prototype.render=function(a,b,c,d){this.child.render(a,b,c,d.finalizedChild.computedValues)},d}(b.DynamicVisual);b.LayoutAnchor=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.points=null}return __extends(c,b),c.prototype.compute=function(b,c){var d={},e=[];if(null!=this.points)for(var f=0;f<this.points.length;f++){var g=this.points[f];g.compute&&(g=g.compute(b,c)),e.push(g)}else e=b.getGeoPolygon().points;return d.points=e,d.isClickable=a.DynamicValue.computePrimitiveValue(b,c,this.isClickable,a.TargetType.Boolean),new a.FinalizedVisual(b,d,this)},c.prototype.render=function(a,b,c,d){var e=a.visualStyle;if(null!==e&&void 0!==e){var f=this.deriveOptions(e);f.isClickable=null===d.isClickable?!0:d.isClickable;for(var g=[],h=0;h<d.points.length;h++){var i=d.points[h],j=new L.LatLng(i.latitude.getDegrees(),i.longitude.getDegrees());g.push(j)}var k=new L.Polygon(g,f);c.addLayer(k)}},c}(a.Shape);a.Polygon=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.radius=null,this.geoPoint=null,this.numberOfSides=3,this.rotation=null,this.radiusX=10,this.radiusY=10,this.innerRadiusX=null,this.innerRadiusY=null}return __extends(d,c),d.prototype.compute=function(a,c){var d={};return d.radius=b.DynamicValue.computePrimitiveValue(a,c,this.radius,b.TargetType.Double),d.numberOfSides=b.DynamicValue.computePrimitiveValue(a,c,this.numberOfSides,b.TargetType.Double),d.radiusX=b.DynamicValue.computePrimitiveValue(a,c,this.radiusX,b.TargetType.Double),d.radiusY=b.DynamicValue.computePrimitiveValue(a,c,this.radiusY,b.TargetType.Double),d.innerRadiusX=b.DynamicValue.computePrimitiveValue(a,c,this.innerRadiusX,b.TargetType.Double),d.innerRadiusY=b.DynamicValue.computePrimitiveValue(a,c,this.innerRadiusY,b.TargetType.Double),d.isClickable=b.DynamicValue.computePrimitiveValue(a,c,this.isClickable,b.TargetType.Boolean),null!=this.geoPoint&&(this.geoPoint.compute?d.geoPoint=this.geoPoint.compute(a,c):d.geoPoint=this.geoPoint),null!=this.rotation&&(this.rotation.compute?d.rotation=this.rotation.compute(a,c):d.rotation=this.rotation),new b.FinalizedVisual(a,d,this)},d.prototype.render=function(b,c,d,e){if(!(a.Browser.isIE()&&a.Browser.getVersion()<=8)){var f=e.geoPoint||b.getGeoCenter(),g=new L.LatLng(f.latitude.getDegrees(),f.longitude.getDegrees()),h=b.visualStyle;if(null!==h&&void 0!==h){var i=this.deriveOptions(h);i.radius=e.radius||h.radius,i.numberOfSides=e.numberOfSides,i.rotation=e.rotation?e.rotation.getDegrees():0,i.radiusX=e.radiusX,i.radiusY=e.radiusY,i.innerRadiusX=e.innerRadiusX,i.innerRadiusY=e.innerRadiusY,i.clickable=null===e.isClickable?!0:e.isClickable;var j=new L.RegularPolygonMarker(g,i);d.addLayer(j)}}},d}(b.Shape);b.PolygonMarker=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.points=null}return __extends(c,b),c.prototype.compute=function(b,c){var d={},e=[];if(null!=this.points)for(var f=0;f<this.points.length;f++){var g=this.points[f];g.compute&&(g=g.compute(b,c)),e.push(g)}else e=b.getGeoPolyline().points;return d.points=e,d.isClickable=a.DynamicValue.computePrimitiveValue(b,c,this.isClickable,a.TargetType.Boolean),new a.FinalizedVisual(b,d,this)},c.prototype.render=function(a,b,c,d){var e=a.visualStyle;if(null!==e&&void 0!==e){var f=this.deriveOptions(e);f.clickable=null===d.isClickable?!0:d.isClickable;for(var g=[],h=0;h<d.points.length;h++){var i=d.points[h];if(null!=i){var j=new L.LatLng(i.latitude.getDegrees(),i.longitude.getDegrees());g.push(j)}}var k=new L.Polyline(g,f);c.addLayer(k)}},c}(a.Shape);a.Polyline=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this.text=null,this.textAlign=null,this.strokeStyle=null,this.fillStyle=null,this.fontSize=null,this.fontWeight=null,this.fontFace=null,this.renderTransform=null,this.width=null,this.height=null,this.color=null,this.shadow=null,this.isClickable=null}return __extends(d,c),d.prototype.compute=function(c,d){var e={};e.text=b.DynamicValue.computePrimitiveValue(c,d,this.text,b.TargetType.String),e.strokeStyle=b.DynamicValue.computePrimitiveValue(c,d,this.strokeStyle,b.TargetType.String),e.fontFamily=b.DynamicValue.computePrimitiveValue(c,d,this.fillStyle,b.TargetType.String),e.fontSize=b.DynamicValue.computePrimitiveValue(c,d,this.fontSize,b.TargetType.Double),e.fontWeight=b.DynamicValue.computePrimitiveValue(c,d,this.fontWeight,b.TargetType.String),e.fontFace=b.DynamicValue.computePrimitiveValue(c,d,this.fontFace,b.TargetType.String),e.textAlign=b.DynamicValue.computePrimitiveValue(c,d,this.textAlign,b.TargetType.String),e.color=b.DynamicValue.computePrimitiveValue(c,d,this.color,b.TargetType.String)||"#000",e.shadow=b.DynamicValue.computePrimitiveValue(c,d,this.shadow,b.TargetType.String)||"0px 0px 0px",e.width=b.DynamicValue.computePrimitiveValue(c,d,this.width,b.TargetType.String),e.height=b.DynamicValue.computePrimitiveValue(c,d,this.height,b.TargetType.String),e.isClickable=b.DynamicValue.computePrimitiveValue(c,d,this.isClickable,b.TargetType.Boolean);var f=new a.StringBuilder;return f.append(e.fontStyle||"normal").append(" "),f.append(e.fontWeight||"normal").append(" "),f.append(e.fontSize||10).append("px "),f.append(e.fontFace||"serif"),e.font=f.toString(),new b.FinalizedVisual(c,e,this)},d.prototype.render=function(b,c,d,e){var f=b.getGeoCenter(),g=new L.LatLng(f.latitude.getDegrees(),f.longitude.getDegrees()),h=new a.StringBuilder;h.append("<div style='"),h.append("border:").append(e.border).append(";"),h.append("text-align:").append(e.textAlign).append(";"),h.append("color:").append(e.color).append(";"),h.append("font:").append(e.font).append(";"),h.append("text-shadow:").append(e.shadow).append(";"),h.append("'>"),h.append(e.text),h.append("</div>");var i=null;(null!=e.height||null!=e.width)&&(i=[e.width||0,e.height||0]);var j=new L.DivIcon({className:"",iconSize:i,html:h.toString()}),k=new L.Marker(g,{icon:j,clickable:null===e.IsClickable?!0:e.IsClickable});d.addLayer(k)},d}(b.DynamicVisual);b.TextBlock=c}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){this.children=new Array,this.as=null}return b.prototype.isTrue=function(a,b){throw new Error("NotImplementedException: isTrue")},b.prototype.convertOperands=function(b,c,d,e,f){if(null===d)throw"ArgumentNullException: leftOperand";if(null===e)throw"ArgumentNullException: rightOperand";var g=d.compute(b,c),h=e.compute(b,c);try{g=a.DynamicValue.convertToTargetType(g,f),h=a.DynamicValue.convertToTargetType(h,f)}catch(i){throw"InvalidConversion: Unable to convert operands to the target type "+f}return{LeftOperand:g,RightOperand:h}},b}();a.ComparisonNode=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){if(null===this.children||0===this.children.length)return!0;for(var c=0;c<this.children.length;c++){var d=this.children[c];if(!d.isTrue(a,b))return!1}return!0},a}();a.AllTrue=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){return!0},a}();a.AlwaysTrue=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){if(null===this.children||0===this.children.length)return!1;for(var c=0;c<this.children.length;c++){var d=this.children[c];if(d.isTrue(a,b))return!0}return!1},a}();a.AnyTrue=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.isTrue=function(a,b){return"Point"==a.getType()},a}();a.FeatureIsPoint=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.isTrue=function(a,b){return"Polygon"==a.getType()},a}();a.FeatureIsPolygon=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.isTrue=function(a,b){return"Line"===a.getType()},a}();a.FeatureIsPolyline=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){if(null===this.children||2!=this.children.length)throw"InvalidOperationException: IsEqual must contain exactly two values";var c=this.children[0].compute(a,b),d=this.children[1].compute(a,b);if(null===c||null===d)return null===c&&null===d;var e=c.toString()===d.toString();return e},a}();a.IsEqual=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.isTrue=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);
switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand>f.RightOperand;default:throw"InvalidComaprisonException: IsGreaterThan cannot compare the listed values for the target type "+this.as.toString()}},c}(a.ComparisonNode);a.IsGreaterThan=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.isTrue=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand>=f.RightOperand;default:throw"InvalidComaprisonException: IsGreaterThan cannot compare the listed values for the target type "+this.as.toString()}},c}(a.ComparisonNode);a.IsGreaterThanEquals=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.isTrue=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand<f.RightOperand;default:throw"InvalidComaprisonException: IsGreaterThan cannot compare the listed values for the target type "+this.as.toString()}},c}(a.ComparisonNode);a.IsLessThan=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.isTrue=function(b,c){if(2!=this.children.length)throw"InvalidCollectionException: Exactly two values are required in this collection even though it is a full blown array.";var d=this.children[0],e=this.children[1];this.as=null===this.as?a.TargetType.Double:this.as;var f=this.convertOperands(b,c,d,e,this.as);switch(this.as){case a.TargetType.Double:case a.TargetType.Integer:case a.TargetType.String:case a.TargetType.Date:return f.LeftOperand<=f.RightOperand;default:throw"InvalidComaprisonException: IsGreaterThan cannot compare the listed values for the target type "+this.as.toString()}},c}(a.ComparisonNode);a.IsLessThanEquals=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){if(null===this.children||2!=this.children.length)throw"InvalidOperationException: IsNotEqual must contain exactly two values";var c=this.children[0].compute(a,b),d=this.children[1].compute(a,b);if(null===c||null===d)return!(null===c&&null===d);var e=c.toString()!=d.toString();return e},a}();a.IsNotEqual=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.isTrue=function(a,b){var c=this.value.compute(a,b);return null===c},a}();a.IsNull=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.children=new Array}return a.prototype.isTrue=function(a,b){if(null===this.children)return!1;for(var c=!0,d=0;d<this.children.length;d++){var e=this.children[d];if(!e.isTrue(a,b)){c=!1;break}}return!c},a}();a.Not=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this._isScaledWithMap=!1,this.computedValues={},this.visualStyle=null,this.visualTemplate=null,this.tooltipTemplate=null,this.isTooltipEnabled=null,this.isFeatureVisible=null,this.useGreatCircleLines=null,this.hitAreaTolerance=null,this.where=null}return a.prototype.getIsScaledWithMap=function(){return this._isScaledWithMap},a.prototype.merge=function(a){},a}();a.Rule=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(b,c,d,e){this.loading=new a.Event,this.loaded=new a.Event,this.updated=new a.Event,this.info=b,this.view=c,this.map=c.getMap()}return b.prototype.getIsLoading=function(){return!1},b.prototype.getLoadPercentage=function(){return 100},b.prototype.getElement=function(){throw new Error("NotImplementedException: WxMap.Client.Layer.GetElement")},b.prototype.getSurface=function(){throw new Error("NotImplementedException: WxMap.Client.Layer.GetSurface")},b.prototype.getOpacity=function(){return this.info.opacity},b.prototype.setOpacity=function(a){this.info.opacity=a},b.prototype.update=function(){},b.prototype.start=function(){},b.prototype.stop=function(){},b.prototype.pin=function(){this.info.isPinned=!0},b.prototype.unpin=function(){this.info.isPinned=!1},b.Canvas=L.Class.extend({onAdd:function(a){this._map=a,this.canvas=L.DomUtil.create("canvas","leaflet-zoom-hide"),this.canvas.style.position="absolute",a.getPanes().overlayPane.appendChild(this.canvas),a.on("move",this._reset,this),this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this.Canvas),a.off("viewreset",this._reset,this)},_reset:function(){var a=this._map.getBounds(),b=a.getNorthWest(),c=this._map.latLngToLayerPoint(b);L.DomUtil.setPosition(this.canvas,c)}}),b}();b.Layer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(e,f,g,h){var i=this;c.call(this,e,f,g,h),this._isRegistered=!1,this._zIndex=-1,this._surface=null,this._isLoading=!1,this._wireViewStarted=function(a,b){i.onViewStarted(a,b)},this._wireViewStopped=function(a,b){i.onViewStopped(a,b)},this._wireLayerUpdated=function(a,b){i.onLayerUpdated(a,b)},this._wireLoading=function(a){i.onLoading(a)},this._wireLoaded=function(a){i.onLoaded(a)};var j=this.view.getControl().clock.getTime();if(this.info.deriveCurrentTimes(j),this.setOpacity(g),h.bingMapKey&&h.bingImagerySet){var k="http://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+h.bingImagerySet+"?key="+h.bingMapKey,l=this,m=a.Net.createPaddedRequest(k,"jsonp");m.callback=function(a){b.BingLayerInfo.cacheModifiers=a.resourceSets[0].resources[0].imageUrlSubdomains,l.info.href=a.resourceSets[0].resources[0].imageUrl;var c=l.info.deriveUrl(),e=l.info.deriveOptions();l._surface=new d.Extension(c,e),l.setZIndex(l._zIndex),l._isRegistered||(l._surface.addEventListener("loading",l._wireLoading),l._surface.addEventListener("load",l._wireLoaded),l._isRegistered=!0),l.initialize()},m.send()}else{var k=this.info.deriveUrl(),n=this.info.deriveOptions();this._surface=new d.Extension(k,n),this.initialize()}}return __extends(d,c),d.prototype.getSurface=function(){return this._surface},d.prototype.getZIndex=function(){return this._zIndex},d.prototype.setZIndex=function(a){this._zIndex=a,this._surface&&this._surface.setZIndex(a)},d.prototype.getIsLoading=function(){return this._isLoading},d.prototype.getOpacity=function(){return this.info.opacity},d.prototype.setOpacity=function(a){var b=this.view.getOpacity(),c=null!=b?b:a;null!=a&&void 0!=a&&this._surface&&(this.info.opacity=c,this._surface.setOpacity(c))},d.prototype.register=function(){this._isRegistered||(this.view.started.addListener(this,this._wireViewStarted),this.view.stopped.addListener(this,this._wireViewStopped),this.info.updated.addListener(this,this._wireLayerUpdated),this._surface&&(this._surface.addEventListener("loading",this._wireLoading),this._surface.addEventListener("load",this._wireLoaded),this._isRegistered=!0))},d.prototype.unregister=function(){this._isRegistered&&(this.view.started.removeListener(this._wireViewStarted),this.view.stopped.removeListener(this._wireViewStopped),this.info.updated.removeListener(this._wireLayerUpdated),this._surface.removeEventListener("loading",this._wireLoading),this._surface.removeEventListener("load",this._wireLoaded),this._isRegistered=!1)},d.prototype.initialize=function(){this.map.addLayer(this._surface)},d.prototype.update=function(){var a=this.info.deriveUrl();this._surface.setUrl(a);var b=this.info.deriveOptions();this._surface.options=b},d.prototype.start=function(){this.register()},d.prototype.stop=function(){this.map.removeLayer(this._surface),this.unregister()},d.prototype.onLoading=function(a){this._isLoading=!0,this.loading.trigger(this)},d.prototype.onLoaded=function(a){this._isLoading=!1,this.loaded.trigger(this)},d.prototype.onViewStarted=function(a,b){this.register()},d.prototype.onViewStopped=function(a,b){var c=this;setTimeout(function(){c.unregister()},1)},d.prototype.onLayerUpdated=function(a,b){var c=this.info.getCurrentValidTime();this.info.deriveCurrentTimes(this.view.getControl().clock.getTime()),c!=this.info.getCurrentValidTime()&&(this.update(),this.updated.trigger(this,{id:this.info.id}))},d.Extension=L.TileLayer.extend({getTileUrl:function(a){var b=this;return L.Util.template(b._url,{s:b._getSubdomain(a),q:b._deriveQuadKey(a.x,a.y,b._getZoomForUrl())})},_deriveQuadKey:function(a,b,c){for(var d=[],e=c;e>0;e--){var f="0",g=1<<e-1;0!=(a&g)&&f++,0!=(b&g)&&(f++,f++),d.push(f)}return d.join("")}}),d}(b.Layer);b.QuadKeyLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(b){this.isValid=!1,this.issueTimes=null,this.validTimes=null,this.validForward=a.TimeSpan.max,this.validBackward=a.TimeSpan.max,this.isBasemap=!1,this.isPinned=!1,this.isAnimate=!this.isBasemap,this.maximumZoom=31,this.minimumZoom=0,this.isConfigured=!1,this.opacity=1,this.startOffset=a.TimeSpan.zero,this.endOffset=a.TimeSpan.zero,this.updated=new a.Event,this.id=b}return c.prototype.getType=function(){return""},c.prototype.getLastUpdated=function(){return this._lastUpdated},c.prototype.setLastUpdated=function(a){this._lastUpdated=a,this.updated.trigger(this)},c.prototype.getCurrentIssueTime=function(){return this._currentIssueTime||"0"},c.prototype.getCurrentValidTime=function(){return this._currentValidTime},c.prototype.getCurrentIteration=function(){return this._currentIteration||"1"},c.prototype.getCurrentCipher=function(){return this._currentCipher||""},c.prototype.toString=function(){return this.label||this.id},c.prototype.deriveUrl=function(a,b,c,d,e,f,g){throw"NotImplementedException: Abstract class LayerInfo does not implement DeriveUrl"},c.prototype.deriveOptions=function(){throw"NotImplementedException: Abstract class LayerInfo does not implement DeriveOptions"},c.prototype.deriveKey=function(a,b,c,d){var e=void 0===d.value?d.toString():d.value.toString();return[this.id,a,b,c,e].join()},c.prototype.deriveCurrentTimes=function(c){var d,e="0",f=new b.ValidTime,g="1",h=0,i=c,j=a.TimeSpan.max,k=a.TimeSpan.fromDates;if(null===this.issueTimes||0===this.issueTimes.length)d=this.validTimes;else{var l=(this.issueTimes,this.issueTimes.length>1?this.issueTimes[1]:this.issueTimes[0]);e=l.value,d=l.validTimes}var m=this.startOffset!=this.endOffset,n=this.validBackward!=a.TimeSpan.max||this.validForward!=a.TimeSpan.max,o=a.DateTime.utcFromNow(),p=!1;if(null!=d)for(var q=0;q<d.length;++q){var r=d[q].value,s=a.DateTime.parseChrono(r),t=i>s?k(s,i):k(i,s);if(t.getTotalMilliseconds()<j.getTotalMilliseconds()){var u=d[q];if(m){var v=a.TimeSpan.fromDates(o,a.DateTime.parseChrono(u.value)),w=v.getTotalMilliseconds();if(w<this.startOffset.getTotalMilliseconds())continue;if(w>this.endOffset.getTotalMilliseconds())continue}if(n){var x=a.DateTime.parseChrono(u.value);if(c>x){var v=a.TimeSpan.fromDates(x,c),w=v.getTotalMilliseconds();if(w>this.validBackward.getTotalMilliseconds())continue}else if(x>c){var v=a.TimeSpan.fromDates(c,x),w=v.getTotalMilliseconds();if(w>this.validForward.getTotalMilliseconds())continue}}p=!0,h=q,j=t,f=u,f.iterations.length>0&&(g=f.iterations[f.iterations.length-1].toString())}}return this._currentIssueTime=e,this._currentValidTime=f.value,this._currentCipher=f.cipher,this._currentIteration=g,this.isValid=p,p},c.cacheModifiers=new Array("0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"),c}();b.LayerInfo=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function a(a){this.unloadedFrames={},this.animator=a;for(var b=this.animator.getTotalFrames(),c=1;b>=c;c++)this.unloadedFrames[c]=!1}return a.prototype.getCount=function(){var a=0;for(var b in this.unloadedFrames)a++;return a},a}(),d=function(){function b(b){var d=this;this._periodPerFrame=new a.TimeSpan(0,300,0,0,0),this._playRate=new a.TimeSpan(300,0,0,0,0),this._totalFrames=0,this._currentFrame=12,this._isPlaying=!1,this._dwellInterval=new a.TimeSpan(500,0,0,0,0),this._timeoutInterval=new a.TimeSpan(0,2,0,0,0),this._isSliding=!0,this._enableLooping=!0,this._isStarting=!1,this._isPaused=!1,this._isLoading=!1,this._isFirstLoopStarted=!1,this.starting=new a.Event,this.started=new a.Event,this.pausing=new a.Event,this.paused=new a.Event,this.stopping=new a.Event,this.stopped=new a.Event,this.frameChanged=new a.Event,this.totalFramesChanged=new a.Event,this.playRateChanged=new a.Event,this.periodPerFrameChanged=new a.Event,this.dwellChanged=new a.Event,this.startTimeChanged=new a.Event,this.endTimeChanged=new a.Event,this.isSlidingChanged=new a.Event,this.enableLoopingChanged=new a.Event,this.isPlayingChanged=new a.Event,this.isPausedChanged=new a.Event,this.loading=new a.Event,this.loaded=new a.Event,this._control=b,this._endTime=this._control.clock.getTime(),this._startTime=new Date(this._endTime.getFullYear(),this._endTime.getMonth(),this._endTime.getDate(),this._endTime.getHours()-1,this._endTime.getMinutes(),this._endTime.getSeconds()),this._control.clock.tick.addListener(this,function(a,b){d.onTick(a,b)}),this._control.view.slidingTimeout.addListener(this,function(a,b){d.onSlidingTimeout(a,b)}),this._control.view.absoluteTimeout.addListener(this,function(a,b){d.onAbsoluteTimeout(a,b)}),this._loadedFrames=new c(this),this.setTotalFrames(12)}return b.prototype.getStartTime=function(){return this._startTime},b.prototype.setStartTime=function(b){if(b>this._endTime)throw new Error("InvalidArgumentException: StartTime cannot exceed the value of EndTime");var c=a.TimeSpan.fromDates(this._control.clock.lastUpdated,a.DateTime.utcFromNow());this._startTime=b,this._startTime.setMilliseconds(b.getMilliseconds()-c.getTotalMilliseconds());var d=this._control.clock.getTime(),e=a.TimeSpan.fromDates(d,this._startTime);Math.abs(e.getTotalMilliseconds())<1e3&&(this._startTime=this._control.clock.getTime());var f=this._totalFrames;this.setTotalFrames(f),this.startTimeChanged.trigger(this,{startTime:this._startTime})},b.prototype.getEndTime=function(){return this._endTime},b.prototype.setEndTime=function(b){if(b<this._startTime)throw new Error("InvalidArgumentException: EndTime must exceed the value of StartTime");var c=a.TimeSpan.fromDates(this._control.clock.lastUpdated,a.DateTime.utcFromNow());this._endTime=b,this._endTime.setMilliseconds(b.getMilliseconds()-c.getTotalMilliseconds());var d=this._control.clock.getTime(),e=a.TimeSpan.fromDates(d,this._endTime);Math.abs(e.getTotalMilliseconds())<1e3&&(this._endTime=this._control.clock.getTime());var f=this._totalFrames;this.setTotalFrames(f),this.endTimeChanged.trigger(this,{endTime:this._endTime})},b.prototype.getPeriodPerFrame=function(){return this._periodPerFrame},b.prototype.setPeriodPerFrame=function(b){this._periodPerFrame=b;var c=a.TimeSpan.fromDates(this._startTime,this._endTime,!1),d=c.getTotalMilliseconds()/this._periodPerFrame.getTotalMilliseconds(),e=Math.ceil(d);this._totalFrames=e,this.periodPerFrameChanged.trigger(this,{totalFrames:this._totalFrames,periodPerFrame:this._periodPerFrame.getTotalMilliseconds()}),this.totalFramesChanged.trigger(this,{totalFrames:this._totalFrames,periodPerFrame:this._periodPerFrame.getTotalMilliseconds()})},b.prototype.getTotalFrames=function(){return this._totalFrames},b.prototype.setTotalFrames=function(b){this._totalFrames=b;var c=a.TimeSpan.fromDates(this._startTime,this._endTime,!1),d=c.getTotalMilliseconds()/(this._totalFrames-1),e=Math.floor(d);this._periodPerFrame=new a.TimeSpan(e,0,0,0,0),this._isPlaying&&(this._control.clock.getTime()<this._startTime&&this._control.clock.setTime(this._startTime),this._control.clock.getTime()>this._endTime&&this._control.clock.setTime(this._endTime),this.skipToTime(this._control.clock.getTime())),this.totalFramesChanged.trigger(this,{totalFrames:this._totalFrames,periodPerFrame:this._periodPerFrame.getTotalMilliseconds()}),this.periodPerFrameChanged.trigger(this,{totalFrames:this._totalFrames,periodPerFrame:this._periodPerFrame.getTotalMilliseconds()})},b.prototype.getCurrentFrame=function(){return this._currentFrame},b.prototype.setCurrentFrame=function(a){this.skipToFrame(a)},b.prototype.getPlayRate=function(){return this._playRate},b.prototype.setPlayRate=function(a){this._playRate=a,this.playRateChanged.trigger(this,{playRate:this._playRate.getTotalMilliseconds()})},b.prototype.getIsPlaying=function(){return this._isPlaying},b.prototype.getIsPaused=function(){return this._isPaused},b.prototype.getIsSliding=function(){return this._isSliding},b.prototype.setIsSliding=function(a){var b=this;a!==!0||this._isSliding?a===!1&&this._isSliding&&this._control.clock.tick.removeListener(this.onTick):this._control.clock.tick.addListener(this,function(a,c){b.onTick(a,c)}),this._isSliding=a,this.isSlidingChanged.trigger(this,{isSliding:this._isSliding})},b.prototype.getIsStarting=function(){return this._isStarting},b.prototype.getDwell=function(){return this._dwellInterval},b.prototype.setDwell=function(a){this._dwellInterval=a,this.dwellChanged.trigger(this,{dwell:this._dwellInterval.getTotalMilliseconds()})},b.prototype.getEnableLooping=function(){return this._enableLooping},b.prototype.setEnableLooping=function(a){this._enableLooping=a,this.enableLoopingChanged.trigger(this,{enableLooping:this._enableLooping})},b.prototype.getIsTicking=function(){return!this._isPaused&&this._isPlaying},b.prototype.getLoadedFramePercent=function(){if(this._isLoading){var a=this._totalFrames-this._loadedFrames.getCount(),b=a/this._totalFrames,c=100*b,d=Math.round(c);return d}return 100},b.prototype.getLoadedFrameCount=function(){if(this._isLoading){var a=this._totalFrames-this._loadedFrames.getCount();return a}return this._totalFrames},b.prototype.getIsLoading=function(){return this._isLoading},b.prototype.startTiming=function(){var a=this;this._timeoutTimer=setTimeout(function(){a.timeout()},this._timeoutInterval.getTotalMilliseconds())},b.prototype.stopTiming=function(){clearTimeout(this._timeoutTimer)},b.prototype.startDwelling=function(){var a=this;this._dwellTimer=setTimeout(function(){a.dwell()},this._dwellInterval.getTotalMilliseconds())},b.prototype.stopDwelling=function(){clearTimeout(this._dwellTimer)},b.prototype.startAnimating=function(){var a=this;this._animationTimer=setTimeout(function(){a.animate()},this._playRate.getTotalMilliseconds())},b.prototype.stopAnimating=function(){clearTimeout(this._animationTimer)},b.prototype.slide=function(a){var b=new Date,c=this._endTime.valueOf()+a.getTotalMilliseconds();b.setTime(c),this._endTime=b,this.endTimeChanged.trigger(this,{endTime:this._endTime});var d=new Date,e=this._startTime.valueOf()+a.getTotalMilliseconds();d.setTime(e),this._startTime=d,this.startTimeChanged.trigger(this,{startTime:this._startTime})},b.prototype.animate=function(){this.stopAnimating(),this._isPlaying&&this._isLoading&&(delete this._loadedFrames.unloadedFrames[this._currentFrame],0===this._loadedFrames.getCount()&&this.raiseLoaded()),this.forward(),this.stopTiming(),this.startTiming(),this.startAnimating()},b.prototype.timeout=function(){this.stopTiming(),this.forward(),this.startTiming()},b.prototype.dwell=function(){this.stopAnimating(),this.stopTiming(),this._isPlaying&&!this._isPaused&&(this.stopDwelling(),this.skipToStart(),this.startAnimating(),this.startTiming(),this._isStarting=!1,this._isFirstLoopStarted=!0)},b.prototype.raiseLoading=function(){this._loadedFrames=new c(this),this._isLoading||(this._isLoading=!0,this.loading.trigger())},b.prototype.cancelLoading=function(){this._isLoading=!1},b.prototype.raiseLoaded=function(){this._isLoading&&(this._isLoading=!1,this.loaded.trigger())},b.prototype.play=function(){var a=this;this._isFirstLoopStarted=!1,this._control.view.moved.addListener(this,function(b,c){a.onMoved(b,c)}),this._control.view.zoomed.addListener(this,function(b,c){a.onZoomed(b,c)}),this._control.view.sizeChanged.addListener(this,function(b,c){a.onSizeChanged(b,c)}),this._control.clock.setIsSliding(!1),this._isStarting=!0,this.starting.trigger(this),this.raiseLoading(),this.startAnimating(),this.startTiming(),this._isPlaying=!0,this.isPlayingChanged.trigger(this,{isPlaying:this._isPlaying}),this._isPaused=!1,this.isPausedChanged.trigger(this,{isPaused:this._isPaused}),this._isStarting=!1,this.started.trigger(this)},b.prototype.stop=function(){this.cancelLoading(),this._control.view.moved.removeListener(this.onMoved),this._control.view.zoomed.removeListener(this.onZoomed),this._control.view.sizeChanged.removeListener(this.onSizeChanged),this.stopping.trigger(),this.stopAnimating(),this.stopTiming(),this._control.clock.setIsSliding(!0),this.skipToNow(),this._isPlaying=!1,this.isPlayingChanged.trigger(this,{isPlaying:this._isPlaying}),this._isPaused=!1,this.isPausedChanged.trigger(this,{isPaused:this._isPaused}),this.stopped.trigger(this)},b.prototype.pause=function(){this.pausing.trigger(this),this.stopAnimating(),this.stopTiming(),this._isPlaying=!0,this.isPlayingChanged.trigger(this,{isPlaying:this._isPlaying}),this._isPaused=!0,this.isPausedChanged.trigger(this,{isPaused:this._isPaused}),this.paused.trigger(this)},b.prototype.forward=function(){if(this._currentFrame<this._totalFrames){this._currentFrame++;var a=this._periodPerFrame.getTotalMilliseconds()*(this._currentFrame-1),b=new Date,c=this._startTime.valueOf()+a;b.setTime(c),this._control.clock.setTime(b),this.frameChanged.trigger(this,{frame:this._currentFrame,time:b})}else this._enableLooping||!this._isFirstLoopStarted?(this.stopAnimating(),this.stopTiming(),this.startDwelling()):this.stop()},b.prototype.backward=function(){if(this._currentFrame>1){this._currentFrame--;var a=this._periodPerFrame.getTotalMilliseconds()*(this._currentFrame-1),b=new Date(this._startTime.getFullYear(),this._startTime.getMonth(),this._startTime.getDate(),this._startTime.getHours(),this._startTime.getMinutes(),this._startTime.getSeconds(),this._startTime.getMilliseconds());b.setMilliseconds(b.getMilliseconds()+a),this._control.clock.setTime(b),this.frameChanged.trigger(this,{frame:this._currentFrame,time:b})}},b.prototype.skipToNow=function(){this.skipToTime(a.DateTime.utcFromNow())},b.prototype.skipToStart=function(){this._control.clock.setTime(this._startTime),this._currentFrame=1,this.frameChanged.trigger(this,{frame:this._currentFrame,time:this._startTime})},b.prototype.skipForward=function(a){var b=this._currentFrame+a;if(b<this._totalFrames){this._currentFrame=b;var c=this._periodPerFrame.getTotalMilliseconds()*(this._currentFrame-1),d=new Date(this._startTime.getFullYear(),this._startTime.getMonth(),this._startTime.getDate(),this._startTime.getHours(),this._startTime.getMinutes(),this._startTime.getSeconds(),this._startTime.getMilliseconds());d.setMilliseconds(d.getMilliseconds()+c),this._control.clock.setTime(d),this.frameChanged.trigger(this,{frame:this._currentFrame,time:d})}else this.skipToEnd()},b.prototype.skipBackward=function(a){var b=this._currentFrame-a;if(b>1){this._currentFrame=b;var c=this._periodPerFrame.getTotalMilliseconds()*(this._currentFrame-1),d=new Date(this._startTime.getFullYear(),this._startTime.getMonth(),this._startTime.getDate(),this._startTime.getHours(),this._startTime.getMinutes(),this._startTime.getSeconds(),this._startTime.getMilliseconds());d.setMilliseconds(d.getMilliseconds()+c),this._control.clock.setTime(d),this.frameChanged.trigger(this,{frame:this._currentFrame,time:d})}else this.skipToStart()},b.prototype.skipToTime=function(b){b<this._startTime&&(b=this._startTime),b>this._endTime&&(b=this._endTime);var c=a.TimeSpan.fromDates(b,this._endTime,!1),d=c.getTotalMilliseconds()/this._periodPerFrame.getTotalMilliseconds(),e=Math.round(this._totalFrames-d);this._control.clock.setTime(b),this._currentFrame!=e&&(this._currentFrame=e,this.frameChanged.trigger(this,{frame:this._currentFrame,time:b}))},b.prototype.skipToFrame=function(a){var b;if(a>this._totalFrames||0>a)throw new Error("InvalidOperationException: The frame is outside the bounds of the animation");a>this._currentFrame?(b=a-this._currentFrame,this.skipForward(b)):a<this._currentFrame&&(b=this._currentFrame-a,this.skipBackward(b))},b.prototype.skipToEnd=function(){this._control.clock.setTime(this._endTime),this._currentFrame=this._totalFrames,this.frameChanged.trigger(this,{frame:this._currentFrame,time:this._endTime})},b.prototype.modifyRange=function(b,c){if(null===b)throw new Error("ArgumentNullException: StartTime cannot be null");if(null===c)throw new Error("ArgumentNullException: EndTime cannot be null");if(b>c)throw new Error("InvalidArgumentException: StartTime cannot exceed the value of EndTime");var d,e,f;d=a.TimeSpan.fromDates(this._control.clock.lastUpdated,a.DateTime.utcFromNow()),this._startTime=b,this._startTime.setMilliseconds(b.getMilliseconds()-d.getTotalMilliseconds()),f=this._control.clock.getTime(),e=a.TimeSpan.fromDates(f,this._startTime),Math.abs(e.getTotalMilliseconds())<1e3&&(this._startTime=this._control.clock.getTime()),d=a.TimeSpan.fromDates(this._control.clock.lastUpdated,a.DateTime.utcFromNow()),this._endTime=c,this._endTime.setMilliseconds(c.getMilliseconds()-d.getTotalMilliseconds()),f=this._control.clock.getTime(),e=a.TimeSpan.fromDates(f,this._endTime),Math.abs(e.getTotalMilliseconds())<1e3&&(this._endTime=this._control.clock.getTime());var g=this._totalFrames;this.setTotalFrames(g),this.startTimeChanged.trigger(this,{startTime:this._startTime}),this.endTimeChanged.trigger(this,{endTime:this._endTime})},b.prototype.minimizeRange=function(){var b,c=a.DateTime.min,d=a.DateTime.max,e=this._control.view.getLayers();for(var f in e){var g=this._control.settings.deriveLayerInfo(f);if(g.isAnimate){if(null===g.issueTimes||0===g.issueTimes.length)b=g.validTimes;else{var h=g.issueTimes.length>1?g.issueTimes[1]:g.issueTimes[0];b=h.validTimes}if(null!=b&&b.length>0){var i=a.DateTime.parseChrono(b[b.length-1].value),j=a.DateTime.parseChrono(b[0].value);(c===a.DateTime.min||i>c&&d>i)&&(c=i),(d===a.DateTime.max||d>j&&j>c)&&(d=j)}}}this.modifyRange(c,d)},b.prototype.maximizeRange=function(){var b=a.DateTime.min,c=a.DateTime.max,d=this._control.view.getLayers();for(var e in d){var f=this._control.settings.deriveLayerInfo(e);if(f.isAnimate){var g;if(null===f.issueTimes||0===f.issueTimes.length)g=f.validTimes;else{var h=f.issueTimes.length>1?f.issueTimes[1]:f.issueTimes[0];g=h.validTimes}if(null!=g&&g.length>0){var i=a.DateTime.parseChrono(g[0].value),j=a.DateTime.parseChrono(g[g.length-1].value);(b===a.DateTime.min||b>j&&c>j)&&(b=j),(c===a.DateTime.max||i>c&&i>b)&&(c=i)}}}this.modifyRange(b,c)},b.prototype.onMoved=function(a,b){this.raiseLoading()},b.prototype.onZoomed=function(a,b){this.raiseLoading()},b.prototype.onSizeChanged=function(a,b){this.raiseLoading()},b.prototype.onTick=function(a,b){this.slide(b.ellapsed)},b.prototype.onSlidingTimeout=function(a,b){this.stop()},b.prototype.onAbsoluteTimeout=function(a,b){this.stop()},b}();b.Animator=d}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(b,c,d){var e=this;void 0===d&&(d=6e4),this._isEnabled=!1,this._isPolling=!1,this._pollCount=0,this._wireViewStarted=function(a,b){e.onViewStarted(a,b)},this._wireViewStopped=function(a,b){e.onViewStopped(a,b)},this.polling=new a.Event,this.polled=new a.Event,this._serviceUri=b,this._pollingInterval=d,this.control=c,this.control.view.started.addListener(this,this._wireViewStarted),this.control.view.stopped.addListener(this,this._wireViewStopped)}return c.prototype.getServiceUri=function(){return this._serviceUri},c.prototype.setServiceUri=function(a){this._serviceUri=a},c.prototype.getPollingInterval=function(){return this._pollingInterval},c.prototype.setPollingInterval=function(a){this._pollingInterval=a},c.prototype.getIsPolling=function(){return this._isPolling},c.prototype.getDocument=function(){return this._document},c.prototype.getCacheModifiers=function(){return this._cacheModifiers},c.prototype.getPollCount=function(){return this._pollCount},c.prototype.getCapabilities=function(){return this._document},c.prototype.setCapabilities=function(c){this._document=c;var d=this._document.hosts.wsi;b.LayerInfo.cacheModifiers=d.s,this._document.mode!=this.control.settings.getMode()&&this.control.settings.setMode(this._document.mode);for(var e,f,g,h=this.control.settings.layers,i=this._document.layers,j=0,k=i.length;k>j;j++){e=i[j];for(var l in h)if(f=h[l],void 0!=f&&e.n===f.id){if(!f.isConfigured){var m=this._document.hosts[f.hostId];g=m.uri.replace("{n}",f.id),g=g.replace("{e}",f.extension),f.href=g,f.isConfigured=!0}var n=!1;if(e.m&&e.m.length>0&&(null===f.issueTimes||0===f.issueTimes.length||e.m[0].t!=f.issueTimes[0].value)){for(var o=[],p=0,q=e.m.length;q>p;p++){for(var r=e.m[p],s=new b.IssueTime(r.t),t=0;t<r.v.length;t++){var u=r.v[t],v=new b.ValidTime(u.t,u.c);v.iterations=u.i,s.validTimes.push(v)}o.push(s)}f.issueTimes=o,n=!0}if(e.v&&e.v.length>0&&(null===f.validTimes||0===f.validTimes.length||e.v[0].t!=f.validTimes[0].value)){for(var w=[],t=0;t<e.v.length;t++){var u=e.v[t],v=new b.ValidTime(u.t,u.c);v.iterations=u.i,w.push(v)}f.validTimes=w,n=!0}n&&f.setLastUpdated(a.DateTime.utcFromNow())}}},c.prototype.poll=function(){this.requestCapabilities()},c.prototype.parseCapabilities=function(a){var b=JSON.parse(a);this.setCapabilities(b)},c.prototype.start=function(a){var b=this;this._isEnabled||(this._isEnabled=!0,a?setTimeout(function(){b.poll(),b._timer=setInterval(function(){b.poll()},b._pollingInterval)},a):(this.poll(),this._timer=setInterval(function(){b.poll()},this._pollingInterval)))},c.prototype.requestCapabilities=function(){var b=this;this.polling.trigger(this);var c=!1,d=a.Net.createCorsRequest("GET",this._serviceUri,!0);d.timeout=15e3,d.onerror=function(){},d.timeout=function(){},d.onabort=function(){},d.onprogress=function(){},d.onreadystatechange=function(){},d.onloadstart=function(){},d.onloadend=function(){},d.onload=function(){if(!c)try{var a=d.responseText;b.parseCapabilities(a),b._pollCount++,b.polled.trigger(b,{pollCount:b._pollCount}),c=!0}catch(e){}},d.send(),setTimeout(function(){if(!c){null!=d&&void 0!=d&&(d.abort,d=null);var e=a.Net.createCorsRequest("GET",b._serviceUri,!0);e.timeout=15e3,e.onerror=function(){},e.ontimeout=function(){},e.onabort=function(){},e.onprogress=function(){},e.onreadystatechange=function(){},e.onloadstart=function(){},e.onloadend=function(){},e.onload=function(){if(!c)try{var a=d.responseText;b.parseCapabilities(a),b._pollCount++,b.polled.trigger(b,{pollCount:b._pollCount}),c=!0}catch(e){}},e.send()}},15e3)},c.prototype.stop=function(){this._isEnabled&&(this._isEnabled=!1,clearInterval(this._timer))},c.prototype.onViewStopped=function(a,b){this.stop()},c.prototype.onViewStarted=function(a,b){this.start()},c}();b.CapabilityClient=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(b){this._isSliding=!0,this._isTicking=!0,this._tickingInterval=1e3,this.tick=new a.Event,this.timeChanged=new a.Event,this._time=b||a.DateTime.utcFromNow(),this.lastUpdated=a.DateTime.utcFromNow(),
this.setTime(this.lastUpdated),this.advance()}return b.prototype.getIsSliding=function(){return this._isSliding},b.prototype.setIsSliding=function(a){a&&!this._isSliding?this._isSliding=a:!a&&this._isSliding&&(this._isSliding=a)},b.prototype.getIsTicking=function(){return this._isTicking},b.prototype.setIsTicking=function(a){a&&!this._isTicking?(this._isTicking=a,this.startTicking()):!a&&this._isTicking&&(this._isTicking=a,this.stopTicking())},b.prototype.getTickingInterval=function(){return this._tickingInterval},b.prototype.setTickingInterval=function(a){this.stopTicking(),this._tickingInterval=a,this.startTicking()},b.prototype.getTime=function(){return this._time},b.prototype.setTime=function(a){this._time=a,this.timeChanged.trigger(this,{time:this._time})},b.prototype.advance=function(){this.stopTicking();var b=a.DateTime.utcFromNow(),c=this.lastUpdated;this.lastUpdated=b;var d=a.TimeSpan.fromDates(c,b);if(this._isSliding){var e=this.getTime(),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),g=f.getMilliseconds()+d.getTotalMilliseconds();f.setMilliseconds(g),this.setTime(f)}this.tick.trigger(this,{time:this.lastUpdated,ellapsed:d}),this.startTicking()},b.prototype.startTicking=function(){var a=this;this._isTicking?this._timer=setTimeout(function(){a.advance()},this._tickingInterval):this.stopTicking()},b.prototype.stopTicking=function(){clearTimeout(this._timer)},b.prototype.start=function(){this.setIsTicking(!0)},b.prototype.stop=function(){this.setIsTicking(!1)},b}();b.Clock=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(c){var d=this;this._layers={},this._layerOrder=new Array,this._isZooming=!1,this._isPanning=!1,this._isRunning=!1,this._isLoading=!1,this._slidingTimeout=-1,this._absoluteTimeout=-1,this._opacity=null,this._size=new a.Size(0,0),this._projection=new a.Gis.MercatorProjection,this._minimumScale=0,this._resumeAnimating=!1,this._mouseEventArgs=null,this._tooltip=new L.Popup({autoPan:!1,maxWidth:400}),this._tooltipLimit=null,this._tooltipContent="",this._tooltipContentRaw="",this._tooltipTitle="Details",this._isLocked=!0,this._tooltipLayerId="",this._tooltipGeoPoint=null,this._tooltipAutoCenter=!0,this._isTooltipOpen=!1,this._isPreloadFramesEnabled=!0,this._wireLayerLoading=function(a,b){d.onLayerLoading(a,b)},this._wireLayerLoaded=function(a,b){d.onLayerLoaded(a,b)},this._wireLayerUpdated=function(a,b){d.onLayerUpdated(a,b)},this._wireMouseDown=function(a){d.onMouseDown(a)},this._wireMouseUp=function(a){d.onMouseUp(a)},this._wireMouseOver=function(a){d.onMouseOver(a)},this._wireMouseOut=function(a){d.onMouseOut(a)},this._wireMouseMove=function(a){d.onMouseMove(a)},this._wireMouseWheel=function(a){d.onMouseWheel(a)},this._wireClick=function(a,b){d.onClick(a,b)},this._wireDoubleClick=function(a,b){d.onDoubleClick(a,b)},this._wireKeyDown=function(a,b){d.onKeyDown(a,b)},this._wireKeyPress=function(a,b){d.onKeyPress(a,b)},this._wireKeyUp=function(a,b){d.onKeyUp(a,b)},this._wireTouchEnter=function(a){d.onTouchEnter(a)},this._wireTouchStart=function(a){d.onTouchStart(a)},this._wireTouchMove=function(a){d.onTouchMove(a)},this._wireTouchEnd=function(a){d.onTouchEnd(a)},this._wireTouchLeave=function(a){d.onTouchLeave(a)},this._wireTouchCancel=function(a){d.onTouchCancel(a)},this._wireWindowResize=function(a,b){d.onWindowResize(a,b)},this._wireZoomStart=function(a){d.onZoomStart(a)},this._wireZoomEnd=function(a){d.onZoomEnd(a)},this._wireMoveStart=function(a){d.onMoveStart(a)},this._wireMove=function(a){d.onMove(a)},this._wireMoveEnd=function(a){d.onMoveEnd(a)},this._wirePopupClose=function(a){d.onPopupClose(a)},this.page=function(a,b){var c=0;a>0?c=this._size.Width/2:0>a&&(c=-(this._size.Width/2));var d=0;b>0?d=-(this._size.Width/2):0>b&&(d=this._size.Width/2),this.pan(c,d)},this.layerArranged=new a.Event,this.layerAdded=new a.Event,this.layerRemoved=new a.Event,this.layerUpdated=new a.Event,this.zooming=new a.Event,this.zoomed=new a.Event,this.panning=new a.Event,this.moved=new a.Event,this.panned=new a.Event,this.sizeChanged=new a.Event,this.slidingTimeout=new a.Event,this.absoluteTimeout=new a.Event,this.stopped=new a.Event,this.started=new a.Event,this.loading=new a.Event,this.loaded=new a.Event,this.minimumZoomLevelChanged=new a.Event,this.maximumZoomLevelChanged=new a.Event,this.mouseEnter=new a.Event,this.mouseLeave=new a.Event,this.mouseLeftButtonDown=new a.Event,this.mouseLeftButtonUp=new a.Event,this.mouseMove=new a.Event,this.mouseRightButtonDown=new a.Event,this.mouseRightButtonUp=new a.Event,this.mouseWheel=new a.Event,this.mouseClick=new a.Event,this.mouseDoubleClick=new a.Event,this.keyDown=new a.Event,this.keyPress=new a.Event,this.keyUp=new a.Event,this.touchEnter=new a.Event,this.touchStart=new a.Event,this.touchMove=new a.Event,this.touchEnd=new a.Event,this.touchLeave=new a.Event,this.touchCancel=new a.Event,this.touchTap=new a.Event,this.touchDoubleTap=new a.Event,this.tooltipDetected=new a.Event,this.tooltipOpened=new a.Event,this.tooltipClosed=new a.Event,this.tooltipMoved=new a.Event,this.tooltipRendered=new a.Event,this._control=c;var e=this._control.getId();this._element=document.getElementById(e),this._element.style.backgroundImage="url("+b.Settings.assetHost+"/Images/grid.png)",this._element.style.backgroundColor="#EEEEEE",this._element.style.overflow="hidden";this.computeMinimumZoomLevel();a.addEventListener(window,"resize",this._wireWindowResize),L.Browser.webkit3d=!1;var f=new L.LatLng(0,0);this._map=new L.Map(e,{zoomControl:!1,attributionControl:!1,keyboardPanOffset:50,closePopupOnClick:!0,maxZoom:31,minZoom:0}).setView(f,3),this._map.on("zoomstart",this._wireZoomStart),this._map.on("zoomend",this._wireZoomEnd),this._map.on("movestart",this._wireMoveStart),this._map.on("move",this._wireMove),this._map.on("moveend",this._wireMoveEnd),this._map.on("popupClose",this._wirePopupClose),this._map.scrollWheelZoom.disable();var g=this._map.getContainer();this._overlay=document.createElement("img"),this._overlay.id="crosshair",this._overlay.src=b.Settings.assetHost+"/Assets/crosshair.png",this._overlay.style.height="7px",this._overlay.style.width="7px",this._overlay.style.display="block",this._overlay.style.position="absolute",this._overlay.style.zIndex=1e3,g.appendChild(this._overlay),this.resize(),this.applyDefaultStyle()}return c.prototype.getMap=function(){return this._map},c.prototype.getInputDevice=function(){return this._inputDevice},c.prototype.getControl=function(){return this._control},c.prototype.getLayers=function(){return this._layers},c.prototype.getLayerOrder=function(){return this._layerOrder},c.prototype.getOrderedLayers=function(){for(var a=[],b=0;b<this._layerOrder.length;b++){var c=this._layerOrder[b],d=this._layers[c];a.push(d)}return a},c.prototype.getIsZooming=function(){return this._isZooming},c.prototype.getIsPanning=function(){return this._isPanning},c.prototype.getIsRunning=function(){return this._isRunning},c.prototype.getIsLoading=function(){for(var a in this._layers)if(this._layers[a].getIsLoading())return!0;return!1},c.prototype.getZoomLevel=function(){return this._map.getZoom()},c.prototype.getMinimumZoomLevel=function(){return this._map.options.minZoom},c.prototype.setMinimumZoomLevel=function(a){var b=this.computeMinimumZoomLevel(),c=b>a?b:a,d=this._map.options.minZoom;if(c!=d&&c<=this._map.options.maxZoom){this._map.options.minZoom=c,this.getZoomLevel()<c&&this.zoom(c);var e={oldZoomLevel:d,newZoomLevel:c};this.minimumZoomLevelChanged.trigger(this,e)}},c.prototype.getMaximumZoomLevel=function(){return this._map.options.maxZoom},c.prototype.setMaximumZoomLevel=function(a){this._map.options.maxZoom=a},c.prototype.getSlidingTimeout=function(){return this._slidingTimeout},c.prototype.setSlidingTimeout=function(a){this.stopSliding(),this._slidingTimeout=a,this._slidingTimeout>0&&this.startSliding()},c.prototype.getAbsoluteTimeout=function(){return this._absoluteTimeout},c.prototype.setAbsoluteTimeout=function(a){this.stopAbsolute(),this._absoluteTimeout=a,this._absoluteTimeout>0&&this.startAbsolute()},c.prototype.getOpacity=function(){return this._opacity},c.prototype.setOpacity=function(a){if(this._isRunning&&(this._opacity=a,null!==a))for(var b in this._layers){var c=this._layers[b];c.info.isBasemap||c.setOpacity(a)}},c.prototype.getBasemapLayers=function(){var a=new Array;for(var b in this._layers){var c=this._layers[b];c.info.isBasemap&&a.push(b)}return a},c.prototype.getPinnedLayers=function(){var a=[];for(var b in this._layers){var c=this._layers[b];c.info.isPinned&&a.push(b)}return a},c.prototype.getTiles=function(){return this.calculateTiles()},c.prototype.getQuadKeys=function(){for(var b=this.calculateTiles(),c=new Array,d=Math.pow(2,this.getZoomLevel()),e={},f=0;f<b.length;f++){var g=b[f],h=d-g.y,i=a.Gis.TmsTileSystem.tileXYToQuadkey(g.x,h-1,g.z);e.hasOwnProperty(i)||(e[i]=null,c.push(i))}return c.sort()},c.prototype.getGeoCenter=function(){var a=this._map.getCenter().toGeoPoint();return a},c.prototype.getScreenCenter=function(){return new a.Point(this._size.width/2,this._size.height/2)},c.prototype.getProjection=function(){return this._projection},c.prototype.getSize=function(){return this._size},c.prototype.getWidth=function(){return this._size.width},c.prototype.getHeight=function(){return this._size.height},c.prototype.getGeoBoundingBox=function(){var b=this._map.getBounds(),c=b.getNorthEast(),d=b.getSouthWest(),e=a.Gis.GeoBoundingBox.fromDegrees(c.lat,d.lng,d.lat,c.lng);return e},c.prototype.setGeoBoundingBox=function(a){var b=new L.LatLng(a.south.getDegrees(),a.west.getDegrees()),c=new L.LatLng(a.north.getDegrees(),a.east.getDegrees()),d=new L.LatLngBounds(b,c);this._map.setMaxBounds(d)},c.prototype.getScale=function(){var b=a.Gis.TmsTileSystem.deriveScale(this.getZoomLevel());return b},c.prototype.getTooltipLayerId=function(){return this._tooltipLayerId},c.prototype.getTooltipLimit=function(){return this._tooltipLimit},c.prototype.setTooltipLimit=function(a){this._tooltipLimit=a},c.prototype.getTooltipTitle=function(){return this._tooltipTitle},c.prototype.setTooltipTitle=function(a){this._tooltipTitle=a;var b=this._tooltipContentRaw;this.setTooltipContent(b)},c.prototype.setTooltipBackground=function(a){var b="#"+this._control.getId()+" .leaflet-popup-content-wrapper, #"+this._control.getId()+" .leaflet-popup-tip{ background: "+a+";}";this._control.injectCss(b)},c.prototype.setTooltipBorderRadius=function(a){var b="#"+this._control.getId()+" .leaflet-popup-content-wrapper {-webkit-border-radius:"+a+";border-radius:"+a+";}";this._control.injectCss(b)},c.prototype.setTooltipPadding=function(a){var b="#"+this._control.getId()+" .leaflet-popup-content-wrapper {padding:"+a+";}";this._control.injectCss(b)},c.prototype.setTooltipShadow=function(a){var b="#"+this._control.getId()+" .leaflet-popup-content-wrapper, .leaflet-popup-tip { box-shadow:"+a+";}";this._control.injectCss(b)},c.prototype.getTooltipContent=function(){return this._tooltipContentRaw},c.prototype.setTooltipContent=function(b){b=b.replace(/\.\.\./gi,"... "),this._tooltipContentRaw=b;var c=new a.StringBuilder,d=this._size.height/2-52,e=this._size.width-40;b.length&&b.length>490;this._tooltipTitle&&c.append("<div style='color:#000;font:bold 10px/10px Tahoma, Arial, Sans-Serif;height:10px;'>").append(this._tooltipTitle).append("</div>"),c.append("<div style='margin-top:1px;padding-top:1px;overflow-x:hidden;overflow-y:auto;max-height:").append(d).append("px;'>"),c.append("<div style='color:#000;height:100%;max-width:").append(e).append("px;'>"),c.append(b),c.append("</div>"),c.append("</div>"),this._tooltipContent=c.toString(),this._tooltip.setContent(this._tooltipContent),this.tooltipRendered.trigger(this,null)},c.prototype.getTooltipGeoPoint=function(){return this._tooltipGeoPoint},c.prototype.setTooltipGeoPoint=function(a){this._tooltipGeoPoint=a,this._tooltip.setLatLng(this._tooltipGeoPoint.toLatLng());var b={geoPoint:a};this.tooltipMoved.trigger(this,b)},c.prototype.getIsTooltipOpen=function(){return this._isTooltipOpen},c.prototype.setTooltipAutoCenter=function(a){this._tooltipAutoCenter=a},c.prototype.getTooltipAutoCenter=function(){return this._tooltipAutoCenter},c.prototype.setTooltipFull=function(){this.setTooltipTitle(""),this.setTooltipBorderRadius("0px"),this.setTooltipPadding("0px"),this.setTooltipBackground("#7f7f7f");var a=document.querySelector(".leaflet-popup-content");a.style.maxWidth="none",a.style.width="",a.firstChild.style.overflowX="initial",a.firstChild.style.overflowY="initial",a.firstChild.firstChild.style.maxWidth="none",a.firstChild.firstChild.style.maxHeight="none";var b=document.querySelector(".leaflet-popup");b.style.position="relative",b.style.left="-"+(this.getWidth()/2-9)+"px",b.style.bottom=this.getHeight()/2-8+"px";var c=a.firstChild.firstChild.firstChild.firstChild;c.style.height=this.getHeight()-20+"px",c.style.width=this.getWidth()-20+"px";var d="#"+this._control.getId()+" .leaflet-popup-tip { display:none; }";this._control.injectCss(d);var e=document.getElementById(this._control.getId());e.style.zIndex="1005";var f=document.getElementById("__wxMap_Cntrls");f.style.zIndex="0"},c.prototype.removeTooltipFull=function(){this.setTooltipTitle("<span style='color:#000;'>Details</span>"),this.setTooltipBorderRadius("0"),this.setTooltipPadding("10px"),this.setTooltipBackground("#fff");var a=document.getElementById(this._control.getId());a.style.zIndex="0";var b=document.getElementById("__wxMap_Cntrls");b.style.zIndex="1002"},c.prototype.arrangeLayers=function(){for(var a=0;a<this._layerOrder.length;a++){var b=this._layerOrder[a],c=this._layers[b];c.setZIndex(2*a)}},c.prototype.startSliding=function(){var a=this;this.stopSliding(),this._slidingTimer=setTimeout(function(){a.onSlidingTimeout()},this._slidingTimeout)},c.prototype.stopSliding=function(){clearTimeout(this._slidingTimer)},c.prototype.startAbsolute=function(){var a=this;this.stopAbsolute(),this._absoluteTimer=setTimeout(function(){a.onAbsoluteTimeout()},this._absoluteTimeout)},c.prototype.stopAbsolute=function(){clearTimeout(this._absoluteTimer)},c.prototype.calculateTiles=function(){var b,c,d=this.getScale(),e=this.getGeoCenter(),f=this.getScreenCenter(),g=this.computeTransforms(this._projection,d,e,f,0),h=[],i={},j=this._size.width,k=this._size.height,l=g.primary.getInverse();b=l.transform(new a.Point(0,0)),c=l.transform(new a.Point(j,k)),this.addTiles(b,c,h,i);var m=g.secondary.getInverse();return b=m.transform(new a.Point(0,0)),c=m.transform(new a.Point(j,k)),this.addTiles(b,c,h,i),h},c.prototype.addTiles=function(b,c,d,e){b=a.Gis.TmsTileSystem.mapToTms(b),c=a.Gis.TmsTileSystem.mapToTms(c),b.x<-1?b.x=-1:b.x>1&&(b.x=1),b.y<-1?b.y=-1:b.y>1&&(b.y=1),c.x<-1?c.x=-1:c.x>1&&(c.x=1),c.y<-1?c.y=-1:c.y>1&&(c.y=1);for(var f=a.Gis.TmsTileSystem.tmsToTile(b,this.getZoomLevel()),g=a.Gis.TmsTileSystem.tmsToTile(c,this.getZoomLevel()),h=f.x,i=g.x,j=g.y,k=f.y,l=a.Gis.Tile,m=h;i>=m;m++)for(var n=j;k>=n;n++){var o=new l(this.getZoomLevel(),m,n),p=[m,n].join();e.hasOwnProperty(p)||(e[p]=null,d.push(o))}},c.prototype.computeTransforms=function(b,c,d,e,f){var g={primary:null,secondary:null},h=this._projection.geoToMap(d),i=new a.Transforms.TranslateTransform(-h.x,-h.y),j=new a.Transforms.RotateTransform(f),k=new a.Transforms.ScaleTransform(c,-c),l=new a.Transforms.TranslateTransform(e.x,e.y),m=new a.Transforms.TransformGroup;m.transforms.push(i),m.transforms.push(j),m.transforms.push(k),m.transforms.push(l),g.primary=m,this._projectionExtent=this._projection.geoToMap(a.Gis.GeoPoint.fromRadians(Math.PI,0)).x-this._projection.geoToMap(a.Gis.GeoPoint.fromRadians(-Math.PI,0)).x;var n,o,p=this._projection.geoToMap(new a.Gis.GeoPoint),q=m.transform(p);q.x<this._size.width/2?(n=e.x+this._projectionExtent*c,o=e.x-this._projectionExtent*c):(o=e.x+this._projectionExtent*c,n=e.x-this._projectionExtent*c),l=new a.Transforms.TranslateTransform(n,e.y);var r=new a.Transforms.TransformGroup;return r.transforms.push(i),r.transforms.push(j),r.transforms.push(k),r.transforms.push(l),g.secondary=r,g},c.prototype.deriveTooltips=function(b){for(var c=new Array,d=this.getLayerOrder(),e=d.length-1;e>0;e--){var f=d[e],g=this._layers[f];if(a.hasInterface(g,"ITooltip")){var h=g.deriveTooltips(b,this._map);c=c.concat(h)}}if(!c.length)return c;for(var i=new Array,j=this._tooltipLimit||c.length,e=0;j>e;e++){var k=c[e];i.push(k)}if(i.length>0){var l={tooltips:i};this.tooltipDetected.trigger(this,l)}return i},c.prototype.deriveTouches=function(c){for(var d=new Array,e=0;e<c.length;e++){var f=c[e],g=new b.Touch,h=f.pageX-this._position.x,i=f.pageY-this._position.y,j=this._map.containerPointToLatLng(new L.Point(h,i));g.screenPoint=new a.Point(h,i),g.geoPoint=j.toGeoPoint(),g.tile=a.Gis.TmsTileSystem.geoToTile(g.geoPoint,this.getZoomLevel()),d.push(g)}return d},c.prototype.createLayer=function(a,c,d){var e=this._control.settings.deriveLayerInfo(a);if(null===e)return null;var f=e.getType(),g=null==this._opacity||e.isBasemap?null:this._opacity;if("TmsGrid"===a){var h=new b.GridLayer(e,this,g,d,256,"#e2b216");return h}if("Graticule"===a){var i=new b.GraticuleLayer(e,this,g,d,"#FF0000");return i}if("TileLayerInfo"===f){var j=new b.TileLayer(e,this,g,d);return j}if("BingLayerInfo"===f){d||(d={});var k=new b.MapboxLayerInfo(a),l=new b.MapboxLayer(k,this,g,d);return l}if("WxMap.Client.WxCentralLayerInfo"===f){var m=new b.QuadKeyLayer(e,this,g,d);return m}if("InrixLayerInfo"===f){var n=new b.InrixLayer(e,this,g,d);return n}if("GeoLayerInfo"===f){var o=new b.GeoLayer(e,this,g,d);return o}if("SweepLayerInfo"===f){var p=new b.SweepLayer(e,this,g,d);return p}return null},c.prototype.computeProjectionExtent=function(){var b=a.Gis.GeoPoint.fromRadians(Math.PI,0),c=a.Gis.GeoPoint.fromRadians(-Math.PI,0);return this._projection.geoToMap(b).x-this._projection.geoToMap(c).x},c.prototype.computeMinimumScale=function(a){var b=a||this.computeProjectionExtent(),c=this._size.width/b;return c},c.prototype.computeMinimumZoomLevel=function(b){var c=b||this.computeMinimumScale(),d=a.Gis.TmsTileSystem.deriveZoomLevel(c),e=null!=this._control.settings.minimumZoom&&d<=this._control.settings.minimumZoom?this._control.settings.minimumZoom:d;return e},c.prototype.lock=function(){if(!this._isLocked)if(this._isLocked=!0,this._map.dragging.disable(),this._map.doubleClickZoom.disable(),this._map.keyboard.disable(),this._map.scrollWheelZoom.disable(),this._map.touchZoom.disable(),this._map.off("mousedown",this._wireMouseDown),this._map.off("mouseup",this._wireMouseUp),this._map.off("mouseover",this._wireMouseOver),this._map.off("mouseout",this._wireMouseOut),L.DomEvent.removeListener(window,"mousemove",this._wireMouseMove),this._map.off("click",this._wireClick),this._map.off("dblclick",this._wireDoubleClick),a.removeEventListener(window,"keydown",this._wireKeyDown),a.removeEventListener(window,"keypress",this._wireKeyPress),a.removeEventListener(window,"keyup",this._wireKeyUp),window.navigator.msPointerEnabled){try{L.DomEvent.removeListener(this._element,"MSPointerDown",this._wireTouchStart)}catch(b){}try{L.DomEvent.removeListener(this._element,"MSPointerMove",this._wireTouchMove)}catch(b){}try{L.DomEvent.removeListener(this._element,"MSPointerUp",this._wireTouchEnd)}catch(b){}}else{try{L.DomEvent.removeListener(this._element,"touchenter",this._wireTouchEnter)}catch(b){}try{L.DomEvent.removeListener(this._element,"touchstart",this._wireTouchStart)}catch(b){}try{L.DomEvent.removeListener(this._element,"touchmove",this._wireTouchMove)}catch(b){}try{L.DomEvent.removeListener(this._element,"touchend",this._wireTouchEnd)}catch(b){}try{L.DomEvent.removeListener(this._element,"touchleave",this._wireTouchLeave)}catch(b){}try{L.DomEvent.removeListener(this._element,"touchcancel",this._wireTouchCancel)}catch(b){}}},c.prototype.unlock=function(){if(this._isLocked){this._isLocked=!1,this._map.dragging.enable(),this._map.doubleClickZoom.enable(),this._map.keyboard.enable(),this._map.scrollWheelZoom.enable(),this._map.touchZoom.enable(),this._map.on("mousedown",this._wireMouseDown),this._map.on("mouseup",this._wireMouseUp),this._map.on("mouseover",this._wireMouseOver),this._map.on("mouseout",this._wireMouseOut),L.DomEvent.addListener(window,"mousemove",this._wireMouseMove,this);var b=L.DomEvent;if(b.on(this._map._container,"mousewheel",this._wireMouseWheel,this),b.on(this._map._container,"MozMousePixelScroll",L.DomEvent.preventDefault),this._map.on("click",this._wireClick),this._map.on("dblclick",this._wireDoubleClick),a.addEventListener(window,"keydown",this._wireKeyDown),a.addEventListener(window,"keypress",this._wireKeyPress),a.addEventListener(window,"keyup",this._wireKeyUp),window.navigator.msPointerEnabled){try{L.DomEvent.addListener(this._element,"MSPointerDown",this._wireTouchStart,this)}catch(c){}try{L.DomEvent.addListener(this._element,"MSPointerMove",this._wireTouchMove,this)}catch(c){}try{L.DomEvent.addListener(this._element,"MSPointerUp",this._wireTouchEnd,this)}catch(c){}}else{try{L.DomEvent.addListener(this._element,"touchstart",this._wireTouchStart,this)}catch(c){}try{L.DomEvent.addListener(this._element,"touchmove",this._wireTouchMove,this)}catch(c){}try{L.DomEvent.addListener(this._element,"touchend",this._wireTouchEnd,this)}catch(c){}try{L.DomEvent.addListener(this._element,"touchenter",this._wireTouchEnter,this)}catch(c){}try{L.DomEvent.addListener(this._element,"touchleave",this._wireTouchLeave,this)}catch(c){}try{L.DomEvent.addListener(this._element,"touchcancel",this._wireTouchCancel,this)}catch(c){}}}},c.prototype.enableGraticule=function(){this.addLayer("Graticule")},c.prototype.disableGraticule=function(){this.removeLayer("Graticule")},c.prototype.enableGrid=function(){this.addLayer("TmsGrid")},c.prototype.disableGrid=function(){this.removeLayer("TmsGrid")},c.prototype.enableStations=function(){this.addLayer("Stations")},c.prototype.disableStations=function(){this.removeLayer("Stations")},c.prototype.move=function(a,b,c,d,e){c||(c=this.getZoomLevel()||4);var f=new L.LatLng(b,a);if(this._map.setView(f,c,!0),d||e){var g=d?this._size.width-d:this._size.width/2,h=e?this._size.height-e:this._size.height/2,i=this.convertToGeoPoint(g,h);this._map.setView(i.toLatLng(),c,!0)}},c.prototype.screenToGeo=function(a){var b=new L.Point(a.x,a.y),c=this._map.containerPointToLatLng(b).toGeoPoint();return c},c.prototype.geoToScreen=function(b){var c=b.toLatLng(),d=this._map.latLngToContainerPoint(c),e=new a.Point(d.x,d.y);return e},c.prototype.findLayer=function(a){return this._layers.hasOwnProperty(a)?this._layers[a]:null},c.prototype.addLayer=function(a,b){return this.insertLayer(a,null,b)},c.prototype.removeLayer=function(a){if(this._isRunning){var b=this._layers[a];if(b){try{b.stop()}catch(c){}delete this._layers[a];for(var d,e=0;e<this._layerOrder.length;e++){var f=this._layerOrder[e];if(f===a){d=e;break}}this._layerOrder.splice(d,1),this.arrangeLayers(),b.loading.removeListener(this._wireLayerLoading),b.loaded.removeListener(this._wireLayerLoaded),b.updated.removeListener(this._wireLayerUpdated),this.slide(),this.clearTooltips(),this.layerRemoved.trigger(this,{id:a})}}},c.prototype.insertLayer=function(a,b,c){if(void 0===b&&(b=null),!a||!this._isRunning||void 0!=this._layers[a])return null;var d=this.createLayer(a,this._map,c);return null===d?null:(this._layers[a]=d,null!=b?this._layerOrder.splice(b,0,a):this._layerOrder.push(a),this.arrangeLayers(),d.start(),d.loading.addListener(this,this._wireLayerLoading),d.loaded.addListener(this,this._wireLayerLoaded),d.updated.addListener(this,this._wireLayerUpdated),this.slide(),this.clearTooltips(),this.layerAdded.trigger(this,{id:a}),d)},c.prototype.clearLayers=function(){if(this._isRunning)for(var a in this._layers)this.removeLayer(a)},c.prototype.arrangeLayer=function(a,b){if(this._isRunning&&void 0!==this._layers[a]){this._layers[a];b>this._layerOrder.length?b=this._layerOrder.length-1:0>b&&(b=0);for(var c,d=0;d<this._layerOrder.length;d++){var e=this._layerOrder[d];a===e&&(c=d)}this._layerOrder.splice(c,1),this._layerOrder.splice(b,0,a),this.arrangeLayers(),this.slide(),this.layerArranged.trigger(this,{id:a,index:b})}},c.prototype.arrangeLayerUp=function(a){if(this._isRunning&&void 0!==this._layers[a]){for(var b,c=(this._layers[a],0);c<this._layerOrder.length;c++){var d=this._layerOrder[c];a===d&&(b=c)}if(b!==this._layerOrder.length-1){var e=b+1;this._layerOrder.splice(b,1),this._layerOrder.splice(e,0,a),this.arrangeLayers(),this.slide(),this.layerArranged.trigger(this,{id:a,index:e})}}},c.prototype.arrangeLayerDown=function(a){if(this._isRunning&&void 0!==this._layers[a]){for(var b,c=(this._layers[a],0);c<this._layerOrder.length;c++){var d=this._layerOrder[c];a===d&&(b=c)}if(!(1>b)){var e=b-1;this._layerOrder.splice(b,1),this._layerOrder.splice(e,0,a),this.arrangeLayers(),this.slide(),this.layerArranged.trigger(this,{id:a,index:e})}}},c.prototype.start=function(){this._isRunning||(this._isRunning=!0,this.unlock(),this._slidingTimeout>0&&this.startSliding(),this._absoluteTimeout>0&&this.startAbsolute(),this.started.trigger(this))},c.prototype.stop=function(){this._isRunning&&(this.loaded.trigger(this),this._isRunning=!1,this.lock(),this.stopSliding(),this.stopAbsolute(),this.stopped.trigger(this))},c.prototype.slide=function(){this._isRunning&&this._slidingTimeout>0&&this.startSliding()},c.prototype.zoom=function(a){this._map.setZoom(a)},c.prototype.zoomIn=function(){this._map.zoomIn()},c.prototype.zoomOut=function(){this._map.zoomOut()},c.prototype.pan=function(a,b){if(this._isRunning){this.slide();var c=new L.Point(a,b);this._map.panBy(c,{animate:!1})}},c.prototype.resize=function(b,c){b&&(this._element.style.width=b+"px"),c&&(this._element.style.height=c+"px");var d=b||this._element.offsetWidth,e=c||this._element.offsetHeight;this._size=new a.Size(d,e),this._map.invalidateSize(),this._position=this.findPosition(this._element);var f=7,g=Math.floor(3.5);this._overlay.style.height=f+"px",this._overlay.style.width=f+"px",this._overlay.style.top=this._size.height/2-g+"px",this._overlay.style.left=this._size.width/2-g+"px",this._projectionExtent=this.computeProjectionExtent();var h=this.computeMinimumZoomLevel();this.getZoomLevel()<h&&this.zoom(h),this.setMinimumZoomLevel(h),this.sizeChanged.trigger(this,{size:this._size})},c.prototype.findPosition=function(b){var c,d;if(c=d=0,b.offsetParent){do c+=b.offsetLeft,d+=b.offsetTop;while(b=b.offsetParent);return new a.Point(c,d)}},c.prototype.applyDefaultStyle=function(){var a=this._element.id.replace(/_Map/,""),b="#"+a+"{alignment-adjust:initial;alignment-baseline:initial;animation:initial;animation-delay:initial;animation-direction:initial;animation-duration:initial;animation-fill-mode:initial;animation-iteration-count:initial;animation-name:initial;animation-play-state:initial;animation-timing-function:initial;azimuth:initial;backface-visibility:initial;background:initial;background-attachment:initial;background-clip:initial;background-color:initial;background-image:initial;background-origin:initial;background-position:initial;background-position-x:initial;background-position-y:initial;background-repeat:initial;background-size:initial;baseline-shift:initial;behavior:initial;binding:initial;border:initial;border-bottom:initial;border-bottom-color:initial;border-bottom-left-radius:initial;border-bottom-right-radius:initial;border-bottom-style:initial;border-bottom-width:initial;border-collapse:initial;border-color:initial;border-image:initial;border-image-outset:initial;border-image-repeat:initial;border-image-slice:initial;border-image-source:initial;border-image-width:initial;border-left:initial;border-left-color:initial;border-left-style:initial;border-left-width:initial;border-radius:initial;border-right:initial;border-right-color:initial;border-right-style:initial;border-right-width:initial;border-spacing:initial;border-style:initial;border-top:initial;border-top-color:initial;border-top-left-radius:initial;border-top-right-radius:initial;border-top-style:initial;border-top-width:initial;border-width:initial;bottom:initial;box-decoration-break:initial;box-shadow:initial;box-sizing:initial;break-after:initial;break-before:initial;break-inside:initial;caption-side:initial;chains:initial;clear:initial;clip:initial;color:initial;color-interpolation:initial;color-interpolation-filters:initial;color-rendering:initial;column-count:initial;column-fill:initial;column-gap:initial;column-rule:initial;column-rule-color:initial;column-rule-style:initial;column-rule-width:initial;columns:initial;content:initial;counter-increment:initial;counter-reset:initial;crop:initial;cue:initial;cue-after:initial;cue-before:initial;cursor:initial;direction:initial;display:block;dominant-baseline:initial;drop-initial-after-adjust:initial;drop-initial-after-align:initial;drop-initial-before-adjust:initial;drop-initial-before-align:initial;drop-initial-size:initial;drop-initial-value:initial;elevation:initial;empty-cells:initial;fill:initial;fill-opacity:initial;fill-rule:initial;filter:initial;fit:initial;fit-position:initial;flex-align:initial;flex-flow:initial;flex-line-pack:initial;flex-order:initial;flex-pack:initial;float:initial;font:initial;font-family:initial;font-feature-settings:initial;font-kerning:initial;font-language-override:initial;font-size:initial;font-size-adjust:initial;font-stretch:initial;font-style:initial;font-synthesis:initial;font-variant:initial;font-variant-alternates:initial;font-variant-caps:initial;font-variant-east-asian:initial;font-variant-ligatures:initial;font-variant-numeric:initial;font-variant-position:initial;font-weight:initial;grid-cell:initial;grid-cell-stacking:initial;grid-column:initial;grid-column-align:initial;grid-column-sizing:initial;grid-column-span:initial;grid-columns:initial;grid-flow:initial;grid-layer:initial;grid-row:initial;grid-row-align:initial;grid-row-sizing:initial;grid-row-span:initial;grid-rows:initial;grid-template:initial;hanging-punctuation:initial;height:initial;hyphens:initial;icon:initial;image-orientation:initial;image-rendering:initial;image-resolution:initial;image-mode:initial;inline-box-align:initial;left:initial;letter-spacing:initial;line-break:initial;line-height:initial;line-stacking:initial;line-stacking-ruby:initial;line-stacking-shift:initial;line-stacking-strategy:initial;list-style:initial;list-style-image:initial;list-style-position:initial;list-style-type:initial;margin:initial;margin-bottom:initial;margin-left:initial;margin-right:initial;margin-top:initial;marker:initial;marker-end:initial;marker-mid:initial;marker-start:initial;marquee-loop:initial;max-height:initial;max-width:initial;min-height:initial;min-width:initial;move-to:initial;nav-down:initial;nav-index:initial;nav-left:initial;nav-right:initial;nav-up:initial;object-fit:initial;object-position:initial;opacity:initial;orphans:initial;outline:initial;outline-color:initial;outline-offset:initial;outline-style:initial;outline-width:initial;overflow:initial;overflow-style:initial;overflow-wrap:initial;overflow-x:initial;overflow-y:initial;padding:initial;padding-bottom:initial;padding-left:initial;padding-right:initial;padding-top:initial;page:initial;page-break-after:initial;page-break-before:initial;page-break-inside:initial;page-policy:initial;pause:initial;pause-after:initial;pause-before:initial;perspective:initial;perspective-origin:initial;pitch:initial;pitch-range:initial;pointer-events:initial;position:initial;presentation-level:initial;quotes:initial;resize:initial;rest:initial;rest-after:initial;rest-before:initial;richness:initial;right:initial;rotation:initial;rotation-point:initial;ruby-align:initial;ruby-overhang:initial;ruby-position:initial;ruby-span:initial;scrollbar-3dlight-color:initial;scrollbar-arrow-color:initial;scrollbar-base-color:initial;scrollbar-darkshadow-color:initial;scrollbar-face-color:initial;scrollbar-highlight-color:initial;scrollbar-shadow-color:initial;scrollbar-track-color:initial;shape-rendering:initial;speak:initial;speak-as:initial;speak-header:initial;speak-numeral:initial;speak-punctuation:initial;speech-rate:initial;stop-color:initial;stop-opacity:initial;stress:initial;stroke:initial;stroke-dasharray:initial;stroke-dashoffset:initial;stroke-linecap:initial;stroke-linejoin:initial;stroke-miterlimit:initial;stroke-opacity:initial;stroke-width:initial;tab-size:initial;table-layout:initial;target:initial;target-name:initial;target-new:initial;target-position:initial;text-align:initial;text-align-last:initial;text-combine-horizontal:initial;text-combine-mode:initial;text-decoration:initial;text-decoration-color:initial;text-decoration-line:initial;text-decoration-skip:initial;text-decoration-style:initial;text-emphasis:initial;text-emphasis-color:initial;text-emphasis-position:initial;text-emphasis-style:initial;text-height:initial;text-indent:initial;text-justify:initial;text-orientation:initial;text-overflow:initial;text-rendering:initial;text-shadow:initial;text-space-collapse:initial;text-transform:initial;text-underline-position:initial;text-wrap:initial;unicode-bidi:initial;user-select:initial;vertical-align:initial;visibility:initial;voice-balance:initial;voice-duration:initial;voice-family:initial;voice-pitch:initial;voice-range:initial;voice-rate:initial;voice-stress:initial;voice-volume:initial;volume:initial;white-space:initial;widows:initial;width:initial;word-break:initial;word-spacing:initial;word-wrap:initial;writing-mode:initial;z-index:initial;zoom:initial;}";
this._control.injectCss(b)},c.prototype.clearTooltips=function(){this.setTooltipContent(""),this.closeTooltips()},c.prototype.openTooltips=function(b,c,d,e){if(void 0===b&&(b=!1),null===this._tooltipGeoPoint&&!c)throw new Error("InvalidOperationException: Tooltip must be positioned before it can be opened");var f=!1;if((void 0!=d&&null!=d||void 0!=e&&null!=e&&e.length>0)&&(f=!0),f){var g=new a.StringBuilder;if(d&&g.append(d),e)for(var h=0;h<e.length;h++){var i=e[h];g.append("<div>").append(i.html).append("</div>")}var j=g.toString();this.setTooltipContent(j)}this._tooltipLayerId=i.layerId,c&&this.setTooltipGeoPoint(c),this._tooltip.openOn(this._map);var k={geoPoint:this._tooltipGeoPoint};if(b&&this._map.panTo(this._tooltipGeoPoint.toLatLng()),!this._isTooltipOpen){var l=this._map.getContainer(),m=l.querySelector(".leaflet-popup-close-button");m&&a.addEventListener(m,"click",this._wirePopupClose),this._isTooltipOpen=!0,this.tooltipOpened.trigger(this,k)}},c.prototype.closeTooltips=function(){this._isTooltipOpen&&(this._map.closePopup(),this._isTooltipOpen=!1,this.tooltipClosed.trigger(this,{}))},c.prototype.convertToGeoPoint=function(a,b){var c=new L.Point(a,b),d=this._map.containerPointToLatLng(c),e=d.toGeoPoint();return e},c.prototype.convertToScreenPoint=function(b,c){var d=new L.LatLng(c,b),e=this._map.latLngToContainerPoint(d),f=new a.Point(e.x,e.y);return f},c.prototype.onSlidingTimeout=function(a,b){this.stop(),this.slidingTimeout.trigger(this)},c.prototype.onAbsoluteTimeout=function(a,b){this.stop(),this.absoluteTimeout.trigger(this)},c.prototype.onSizeChanged=function(a,b){this.slide()},c.prototype.onMoveStart=function(a){this._control.animator&&this._control.animator.getIsPlaying()&&!this._control.animator.getIsPaused()&&(this._resumeAnimating=!0,this._control.animator.pause()),this._isPanning=!0,this.panning.trigger(this,a)},c.prototype.onMove=function(a){this.slide();var b=this._map.getCenter(),c=b.toGeoPoint();this.moved.trigger(this,{geoCenter:c})},c.prototype.onMoveEnd=function(a){this._isPanning=!1,this.panned.trigger(this,a),this._resumeAnimating&&this._control.animator.getIsPaused()&&(this._control.animator.play(),this._resumeAnimating=!1)},c.prototype.onLayerLoading=function(a,b){this._isLoading||(this._isLoading=!0,this.loading.trigger(this))},c.prototype.onLayerLoaded=function(a,b){this._isLoading&&!this.getIsLoading()&&(this._isLoading=!1,this.loaded.trigger(this))},c.prototype.onLayerUpdated=function(a,b){this.layerUpdated.trigger(this,b)},c.prototype.onMouseDown=function(b){this._inputDevice=a.InputDevice.Mouse,this._control.mouse.isDown=!0;var c=new a.Point(b.containerPoint.x,b.containerPoint.y),d=b.latlng.toGeoPoint();this._control.mouse.downScreenPoint=c,this._control.mouse.screenPoint=c,this._control.mouse.geoPoint=d,this.mouseLeftButtonDown.trigger(this,{x:c.x,y:c.y,longitude:d.longitude.getDegrees(),lLatitude:d.latitude.getDegrees()})},c.prototype.onMouseUp=function(b){this._inputDevice=a.InputDevice.Mouse,this._control.mouse.isDown=!1;var c=new a.Point(b.containerPoint.x,b.containerPoint.y),d=b.latlng.toGeoPoint();this._control.mouse.screenPoint=c,this._control.mouse.geoPoint=d,this._control.mouse.downScreenPoint=null,this._mouseEventArgs={x:c.x,y:c.y,longitude:d.longitude.getDegrees(),latitude:d.latitude.getDegrees()},this.mouseLeftButtonUp.trigger(this,this._mouseEventArgs)},c.prototype.onMouseOver=function(b){this._inputDevice=a.InputDevice.Mouse,this._control.mouse.isOver=!0;var c=new a.Point(b.containerPoint.x,b.containerPoint.y),d=b.latlng.toGeoPoint();this._control.mouse.screenPoint=c,this._control.mouse.geoPoint=d,this.mouseEnter.trigger(this,{x:c.x,y:c.y,longitude:d.longitude.getDegrees(),latitude:d.latitude.getDegrees()})},c.prototype.onMouseOut=function(b){this._inputDevice=a.InputDevice.Mouse,this._control.mouse.isOver=!1;var c=new a.Point(b.containerPoint.x,b.containerPoint.y),d=a.Gis.GeoPoint.fromDegrees(b.latlng.lng,b.latlng.lat);this._control.mouse.screenPoint=c,this._control.mouse.geoPoint=d,this.mouseLeave.trigger(this,{x:c.x,y:c.y,longitude:d.longitude.getDegrees(),latitude:d.latitude.getDegrees()})},c.prototype.onMouseMove=function(b){this._inputDevice=a.InputDevice.Mouse,this.slide();var c=this._map.mouseEventToContainerPoint(b),d=new a.Point(c.x,c.y),e=this._map.mouseEventToLatLng(b),f=a.Gis.GeoPoint.fromDegrees(e.lng,e.lat);f.normalize(),this._control.mouse.screenPoint=d,this._control.mouse.geoPoint=f,this._control.mouse.tile=a.Gis.TmsTileSystem.geoToTile(this._control.mouse.geoPoint,this.getZoomLevel()),this.mouseMove.trigger(this,{x:d.x,y:d.y,longitude:f.longitude.getDegrees(),latitude:f.latitude.getDegrees()})},c.prototype.onMouseWheel=function(b){if(this._isRunning){this._inputDevice=a.InputDevice.Mouse,this.slide(),b||(b=window.event);var c=0;b.wheelDelta&&(c=b.wheelDelta/120),b.detail&&(c=-b.detail/3),this.mouseWheel.trigger(this,{delta:c});var d=this._map.scrollWheelZoom;d._onWheelScroll(b)}},c.prototype.onDoubleClick=function(b,c){if(this._inputDevice===a.InputDevice.Mouse)this.mouseDoubleClick.trigger(this,this._mouseEventArgs);else if(this._inputDevice===a.InputDevice.Touch){var d={};if(this._control.touches&&this._control.touches.length>0){var e=this._control.touches[0];d={x:e.screenPoint.x,y:e.screenPoint.y,longitude:e.geoPoint.longitude.getDegrees(),latitude:e.geoPoint.latitude.getDegrees()}}this.slide(),this.touchDoubleTap.trigger(this,d)}},c.prototype.onClick=function(b,c){var d=b.latlng.toGeoPoint(),e=this.deriveTooltips(d);e.length>0?this.openTooltips(this._tooltipAutoCenter,d,null,e):this._isTooltipOpen&&this.closeTooltips(),this._inputDevice===a.InputDevice.Mouse?this.mouseClick.trigger(this,this._mouseEventArgs):this._inputDevice===a.InputDevice.Touch&&this.touchTap.trigger(this)},c.prototype.onKeyDown=function(b,c){if(this._inputDevice=a.InputDevice.Keyboard,this._control.mouse.isOver){var d={keyCode:b.keyCode,charCode:b.charCode,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,altKey:b.altKey,metaKey:b.metaKey};this.keyDown.trigger(this,d)}},c.prototype.onKeyPress=function(b,c){if(this._inputDevice=a.InputDevice.Keyboard,this._control.mouse.isOver){var d={keyCode:b.keyCode,charCode:b.charCode};this.keyPress.trigger(this,d)}},c.prototype.onKeyUp=function(b,c){if(this._inputDevice=a.InputDevice.Keyboard,this._control.mouse.isOver){var d={keyCode:b.keyCode,charCode:b.charCode};this.keyUp.trigger(this,d)}},c.prototype.onTouchEnter=function(b){if(this._inputDevice=a.InputDevice.Touch,this.slide(),b.targetTouches){var c=this.deriveTouches(b.targetTouches);this._control.touches=c,this.touchEnter.trigger(this,{touches:c})}},c.prototype.onTouchStart=function(b){if(this._inputDevice=a.InputDevice.Touch,this.slide(),b.targetTouches){var c=this.deriveTouches(b.targetTouches);this._control.touches=c,this.touchStart.trigger(this,{touches:c})}},c.prototype.onTouchMove=function(b){if(this._inputDevice=a.InputDevice.Touch,this.slide(),b.targetTouches){var c=this.deriveTouches(b.targetTouches);this._control.touches=c,this.touchMove.trigger(this,{touches:c})}},c.prototype.onTouchEnd=function(b){this._inputDevice=a.InputDevice.Touch,this.slide(),this._control.touches=[],this.touchEnd.trigger(this)},c.prototype.onTouchLeave=function(b){this._inputDevice=a.InputDevice.Touch,this.slide(),this._control.touches=[],this.touchLeave.trigger(this)},c.prototype.onTouchCancel=function(b){this._inputDevice=a.InputDevice.Touch,this.slide(),this._control.touches=[],this.touchCancel.trigger(this)},c.prototype.onZoomStart=function(a){this._isZooming=!0,this.closeTooltips(),this.zooming.trigger(this,{zoomLevel:this._map.getZoom()})},c.prototype.onZoomEnd=function(a){var b=this._map.getZoom();this._isZooming=!1,this.zoomed.trigger(this,{zoomLevel:b})},c.prototype.onPopupClose=function(a){this._isTooltipOpen=!1,this.tooltipClosed.trigger(this,{})},c.prototype.onWindowResize=function(a,b){var c=this._map.getContainer();this._overlay.style.height=c.style.height,this._overlay.style.width="100%",this.resize()},c}();b.View=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(d){if(c.call(this,d),this.blankTileUri=b.Settings.assetHost+"/Assets/blank.gif",this.brokenTileUri=b.Settings.assetHost+"/Assets/broken.gif",this.isBasemap){var e=new a.DateTime(new Date),f=e.toChronoString(),g=new b.ValidTime(f,"");this.validTimes=[g]}}return __extends(d,c),d.prototype.getType=function(){return"BingLayerInfo"},d.prototype.deriveUrl=function(a,b,c,d,e,f,g){var h=this.href.replace("{quadkey}","{q}").replace("{culture}","en-us").replace("{subdomain}","{s}");return h},d.prototype.deriveOptions=function(){var a={subdomains:d.cacheModifiers,tms:!1,reuseTiles:!1,errorTileUrl:this.brokenTileUri,maxZoom:this.maximumZoom,minZoom:this.minimumZoom};return a},d.cacheModifiers=new Array("1","2","3","4"),d.alias="",d}(b.LayerInfo);b.BingLayerInfo=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(c,d,e,f){var g=this;this._isLoadable=!0,this._isLoaded=!1,this._traceMode=a.TraceMode.Normal,this._leafletCss='__id__ .leaflet-image-layer,__id__ .leaflet-layer,__id__ .leaflet-map-pane canvas,__id__ .leaflet-map-pane svg,__id__ .leaflet-marker-icon,__id__ .leaflet-marker-shadow,__id__ .leaflet-pane,__id__ .leaflet-tile,__id__ .leaflet-tile-container,__id__ .leaflet-zoom-box{position:absolute;left:0;top:0}__id__ .leaflet-container{overflow:hidden;-ms-touch-action:none;touch-action:none;background:#ddd;outline:0;font:12px/1.5 "Helvetica Neue",Arial,Helvetica,sans-serif}__id__ .leaflet-marker-icon,__id__ .leaflet-marker-shadow,__id__ .leaflet-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-user-drag:none}__id__ .leaflet-safari .leaflet-tile{image-rendering:-webkit-optimize-contrast}__id__ .leaflet-safari .leaflet-tile-container{width:1600px;height:1600px;-webkit-transform-origin:0 0}__id__ .leaflet-marker-icon,__id__ .leaflet-marker-shadow{display:block}__id__ .leaflet-container .leaflet-marker-pane img,__id__ .leaflet-container .leaflet-overlay-pane svg,__id__ .leaflet-container .leaflet-tile-pane img,__id__ .leaflet-container img.leaflet-image-layer{max-width:none!important}__id__ .leaflet-tile{filter:inherit;visibility:hidden}__id__ .leaflet-tile-loaded{visibility:inherit}__id__ .leaflet-zoom-box{width:0;height:0;-moz-box-sizing:border-box;box-sizing:border-box;z-index:800}__id__ .leaflet-overlay-pane svg{-moz-user-select:none}__id__ .leaflet-pane{z-index:400}__id__ .leaflet-tile-pane{z-index:200}__id__ .leaflet-overlay-pane{z-index:400}__id__ .leaflet-shadow-pane{z-index:500}__id__ .leaflet-marker-pane{z-index:600}__id__ .leaflet-popup-pane{z-index:700}__id__ .leaflet-map-pane canvas{z-index:100}__id__ .leaflet-map-pane svg{z-index:200}__id__ .leaflet-vml-shape{width:1px;height:1px}__id__ .lvml{behavior:url(#default#VML);display:inline-block;position:absolute}__id__ .leaflet-control{position:relative;z-index:800;pointer-events:auto;float:left;clear:both}__id__ .leaflet-bottom,__id__ .leaflet-top{position:absolute;z-index:1000;pointer-events:none}__id__ .leaflet-top{top:0}__id__ .leaflet-right{right:0}__id__ .leaflet-bottom{bottom:0}__id__ .leaflet-left{left:0}__id__ .leaflet-right .leaflet-control{float:right;margin-right:10px}__id__ .leaflet-top .leaflet-control{margin-top:10px}__id__ .leaflet-bottom .leaflet-control{margin-bottom:10px}__id__ .leaflet-left .leaflet-control{margin-left:10px}__id__ .leaflet-fade-anim .leaflet-tile{will-change:opacity}__id__ .leaflet-fade-anim .leaflet-popup{opacity:0;-webkit-transition:opacity .2s linear;-moz-transition:opacity .2s linear;-o-transition:opacity .2s linear;transition:opacity .2s linear}__id__ .leaflet-fade-anim .leaflet-map-pane .leaflet-popup{opacity:1}__id__ .leaflet-zoom-animated{-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}__id__ .leaflet-zoom-anim .leaflet-zoom-animated{will-change:transform;-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.25,1);-moz-transition:-moz-transform .25s cubic-bezier(0,0,.25,1);-o-transition:-o-transform .25s cubic-bezier(0,0,.25,1);transition:transform .25s cubic-bezier(0,0,.25,1)}__id__ .leaflet-pan-anim .leaflet-tile,.leaflet-zoom-anim .leaflet-tile{-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none}__id__ .leaflet-zoom-anim .leaflet-zoom-hide{visibility:hidden}__id__ .leaflet-interactive{cursor:pointer}__id__ .leaflet-grab{cursor:-webkit-grab;cursor:-moz-grab}__id__ .leaflet-crosshair,.leaflet-crosshair .leaflet-interactive{cursor:crosshair}__id__ .leaflet-control,__id__ .leaflet-popup-pane{cursor:auto}__id__ .leaflet-dragging .leaflet-grab,__id__ .leaflet-dragging .leaflet-grab .leaflet-interactive,__id__ .leaflet-dragging .leaflet-marker-draggable{cursor:move;cursor:-webkit-grabbing;cursor:-moz-grabbing}__id__ .leaflet-container a{color:#0078A8}__id__ .leaflet-container a.leaflet-active{outline:orange solid 2px}__id__ .leaflet-zoom-box{border:2px dotted #38f;background:rgba(255,255,255,.5)}__id__ .leaflet-bar{box-shadow:0 1px 5px rgba(0,0,0,.65);border-radius:4px}__id__ .leaflet-bar a,__id__ .leaflet-bar a:hover{background-color:#fff;border-bottom:1px solid #ccc;width:26px;height:26px;line-height:26px;display:block;text-align:center;text-decoration:none;color:#000}__id__ .leaflet-bar a,__id__ .leaflet-control-layers-toggle{background-position:50% 50%;background-repeat:no-repeat;display:block}__id__ .leaflet-bar a:hover{background-color:#f4f4f4}__id__ .leaflet-bar a:first-child{border-top-left-radius:4px;border-top-right-radius:4px}__id__ .leaflet-bar a:last-child{border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:none}__id__ .leaflet-bar a.leaflet-disabled{cursor:default;background-color:#f4f4f4;color:#bbb}__id__ .leaflet-touch .leaflet-bar a{width:30px;height:30px;line-height:30px}__id__ .leaflet-control-zoom-in,__id__ .leaflet-control-zoom-out{font:700 18px "Lucida Console",Monaco,monospace;text-indent:1px}__id__ .leaflet-control-zoom-out{font-size:20px}__id__ .leaflet-touch .leaflet-control-zoom-in{font-size:22px}__id__ .leaflet-touch .leaflet-control-zoom-out{font-size:24px}__id__ .leaflet-control-layers{box-shadow:0 1px 5px rgba(0,0,0,.4);background:#fff;border-radius:5px}__id__ .leaflet-control-layers-toggle{background-image:url(images/layers.png);width:36px;height:36px}__id__ .leaflet-retina .leaflet-control-layers-toggle{background-image:url(images/layers-2x.png);background-size:26px 26px}__id__ .leaflet-touch .leaflet-control-layers-toggle{width:44px;height:44px}__id__ .leaflet-control-layers .leaflet-control-layers-list,__id__ .leaflet-control-layers-expanded .leaflet-control-layers-toggle{display:none}__id__ .leaflet-control-layers-expanded .leaflet-control-layers-list{display:block;position:relative}__id__ .leaflet-control-layers-expanded{padding:6px 10px 6px 6px;color:#333;background:#fff}__id__ .leaflet-control-layers-scrollbar{overflow-y:scroll;padding-right:5px}__id__ .leaflet-control-layers-selector{margin-top:2px;position:relative;top:1px}__id__ .leaflet-control-layers label{display:block}__id__ .leaflet-control-layers-separator{height:0;border-top:1px solid #ddd;margin:5px -10px 5px -6px}__id__ .leaflet-container .leaflet-control-attribution{background:#fff;background:rgba(255,255,255,.7);margin:0}__id__ .leaflet-control-attribution,__id__ .leaflet-control-scale-line{padding:0 5px;color:#333}__id__ .leaflet-control-attribution a{text-decoration:none}__id__ .leaflet-control-attribution a:hover{text-decoration:underline}__id__ .leaflet-container .leaflet-control-attribution,__id__ .leaflet-container .leaflet-control-scale{font-size:11px}__id__ .leaflet-left .leaflet-control-scale{margin-left:5px}__id__ .leaflet-bottom .leaflet-control-scale{margin-bottom:5px}__id__ .leaflet-control-scale-line{border:2px solid #777;border-top:none;line-height:1.1;padding:2px 5px 1px;font-size:11px;white-space:nowrap;overflow:hidden;-moz-box-sizing:content-box;box-sizing:content-box;background:#fff;background:rgba(255,255,255,.5)}__id__ .leaflet-control-scale-line:not(:first-child){border-top:2px solid #777;border-bottom:none;margin-top:-2px}__id__ .leaflet-control-scale-line:not(:first-child):not(:last-child){border-bottom:2px solid #777}__id__ .leaflet-touch .leaflet-bar,__id__ .leaflet-touch .leaflet-control-attribution,__id__ .leaflet-touch .leaflet-control-layers{box-shadow:none}__id__ .leaflet-touch .leaflet-bar,__id__ .leaflet-touch .leaflet-control-layers{border:2px solid rgba(0,0,0,.2);background-clip:padding-box}__id__ .leaflet-popup{position:absolute;text-align:center}__id__ .leaflet-popup-content-wrapper{padding:1px;text-align:left;border-radius:12px}__id__ .leaflet-popup-content{margin:13px 19px;line-height:1.4}__id__ .leaflet-popup-content p{margin:18px 0}__id__ .leaflet-popup-tip-container{margin:0 auto;width:40px;height:20px;position:relative;overflow:hidden}__id__ .leaflet-popup-tip{width:17px;height:17px;padding:1px;margin:-10px auto 0;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}__id__ .leaflet-popup-content-wrapper,__id__ .leaflet-popup-tip{background:#fff;color:#333;box-shadow:0 3px 14px rgba(0,0,0,.4)}__id__ .leaflet-container a.leaflet-popup-close-button{position:absolute;top:0;right:0;padding:4px 4px 0 0;border:none;text-align:center;width:18px;height:14px;font:16px/14px Tahoma,Verdana,sans-serif;color:#c3c3c3;text-decoration:none;font-weight:700;background:0 0}__id__ .leaflet-container a.leaflet-popup-close-button:hover{color:#999}__id__ .leaflet-popup-scrolled{overflow:auto;border-bottom:1px solid #ddd;border-top:1px solid #ddd}__id__ .leaflet-oldie .leaflet-popup-content-wrapper{zoom:1}__id__ .leaflet-oldie .leaflet-popup-tip{width:24px;margin:0 auto;-ms-filter:"progid:DXImageTransform.Microsoft.Matrix(M11 = 0.70710678, M12 = 0.70710678, M21 = -0.70710678, M22 = 0.70710678)";filter:progid:DXImageTransform.Microsoft.Matrix(M11=.70710678, M12=.70710678, M21=-.70710678, M22=.70710678)}__id__ .leaflet-oldie .leaflet-popup-tip-container{margin-top:-1px}__id__ .leaflet-oldie .leaflet-control-layers,__id__ .leaflet-oldie .leaflet-control-zoom,__id__ .leaflet-oldie .leaflet-popup-content-wrapper,__id__ .leaflet-oldie .leaflet-popup-tip{border:1px solid #999}__id__ .leaflet-div-icon{background:#fff;border:1px solid #666}',this._tense="pastId",this.version="3.9.8",this.loaded=new a.Event,this.traceModeChanged=new a.Event,this.menuItemEnabled=new a.Event,this.menuItemDisabled=new a.Event,this._id=c,this._initParams=f,this.settings=new b.Settings(d,this),this.clock=new b.Clock,this.mouse=new b.Mouse,this.view=new b.View(this),this.view.setSlidingTimeout(this.settings.slidingTimeout),this.view.setAbsoluteTimeout(this.settings.absoluteTimeout),this.view.start(),this.animator=new b.Animator(this),this.capabilityClient=new b.CapabilityClient(d.capabilityHost||"http://tessera.intellicast.com/201109/en-US/0000/0000/capability.json",this),this.capabilityClient.setCapabilities(e),this.capabilityClient.start(),a.addEventListener(window,"beforeunload",function(a){g.onUnloaded()}),this.bootStrap(),this._leafletCss=this._leafletCss+"__id__ .leaflet-popup-content-wrapper{padding:10px;} __id__ .leaflet-popup-content{margin:0px;} __id__ .leaflet-tile{-webkit-backface-visibility: visible !important;}",this._leafletCss=this._leafletCss.replace(/__id__/gi,"#"+this._id.replace(/_Map/,"")),this.injectCss(this._leafletCss),this._isLoaded=!0}return c.prototype.getId=function(){return this._id},c.prototype.getIsLoadable=function(){return(!a.Browser.hasCors||"Microsoft Internet Explorer"===a.Browser.getName()&&a.Browser.getVersion()<=7)&&(this._isLoadable=!1),this._isLoadable},c.prototype.getIsLoaded=function(){return this._isLoaded},c.prototype.getState=function(){var c=new b.MapState;c.scale=this.view.getScale(),c.opacity=this.view.getOpacity();var d=(this.view.getScreenCenter(),this.view.getGeoCenter());d.normalize(),c.location={longitude:d.longitude.getDegrees(),latitude:d.latitude.getDegrees()};for(var e=this.view.getLayers(),f=this.view.getLayerOrder(),g=[],h=0;h<f.length;h++){var i=f[h],j=e[i];!j.info.isBasemap||null!==c.basemap&&void 0!==c.basemap?(g.push(i),c.layers[i]={opacity:j.getOpacity()}):c.basemap=j.info.id}c.layerOrder=g;var k=new a.Client.AnimationState;return k.currentFrame=this.animator.getCurrentFrame(),k.dwell=this.animator.getDwell().getTotalMilliseconds(),k.enableLooping=this.animator.getEnableLooping(),k.isSliding=this.animator.getIsSliding(),k.periodPerFrame=this.animator.getPeriodPerFrame().getTotalMilliseconds(),k.playRate=this.animator.getPlayRate().getTotalMilliseconds(),k.totalFrames=this.animator.getTotalFrames(),c.animation=k,c},c.prototype.getTraceMode=function(){return this._traceMode},c.prototype.setTraceMode=function(a){var b=this._traceMode;this._traceMode=a,b!=this._traceMode&&this.traceModeChanged.trigger(this,{oldMode:b,newMode:a})},c.prototype.getInitParams=function(){return this._initParams},c.prototype.getMenu=function(){return this.settings.menu},c.prototype.bootStrap=function(){var b,c,d=this._initParams,e=this.settings;if(a.Storage.isEnabled){var f=d&&d.persistAnimation?"true"==d.persistAnimation.toLowerCase():null,g=d&&d.persistOpacity?"true"==d.persistOpacity.toLowerCase():null,h=d&&d.persistLocation?"true"==d.persistLocation.toLowerCase():null,i=d&&d.persistZoomLevel?"true"==d.persistZoomLevel.toLowerCase():null,j=d&&d.persistLayers?"true"==d.persistLayers.toLowerCase():null,k=d&&d.persistBasemap?"true"==d.persistBasemap.toLowerCase():null;b={persistLocation:h,persistScale:i,persistAnimation:f,persistLayers:j,persistBasemap:k,persistOpacity:g},c=a.Storage.retrieve("__"+this._id+a.Storage._versionKey),c||(c=a.Storage.retrieve("__"+this._id)),void 0!=c&&null!=c&&(c=a.Storage.sanitizeMap(c))}else b={persistLocation:!1,persistScale:!1,persistAnimation:!1,persistLayers:!1,persistBasemap:!1,persistOpacity:!1};var l=-97,m=39;if(b.persistLocation&&c&&c.location)c.location&&(l=c.location.longitude,m=c.location.latitude);else{try{l=parseFloat(d.longitude)}catch(n){}try{m=parseFloat(d.latitude)}catch(n){}}var o=e.minimumZoom;if(null!=o&&this.view.setMinimumZoomLevel(o),"Standard"===e.getMode()){var p=e.maximumZoom;null!=p&&this.view.setMaximumZoomLevel(p)}var q=4;if(b.persistScale&&c&&c.scale){var r=c.scale;q=a.Gis.TmsTileSystem.deriveZoomLevel(r)}else if(d&&d.zoomLevel)try{q=parseInt(d.zoomLevel)}catch(n){}if(this.view.move(l,m,q),b.persistBasemap&&c&&c.basemap){var s=c.basemap;this.view.addLayer(s)}else if(d&&d.basemap){var s=d.basemap;this.view.addLayer(s)}if(b.persistLayers&&c&&c.layerOrder)for(var t=c.layerOrder,u=0,v=t.length;v>u;u++){var w=t[u],x=this.view.addLayer(w);if(b.persistOpacity){var y=c.layers,z=y[w];if(null!=z){var A=z.opacity;x.setOpacity(A)}}}else if(d&&d.layers)for(var t=d.layers.split(","),B=0,v=t.length;v>B;B++){var w=t[B],x=this.view.addLayer(w);if(b.persistOpacity&&c){var y=c.layers,z=y[w];if(null!=z){var A=z.opacity;x.setOpacity(A)}}}if(b.persistOpacity||void 0==d.opacity||null==d.opacity){if(c&&c.opacity){var A=c.opacity;this.view.setOpacity(c.opacity)}}else try{this.view.setOpacity(parseFloat(d.opacity))}catch(n){}if(b.persistAnimation&&c&&c.animation){var C=c.animation;this.animator.setTotalFrames(C.totalFrames),this.animator.setCurrentFrame(C.currentFrame),this.animator.setIsSliding(C.isSliding),this.animator.setEnableLooping(C.enableLooping),this.animator.setPlayRate(new a.TimeSpan(C.playRate,0,0,0,0)),this.animator.setDwell(new a.TimeSpan(C.dwell,0,0,0,0))}var D=a.Gis.GeoBoundingBox.fromDegrees(85.05113,-270,-85.05113,270);this.view.setGeoBoundingBox(D)},c.prototype.injectCss=function(a){var b,c,d,e="__WxMap_Style",f=document.getElementsByTagName("head")[0];(c=document.getElementById(e))&&c?(c.styleSheet?(d=c.styleSheet.cssText,c.styleSheet.cssText=""):(d=c.innerHTML,c.innerHTML=""),a=d+a,b=document.createTextNode(a)):(c=document.createElement("style"),b=document.createTextNode(a),c.setAttribute("type","text/css"),c.setAttribute("id",e),f.insertBefore(c,f.firstChild)),c.styleSheet?c.styleSheet.cssText=b.nodeValue:c.appendChild(b)},c.prototype.findMenuItemInfo=function(a){var b=this.settings.menu;if(b){for(var c=0,d=b.trees.length;d>c;c++)for(var e=b.trees[c],f=0,g=e.children.length;g>f;f++){var h=e.children[f];if(h.id===a)return[c,h]}return[]}},c.prototype.enableMenuItem=function(a){var b=this.findMenuItemInfo(a),c=this.settings.menu.trees[b[0]],d=this.view.getLayers();if(b.length){if(/single/gi.test(c.mode))for(var e=0,f=c.children.length;f>e;e++)if(c.children[e].id!==a&&c.children[e].isActive){for(var g=c.children[e].layers,h=0;h<g.length;h++)g[h].pastId in d?this.view.removeLayer(g[h].pastId):g[h].futureId in d&&this.view.removeLayer(g[h].futureId);c.children[e].isActive=!1,this.menuItemDisabled.trigger(this,{menuItem:c.children[e]})}b[1].isActive=!0;for(var e=0;e<b[1].layers.length;e++){var i=parseInt(b[1].zone,10),j=this.deriveMenuItemLayerId(b[1].layers[e]);isNaN(i)?this.view.addLayer(j):this.view.insertLayer(j,i)}this.menuItemEnabled.trigger(this,{menuItem:b[1]})}},c.prototype.disableMenuItem=function(a){var b=this.findMenuItemInfo(a),c=this.settings.menu.trees[b[0]];if(!/required/gi.test(c.requirement)&&b.length){b[1].isActive=!1;for(var d=0;d<b[1].layers.length;d++){var e=this.deriveMenuItemLayerId(b[1].layers[d]);this.view.removeLayer(e)}this.menuItemDisabled.trigger(this,{menuItem:b[1]})}},c.prototype.enableActiveMenuItems=function(){var a=this.settings;if(a.menu)for(var b=a.menu.trees,c=0,d=b.length;d>c;c++)for(var e=b[c].children,f=0,g=e.length;g>f;f++){var h=e[f];h.isActive&&this.enableMenuItem(h.id)}},c.prototype.updateMenuItemTense=function(b){switch(b){case a.TimeMode.Past:this._tense="pastId";break;case a.TimeMode.Future:this._tense="futureId"}},c.prototype.deriveMenuItemLayerId=function(a){var b=a[this._tense];return null==b&&("futureId"==this._tense?b=a.pastId:"pastId"==this._tense&&(b=a.futureId)),b},c.prototype.onUnloaded=function(){if(a.Storage.isEnabled){var b=this.getState();a.Storage.save("__"+this._id+a.Storage._versionKey,b)}this.settings=null},c}();b.Control=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(d,e,f,g){c.call(this,d,e,f,g),this._surface=null,this._isRegistered=!1,this._cachedTiles={},this._pendingTiles={},this._pendingTileCount=0,this._isLoading=!1,this.self=this,this._styleContext=new a.Style.Context(d),this._isTiled=!(1===d.pyramidPolicy.length&&0===d.pyramidPolicy[0].dataZoom),this._localTile=new b.GeoTile,this._surface=new L.LayerGroup,this.map.addLayer(this._surface),this.info.deriveCurrentTimes(this.view.getControl().clock.getTime()),this._styleContext=new a.Style.Context(this.info),this._styleContext.mapScale=this.view.getScale(),this._styleContext.mapZoom=this.view.getZoomLevel(),null!=f&&void 0!=f&&(this.info.opacity=f,this._styleContext.opacity=f),g&&g.style?(this._style=g.style,this._style.assetLoaded.addListener(this,this.self.onStyleAssetLoaded),this._style.load(this._styleContext),this.requestData()):this.requestStyle(this.info.stylePath)}return __extends(d,c),d.prototype.getSurface=function(){return this._surface},d.prototype.getZIndex=function(){return this._styleContext.zIndex},d.prototype.setZIndex=function(a){this._styleContext.zIndex=a},d.prototype.getStyle=function(){return this._style},d.prototype.setStyle=function(a){this._style=a,this._style.assetLoaded.addListener(this,this.self.onStyleAssetLoaded),this._style.load(this._styleContext),this.clear(),this.requestData()},d.prototype.getOpacity=function(){return this.info.opacity},d.prototype.setOpacity=function(a){},d.prototype.getInterfaces=function(){return["ITooltip"]},d.prototype.getIsLoading=function(){return this._isLoading},d.prototype.paintGrid=function(){},d.prototype.deriveViewportTiles=function(){var b=new Array,c=this.deriveKeyZoomLevel(this.view.getZoomLevel());if(0===c)return b.push(new a.Gis.Tile(0,0,0)),b;for(var d=this.deriveTileGrid(),e=d.startPosition.y;e<d.screenHeight;e+=d.tileDimension){var f=e+d.tileDimension/2;if(f>=d.northPoleScreen.y&&f<=d.southPoleScreen.y)for(var g=d.startPosition.x;g<d.screenWidth;g+=d.tileDimension){var h=g+d.tileDimension/2,i=this.deriveTile(new a.Point(h,f),c);b.push(i)}}return b},d.prototype.deriveTile=function(b,c){var d=(this.view.getScale(),this.view.screenToGeo(b));d.normalize();var e=this.view.getProjection().geoToMap(d),f=0===c?new a.Point(0,0):a.Gis.TmsTileSystem.mapToTms(e),g=0===c?new a.Gis.Tile(0,0,0):a.Gis.TmsTileSystem.tmsToTile(f,c-1);return g.z++,g},d.prototype.deriveTileGrid=function(){var b,c=(this.view.getGeoCenter(),this.view.getScale()),d=this.view.getZoomLevel(),e=this.deriveKeyZoomLevel(d),f=512*Math.pow(2,d-e),g=this.view.getHeight(),h=this.view.getWidth(),i=a.Gis.GeoPoint.fromDegrees(0,a.Gis.Geo.maximumLatitude.getDegrees()),j=a.Gis.GeoPoint.fromDegrees(0,a.Gis.Geo.minimumLatitude.getDegrees()),k=this.view.geoToScreen(i),l=this.view.geoToScreen(j);b=k.y>0?this.view.screenToGeo(new a.Point(0,k.y)):this.view.screenToGeo(new a.Point(0,0)),l.y<g&&(g-=h-l.y);var m=this.view.getProjection().geoToMap(b),n=new a.Point(0,0);n.x=m.x*c,n.y=-(m.y*c);var o=128*Math.pow(2,d),p=new a.Point(0,0);return p.x=-((n.x+o)%f),p.y=-((n.y+o)%f),k.y>0&&(p.y=k.y),{startPosition:p,tileDimension:f,screenWidth:h,screenHeight:g,northPoleScreen:k,southPoleScreen:l}},d.prototype.deriveKeyZoomLevel=function(a){for(var b=this.info.pyramidPolicy.length,c=0,d=0;b>d;d++){var e=this.info.pyramidPolicy[d];if(e.StartZoom>a)break;c=e.DataZoom}return c},d.prototype.deriveStyleContext=function(a){var b=a.clone();return b.mapScale=this.view.getScale(),b.mapZoom=this.view.getZoomLevel(),b},d.prototype.requestData=function(){if(!this.info.isLocalOnly)try{var b;this._isTiled?b=this.deriveViewportTiles():(b=new Array,b.push(new a.Gis.Tile(0,0,0)));for(var c=0;c<b.length;c++){var d=b[c],e=this.info.deriveKey(d.z,d.x,d.y);if(this._cachedTiles.hasOwnProperty(e)===!0){var f=this._cachedTiles[e];void 0!=f&&f.isRendered===!1&&this.view.getIsZooming()===!1&&this.renderTile(f)}else this._pendingTiles.hasOwnProperty(e)===!1&&this.requestTile(d,e)}}catch(g){a.Console.log(g)}},d.prototype.processTile=function(a){var b=this.info.deriveKey(a.z,a.x,a.y);this._pendingTileCount--,delete this._pendingTiles[b],this._pendingTileCount<=0&&this._isLoading&&(this._pendingTileCount=0,this._isLoading=!1,this.loaded.trigger(this))},d.prototype.requestTile=function(b,c){var d=this;this._pendingTiles[c]=b,this._pendingTileCount++,this._isLoading||(this._isLoading=!0,this.loading.trigger(this));var e=this.info.deriveUrl(b.z,b.x,b.y);if(null!==e){var f=a.Net.createCorsRequest("GET",e,!0);f.onerror=function(){d.processTile(b)},f.timeout=function(){d.processTile(b)},f.onabort=function(){d.processTile(b)},f.onprogress=function(){},f.onload=function(){d.processTile(b),d.formatTile(f.responseText,b)},f.send()}},d.prototype.formatTile=function(c,d){if(this.view.getIsRunning){var e=[d.z,d.x,d.y].join();if(!this._cachedTiles[e]){var f=a.Geo.Formatter.parse(c,this.info.extension,this.view.getProjection()),g=new b.GeoTile;g.features=f,this._cachedTiles[e]=g,void 0!=this._style&&(this.styleTile(g),this.renderTile(g))}}},d.prototype.styleTile=function(a){if(!a.isStyled){var b=this.deriveStyleContext(this._styleContext);this._style.apply(a.features,b),a.isStyled=!0}},d.prototype.renderTile=function(a){for(var b=0;b<a.features.length;b++){var c=a.features[b];this.renderFeature(c)}a.isRendered=!0},d.prototype.renderFeature=function(a){if(a&&null!=a.visualRecipe)for(var b=0,c=a.visualRecipe.length;c>b;b++){var d=a.visualRecipe[b];d.render(a,this._styleContext,this._surface)}},d.prototype.requestStyle=function(b){var c=this;if(!b)return this.loadDefaultStyle(),void this.requestData();var d=a.Net.createCorsRequest("GET",b,!0);d.onerror=function(){c.loadDefaultStyle()},d.timeout=function(){c.loadDefaultStyle()},d.onabort=function(){c.loadDefaultStyle();
},d.onprogress=function(){},d.onload=function(){d.responseText?c.formatStyle(d.responseText):c.loadDefaultStyle();var a=c.view.getControl().clock.getTime();c.info.deriveCurrentTimes(a),c.info.getCurrentValidTime()&&c.requestData()},d.send()},d.prototype.formatStyle=function(b){this.view.getIsRunning()&&(this._style=a.Style.Formatter.parse(b,"json",this.view.getProjection()),this._style.assetLoaded.addListener(this,this.self.onStyleAssetLoaded),this._style.load(this._styleContext))},d.prototype.loadDefaultStyle=function(){this._style=a.Style.createDefaultStyle(),this.requestData()},d.prototype.clear=function(){this.clearPending(),this.clearCache(),this.clearSurface()},d.prototype.clearCache=function(){this._cachedTiles={}},d.prototype.clearSurface=function(){this._surface.clearLayers();for(var a in this._cachedTiles){var b=this._cachedTiles[a];void 0!=b&&(b.isRendered=!1)}},d.prototype.clearPending=function(){this._pendingTiles={},this._pendingTileCount=0},d.prototype.register=function(){this._isRegistered||(this.info.isLocalOnly||this.info.updated.addListener(this,this.self.onLayerUpdated),this.view.zooming.addListener(this,this.self.onZooming),this.view.zoomed.addListener(this,this.self.onZoomed),this.view.mouseLeftButtonUp.addListener(this,this.self.onMouseLeftButtonUp),this.view.touchEnd.addListener(this,this.self.onTouchEnd),this._isRegistered=!0)},d.prototype.unregister=function(){this._isRegistered&&(this.info.isLocalOnly||this.info.updated.removeListener(this.self.onLayerUpdated),this.view.zoomed.removeListener(this.self.onZoomed),this.view.zooming.removeListener(this.self.onZooming),this.view.mouseLeftButtonUp.removeListener(this.self.onMouseLeftButtonUp),this.view.touchEnd.removeListener(this.self.onTouchEnd),this._isRegistered=!1)},d.prototype.addLocalFeature=function(a){this._localTile.features.push(a),this._localTile.isStyled=!1,void 0!=this._style&&(this.clearSurface(),this.requestData(),this.styleTile(this._localTile),this.renderTile(this._localTile))},d.prototype.addLocalFeatures=function(a){for(var b=0;b<a.length;b++){var c=a[b];this._localTile.features.push(c),this._localTile.isStyled=!1}void 0!=this._style&&(this.clearSurface(),this.requestData(),this.styleTile(this._localTile),this.renderTile(this._localTile))},d.prototype.updateLocalFeatures=function(a){this._localTile.features=a,this._localTile.isStyled=!1,void 0!=this._style&&(this.clearSurface(),this.requestData(),this.styleTile(this._localTile),this.renderTile(this._localTile))},d.prototype.retrieveLocalFeatures=function(){return this._localTile.features},d.prototype.clearLocalFeatures=function(){this._localTile.features=new Array,this._localTile.isStyled=!1,void 0!=this._style&&(this.clearSurface(),this.requestData())},d.prototype.start=function(){this.register()},d.prototype.stop=function(){this.unregister(),this.map.removeLayer(this._surface),this._cachedTiles={},this._pendingTiles={},this._localTile.features=[]},d.prototype.deriveTooltips=function(a){var b=this.view.getProjection().geoToMap(a),c=new Array;if(null!=this._style){var d=this.deriveKeyZoomLevel(this.view.getZoomLevel());for(var e in this._cachedTiles){var f=e.split(","),g=f[0];if(g==d)for(var h=this._cachedTiles[e],i=this._style.deriveTooltips(h.features,this._styleContext,b,this.info.id),j=0;j<i.length;j++){var k=i[j];c.push(k)}}if(null!=this._localTile&&this._localTile.features.length>0)for(var i=this._style.deriveTooltips(this._localTile.features,this._styleContext,b,this.info.id),j=0;j<i.length;j++){var k=i[j];c.push(k)}}return c},d.prototype.onZoomed=function(a,b){void 0!=this._style&&(this._styleContext.mapScale=this.view.getScale(),this._styleContext.mapZoom=this.view.getZoomLevel(),this._localTile&&(this.styleTile(this._localTile),this.renderTile(this._localTile)),this.requestData())},d.prototype.onZooming=function(a,b){this.clearSurface()},d.prototype.onMouseLeftButtonUp=function(a,b){this._styleContext.mapScale=this.view.getScale(),this._styleContext.mapZoom=this.view.getZoomLevel(),void 0!=this._style&&this.requestData()},d.prototype.onTouchEnd=function(a,b){this._styleContext.mapScale=this.view.getScale(),this._styleContext.mapZoom=this.view.getZoomLevel(),void 0!=this._style&&this.requestData()},d.prototype.onLayerUpdated=function(a,b){var c=this.info,d=c.getCurrentValidTime(),e=this.view.getControl().clock.getTime();this.info.deriveCurrentTimes(e),d!=c.getCurrentValidTime()&&void 0!=this._style&&(this.clear(),this.requestData(),this.styleTile(this._localTile),this.renderTile(this._localTile),this.updated.trigger(this,{id:this.info.id}))},d.prototype.onStyleAssetLoaded=function(a,b){},d}(b.Layer);b.GeoLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(a,c){b.call(this,a),this.isLocalOnly=!1,this.pyramidPolicy=c||[{DataZoom:0,StartZoom:0}],this.isTiled=!(1===this.pyramidPolicy.length&&0===this.pyramidPolicy[0].DataZoom)}return __extends(c,b),c.prototype.getType=function(){return"GeoLayerInfo"},c.prototype.deriveKey=function(a,b,c,d){return[a.toString(),b.toString(),c.toString()].join()},c.prototype.deriveUrl=function(b,c,d,e,f,g,h){var i=b||0,j=c||0,k=d||0,l=(j+k)%a.LayerInfo.cacheModifiers.length,m=a.LayerInfo.cacheModifiers[l]||"0",n=e||this.getCurrentIssueTime(),o=f||this.getCurrentValidTime(),p=g||this.getCurrentIteration(),q=h||this.getCurrentCipher();if(!this.href||null===o||void 0===o)return null;var r=this.href.replace("{s}",m).replace("{l}","en-US").replace("{c}",q).replace("{m}",n).replace("{v}",o).replace("{i}",p).replace("{z}",i.toString()).replace("{x}",j.toString()).replace("{y}",k.toString());return r},c}(a.LayerInfo);a.GeoLayerInfo=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.features=new Array,this.visuals=null,this.isStyled=!1,this.isRendered=!1,this.lastFilterVersion=-1}return a.prototype.moose=function(){},a}();a.GeoTile=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(a,d,e,f,g){var h=this;void 0===g&&(g="#999999"),c.call(this,a,d,e,f),this._opacity=1,this._wireMoved=function(a,b){h.onMoved(a,b)},this._wireZoomed=function(a,b){h.onZoomed(a,b)},this._wireSizeChanged=function(a,b){h.onSizeChanged(a,b)},f&&(this._thickness=f.thickness||1),this._color=g,this._surface=new b.Layer.Canvas,this.map.addLayer(this._surface),this.setOpacity(e),this._canvas=this._surface.canvas,this._context=this._canvas.getContext("2d")}return __extends(d,c),d.prototype.getElement=function(){return this._canvas},d.prototype.getSurface=function(){return this._surface},d.prototype.getWidth=function(){return this._canvas.width},d.prototype.getHeight=function(){return this._canvas.height},d.prototype.getColor=function(){return this._color},d.prototype.setColor=function(a){this._color=a,this.update()},d.prototype.getThickness=function(){return this._thickness},d.prototype.setThickness=function(a){this._thickness=a,this.update()},d.prototype.getZIndex=function(){return this._canvas.style.zIndex},d.prototype.setZIndex=function(a){this._canvas.style.zIndex=a},d.prototype.getOpacity=function(){return this._opacity},d.prototype.setOpacity=function(a){var b=this.view.getOpacity(),c=null!=b?b:a;null!=c&&void 0!=c&&(this._opacity=c)},d.prototype.clear=function(){this._context.clearRect(0,0,this.getWidth(),this.getHeight())},d.prototype.resize=function(){this._canvas.width=this.view.getWidth(),this._canvas.height=this.view.getHeight()},d.prototype.drawLine=function(a,b){this._context.beginPath(),this._context.moveTo(a.x+.5,a.y+.5),this._context.lineTo(b.x+.5,b.y+.5),this._context.stroke(),this._context.closePath()},d.prototype.register=function(){this.view.moved.addListener(this,this._wireMoved),this.view.zoomed.addListener(this,this._wireZoomed),this.view.sizeChanged.addListener(this,this._wireSizeChanged)},d.prototype.unregister=function(){this.view.moved.removeListener(this._wireMoved),this.view.zoomed.removeListener(this._wireZoomed),this.view.sizeChanged.removeListener(this._wireSizeChanged)},d.prototype.update=function(){this.clear(),this._context.lineWidth=this._thickness,this._context.strokeStyle=this._color;var b,c=this.view.getGeoBoundingBox(),d=this.view.getZoomLevel();3>d?b=20:6>d?b=10:9>d&&(b=5);var e=Math.round(Math.round(c.west.getDegrees()-b)/b)*b,f=Math.round(Math.round(c.east.getDegrees()+b)/b)*b,g=Math.round(Math.round(c.south.getDegrees()-b)/b)*b,h=Math.round(Math.round(c.north.getDegrees()+b)/b)*b;-85>g&&(g=-85.05113),h>85&&(h=85.05113);for(var i=e;f>i;i+=b){var j=a.Gis.GeoPoint.fromDegrees(i,g),k=this.view.geoToScreen(j),l=a.Gis.GeoPoint.fromDegrees(i,h),m=this.view.geoToScreen(l);this.drawLine(k,m)}for(var n=g;h>n;n+=b){var o=a.Gis.GeoPoint.fromDegrees(e,n),p=this.view.geoToScreen(o),q=a.Gis.GeoPoint.fromDegrees(f,n),r=this.view.geoToScreen(q);this.drawLine(p,r)}},d.prototype.start=function(){this.register(),this.resize(),this.update()},d.prototype.stop=function(){this.map.removeLayer(this._surface),this.unregister()},d.prototype.onMoved=function(a,b){this.update()},d.prototype.onSizeChanged=function(a,b){this.resize(),this.update()},d.prototype.onZoomed=function(a,b){this.update()},d}(b.Layer);b.GraticuleLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(a,d,e,f,g,h){var i=this;void 0===g&&(g=256),void 0===h&&(h="#999999"),c.call(this,a,d,e,f),this._opacity=1,this._wireMoved=function(a,b){i.onMoved(a,b)},this._wireZoomed=function(a,b){i.onZoomed(a,b)},this._wireSizeChanged=function(a,b){i.onSizeChanged(a,b)},this._color=h,this._dimension=g,this._thickness=f?f.thickness||1:1,this.setOpacity(e),this._surface=new b.Layer.Canvas,this.map.addLayer(this._surface),this._canvas=this._surface.canvas,this._context=this._canvas.getContext("2d")}return __extends(d,c),d.prototype.getElement=function(){return this._canvas},d.prototype.getSurface=function(){return this._canvas},d.prototype.getWidth=function(){return this._canvas.width},d.prototype.getHeight=function(){return this._canvas.height},d.prototype.getColor=function(){return this._color},d.prototype.setColor=function(a){this._color=a},d.prototype.getThickness=function(){return this._thickness},d.prototype.setThickness=function(a){this._thickness=a},d.prototype.getZIndex=function(){return this._canvas.style.zIndex},d.prototype.setZIndex=function(a){this._canvas.style.zIndex=a},d.prototype.getOpacity=function(){return this._opacity},d.prototype.setOpacity=function(a){null!=a&&void 0!=a&&(this._opacity=a)},d.prototype.register=function(){this.view.moved.addListener(this,this._wireMoved),this.view.zoomed.addListener(this,this._wireZoomed),this.view.sizeChanged.addListener(this,this._wireSizeChanged)},d.prototype.unregister=function(){this.view.moved.removeListener(this._wireMoved),this.view.zoomed.removeListener(this._wireZoomed),this.view.sizeChanged.removeListener(this._wireSizeChanged)},d.prototype.clear=function(){this._context.clearRect(0,0,this.getWidth(),this.getHeight()),this._context.lineWidth=this._thickness,this._context.strokeStyle=this._color},d.prototype.resize=function(){var a=this.view.getSize();this._canvas.setAttribute("width",a.width),this._canvas.setAttribute("height",a.height)},d.prototype.drawLine=function(a,b){this._context.beginPath(),this._context.moveTo(a.x+.5,a.y+.5),this._context.lineTo(b.x+.5,b.y+.5),this._context.stroke(),this._context.closePath()},d.prototype.drawVerticalLine=function(b,c,d,e){var f=d*this._dimension,g=a.Gis.TmsTileSystem.screenToTms(new a.Point(f,0),e),h=a.Gis.TmsTileSystem.tmsToGeo(g),i=h.longitude,j=new a.Gis.GeoPoint(i,b.getTopLeftGeoPoint().latitude),k=new a.Gis.GeoPoint(i,b.getBottomLeftGeoPoint().latitude);j.latitude.getDegrees()>85.05113&&(j.latitude=a.Gis.Latitude.fromDegrees(85.05113)),k.latitude.getDegrees()<-85.05113&&(k.latitude=a.Gis.Latitude.fromDegrees(-85.05113));var l=this.view.geoToScreen(j),m=this.view.geoToScreen(k);l.round(),m.round(),this.drawLine(l,m)},d.prototype.drawHorizontalLine=function(b,c,d,e){var f=Math.pow(2,e),g=c?d:f-d,h=g*this._dimension,i=new a.Point(0,h),j=a.Gis.TmsTileSystem.screenToTms(i,e),k=a.Gis.TmsTileSystem.tmsToGeo(j),l=k.latitude;l.getDegrees()>85.05113&&(l=a.Gis.Latitude.fromDegrees(85.05113)),l.getDegrees()<-85.05113&&(l=a.Gis.Latitude.fromDegrees(-85.05113));var m=new a.Gis.GeoPoint(b.getTopLeftGeoPoint().longitude,l),n=new a.Gis.GeoPoint(b.getTopRightGeoPoint().longitude,l);m.longitude.getDegrees()<-180&&(m.longitude=a.Gis.Longitude.fromDegrees(-180)),n.longitude.getDegrees()>180&&(n.longitude=a.Gis.Longitude.fromDegrees(180));var o=this.view.geoToScreen(m);o.x=0;var p=this.view.geoToScreen(n);p.x=this._canvas.width,o.round(),p.round(),this.drawLine(o,p)},d.prototype.start=function(){this.register(),this.resize(),this.update()},d.prototype.stop=function(){this.map.removeLayer(this._surface),this.unregister()},d.prototype.update=function(){this.clear();var b=this.view.getGeoBoundingBox(),c=this.view.getZoomLevel(),d=Math.pow(2,c)-1,e=b.getBottomLeftGeoPoint(),f=a.Gis.TmsTileSystem.geoToTile(e,c);f.y>d&&(f.y=0);var g=b.getTopLeftGeoPoint(),h=a.Gis.TmsTileSystem.geoToTile(g,c);h.y>d&&(h.y=d);var i=b.getTopRightGeoPoint(),j=a.Gis.TmsTileSystem.geoToTile(i,c);j.y>d&&(j.y=d);var k=b.getBottomRightGeoPoint(),l=a.Gis.TmsTileSystem.geoToTile(k,c);l.y>d&&(l.y=0);var m,n,o,p,q=h.x>=j.x;if(q){for(m=h.x-1;d>=m;m++)this.drawVerticalLine(b,!0,m,c);for(m=0,o=j.x;o>=m;m++)this.drawVerticalLine(b,!0,m,c)}else for(m=h.x,o=j.x+1;o>=m;m++)this.drawVerticalLine(b,!1,m,c);if(q){for(n=f.y;d>=n;n++)this.drawHorizontalLine(b,q,n,c);for(n=0,p=l.y;p>=n;n++)this.drawHorizontalLine(b,q,n,c)}else for(n=f.y,p=h.y+1;p>=n;n++)this.drawHorizontalLine(b,q,n,c)},d.prototype.onMoved=function(a,b){this.update()},d.prototype.onSizeChanged=function(a,b){this.resize(),this.update()},d.prototype.onZoomed=function(a,b){this.update()},d}(b.Layer);b.GridLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(a,d,e,f){var g=this;b.call(this,a,d,e,f),this._isRegistered=!1,this._zIndex=-1,this._surface=null,this._isLoading=!1,this._wireViewStarted=function(a,b){g.onViewStarted(a,b)},this._wireViewStopped=function(a,b){g.onViewStopped(a,b)},this._wireLayerUpdated=function(a,b){g.onLayerUpdated(a,b)},this._wireLoading=function(a){g.onLoading(a)},this._wireLoaded=function(a){g.onLoaded(a)};var h=this.view.getControl().clock.getTime();this.info.deriveCurrentTimes(h);var i=this.info.deriveUrl(),f=this.info.deriveOptions();this._surface=new c.Extension(i,f),this.setOpacity(e),this.map.addLayer(this._surface)}return __extends(c,b),c.prototype.getSurface=function(){return this._surface},c.prototype.getZIndex=function(){return this._zIndex},c.prototype.setZIndex=function(a){this._zIndex=a,this._surface.setZIndex(a)},c.prototype.getIsLoading=function(){return this._isLoading},c.prototype.getOpacity=function(){return this.info.opacity},c.prototype.setOpacity=function(a){var b=this.view.getOpacity(),c=null!=b?b:a;null!=c&&void 0!=c&&(this.info.opacity=c,this._surface.setOpacity(c))},c.prototype.register=function(){this._isRegistered||(this.view.started.addListener(this,this._wireViewStarted),this.view.stopped.addListener(this,this._wireViewStopped),this.info.updated.addListener(this,this._wireLayerUpdated),this._surface.addEventListener("loading",this._wireLoading),this._surface.addEventListener("load",this._wireLoaded),this._isRegistered=!0)},c.prototype.unregister=function(){this._isRegistered&&(this.view.started.removeListener(this._wireViewStarted),this.view.stopped.removeListener(this._wireViewStopped),this.info.updated.removeListener(this._wireLayerUpdated),this._surface.removeEventListener("loading",this._wireLoading),this._surface.removeEventListener("load",this._wireLoaded),this._isRegistered=!1)},c.prototype.update=function(){var a=this.info.deriveUrl();this._surface.setUrl(a)},c.prototype.start=function(){this.register()},c.prototype.stop=function(){this.map.removeLayer(this._surface),this.unregister()},c.prototype.onLoading=function(a){this._isLoading=!0,this.loading.trigger(this)},c.prototype.onLoaded=function(a){this._isLoading=!1,this.loaded.trigger(this)},c.prototype.onViewStarted=function(a,b){this.register()},c.prototype.onViewStopped=function(a,b){var c=this;setTimeout(function(){c.unregister()},1)},c.prototype.onLayerUpdated=function(a,b){var c=this.info.getCurrentValidTime();this.info.deriveCurrentTimes(this.view.getControl().clock.getTime()),c!=this.info.getCurrentValidTime()&&(this.update(),this.updated.trigger(this,{id:this.info.id}))},c.Extension=L.TileLayer.extend({getTileUrl:function(b){var c=this;if(-1===this._url.indexOf("http:"))return"http://images.intellicast.com/App_Images/bg_trans.gif";var d=Math.pow(2,f),e=d-b.y,f=this._getZoomForUrl(),g=(a.Gis.TmsTileSystem.tileXYToQuadkey(b.x,e-1,f),"1"),h="1,2,3";switch(f){case 1:g="1",h="1,2,3";break;case 2:g="2",h="1,2,3";break;case 3:g="3",h="1,2,3";break;case 4:g="4",h="1,2,3";break;case 5:g="5",h="1,2,3";break;case 6:g="6",h="1,2,3";break;case 7:g="6",h="1,2";break;case 8:g="6",h="1";break;case 9:g="7",h="1,2";break;case 10:g="8",h="1,2";break;case 11:g="8",h="1,2,3";break;case 12:g="8",h="1,2,3";break;case 13:g="8",h="1,2,3,4";break;case 14:g="8",h="1,2,3,4,5";break;case 15:g="8",h="1,2,3,4,5,6";break;case 16:g="8",h="1,2,3,4,5,6,7"}return L.Util.template(this._url,{s:this._getSubdomain(b),f:h,p:g,q:c._deriveQuadKey(b.x,b.y,c._getZoomForUrl())})},_deriveQuadKey:function(a,b,c){for(var d=[],e=c;e>0;e--){var f="0",g=1<<e-1;0!=(a&g)&&f++,0!=(b&g)&&(f++,f++),d.push(f)}return d.join("")}}),c}(b.Layer);b.InrixLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(d){c.call(this,d);var e=new a.DateTime(new Date),f=e.toChronoString(),g=new b.ValidTime(f,"");this.validTimes=[g]}return __extends(d,c),d.prototype.getType=function(){return"InrixLayerInfo"},d.prototype.deriveUrl=function(b,c,d,e,f,g,h){var i=new a.StringBuilder,j=this.href;return i.append(j).append("&coverage=255&format=png&layers=T&penWidth={p}&frcLevel={f}&Quadkey={q}"),i.toString()},d.prototype.deriveOptions=function(){var a={subdomains:b.LayerInfo.cacheModifiers,tms:!1,reuseTiles:!1,errorTileUrl:"http://images.intellicast.com/App_Images/bg_trans.gif"};return a},d}(b.LayerInfo);b.InrixLayerInfo=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a){void 0===a&&(a=""),this.validTimes=new Array,this.value=a}return a}();a.IssueTime=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){this.isDown=!1,this.isOver=!1}return a}();a.Mouse=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(d,e){this._mode="Standard",this.self=this,this.layers={},this.modeChanged=new a.Event,this.maximumZoom=d.maximumZoom||31,this.minimumZoom=d.minimumZoom||1,this.slidingTimeout=d.slidingTimeout||6e5,this.absoluteTimeout=d.absoluteTimeout||72e5,this.menu=d.menu,this.control=e,c.assetHost=d.assetHost||"http://tessera0.intellicast.com",b.GeoLayerInfo.styeHost=d.styleHost;for(var f=0,g=d.layers.length;g>f;f++){var h=d.layers[f];if("tile"===h._){var i=new b.TileLayerInfo(h.id);i.label=h.label,i.extension=h.extension,i.hostId=h.hostId,i.minimumZoom=h.minZoom,i.maximumZoom=h.maxZoom,i.tags=h.tags,i.legendUri=h.legendUrl,i.isBasemap=h.isBaseMap,i.isAnimate=h.isAnimate,i.validForward=h.validForward?new a.TimeSpan(h.validForward):a.TimeSpan.max,i.validBackward=h.validBackward?new a.TimeSpan(h.validBackward):a.TimeSpan.max,i.startOffset=h.startOffset?new a.TimeSpan(h.startOffset):a.TimeSpan.zero,i.endOffset=h.endOffset?new a.TimeSpan(h.endOffset):a.TimeSpan.zero,i.brokenTileUri=h.brokenTileUri,i.attributionSource=h.attributionSource,this.layers[i.id]=i}else if("bing"===h._){var j=new b.BingLayerInfo(h.id);j.bingMapKey=d.bingMapKey,j.label=h.label,j.extension=h.extension,j.hostId=h.hostId,j.minimumZoom=h.minZoom,j.maximumZoom=h.maxZoom,j.tags=h.tags,j.legendUri=h.legendUri,j.isBasemap=h.isBaseMap,j.isAnimate=h.isAnimate,j.alias=h.alias,j.shading=h.shading,j.validForward=h.validForward?new a.TimeSpan(h.validForward):a.TimeSpan.max,j.validBackward=h.validBackward?new a.TimeSpan(h.validBackward):a.TimeSpan.max,j.attributionSource=h.attributionSource,this.layers[j.id]=j}else if("inrix"===h._){var k=new b.InrixLayerInfo(h.id);k.label=h.label,k.extension=h.extension,k.hostId=h.hostId,k.minimumZoom=h.minZoom,k.maximumZoom=h.maxZoom,k.tags=h.tags,k.legendUri=h.legendUri,k.isBasemap=h.isBaseMap,k.isAnimate=h.isAnimate,k.validForward=h.validForward?new a.TimeSpan(h.validForward):a.TimeSpan.max,k.validBackward=h.validBackward?new a.TimeSpan(h.validBackward):a.TimeSpan.max,k.attributionSource=h.attributionSource,this.layers[k.id]=k}else if("wxcentral"===h._){var l=new b.WxCentralLayerInfo(h.id);l.label=h.label,l.extension=h.extension,l.hostId=h.hostId,l.minimumZoom=h.minZoom,l.maximumZoom=h.maxZoom,l.tags=h.tags,l.legendUri=h.legendUri,l.isBasemap=h.isBaseMap,l.isAnimate=h.isAnimate,l.validForward=h.validForward?new a.TimeSpan(h.validForward):a.TimeSpan.max,l.validBackward=h.validBackward?new a.TimeSpan(h.validBackward):a.TimeSpan.max,l.attributionSource=h.attributionSource,this.layers[l.id]=l}else if("sweep"===h._){var m=new b.SweepLayerInfo(h.id);m.label=h.label,m.extension=h.extension,m.hostId=h.hostId,m.minimumZoom=h.minZoom,m.maximumZoom=h.maxZoom,m.tags=h.tags,m.attributionSource=h.attributionSource,this.layers[m.id]=m}else{var n=new b.GeoLayerInfo(h.id,h.pyramidPolicy);n.label=h.label,n.extension="gml",n.hostId=h.hostId,n.minimumZoom=h.minZoom,n.maximumZoom=h.maxZoom,n.tags=h.tags,n.legendUri=h.legendUri,n.isBasemap=h.isBaseMap,n.isAnimate=h.isAnimate,n.validBackward=h.validForward,n.validBackward=h.validBackward,n.validForward=h.validForward?new a.TimeSpan(h.validForward):a.TimeSpan.max,n.validBackward=h.validBackward?new a.TimeSpan(h.validBackward):a.TimeSpan.max,n.stylePath=h.stylePath?b.GeoLayerInfo.styeHost+h.stylePath:null,n.isLocalOnly=h.isLocalOnly||!1,n.attributionSource=h.attributionSource,this.layers[n.id]=n}}}return c.prototype.getMode=function(){return this._mode},c.prototype.setMode=function(a){var b=this._mode;this._mode=a,this.modeChanged.trigger(this,{oldMode:b,newMode:a})},c.prototype.deriveLayerInfo=function(a){if(this.layers.hasOwnProperty(a))return this.layers[a];if("TmsGrid"===a){var c=new b.GeoLayerInfo("TmsGrid");return c.label="Tms Grid",c}if("Graticule"===a){var c=new b.GeoLayerInfo("Graticule");return c.label="Graticule",c}return null},c}();b.Settings=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b}(a.Layer);a.SweepLayer=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.getType=function(){return"SweepLayerInfo"},b}(a.LayerInfo);a.SweepLayerInfo=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(c,d,e,f){var g=this;b.call(this,c,d,e,f),this._isLoading=!0,this._isRegistered=!1,this._zIndex=-1,this._frames=null,this._surface=null,this._wireLoading=function(a){g.onLoading(a)},this._wireLoaded=function(a){g.onLoaded(a)},this._wireViewStarted=function(a,b){g.onViewStarted(a,b)},this._wireViewStopped=function(a,b){g.onViewStopped(a,b)},this._wireUpdated=function(a,b){g.onLayerUpdated(a,b)},this._wireAnimationStopped=function(a,b){g.onAnimationStopped(a,b)},this._wireAnimationFrameChanged=function(a,b){g.onAnimationFrameChanged(a,b)},this._lastUpdateTime=new a.DateTime(a.DateTime.utcFromNow()).toChronoString();var h=this.view.getControl().clock.getTime();this.info.deriveCurrentTimes(h);var i=this.info.deriveUrl(),f=this.info.deriveOptions();this._surface=new L.TileLayer(i,f),this.setOpacity(e),this.map.addLayer(this._surface)}return __extends(c,b),c.prototype.getSurface=function(){return this._surface},c.prototype.getZIndex=function(){return this._zIndex},c.prototype.setZIndex=function(a){this._zIndex=a,this._surface.setZIndex(a);for(var b in this._frames){var c=this._frames[b];c.setZIndex(this._zIndex)}},c.prototype.getIsLoading=function(){return this._isLoading},c.prototype.getOpacity=function(){return this.info.opacity},c.prototype.setOpacity=function(a){var b=this.view.getOpacity(),c=null!=b?b:a;if(null!=a&&void 0!=a&&(this.info.opacity=a,this._surface.setOpacity(c),null!=this._frames))for(var d in this._frames){var e=this._frames[d];e.setOpacity(c)}},c.prototype.loadFrames=function(){var a,b=this.map,c=this.info.issueTimes,d=this.info.validTimes;if(null===c||0===c.length)a=d;else{var e=c.length>1?c[1]:c[0];a=e.validTimes}if(null===a)return void(this._frames=null);this._frames={};for(var f=0;f<a.length;f++){var g=a[f],h=this.info.deriveUrl(null,null,null,null,g.value,"1",g.cipher),i=this.info.deriveOptions(),j=new L.TileLayer(h,i);j.addEventListener("loading",this._wireLoading),j.addEventListener("load",this._wireLoaded),this._frames[g.value]=j,j.setOpacity(this.info.opacity),b.addLayer(j),j.setZIndex(this._zIndex);var k=j.getContainer();k.style.visibility="hidden",k.style.display="none"}var l=this._surface.getContainer();l.style.visibility="hidden",l.style.display="none"},c.prototype.updateFrames=function(){var a,b=this.map,c=!1,d=this.info.issueTimes,e=this.info.validTimes;if(null===d||0===d.length)a=e;else{var f=d.length>1?d[1]:d[0];a=f.validTimes}for(var g in this._frames){for(var h=this._frames[g],i=!1,j=0;j<a.length;j++){var k=a[j];if(k.value===g){i=!0;break}}i||(b.removeLayer(h),delete this._frames[g],c=!0)}for(var j=0;j<a.length;j++){var k=a[j],l=!1;for(var g in this._frames)if(g===k.value){l=!0;break}if(!l){var m=this.info.deriveUrl(null,null,null,null,k.value,"1",k.cipher),n=this.info.deriveOptions(),o=new L.TileLayer(m,n);o.setOpacity(this.info.opacity),o.addEventListener("loading",this._wireLoading),o.addEventListener("load",this._wireLoaded),this._frames[k.value]=o,b.addLayer(o),o.setZIndex(this._zIndex);var p=o.getContainer();p.style.visibility="hidden",p.style.display="none",c=!0}}return c},c.prototype.unloadFrames=function(){for(var a in this._frames){var b=this._frames[a];b.removeEventListener("loading",this._wireLoading),b.removeEventListener("load",this._wireLoaded),this.map.removeLayer(b)}this._frames=null;var c=this._surface.getContainer();null!=c&&(c.style.visibility="visible",c.style.display="block")},c.prototype.changeFrame=function(){null==this._frames&&this.loadFrames();try{var b=this.info,c=this.view.getControl().clock.getTime();b.deriveCurrentTimes(c);var d=b.getCurrentValidTime(),e=this._frames[d];if(null!=e){for(var f in this._frames){var g=this._frames[f],h=g.getContainer();h.style.visibility="hidden",h.style.display="none"}var i=e.getContainer();null!=i&&(i.style.visibility="visible",i.style.display="block")}}catch(j){a.Console.log(j)}},c.prototype.register=function(){if(!this._isRegistered){if(this.view.started.addListener(this,this._wireViewStarted),this.view.stopped.addListener(this,this._wireViewStopped),this.info.updated.addListener(this,this._wireUpdated),this._surface.addEventListener("loading",this._wireLoading),this._surface.addEventListener("load",this._wireLoaded),this.info.isAnimate){var a=this.view.getControl();a.animator.stopped.addListener(this,this._wireAnimationStopped),a.animator.frameChanged.addListener(this,this._wireAnimationFrameChanged)}this._isRegistered=!0}},c.prototype.unregister=function(){if(this._isRegistered){if(this.view.started.removeListener(this._wireViewStarted),this.view.stopped.removeListener(this._wireViewStopped),this.info.updated.removeListener(this._wireUpdated),this._surface.removeEventListener("loading",this._wireLoading),this._surface.removeEventListener("load",this._wireLoaded),this.info.isAnimate){var a=this.view.getControl();a.animator.stopped.removeListener(this._wireAnimationStopped),a.animator.frameChanged.removeListener(this._wireAnimationFrameChanged)}this._isRegistered=!1}},c.prototype.update=function(){var a=this.info.deriveUrl();this._surface.setUrl(a)},c.prototype.start=function(){this.register()},c.prototype.stop=function(){this.unloadFrames(),this.map.removeLayer(this._surface),this.unregister()},c.prototype.onLoading=function(a){a.target.isLoading=!0,this._isLoading=!0,this.loading.trigger(this)},c.prototype.onLoaded=function(a){if(a.target.isLoading=!1,null==this._frames)this._isLoading=!1,this.loaded.trigger(this);else{var b=!1;for(var c in this._frames){var d=this._frames[c];if(d.isLoading){b=!0;break}}b||this._isLoading&&(this._isLoading=b,this.loaded.trigger(this))}},c.prototype.onAnimationStopped=function(a,b){this.unloadFrames();var c=this.info;c.getCurrentValidTime();c.deriveCurrentTimes(this.view.getControl().clock.getTime()),this.update()},c.prototype.onAnimationFrameChanged=function(a,b){var c=this.view.getControl().animator;if(c.getIsPlaying()||c.getIsPaused())this.changeFrame();else{this.unloadFrames();var d=this.info;d.getCurrentValidTime();d.deriveCurrentTimes(this.view.getControl().clock.getTime()),this.update()}},c.prototype.onViewStarted=function(a,b){this.register()},c.prototype.onViewStopped=function(a,b){var c=this;setTimeout(function(){c.unregister()},1)},c.prototype.onLayerUpdated=function(a,b){var c=!1,d=this.info,e=d.getCurrentValidTime();d.deriveCurrentTimes(this.view.getControl().clock.getTime()),e!=d.getCurrentValidTime()&&(this.update(),c=!0),null!=this._frames&&(c=this.updateFrames()),c&&this.updated.trigger(this,{id:this.info.id})},c}(b.Layer);b.TileLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(b){function c(c){b.call(this,c),this.blankTileUri=a.Settings.assetHost+"/Assets/blank.gif",this.brokenTileUri=a.Settings.assetHost+"/Assets/broken.gif",this.tileWidth=256,this.tileHeight=256}return __extends(c,b),c.prototype.getType=function(){return"TileLayerInfo"},c.prototype.deriveUrl=function(a,b,c,d,e,f,g){var h=d||this.getCurrentIssueTime(),i=e||this.getCurrentValidTime(),j=f||this.getCurrentIteration(),k=g||this.getCurrentCipher();if(!this.href||!i)return this.blankTileUri;var l=this.href.replace("{l}","en-US").replace("{c}",k).replace("{m}",h).replace("{v}",i).replace("{i}",j);return l},c.prototype.deriveOptions=function(){var b={subdomains:a.LayerInfo.cacheModifiers,tms:!0,reuseTiles:!1,errorTileUrl:this.brokenTileUri,maxZoom:this.maximumZoom,minZoom:this.minimumZoom};return b},c}(a.LayerInfo);a.TileLayerInfo=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.Touch=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a,b){void 0===a&&(a=""),void 0===b&&(b=""),this.iterations=new Array,this.value=a,this.cipher=b}return a}();a.ValidTime=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.getType=function(){return"WxCentralLayerInfo"},b.prototype.deriveUrl=function(a,b,c,d,e,f,g){var h=(d||this.getCurrentIssueTime(),e||this.getCurrentValidTime(),f||this.getCurrentIteration(),this.deriveTimeStamp(e)),i=this.href.replace("{quadkey}","{q}").replace("{timestamp}",h);return i},b.prototype.deriveTimeStamp=function(a){return a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)+"T"+a.substring(8,10)+":"+a.substring(10,12)+":"+a.substring(12,14)},b.prototype.deriveOptions=function(){var a={tms:!0,reuseTiles:!1,errorTileUrl:"http://images.intellicast.com/App_Images/bg_trans.gif"};return a},b}(a.LayerInfo);a.WxCentralLayerInfo=b}(b=a.Client||(a.Client={}));
}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._wireSkipToStartButtonClick=function(a){b.onSkipToStartButtonClick(a)},this._wireBackwardButtonClick=function(a){b.onBackwardButtonClick(a)},this._wireStopButtonClick=function(a){b.onStopButtonClick(a)},this._wirePauseButtonClick=function(a){b.onPauseButtonClick(a)},this._wirePlayButtonClick=function(a){b.onPlayButtonClick(a)},this._wireForwardButtonClick=function(a){b.onForwardButtonClick(a)},this._wireSkipToEndButtonClick=function(a){b.onSkipToEndButtonClick(a)},this._wireFrameCountInputBlur=function(a){b.onFrameCountInputBlur(a)},this._wireFrameRateInputBlur=function(a){b.onFrameRateInputBlur(a)},this._wireFramePeriodInputBlur=function(a){b.onFramePeriodInputBlur(a)},this._wireFrameDwellInputBlur=function(a){b.onFrameDwellInputBlur(a)},this._wireStartTimeInputBlur=function(a){b.onStartTimeInputBlur(a)},this._wireEndTimeInputBlur=function(a){b.onEndTimeInputBlur(a)},this._wireCurrentFrameInputBlur=function(a){b.onCurrentFrameInputBlur(a)},this._wireCurrentTimeInputBlur=function(a){b.onCurrentTimeInputBlur(a)},this._wireMinimizeRangeButtonClick=function(a){b.onMinimizeRangeButtonClick(a)},this._wireMaximizeRangeButtonClick=function(a){b.onMaximizeRangeButtonClick(a)},this._wireSlidingCheckboxClick=function(a){b.onSlidingCheckboxClick(a)},this._wireLoopingCheckboxClick=function(a){b.onLoopingCheckboxClick(a)},this._wireDwellChanged=function(a,c){b.onDwellChanged(a,c)},this._wireEnableLoopingChanged=function(a,c){b.onEnableLoopingChanged(a,c)},this._wireEndTimeChanged=function(a,c){b.onEndTimeChanged(a,c)},this._wireFrameChanged=function(a,c){b.onFrameChanged(a,c)},this._wireIsSlidingChanged=function(a,c){b.onIsSlidingChanged(a,c)},this._wireAnimatorPaused=function(a,c){b.onAnimatorPaused(a,c)},this._wirePeriodPerFrameChanged=function(a,c){b.onPeriodPerFrameChanged(a,c)},this._wirePlayRateChanged=function(a,c){b.onPlayRateChanged(a,c)},this._wireAnimatorStarted=function(a,c){b.onAnimatorStarted(a,c)},this._wireStartTimeChanged=function(a,c){b.onStartTimeChanged(a,c)},this._wireAnimatorStopped=function(a,c){b.onAnimatorStopped(a,c)},this._wireTotalFramesChanged=function(a,c){b.onTotalFramesChanged(a,c)},this._wireCurrentTimeChanged=function(a,c){b.onCurrentTimeChanged(a,c)},this._wireAnimatorLoading=function(a,c){b.onAnimatorLoading(a,c)},this._wireAnimatorLoaded=function(a,c){b.onAnimatorLoaded(a,c)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.load=function(){this._skipToStartButton=document.getElementById("__wxMap_skipToStartButton"),this._backwardButton=document.getElementById("__wxMap_backwardButton"),this._stopButton=document.getElementById("__wxMap_stopButton"),this._pauseButton=document.getElementById("__wxMap_pauseButton"),this._playButton=document.getElementById("__wxMap_playButton"),this._forwardButton=document.getElementById("__wxMap_forwardButton"),this._skipToEndButton=document.getElementById("__wxMap_skipToEndButton"),this._frameCountInput=document.getElementById("__wxMap_frameCountInput"),this._frameRateInput=document.getElementById("__wxMap_frameRateInput"),this._framePeriodButton=document.getElementById("__wxMap_framePeriodButton"),this._framePeriodInput=document.getElementById("__wxMap_framePeriodInput"),this._frameDwellButton=document.getElementById("__wxMap_frameDwellButton"),this._frameDwellInput=document.getElementById("__wxMap_frameDwellInput"),this._slidingCheckbox=document.getElementById("__wxMap_slidingCheckbox"),this._loopingCheckbox=document.getElementById("__wxMap_loopingCheckbox"),this._startTimeButton=document.getElementById("__wxMap_startTimeButton"),this._startTimeInput=document.getElementById("__wxMap_startTimeInput"),this._endTimeButton=document.getElementById("__wxMap_endTimeButton"),this._endTimeInput=document.getElementById("__wxMap_endTimeInput"),this._currentFrameInput=document.getElementById("__wxMap_currentFrameInput"),this._currentTimeInput=document.getElementById("__wxMap_currentTimeInput"),this._minimizeRangeButton=document.getElementById("__wxMap_minimizeRangeButton"),this._maximizeRangeButton=document.getElementById("__wxMap_maximizeRangeButton"),this._loadingPercentage=document.getElementById("__wxMap_loadingPercentage")},b.prototype.register=function(){a.addEventListener(this._skipToStartButton,"click",this._wireSkipToStartButtonClick),a.addEventListener(this._backwardButton,"click",this._wireBackwardButtonClick),a.addEventListener(this._stopButton,"click",this._wireStopButtonClick),a.addEventListener(this._pauseButton,"click",this._wirePauseButtonClick),a.addEventListener(this._playButton,"click",this._wirePlayButtonClick),a.addEventListener(this._forwardButton,"click",this._wireForwardButtonClick),a.addEventListener(this._skipToEndButton,"click",this._wireSkipToEndButtonClick),a.addEventListener(this._frameCountInput,"blur",this._wireFrameCountInputBlur),a.addEventListener(this._frameRateInput,"blur",this._wireFrameRateInputBlur),a.addEventListener(this._framePeriodInput,"blur",this._wireFramePeriodInputBlur),a.addEventListener(this._frameDwellInput,"blur",this._wireFrameDwellInputBlur),a.addEventListener(this._startTimeInput,"blur",this._wireStartTimeInputBlur),a.addEventListener(this._endTimeInput,"blur",this._wireEndTimeInputBlur),a.addEventListener(this._currentFrameInput,"blur",this._wireCurrentFrameInputBlur),a.addEventListener(this._currentTimeInput,"blur",this._wireCurrentTimeInputBlur),a.addEventListener(this._minimizeRangeButton,"click",this._wireMinimizeRangeButtonClick),a.addEventListener(this._maximizeRangeButton,"click",this._wireMaximizeRangeButtonClick),a.addEventListener(this._slidingCheckbox,"click",this._wireSlidingCheckboxClick),a.addEventListener(this._loopingCheckbox,"click",this._wireLoopingCheckboxClick),this.map.animator.dwellChanged.addListener(this,this._wireDwellChanged),this.map.animator.enableLoopingChanged.addListener(this,this._wireEnableLoopingChanged),this.map.animator.endTimeChanged.addListener(this,this._wireEndTimeChanged),this.map.animator.frameChanged.addListener(this,this._wireFrameChanged),this.map.animator.isSlidingChanged.addListener(this,this._wireIsSlidingChanged),this.map.animator.paused.addListener(this,this._wireAnimatorPaused),this.map.animator.periodPerFrameChanged.addListener(this,this._wirePeriodPerFrameChanged),this.map.animator.playRateChanged.addListener(this,this._wirePlayRateChanged),this.map.animator.started.addListener(this,this._wireAnimatorStarted),this.map.animator.startTimeChanged.addListener(this,this._wireStartTimeChanged),this.map.animator.stopped.addListener(this,this._wireAnimatorStopped),this.map.animator.totalFramesChanged.addListener(this,this._wireTotalFramesChanged),this.map.clock.timeChanged.addListener(this,this._wireCurrentTimeChanged),this.map.animator.loading.addListener(this,this._wireAnimatorLoading),this.map.animator.loaded.addListener(this,this._wireAnimatorLoaded)},b.prototype.unregister=function(){a.removeEventListener(this._skipToStartButton,"click",this._wireSkipToStartButtonClick),a.removeEventListener(this._backwardButton,"click",this._wireBackwardButtonClick),a.removeEventListener(this._stopButton,"click",this._wireStopButtonClick),a.removeEventListener(this._pauseButton,"click",this._wirePauseButtonClick),a.removeEventListener(this._playButton,"click",this._wirePlayButtonClick),a.removeEventListener(this._forwardButton,"click",this._wireForwardButtonClick),a.removeEventListener(this._skipToEndButton,"click",this._wireSkipToEndButtonClick),a.removeEventListener(this._frameCountInput,"blur",this._wireFrameCountInputBlur),a.removeEventListener(this._frameRateInput,"blur",this._wireFrameRateInputBlur),a.removeEventListener(this._framePeriodInput,"blur",this._wireFramePeriodInputBlur),a.removeEventListener(this._frameDwellInput,"blur",this._wireFrameDwellInputBlur),a.removeEventListener(this._startTimeInput,"blur",this._wireStartTimeInputBlur),a.removeEventListener(this._endTimeInput,"blur",this._wireEndTimeInputBlur),a.removeEventListener(this._currentFrameInput,"blur",this._wireCurrentFrameInputBlur),a.removeEventListener(this._currentTimeInput,"blur",this._wireCurrentTimeInputBlur),a.removeEventListener(this._minimizeRangeButton,"click",this._wireMinimizeRangeButtonClick),a.removeEventListener(this._maximizeRangeButton,"click",this._wireMaximizeRangeButtonClick),a.removeEventListener(this._slidingCheckbox,"click",this._wireSlidingCheckboxClick),a.removeEventListener(this._loopingCheckbox,"click",this._wireLoopingCheckboxClick),this.map.animator.dwellChanged.removeListener(this._wireDwellChanged),this.map.animator.enableLoopingChanged.removeListener(this._wireEnableLoopingChanged),this.map.animator.endTimeChanged.removeListener(this._wireEndTimeChanged),this.map.animator.frameChanged.removeListener(this._wireFrameChanged),this.map.animator.isSlidingChanged.removeListener(this._wireIsSlidingChanged),this.map.animator.paused.removeListener(this._wireAnimatorPaused),this.map.animator.periodPerFrameChanged.removeListener(this._wirePeriodPerFrameChanged),this.map.animator.playRateChanged.removeListener(this._wirePlayRateChanged),this.map.animator.started.removeListener(this._wireAnimatorStarted),this.map.animator.startTimeChanged.removeListener(this._wireStartTimeChanged),this.map.animator.stopped.removeListener(this._wireAnimatorStopped),this.map.animator.totalFramesChanged.removeListener(this._wireTotalFramesChanged),this.map.clock.timeChanged.removeListener(this._wireCurrentTimeChanged),this.map.animator.loading.removeListener(this._wireAnimatorLoading),this.map.animator.loaded.removeListener(this._wireAnimatorLoaded)},b.prototype.bindSettings=function(){this._frameCountInput.value=this.map.animator.getTotalFrames(),this._frameRateInput.value=this.map.animator.getPlayRate(),this._framePeriodInput.value=this.map.animator.getPeriodPerFrame(),this._frameDwellInput.value=this.map.animator.getDwell(),this._slidingCheckbox.checked=this.map.animator.getIsSliding(),this._loopingCheckbox.checked=this.map.animator.getEnableLooping()},b.prototype.bindState=function(){var b=new a.StringBuilder,c=new a.DateTime(this.map.animator.getStartTime());b.append(c.toShortDateString()),b.append(" "),b.append(c.toShortTimeString()),this._startTimeInput.value=b.toString(),b.clear();var d=new a.DateTime(this.map.animator.getEndTime());b.append(d.toShortDateString()),b.append(" "),b.append(d.toShortTimeString()),this._endTimeInput.value=b.toString(),b.clear();var e=new a.DateTime(this.map.clock.getTime());b.append(e.toShortDateString()),b.append(" "),b.append(e.toShortTimeString()),this._currentTimeInput.value=b.toString(),this._currentFrameInput.value=this.map.animator.getCurrentFrame()},b.prototype.onSlidingCheckboxClick=function(b){a.Event.cancel(b),this.map.animator.setIsSliding(this._slidingCheckbox.checked)},b.prototype.onLoopingCheckboxClick=function(b){a.Event.cancel(b),this.map.animator.setEnableLooping(this._loopingCheckbox.checked)},b.prototype.onSkipToStartButtonClick=function(b){a.Event.cancel(b),this.map.animator.skipToStart()},b.prototype.onBackwardButtonClick=function(b){a.Event.cancel(b),this.map.animator.backward()},b.prototype.onStopButtonClick=function(b){a.Event.cancel(b),this.map.animator.stop()},b.prototype.onPauseButtonClick=function(b){a.Event.cancel(b),this.map.animator.pause()},b.prototype.onPlayButtonClick=function(b){a.Event.cancel(b),this.map.animator.play()},b.prototype.onForwardButtonClick=function(b){a.Event.cancel(b),this.map.animator.forward()},b.prototype.onSkipToEndButtonClick=function(b){a.Event.cancel(b),this.map.animator.skipToEnd()},b.prototype.onFrameCountInputBlur=function(a){this.map.animator.setTotalFrames(this._frameCountInput.value)},b.prototype.onFrameRateInputBlur=function(a){this.map.animator.setPlayRate(this._frameRateInput.value)},b.prototype.onFramePeriodInputBlur=function(a){this.map.animator.setPeriodPerFrame(this._framePeriodInput.value)},b.prototype.onFrameDwellInputBlur=function(a){this.map.animator.setDwell(this._frameDwellInput.value)},b.prototype.onStartTimeInputBlur=function(b){var c=a.DateTime.parseChrono(this._startTimeInput.value);this.map.animator.setStartTime(c)},b.prototype.onEndTimeInputBlur=function(b){var c=a.DateTime.parseChrono(this._endTimeInput.value);this.map.animator.setEndTime(c)},b.prototype.onCurrentFrameInputBlur=function(a){this.map.animator.skipToFrame(this._currentFrameInput.value)},b.prototype.onCurrentTimeInputBlur=function(b){var c=a.DateTime.parseChrono(this._currentTimeInput.value);this.map.animator.skipToTime(c)},b.prototype.onMinimizeRangeButtonClick=function(b){a.Event.cancel(b),this.map.animator.minimizeRange()},b.prototype.onMaximizeRangeButtonClick=function(b){a.Event.cancel(b),this.map.animator.maximizeRange()},b.prototype.onDwellChanged=function(a,b){this.dashboard.outputPanel.queueEvent("DwellChanged"),this._frameDwellInput.value=b.dwell},b.prototype.onEnableLoopingChanged=function(a,b){this.dashboard.outputPanel.queueEvent("EnableLoopingChanged"),this._loopingCheckbox.checked=b.enableLooping},b.prototype.onEndTimeChanged=function(b,c){var d=new a.StringBuilder,e=new a.DateTime(c.endTime);d.append(e.toShortDateString()),d.append(" "),d.append(e.toShortTimeString()),this._endTimeInput.value=d.toString()},b.prototype.onFrameChanged=function(a,b){this._currentFrameInput.value=b.frame,this._loadingPercentage.innerHTML=this.map.animator.getLoadedFramePercent()+"%"},b.prototype.onIsSlidingChanged=function(a,b){this.dashboard.outputPanel.queueEvent("IsSlidingChanged"),this._slidingCheckbox.checked=b.isSliding},b.prototype.onAnimatorPaused=function(a,b){this.dashboard.outputPanel.queueEvent("Paused")},b.prototype.onPeriodPerFrameChanged=function(a,b){this.dashboard.outputPanel.queueEvent("PeriodPerFrameChanged"),this._framePeriodInput.value=b.periodPerFrame,this._frameCountInput.value=b.totalFrames},b.prototype.onPlayRateChanged=function(a,b){this._frameRateInput.value=b.playRate},b.prototype.onAnimatorStarted=function(a,b){this.dashboard.outputPanel.queueEvent("AnimatorStarted")},b.prototype.onStartTimeChanged=function(b,c){var d=new a.DateTime(c.startTime),e=new a.StringBuilder;e.append(d.toShortDateString()),e.append(" "),e.append(d.toShortTimeString()),this._startTimeInput.value=e.toString()},b.prototype.onAnimatorStopped=function(a,b){this.dashboard.outputPanel.queueEvent("AnimatorStopped"),this._loadingPercentage.style.visibility="hidden"},b.prototype.onTotalFramesChanged=function(a,b){this.dashboard.outputPanel.queueEvent("TotalFramesChanged"),this._framePeriodInput.value=b.periodPerFrame,this._frameCountInput.value=b.totalFrames},b.prototype.onCurrentTimeChanged=function(b,c){var d=new a.DateTime(c.time),e=new a.StringBuilder;e.append(d.toShortDateString()),e.append(" "),e.append(d.toShortTimeString()),this._currentTimeInput.value=e.toString()},b.prototype.onAnimatorLoading=function(a,b){this.dashboard.outputPanel.queueEvent("AnimatorLoading"),this._loadingPercentage.style.visibility="visible",this._loadingPercentage.innerHTML=this.map.animator.getLoadedFramePercent()+"%"},b.prototype.onAnimatorLoaded=function(a,b){var c=this;this.dashboard.outputPanel.queueEvent("AnimatorLoaded"),setTimeout(function(){c._loadingPercentage.style.visibility="hidden"},500)},b}();b.AnimationPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function c(a,c,d){var e=this;this._wireToggleControlsClick=function(a){e.onToggleControlsClick(a)},this._wireViewStarted=function(a){e.onViewStarted(a)},this._wireLoading=function(a){e.onLoading(a)},this._wireLoaded=function(a){e.onLoaded(a)},this.type="WxMap.Profiler.Dashboard",this.isEnabled=!0,this.persistSession=!0,this.elementId=a,this.element=document.getElementById(a),this.map=c,this.args=d,this.html=b.Markup(),this.style=b.Style(),this.inject(),this.load(),this.bind(),this.initialize(),this.register(),this.loadEnabledState(),this.outputPanel.queueEvent("Loaded"),this.outputPanel.bindMessages({message:"Started"})}return c.prototype.loadEnabledState=function(){if(a.Storage.isEnabled){var b=a.Storage.retrieve(this.type+".Enabled");null!==b&&(b||this.disable())}},c.prototype.saveEnabledState=function(){if(a.Storage.isEnabled){var b=this.type+".Enabled";a.Storage.remove(b),a.Storage.save(b,this.isEnabled)}},c.prototype.bindCollapsibleRegions=function(){for(var b=this,c=this.element.querySelectorAll(".Collapse-Trigger"),d=function(c){var d=a.Event.deriveSourceElement(c),e=d.parentNode.querySelector(".Content");""===e.style.display?(e.style.display="none",d.className+=" Collapsed"):(e.style.display="",d.className=d.className.replace(/ Collapsed/g,"")),b.saveCollapsibleRegionState()},e=0,f=c.length;f>e;e++)c[e].id="__wxMap_Collapse_"+e,a.addEventListener(c[e],"click",d);this.loadCollapsibleRegionState()},c.prototype.loadCollapsibleRegionState=function(){if(a.Storage.isEnabled){var b,c=a.Storage.retrieve(this.type+".Collapsed");if(c)for(var d=0;d<c.length;d++)b=document.getElementById(c[d]),b.className+=" Collapsed",b.parentNode.querySelector(".Content").style.display="none"}},c.prototype.saveCollapsibleRegionState=function(){if(a.Storage.isEnabled){var b=this.element.querySelectorAll(".Collapsed"),c=[],d=this.type+".Collapsed";if(b.length){for(var e=0;e<b.length;e++)c.push(b[e].id);a.Storage.remove(d),a.Storage.save(d,c)}else a.Storage.remove(d)}},c.prototype.inject=function(){var b=new a.StringBuilder,c=document.getElementsByTagName("head")[0],d=document.createElement("style"),e=document.createTextNode(this.style);d.type="text/css",d.styleSheet?d.styleSheet.cssText=e.nodeValue:d.appendChild(e),c.insertBefore(d,c.firstChild),b.append(this.html),this.element.innerHTML=b.toString(),this.bindCollapsibleRegions()},c.prototype.enable=function(){this.isEnabled||(this.isEnabled=!0,this._toggleControls.innerHTML="Disable &raquo;",this._overlay.style.visibility="hidden",this.register(),this.animationPanel.register(),this.diagnosticsPanel.register(),this.layersPanel.register(),this.outputPanel.register(),this.parametersPanel.register(),this.viewportPanel.register(),this.bind())},c.prototype.disable=function(){this.isEnabled&&(this.isEnabled=!1,this._toggleControls.innerHTML="Enable &raquo;",this._overlay.style.visibility="visible",this.unregister(),this.animationPanel.unregister(),this.diagnosticsPanel.unregister(),this.layersPanel.unregister(),this.outputPanel.unregister(),this.parametersPanel.unregister(),this.viewportPanel.unregister())},c.prototype.load=function(){this.viewportPanel=new b.ViewportPanel(this),this.diagnosticsPanel=new b.DiagnosticsPanel(this),this.layersPanel=new b.LayersPanel(this),this.animationPanel=new b.AnimationPanel(this),this.parametersPanel=new b.ParametersPanel(this),this.outputPanel=new b.OutputPanel(this),this._overlay=document.getElementById("__wxMap_overlay"),this._toggleControls=document.getElementById("__wxMap_toggleControls"),this._version=document.getElementById("__wxMap_Version"),this._loading=document.getElementById("__wxMap_Loading")},c.prototype.initialize=function(){a.addEventListener(this._toggleControls,"click",this._wireToggleControlsClick)},c.prototype.register=function(){this.map.view.started.addListener(this,this._wireViewStarted),this.map.view.loading.addListener(this,this._wireLoading),this.map.view.loaded.addListener(this,this._wireLoaded)},c.prototype.unregister=function(){this.map.view.started.removeListener(this._wireViewStarted),this.map.view.loading.removeListener(this._wireLoading),this.map.view.loaded.removeListener(this._wireLoaded)},c.prototype.bind=function(){this.bindVersion(),this.layersPanel.bindActiveLayers(),this.layersPanel.bindInactiveLayers(),this.viewportPanel.bindPosition(),this.viewportPanel.bindBounds(),this.viewportPanel.bindScale(),this.viewportPanel.bindSize(),this.viewportPanel.bindTimeouts(),this.animationPanel.bindSettings(),this.animationPanel.bindState(),this.parametersPanel.bindParameters(),this.diagnosticsPanel.bindTraceMode()},c.prototype.bindVersion=function(){this._version.innerHTML=this.map.version},c.prototype.onToggleControlsClick=function(a){a.preventDefault(),this.isEnabled?this.disable():this.enable(),this.saveEnabledState()},c.prototype.onLoading=function(a){this._loading.style.visibility="visible"},c.prototype.onLoaded=function(a){this._loading.style.visibility="hidden"},c.prototype.onViewStarted=function(a){this.outputPanel.queueEvent("MapStarted")},c}();b.Dashboard=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._wireMoveButtonClick=function(a){b.onMoveButtonClick(a)},this._wireGraticuleCheckboxClick=function(a){b.onGraticuleCheckboxClick(a)},this._wireGridCheckboxClick=function(a){b.onGridCheckboxClick(a)},this._wireTraceModeInputClick=function(a){b.onTraceModeInputClick(a)},this._wireMouseLeftButtonDown=function(a){b.onMouseLeftButtonDown(a)},this._wireMouseLeftButtonUp=function(a){b.onMouseLeftButtonUp(a)},this._wireMouseWheel=function(a){b.onMouseWheel(a)},this._wireMouseEnter=function(a){b.onMouseEnter(a)},this._wireMouseLeave=function(a){b.onMouseLeave(a)},this._wireMouseMove=function(a){b.onMouseMove(a)},this._wireMouseClick=function(a){b.onMouseClick(a)},this._wireMouseDoubleClick=function(a){b.onMouseDoubleClick(a)},this._wireTouchStart=function(a){b.onTouchStart(a)},this._wireTouchEnd=function(a){b.onTouchEnd(a)},this._wireTouchMove=function(a){b.onTouchMove(a)},this._wireTouchTap=function(a){b.onTouchTap(a)},this._wireTouchDoubleTap=function(a){b.onTouchDoubleTap(a)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.load=function(){this._gridCheckbox=document.getElementById("__wxMap_gridCheckbox"),this._graticuleCheckbox=document.getElementById("__wxMap_graticuleCheckbox"),this._tracingModeInput=document.getElementById("__wxMap_tracingModeInput"),this._mouseGeo=document.getElementById("__wxMap_mouseGeo"),this._mouseScreen=document.getElementById("__wxMap_mouseScreen"),this._mouseTile=document.getElementById("__wxMap_mouseTile"),this._mouseQuadKey=document.getElementById("__wxMap_mouseQuadKey"),this._touchGeo=document.getElementById("__wxMap_touchGeo"),this._touchScreen=document.getElementById("__wxMap_touchScreen"),this._touchTile=document.getElementById("__wxMap_touchTile"),this._touchQuadKey=document.getElementById("__wxMap_touchQuadKey"),this._moveButton=document.getElementById("__wxMap_moveButton")},b.prototype.register=function(){a.addEventListener(this._moveButton,"click",this._wireMoveButtonClick),a.addEventListener(this._graticuleCheckbox,"click",this._wireGraticuleCheckboxClick),a.addEventListener(this._gridCheckbox,"click",this._wireGridCheckboxClick),a.addEventListener(this._tracingModeInput,"click",this._wireTraceModeInputClick),this.map.view.mouseLeftButtonDown.addListener(this,this._wireMouseLeftButtonDown),this.map.view.mouseLeftButtonUp.addListener(this,this._wireMouseLeftButtonUp),this.map.view.mouseWheel.addListener(this,this._wireMouseWheel),this.map.view.mouseEnter.addListener(this,this._wireMouseEnter),this.map.view.mouseLeave.addListener(this,this._wireMouseLeave),this.map.view.mouseMove.addListener(this,this._wireMouseMove),this.map.view.mouseClick.addListener(this,this._wireMouseClick),this.map.view.mouseDoubleClick.addListener(this,this._wireMouseDoubleClick),this.map.view.touchStart.addListener(this,this._wireTouchStart),this.map.view.touchMove.addListener(this,this._wireTouchMove),this.map.view.touchEnd.addListener(this,this._wireTouchEnd),this.map.view.touchTap.addListener(this,this._wireTouchTap),this.map.view.touchDoubleTap.addListener(this,this._wireTouchDoubleTap)},b.prototype.unregister=function(){a.removeEventListener(this._moveButton,"click",this._wireMoveButtonClick),a.removeEventListener(this._graticuleCheckbox,"click",this._wireGraticuleCheckboxClick),a.removeEventListener(this._gridCheckbox,"click",this._wireGridCheckboxClick),a.removeEventListener(this._tracingModeInput,"click",this._wireTraceModeInputClick),this.map.view.mouseLeftButtonDown.removeListener(this._wireMouseLeftButtonDown),this.map.view.mouseLeftButtonUp.removeListener(this._wireMouseLeftButtonUp),this.map.view.mouseWheel.removeListener(this._wireMouseWheel),this.map.view.mouseEnter.removeListener(this._wireMouseEnter),this.map.view.mouseLeave.removeListener(this._wireMouseLeave),this.map.view.mouseMove.removeListener(this._wireMouseMove),this.map.view.mouseClick.removeListener(this._wireMouseClick),this.map.view.mouseDoubleClick.removeListener(this._wireMouseDoubleClick),this.map.view.touchStart.removeListener(this._wireTouchStart),this.map.view.touchMove.removeListener(this._wireTouchMove),this.map.view.touchEnd.removeListener(this._wireTouchEnd)},b.prototype.bindMouse=function(){var b=this.map.mouse.geoPoint;this._mouseGeo.value=[b.longitude.getDegrees().toFixed(2)+"",b.latitude.getDegrees().toFixed(2)+""].join(", ");var c=this.map.mouse.screenPoint;this._mouseScreen.value=c.x+", "+c.y;var d=this.map.mouse.tile;this._mouseTile.value=d.x+", "+d.y;var e=Math.pow(2,this.map.view.getZoomLevel()),f=e-d.y,g=a.Gis.TmsTileSystem.tileXYToQuadkey(d.x,f-1,d.z);this._mouseQuadKey.value=g},b.prototype.bindTouch=function(){var b=this.map.touches[0],c=b.geoPoint;this._touchGeo.value=[c.longitude.getDegrees().toFixed(2)+"",c.latitude.getDegrees().toFixed(2)+""].join(", ");var d=b.screenPoint;this._touchScreen.value=d.x+", "+d.y;var e=b.tile;this._touchTile.value=e.x+", "+e.y;var f=Math.pow(2,this.map.view.getZoomLevel()),g=f-e.y,h=a.Gis.TmsTileSystem.tileXYToQuadkey(e.x,g-1,e.z);this._touchQuadKey.value=h},b.prototype.bindTraceMode=function(){if(a.Storage.isEnabled){var b=a.Storage.retrieve("traceMode");switch(null===b&&(b=1),this.map.setTraceMode(b),b){case 0:this._tracingModeInput.value="None";break;case 1:this._tracingModeInput.value="Normal";break;case 2:this._tracingModeInput.value="Verbose"}}},b.prototype.onMoveButtonClick=function(a){},b.prototype.onMouseLeftButtonDown=function(a){this.dashboard.outputPanel.queueEvent("Mouse LeftButtonDown")},b.prototype.onMouseLeftButtonUp=function(a){this.map.mouse.isOver?this.dashboard.outputPanel.queueEvent("Mouse LeftButtonUp"):(this._mouseGeo.value="",this._mouseScreen.value="",this._mouseTile.value="")},b.prototype.onMouseWheel=function(a){this.dashboard.outputPanel.queueEvent("Mouse Wheel")},b.prototype.onMouseEnter=function(a){this.dashboard.outputPanel.queueEvent("Mouse Enter")},b.prototype.onMouseLeave=function(a){this.dashboard.outputPanel.queueEvent("Mouse Leave"),this._mouseGeo.value="",this._mouseScreen.value="",this._mouseTile.value="",this._mouseQuadKey.value=""},b.prototype.onMouseMove=function(a){this.bindMouse()},b.prototype.onMouseClick=function(a){this.dashboard.outputPanel.queueEvent("Mouse Click")},b.prototype.onMouseDoubleClick=function(a){this.dashboard.outputPanel.queueEvent("Mouse DoubleClick")},b.prototype.onTouchStart=function(a){this.bindTouch(),this.dashboard.outputPanel.queueEvent("Touch Start")},b.prototype.onTouchMove=function(a){this.bindTouch(),this.dashboard.outputPanel.queueEvent("Touch Move")},b.prototype.onTouchEnd=function(a){this._touchGeo.value="",this._touchScreen.value="",this._touchTile.value="",this._touchQuadKey.value="",this.dashboard.outputPanel.queueEvent("Touch End")},b.prototype.onTouchTap=function(a){this.dashboard.outputPanel.queueEvent("Touch Tap")},b.prototype.onTouchDoubleTap=function(a){this.dashboard.outputPanel.queueEvent("Touch DoubleTap")},b.prototype.onGraticuleCheckboxClick=function(a){a.target.checked?this.map.view.enableGraticule():this.map.view.disableGraticule()},b.prototype.onGridCheckboxClick=function(a){a.target.checked?this.map.view.enableGrid():this.map.view.disableGrid()},b.prototype.onTraceModeInputClick=function(b){if(a.Storage.isEnabled)switch(this._tracingModeInput.value){case"None":this.map.setTraceMode(a.TraceMode.None),a.Storage.save("traceMode",a.TraceMode.None);break;case"Normal":this.map.setTraceMode(a.TraceMode.Normal),a.Storage.save("traceMode",a.TraceMode.Normal);break;case"Verbose":this.map.setTraceMode(a.TraceMode.Verbose),a.Storage.save("traceMode",a.TraceMode.Verbose)}},b}();b.DiagnosticsPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._wireInactiveLayersButtonClick=function(a){b.onInactiveLayersButtonClick(a)},this._wireActiveLayersButtonClick=function(a){b.onActiveLayersButtonClick(a)},this._wireActiveLayersInputClick=function(a){b.onActiveLayersInputClick(a)},this._wireOpacityLayerButtonClick=function(a){b.onOpacityLayerButtonClick(a)},this._wireStyleButtonClick=function(a){b.onStyleButtonClick(a)},this._wireDataButtonClick=function(a){b.onDataButtonClick(a)},this._wireArrangeLayerUpButtonClick=function(a){b.onArrangeLayerUpButtonClick(a)},this._wireArrangeLayerDownButtonClick=function(a){b.onArrangeLayerDownButtonClick(a)},this._wireLayerIndexInputBlur=function(a){b.onLayerIndexInputBlur(a)},this._wireDataLayerCloseClick=function(a){b.onDataLayerCloseClick(a)},this._wireStyleLayerCloseClick=function(a){b.onStyleLayerCloseClick(a)},this._wireDataLayerAddClick=function(a){b.onDataLayerAddClick(a)},this._wireDataLayerUpdateClick=function(a){b.onDataLayerUpdateClick(a)},this._wireStyleLayerUpdateClick=function(a){b.onStyleLayerUpdateClick(a)},this._wireLayerAdded=function(a,c){b.onLayerAdded(a,c)},this._wireLayerRemoved=function(a,c){b.onLayerRemoved(a,c)},this._wireLayerUpdated=function(a,c){b.onLayerUpdated(a,c)},this._wireLayerArranged=function(a,c){b.onLayerArranged(a,c)},this._wireInactiveLayersFilterButtonClick=function(a){b.onInactiveLayersFilterButtonClick(a)},this._wireInactiveLayersFilterClearButtonClick=function(a){b.onInactiveLayersFilterClearButtonClick(a)},this._wireInactiveLayersFilterInputKeyUp=function(a){b.onInactiveLayersFilterInputKeyUp(a)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.load=function(){this._inactiveLayersButton=document.getElementById("__wxMap_inactiveLayersButton"),this._inactiveLayersInput=document.getElementById("__wxMap_inactiveLayersInput"),this._inactiveLayersFilterInput=document.getElementById("__wxMap_inactiveLayersFilterInput"),this._inactiveLayersFilterButton=document.getElementById("__wxMap_inactiveLayersFilterButton"),this._inactiveLayersFilterClearButton=document.getElementById("__wxMap_inactiveLayersFilterClearButton"),this._activeLayersButton=document.getElementById("__wxMap_activeLayersButton"),this._activeLayersInput=document.getElementById("__wxMap_activeLayersInput"),this._opacityLayerInput=document.getElementById("__wxMap_opacityLayerInput"),this._arrangeLayerUpButton=document.getElementById("__wxMap_arrangeLayerUpButton"),this._layerIndexInput=document.getElementById("__wxMap_layerIndexInput"),this._arrangeLayerDownButton=document.getElementById("__wxMap_arrangeLayerDownButton"),this._styleLayerButton=document.getElementById("__wxMap_styleLayerButton"),this._dataLayerButton=document.getElementById("__wxMap_dataLayerButton"),this._styleLayerClose=document.getElementById("__wxMap_styleLayerClose"),this._styleLayerId=document.getElementById("__wxMap_styleLayerId"),this._styleLayerUpdate=document.getElementById("__wxMap_styleLayerUpdate"),this._styleLayerText=document.getElementById("__wxMap_styleLayerText"),this._dataLayerClose=document.getElementById("__wxMap_dataLayerClose"),this._dataLayerId=document.getElementById("__wxMap_dataLayerId"),this._dataLayerAdd=document.getElementById("__wxMap_dataLayerAdd"),this._dataLayerUpdate=document.getElementById("__wxMap_dataLayerUpdate"),this._dataLayerText=document.getElementById("__wxMap_dataLayerText"),this._modalStyle=document.getElementById("__wxMap_modalStyle"),this._modalData=document.getElementById("__wxMap_modalData"),this._opacityLayerButton=document.getElementById("__wxMap_opacityLayerButton")},b.prototype.register=function(){a.addEventListener(this._inactiveLayersButton,"click",this._wireInactiveLayersButtonClick),
a.addEventListener(this._activeLayersButton,"click",this._wireActiveLayersButtonClick),a.addEventListener(this._activeLayersInput,"click",this._wireActiveLayersInputClick),a.addEventListener(this._opacityLayerButton,"click",this._wireOpacityLayerButtonClick),a.addEventListener(this._styleLayerButton,"click",this._wireStyleButtonClick),a.addEventListener(this._dataLayerButton,"click",this._wireDataButtonClick),a.addEventListener(this._arrangeLayerUpButton,"click",this._wireArrangeLayerUpButtonClick),a.addEventListener(this._arrangeLayerDownButton,"click",this._wireArrangeLayerDownButtonClick),a.addEventListener(this._layerIndexInput,"blur",this._wireLayerIndexInputBlur),a.addEventListener(this._dataLayerClose,"click",this._wireDataLayerCloseClick),a.addEventListener(this._styleLayerClose,"click",this._wireStyleLayerCloseClick),a.addEventListener(this._dataLayerAdd,"click",this._wireDataLayerAddClick),a.addEventListener(this._dataLayerUpdate,"click",this._wireDataLayerUpdateClick),a.addEventListener(this._styleLayerUpdate,"click",this._wireStyleLayerUpdateClick),a.addEventListener(this._inactiveLayersFilterButton,"click",this._wireInactiveLayersFilterButtonClick),a.addEventListener(this._inactiveLayersFilterClearButton,"click",this._wireInactiveLayersFilterClearButtonClick),a.addEventListener(this._inactiveLayersFilterInput,"keyup",this._wireInactiveLayersFilterInputKeyUp),this.map.view.layerAdded.addListener(this,this._wireLayerAdded),this.map.view.layerRemoved.addListener(this,this._wireLayerRemoved),this.map.view.layerUpdated.addListener(this,this._wireLayerUpdated),this.map.view.layerArranged.addListener(this,this._wireLayerArranged)},b.prototype.unregister=function(){a.removeEventListener(this._inactiveLayersButton,"click",this._wireInactiveLayersButtonClick),a.removeEventListener(this._activeLayersButton,"click",this._wireActiveLayersButtonClick),a.removeEventListener(this._activeLayersInput,"click",this._wireActiveLayersInputClick),a.removeEventListener(this._opacityLayerButton,"click",this._wireOpacityLayerButtonClick),a.removeEventListener(this._styleLayerButton,"click",this._wireStyleButtonClick),a.removeEventListener(this._dataLayerButton,"click",this._wireDataButtonClick),a.removeEventListener(this._arrangeLayerUpButton,"click",this._wireArrangeLayerUpButtonClick),a.removeEventListener(this._arrangeLayerDownButton,"click",this._wireArrangeLayerDownButtonClick),a.removeEventListener(this._layerIndexInput,"blur",this._wireLayerIndexInputBlur),a.removeEventListener(this._dataLayerClose,"click",this._wireDataLayerCloseClick),a.removeEventListener(this._styleLayerClose,"click",this._wireStyleLayerCloseClick),a.removeEventListener(this._dataLayerAdd,"click",this._wireDataLayerAddClick),a.removeEventListener(this._dataLayerUpdate,"click",this._wireDataLayerUpdateClick),a.removeEventListener(this._styleLayerUpdate,"click",this._wireStyleLayerUpdateClick),a.removeEventListener(this._inactiveLayersFilterButton,"click",this._wireInactiveLayersFilterButtonClick),a.removeEventListener(this._inactiveLayersFilterClearButton,"click",this._wireInactiveLayersFilterClearButtonClick),a.removeEventListener(this._inactiveLayersFilterInput,"keyup",this._wireInactiveLayersFilterInputKeyUp),this.map.view.layerAdded.removeListener(this._wireLayerAdded),this.map.view.layerRemoved.removeListener(this._wireLayerRemoved),this.map.view.layerUpdated.removeListener(this._wireLayerUpdated),this.map.view.layerArranged.removeListener(this._wireLayerArranged)},b.prototype.bindInactiveLayers=function(){var a,b,c,d;this._inactiveLayersInput.innerHTML="",c=document.createElement("option"),c.value="0000",c.text="- Select a Layer -",this.addOption(c,this._inactiveLayersInput),a=[],d=this.deriveInactiveLayers();for(var e in d)b=d[e],a.push(b);a.sort(function(a,b){var c=a.id,d=b.id;return c-d}),this.renderInactiveLayers(a)},b.prototype.bindActiveLayers=function(){var a=this.map.view.getLayers(),b=this.map.view.getLayerOrder();this._activeLayersInput.options.length=0;for(var c=b.length-1;c>=0;c--){var d=b[c],e=a[d],f=document.createElement("option");f.value=e.info.id,f.text=e.info.id+" - "+e.info.label,this.addOption(f,this._activeLayersInput)}},b.prototype.deriveInactiveLayers=function(){var a={},b=this.map.view.getLayers();for(var c in this.map.settings.layers){var d=this.map.settings.layers[c];void 0==b[d.id]&&(a[c]=d)}return a},b.prototype.addOption=function(a,b){try{b.add(a,null)}catch(c){try{b.add(a)}catch(d){b.options[b.options.length]=new Option(a.innerText,a.value,!1,!1)}}},b.prototype.renderInactiveLayers=function(a,b){var c,d;b&&(this._inactiveLayersInput.innerHTML="");for(var e=0,f=a.length;f>e;e++)c=a[e],d=document.createElement("option"),d.value=c.id,d.text=c.id+" - "+c.label,this.addOption(d,this._inactiveLayersInput)},b.prototype.onOpacityLayerButtonClick=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this.map.view.findLayer(this._activeLayersInput.value);null!=b&&b.setOpacity(this._opacityLayerInput.value)}},b.prototype.onStyleButtonClick=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this.map.view.findLayer(this._activeLayersInput.value);null!=b&&"GeoLayerInfo"!=b.info.getType()?window.alert("Only GeoLayers can modify their style."):(this._modalStyle.style.visibility="visible",this._styleLayerText.value='{"_" : "Definition"}',this._styleLayerId.innerHTML=b.info.id+" - "+b.info.label)}},b.prototype.onDataButtonClick=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this.map.view.findLayer(this._activeLayersInput.value);"GeoLayerInfo"!=b.info.getType()?window.alert("Only GeoLayers can modify their data."):(this._modalData.style.visibility="visible",this._dataLayerText.value='<?xml version="1.0" encoding="utf-8" standalone="yes"?><gml:collection xmlns:gml="http://www.opengis.net/gml"></gml>',this._dataLayerId.innerHTML=b.info.id+" - "+b.info.label)}},b.prototype.onArrangeLayerUpButtonClick=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this._activeLayersInput.value,c=this.map.view.findLayer(b);this.map.view.arrangeLayerUp(b),this.bindActiveLayers();for(var d=0;d<this._activeLayersInput.options.length;d++){var e=this._activeLayersInput.options[d];e.value===b&&(e.selected=!0)}var f=c.getOpacity();this._opacityLayerInput.value=f.toFixed(1);for(var g=this.map.view.getLayerOrder(),h=0;h<g.length;h++){var i=g[h];if(i===b)break}this._layerIndexInput.value=h}},b.prototype.onArrangeLayerDownButtonClick=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this._activeLayersInput.value,c=this.map.view.findLayer(b);this.map.view.arrangeLayerDown(b),this.bindActiveLayers();for(var d=0;d<this._activeLayersInput.options.length;d++){var e=this._activeLayersInput.options[d];e.value===b&&(e.selected=!0)}var f=c.getOpacity();this._opacityLayerInput.value=f.toFixed(1);for(var g=this.map.view.getLayerOrder(),h=0;h<g.length;h++){var i=g[h];if(i===b)break}this._layerIndexInput.value=h}},b.prototype.onLayerIndexInputBlur=function(a){if(""===this._activeLayersInput.value)window.alert("No Layer Selected");else{var b=this._layerIndexInput.value,c=this._activeLayersInput.value,d=this.map.view.findLayer(c);this.map.view.arrangeLayer(c,b),this.bindActiveLayers();for(var e=0;e<this._activeLayersInput.options.length;e++){var f=this._activeLayersInput.options[e];f.value===c&&(f.selected=!0)}var g=d.getOpacity();this._opacityLayerInput.value=g.toFixed(1);for(var h=this.map.view.getLayerOrder(),i=0;i<h.length;i++){var j=h[i];if(j===c)break}this._layerIndexInput.value=i}},b.prototype.onDataLayerCloseClick=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,this._modalData.style.visibility="hidden"},b.prototype.onStyleLayerCloseClick=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,this._modalStyle.style.visibility="hidden"},b.prototype.onDataLayerAddClick=function(b){var c=this.map.view.findLayer(this._activeLayersInput.value);if(null===c||"GeoLayerInfo"!=c.info.getType())throw"InvalidOperationException: Only a GeoLayer can add geoFeatures";var d=a.Geo.Formatter.parse(this._dataLayerText.value);c.addLocalFeatures(d)},b.prototype.onDataLayerUpdateClick=function(b){var c=this.map.view.findLayer(this._activeLayersInput.value);if(null===c||"GeoLayerInfo"!=c.info.getType())throw"InvalidOperationException: Only a GeoLayer can add geoFeatures";var d=a.Geo.Formatter.parse(this._dataLayerText.value);c.updateLocalFeatures(d)},b.prototype.onStyleLayerUpdateClick=function(b){var c=this.map.view.findLayer(this._activeLayersInput.value);if(null===c)throw"InvalidOperationException: Layer cannot be found.";if("GeoLayerInfo"!=c.info.getType())throw"InvalidOperationException: Only a GeoLayer can add geoFeatures";var d=a.Style.Formatter.parse(this._styleLayerText.value,"json",this.map.view.getProjection());c.setStyle(d)},b.prototype.onLayerUpdated=function(a,b){this.dashboard.outputPanel.queueEvent("LayerUpdated:"+b.id)},b.prototype.onLayerArranged=function(a,b){this.dashboard.outputPanel.queueEvent("LayerArranged:"+b.id),this.bindActiveLayers()},b.prototype.onInactiveLayersButtonClick=function(a){this.map.view.addLayer(this._inactiveLayersInput.value)},b.prototype.onActiveLayersInputClick=function(a){if(""!==this._activeLayersInput.value){for(var b=this._activeLayersInput.value,c=0;c<this._activeLayersInput.options.length;c++){var d=this._activeLayersInput.options[c];d.value!=b&&(d.selected=!1)}var e=this.map.view.findLayer(b),f=e.getOpacity();this._opacityLayerInput.value=f.toFixed(2);for(var g=this.map.view.getLayerOrder(),h=0;h<g.length;h++){var i=g[h];if(i===b)break}this._layerIndexInput.value=h}},b.prototype.onActiveLayersButtonClick=function(a){""===this._activeLayersInput.value?window.alert("No Layer Selected"):this.map.view.removeLayer(this._activeLayersInput.value)},b.prototype.onLayerAdded=function(a,b){this.dashboard.outputPanel.queueEvent("LayerAdded"),this.bindInactiveLayers(),this.bindActiveLayers()},b.prototype.onLayerRemoved=function(a,b){this.dashboard.outputPanel.queueEvent("LayerRemoved"),this.bindInactiveLayers(),this.bindActiveLayers()},b.prototype.onInactiveLayersFilterButtonClick=function(a){var b,c,d,e,f;if(b=[],d=this._inactiveLayersFilterInput.value,!d)return!1;c=new RegExp(d,"gi"),e=this.map.settings.layers;for(var g in e)f=e[g],(c.test(f.label)||c.test(f.id))&&b.push(f);this.renderInactiveLayers(b,!0)},b.prototype.onInactiveLayersFilterClearButtonClick=function(a){this._inactiveLayersFilterInput.value="",this.bindInactiveLayers()},b.prototype.onInactiveLayersFilterInputKeyUp=function(a){return a.keyCode&&13===a.keyCode?void this.onInactiveLayersFilterButtonClick(a):!1},b}();b.LayersPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._events=new Array,this._messages=new Array,this._wireAbsoluteTimeout=function(a){b.onAbsoluteTimeout(a)},this._wireSlidingTimeout=function(a){b.onSlidingTimeout(a)},this._wireLogged=function(a,c){b.onLogged(a,c)},this._wireWarned=function(a,c){b.onWarned(a,c)},this._wireErrored=function(a,c){b.onErrored(a,c)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.load=function(){this._eventsList=document.getElementById("__wxMap_eventsList"),this._traceList=document.getElementById("__wxMap_traceList")},b.prototype.register=function(){this.map.view.absoluteTimeout.addListener(this,this._wireAbsoluteTimeout),this.map.view.slidingTimeout.addListener(this,this._wireSlidingTimeout),a.Console.logged.addListener(this,this._wireLogged),a.Console.warned.addListener(this,this._wireWarned),a.Console.errored.addListener(this,this._wireErrored)},b.prototype.unregister=function(){this.map.view.absoluteTimeout.removeListener(this._wireAbsoluteTimeout),this.map.view.slidingTimeout.removeListener(this._wireSlidingTimeout),a.Console.logged.removeListener(this._wireLogged),a.Console.warned.removeListener(this._wireWarned),a.Console.errored.removeListener(this._wireErrored)},b.prototype.queueEvent=function(b){this._events.length>4&&this._events.pop();var c={message:b.toString(),timeStamp:a.DateTime.utcFromNow()};this._events.unshift(c);var d=new a.StringBuilder;d.append("<ul class='Message-List'>");for(var e=0;e<this._events.length;e++){var f=this._events[e];d.append("<li "),0===e?d.append("style='color:#000;'"):1===e?d.append("style='color:#333;'"):2===e?d.append("style='color:#666;'"):3===e?d.append("style='color:#999;'"):4===e&&d.append("style='color:#CCC;'"),d.append(">"),d.append(new a.DateTime(f.timeStamp).toShortTimeString()),d.append(" - "+f.message),d.append("</li>")}d.append("</ul>"),this._eventsList.innerHTML=d.toString()},b.prototype.bindMessages=function(b){this._messages.length>4&&this._messages.pop();var c={message:b.message.replace("<","&lt;").replace(">","&gt;"),timeStamp:a.DateTime.utcFromNow()};this._messages.unshift(c);var d=new a.StringBuilder;d.append("<ul class='Message-List'>");for(var e=0;e<this._messages.length;e++){var f=this._messages[e];d.append("<li "),f.message.error?d.append("style='color:#990000;'"):0===e?d.append("style='color:#000;'"):1===e?d.append("style='color:#333;'"):2===e?d.append("style='color:#666;'"):3===e?d.append("style='color:#999;'"):4===e&&d.append("style='color:#CCC;'"),d.append(">"),d.append(new a.DateTime(f.timeStamp).toShortTimeString()),d.append(" - "+f.message),d.append("</li>")}d.append("</ul>"),this._traceList.innerHTML=d.toString()},b.prototype.onAbsoluteTimeout=function(a){this.queueEvent("AbsoluteTimeout")},b.prototype.onSlidingTimeout=function(a){this.queueEvent("SlidingTimeout")},b.prototype.onLogged=function(a,b){this.bindMessages(b)},b.prototype.onWarned=function(a,b){this.bindMessages(b)},b.prototype.onErrored=function(a,b){this.bindMessages(b)},b}();b.OutputPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._wireUnload=function(a){b.onUnload(a)},this._wireParamRefreshClick=function(a){b.onParamRefreshClick(a)},this._wireParamClearClick=function(a){b.onParamClearClick(a)},this._wireParamAlternateHtmlClick=function(a){b.onParamAlternateHtmlClick(a)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.load=function(){this._initZoom=document.getElementById("__wxMap_initZoom"),this._initLongitude=document.getElementById("__wxMap_initLongitude"),this._initLatitude=document.getElementById("__wxMap_initLatitude"),this._initBasemap=document.getElementById("__wxMap_initBasemap"),this._initLayers=document.getElementById("__wxMap_initLayers"),this._initOpacity=document.getElementById("__wxMap_initOpacity"),this._persistZoom=document.getElementById("__wxMap_persistZoom"),this._persistBasemap=document.getElementById("__wxMap_persistBasemap"),this._persistLocation=document.getElementById("__wxMap_persistLocation"),this._persistLayers=document.getElementById("__wxMap_persistLayers"),this._persistAnimator=document.getElementById("__wxMap_persistAnimator"),this._persistOpacity=document.getElementById("__wxMap_persistOpacity"),this._paramScriptId=document.getElementById("__wxMap_paramScriptId"),this._paramCallback=document.getElementById("__wxMap_paramCallback"),this._paramAlternateHtml=document.getElementById("__wxMap_paramAlternateHtml"),this._paramArguments=document.getElementById("__wxMap_paramArguments"),this._paramRefresh=document.getElementById("__wxMap_paramRefresh"),this._paramClear=document.getElementById("__wxMap_paramClear")},b.prototype.register=function(){a.addEventListener(window,"beforeunload",this._wireUnload),a.addEventListener(this._paramRefresh,"click",this._wireParamRefreshClick),a.addEventListener(this._paramClear,"click",this._wireParamClearClick),a.addEventListener(this._paramAlternateHtml,"click",this._wireParamAlternateHtmlClick)},b.prototype.unregister=function(){a.removeEventListener(window,"beforeunload",this._wireUnload),a.removeEventListener(this._paramRefresh,"click",this._wireParamRefreshClick),a.removeEventListener(this._paramClear,"click",this._wireParamClearClick),a.removeEventListener(this._paramAlternateHtml,"click",this._wireParamAlternateHtmlClick)},b.prototype.bindParameters=function(){var a=this.map.getInitParams();if(this._initZoom.value=a.zoomLevel||"",this._initOpacity.value=a.opacity||"",this._initLongitude.value=a.longitude||"",this._initLatitude.value=a.latitude||"",this._initBasemap.value=a.basemap||"",this._initLayers.value=a.layers||"",this._persistLocation.checked="true"===a.persistLocation||!1,this._persistAnimator.checked="true"===a.persistAnimation||!1,this._persistLayers.checked="true"===a.persistLayers||!1,this._persistBasemap.checked="true"===a.persistBasemap||!1,this._persistZoom.checked="true"===a.persistZoomLevel||!1,this._persistOpacity.checked="true"===a.persistOpacity||!1,this.dashboard.args){this._paramScriptId.value=this.dashboard.args.scriptId||"",this._paramCallback.value=this.dashboard.args.callback||"";var b={};for(var c in this.dashboard.args)"scriptId"!==c&&"callback"!==c&&"alternateHtml"!==c&&(b[c]=this.dashboard.args[c]);var d=JSON.stringify(b);d=d.replace(/\,/g,"\n").replace(/\}/g,"").replace(/\{/g,"").replace(/\"\:/g,"=").replace(/\"/g,""),this._paramArguments.value=d}},b.prototype.onParamRefreshClick=function(a){window.location.reload()},b.prototype.onParamClearClick=function(a){this.dashboard.persistSession=!1,window.location.reload()},b.prototype.onParamAlternateHtmlClick=function(a){},b.prototype.onUnload=function(b){if(this.dashboard.persistSession){var c={};c.persistLocation=this._persistLocation.checked.toString(),c.persistAnimation=this._persistAnimator.checked.toString(),c.persistLayers=this._persistLayers.checked.toString(),c.persistOpacity=this._persistOpacity.checked.toString(),c.persistZoomLevel=this._persistZoom.checked.toString(),c.persistBasemap=this._persistBasemap.checked.toString(),c.zoomLevel=this._initZoom.value,c.longitude=this._initLongitude.value,c.latitude=this._initLatitude.value,c.layers=this._initLayers.value,c.basemap=this._initBasemap.value,c.opacity=this._initOpacity.value;var b={};b.scriptId=this._paramScriptId.value,b.callback=this._paramCallback.value,b.alternateHtml="";for(var d=this._paramArguments.value.split("\n"),e=0;e<d.length;e++){var f=d[e].split("=");b[f[0]]=f[1]}a.Storage.save("__initParams",c),a.Storage.save("__args",b)}else a.Storage.remove("__args"),a.Storage.remove("__initParams")},b}();b.ParametersPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._isPanningNorth=!1,this._isPanningNorthEast=!1,this._isPanningEast=!1,this._isPanningSouthEast=!1,this._isPanningSouth=!1,this._isPanningSouthWest=!1,this._isPanningWest=!1,this._isPanningNorthWest=!1,this._isMouseDown=!1,this._panNorthButtonTimer=null,this._panNorthEastButtonTimer=null,this._panEastButtonTimer=null,this._panSouthEastButtonTimer=null,this._panSouthButtonTimer=null,this._panSouthWestButtonTimer=null,this._panWestButtonTimer=null,this._panNorthWestButtonTimer=null,this._wirePanNorthButtonMouseDown=function(a){b.onPanNorthButtonMouseDown(a)},this._wirePanNorthButtonMouseUp=function(a){b.onPanNorthButtonMouseUp(a)},this._wirePanNorthEastButtonMouseDown=function(a){b.onPanNorthEastButtonMouseDown(a)},this._wirePanNorthEastButtonMouseUp=function(a){b.onPanNorthEastButtonMouseUp(a)},this._wirePanEastButtonMouseDown=function(a){b.onPanEastButtonMouseDown(a)},this._wirePanEastButtonMouseUp=function(a){b.onPanEastButtonMouseUp(a)},this._wirePanSouthEastButtonMouseDown=function(a){b.onPanSouthEastButtonMouseDown(a)},this._wirePanSouthEastButtonMouseUp=function(a){b.onPanSouthEastButtonMouseUp(a)},this._wirePanSouthButtonMouseDown=function(a){b.onPanSouthButtonMouseDown(a)},this._wirePanSouthButtonMouseUp=function(a){b.onPanSouthButtonMouseUp(a)},this._wirePanSouthWestButtonMouseDown=function(a){b.onPanSouthWestButtonMouseDown(a)},this._wirePanSouthWestButtonMouseUp=function(a){b.onPanSouthWestButtonMouseUp(a)},this._wirePanWestButtonMouseDown=function(a){b.onPanWestButtonMouseDown(a)},this._wirePanWestButtonMouseUp=function(a){b.onPanWestButtonMouseUp(a)},this._wirePanNorthWestButtonMouseDown=function(a){b.onPanNorthWestButtonMouseDown(a)},this._wirePanNorthWestButtonMouseUp=function(a){b.onPanNorthWestButtonMouseUp(a)},this._wirePanNorthButtonMouseOver=function(a){b.onPanNorthButtonMouseOver(a)},this._wirePanNorthButtonMouseOut=function(a){b.onPanNorthButtonMouseOut(a)},this._wirePanNorthEastButtonMouseOver=function(a){b.onPanNorthEastButtonMouseOver(a)},this._wirePanNorthEastButtonMouseOut=function(a){b.onPanNorthEastButtonMouseOut(a)},this._wirePanEastButtonMouseOver=function(a){b.onPanEastButtonMouseOver(a)},this._wirePanEastButtonMouseOut=function(a){b.onPanEastButtonMouseOut(a)},this._wirePanSouthEastButtonMouseOver=function(a){b.onPanSouthEastButtonMouseOver(a)},this._wirePanSouthEastButtonMouseOut=function(a){b.onPanSouthEastButtonMouseOut(a)},this._wirePanSouthButtonMouseOver=function(a){b.onPanSouthButtonMouseOver(a)},this._wirePanSouthButtonMouseOut=function(a){b.onPanSouthButtonMouseOut(a)},this._wirePanSouthWestButtonMouseOver=function(a){b.onPanSouthWestButtonMouseOver(a)},this._wirePanSouthWestButtonMouseOut=function(a){b.onPanSouthWestButtonMouseOut(a)},this._wirePanWestButtonMouseOver=function(a){b.onPanWestButtonMouseOver(a)},this._wirePanWestButtonMouseOut=function(a){b.onPanWestButtonMouseOut(a)},this._wirePanNorthWestButtonMouseOver=function(a){b.onPanNorthWestButtonMouseOver(a)},this._wirePanNorthWestButtonMouseOut=function(a){b.onPanNorthWestButtonMouseOut(a)},this._wireOpacityInputBlur=function(a){b.onOpacityInputBlur(a)},this._wireDecreaseOpacityButtonClick=function(a){b.onDecreaseOpacityButtonClick(a)},this._wireIncreaseOpacityButtonClick=function(a){b.onIncreaseOpacityButtonClick(a)},this._wireZoomInButtonClick=function(a){b.onZoomInButtonClick(a)},this._wireZoomOutButtonClick=function(a){b.onZoomOutButtonClick(a)},this._wireScaleInButtonClick=function(a){b.onScaleInButtonClick(a)},this._wireScaleOutButtonClick=function(a){b.onScaleOutButtonClick(a)},this._wireViewportLatLonButtonClick=function(a){b.onViewportLatLonButtonClick(a)},this._wireViewportWidthHeightButtonClick=function(a){b.onViewportWidthHeightButtonClick(a)},this._wireWindowMouseUp=function(a){b.onWindowMouseUp(a)},this._wireSelectStart=function(){b.onSelectStart()},this._wireMoved=function(a){b.onMoved(a)},this._wireSizeChanged=function(a){b.onSizeChanged(a)},this._wireZoomed=function(a){b.onZoomed(a)},this._wireStopped=function(a){b.onStopped(a)},this._wireStarted=function(a){b.onStarted(a)},this.dashboard=a,this.map=a.map,this.load(),this.register()}return b.prototype.startPanningNorth=function(){var a=this;this._isPanningNorth?this._panNorthButtonTimer=setTimeout(function(){a.panNorth()},10):this.stopPanningNorth()},b.prototype.panNorth=function(){this.stopPanningNorth(),this.map.view.pan(0,this._panInterval.value),this.startPanningNorth()},b.prototype.stopPanningNorth=function(){clearInterval(this._panNorthButtonTimer)},b.prototype.startPanningNorthEast=function(){var a=this;this._isPanningNorthEast?this._panNorthEastButtonTimer=setTimeout(function(){a.panNorthEast()},10):this.stopPanningNorthEast()},b.prototype.panNorthEast=function(){this.stopPanningNorthEast(),this.map.view.pan(-this._panInterval.value,this._panInterval.value),this.startPanningNorthEast()},b.prototype.stopPanningNorthEast=function(){clearInterval(this._panNorthEastButtonTimer)},b.prototype.startPanningEast=function(){var a=this;this._isPanningEast?this._panEastButtonTimer=setTimeout(function(){a.panEast()},10):this.stopPanningEast()},b.prototype.panEast=function(){this.stopPanningEast(),this.map.view.pan(-this._panInterval.value,0),this.startPanningEast()},b.prototype.stopPanningEast=function(){clearInterval(this._panEastButtonTimer)},b.prototype.startPanningSouthEast=function(){var a=this;this._isPanningSouthEast?this._panSouthEastButtonTimer=setTimeout(function(){a.panSouthEast()},10):this.stopPanningSouthEast()},b.prototype.panSouthEast=function(){this.stopPanningSouthEast(),this.map.view.pan(-this._panInterval.value,-this._panInterval.value),this.startPanningSouthEast()},b.prototype.stopPanningSouthEast=function(){clearInterval(this._panSouthEastButtonTimer)},b.prototype.startPanningSouth=function(){var a=this;this._isPanningSouth?this._panSouthButtonTimer=setTimeout(function(){a.panSouth()},10):this.stopPanningSouth()},b.prototype.panSouth=function(){this.stopPanningSouth(),this.map.view.pan(0,-this._panInterval.value),this.startPanningSouth()},b.prototype.stopPanningSouth=function(){clearInterval(this._panSouthButtonTimer)},b.prototype.startPanningSouthWest=function(){var a=this;this._isPanningSouthWest?this._panSouthWestButtonTimer=setTimeout(function(){a.panSouthWest()},10):this.stopPanningSouthWest()},b.prototype.panSouthWest=function(){this.stopPanningSouthWest(),this.map.view.pan(this._panInterval.value,-this._panInterval.value),this.startPanningSouthWest()},b.prototype.stopPanningSouthWest=function(){clearInterval(this._panSouthWestButtonTimer)},b.prototype.startPanningWest=function(){var a=this;this._isPanningWest?this._panWestButtonTimer=setTimeout(function(){a.panWest()},10):this.stopPanningWest()},b.prototype.panWest=function(){this.stopPanningWest(),this.map.view.pan(this._panInterval.value,0),this.startPanningWest()},b.prototype.stopPanningWest=function(){clearInterval(this._panWestButtonTimer)},b.prototype.startPanningNorthWest=function(){var a=this;this._isPanningNorthWest?this._panNorthWestButtonTimer=setTimeout(function(){a.panNorthWest()},10):this.stopPanningNorthWest()},b.prototype.panNorthWest=function(){this.stopPanningNorthWest(),this.map.view.pan(this._panInterval.value,this._panInterval.value),this.startPanningNorthWest()},b.prototype.stopPanningNorthWest=function(){clearInterval(this._panNorthWestButtonTimer)},b.prototype.load=function(){this._panNorthButton=document.getElementById("__wxMap_panNorthButton"),this._panNorthEastButton=document.getElementById("__wxMap_panNorthEastButton"),this._panEastButton=document.getElementById("__wxMap_panEastButton"),this._panSouthEastButton=document.getElementById("__wxMap_panSouthEastButton"),this._panSouthButton=document.getElementById("__wxMap_panSouthButton"),this._panSouthWestButton=document.getElementById("__wxMap_panSouthWestButton"),this._panWestButton=document.getElementById("__wxMap_panWestButton"),this._panNorthWestButton=document.getElementById("__wxMap_panNorthWestButton"),this._viewportNorth=document.getElementById("__wxMap_viewportNorth"),this._viewportEast=document.getElementById("__wxMap_viewportEast"),this._viewportSouth=document.getElementById("__wxMap_viewportSouth"),this._viewportWest=document.getElementById("__wxMap_viewportWest"),this._panInterval=document.getElementById("__wxMap_panInterval"),this._zoomInButton=document.getElementById("__wxMap_zoomInButton"),this._zoomOutButton=document.getElementById("__wxMap_zoomOutButton"),this._scaleInButton=document.getElementById("__wxMap_scaleInButton"),this._scaleOutButton=document.getElementById("__wxMap_scaleOutButton"),this._opacityInput=document.getElementById("__wxMap_opacityInput"),this._decreaseOpacityButton=document.getElementById("__wxMap_decreaseOpacityButton"),this._increaseOpacityButton=document.getElementById("__wxMap_increaseOpacityButton"),this._viewportZoom=document.getElementById("__wxMap_viewportZoom"),this._viewportScale=document.getElementById("__wxMap_viewportScale"),this._viewportLongitude=document.getElementById("__wxMap_viewportLongitude"),this._viewportLatitude=document.getElementById("__wxMap_viewportLatitude"),this._viewportLatLonButton=document.getElementById("__wxMap_viewportLatLonButton"),this._sliding=document.getElementById("__wxMap_sliding"),this._viewportX=document.getElementById("__wxMap_viewportX"),this._viewportY=document.getElementById("__wxMap_viewportY"),this._absolute=document.getElementById("__wxMap_absolute"),this._viewportWidth=document.getElementById("__wxMap_viewportWidth"),this._viewportHeight=document.getElementById("__wxMap_viewportHeight"),this._viewportWidthHeightButton=document.getElementById("__wxMap_viewportWidthHeightButton"),this._maxZoom=document.getElementById("__wxMap_maxZoom"),this._minZoom=document.getElementById("__wxMap_minZoom")},b.prototype.register=function(){a.addEventListener(this._panNorthButton,"mousedown",this._wirePanNorthButtonMouseDown),a.addEventListener(this._panNorthButton,"mouseup",this._wirePanNorthButtonMouseUp),a.addEventListener(this._panNorthEastButton,"mousedown",this._wirePanNorthEastButtonMouseDown),a.addEventListener(this._panNorthEastButton,"mouseup",this._wirePanNorthEastButtonMouseUp),a.addEventListener(this._panEastButton,"mousedown",this._wirePanEastButtonMouseDown),a.addEventListener(this._panEastButton,"mouseup",this._wirePanEastButtonMouseUp),a.addEventListener(this._panSouthEastButton,"mousedown",this._wirePanSouthEastButtonMouseDown),a.addEventListener(this._panSouthEastButton,"mouseup",this._wirePanSouthEastButtonMouseUp),a.addEventListener(this._panSouthButton,"mousedown",this._wirePanSouthButtonMouseDown),a.addEventListener(this._panSouthButton,"mouseup",this._wirePanSouthButtonMouseUp),a.addEventListener(this._panSouthWestButton,"mousedown",this._wirePanSouthWestButtonMouseDown),a.addEventListener(this._panSouthWestButton,"mouseup",this._wirePanSouthWestButtonMouseUp),a.addEventListener(this._panWestButton,"mousedown",this._wirePanWestButtonMouseDown),a.addEventListener(this._panWestButton,"mouseup",this._wirePanWestButtonMouseUp),a.addEventListener(this._panNorthWestButton,"mousedown",this._wirePanNorthWestButtonMouseDown),a.addEventListener(this._panNorthWestButton,"mouseup",this._wirePanNorthWestButtonMouseUp),a.addEventListener(this._panNorthButton,"mouseover",this._wirePanNorthButtonMouseOver),a.addEventListener(this._panNorthButton,"mouseout",this._wirePanNorthButtonMouseOut),a.addEventListener(this._panNorthEastButton,"mouseover",this._wirePanNorthEastButtonMouseOver),a.addEventListener(this._panNorthEastButton,"mouseout",this._wirePanNorthEastButtonMouseOut),a.addEventListener(this._panEastButton,"mouseover",this._wirePanEastButtonMouseOver),a.addEventListener(this._panEastButton,"mouseout",this._wirePanEastButtonMouseOut),a.addEventListener(this._panSouthEastButton,"mouseover",this._wirePanSouthEastButtonMouseOver),a.addEventListener(this._panSouthEastButton,"mouseout",this._wirePanSouthEastButtonMouseOut),a.addEventListener(this._panSouthButton,"mouseover",this._wirePanSouthButtonMouseOver),a.addEventListener(this._panSouthButton,"mouseout",this._wirePanSouthButtonMouseOut),a.addEventListener(this._panSouthWestButton,"mouseover",this._wirePanSouthWestButtonMouseOver),a.addEventListener(this._panSouthWestButton,"mouseout",this._wirePanSouthWestButtonMouseOut),a.addEventListener(this._panWestButton,"mouseover",this._wirePanWestButtonMouseOver),a.addEventListener(this._panWestButton,"mouseout",this._wirePanWestButtonMouseOut),a.addEventListener(this._panNorthWestButton,"mouseover",this._wirePanNorthWestButtonMouseOver),a.addEventListener(this._panNorthWestButton,"mouseout",this._wirePanNorthWestButtonMouseOut),a.addEventListener(this._opacityInput,"blur",this._wireOpacityInputBlur),a.addEventListener(this._decreaseOpacityButton,"click",this._wireDecreaseOpacityButtonClick),a.addEventListener(this._increaseOpacityButton,"click",this._wireIncreaseOpacityButtonClick),a.addEventListener(this._zoomInButton,"click",this._wireZoomInButtonClick),a.addEventListener(this._zoomOutButton,"click",this._wireZoomOutButtonClick),a.addEventListener(this._scaleInButton,"click",this._wireScaleInButtonClick),a.addEventListener(this._scaleOutButton,"click",this._wireScaleOutButtonClick),a.addEventListener(this._viewportLatLonButton,"click",this._wireViewportLatLonButtonClick),
a.addEventListener(this._viewportWidthHeightButton,"click",this._wireViewportWidthHeightButtonClick),a.addEventListener(window,"mouseup",this._wireWindowMouseUp),this._panNorthButton.onselectstart=this._wireSelectStart,this._panNorthEastButton.onselectstart=this._wireSelectStart,this._panEastButton.onselectstart=this._wireSelectStart,this._panSouthEastButton.onselectstart=this._wireSelectStart,this._panSouthButton.onselectstart=this._wireSelectStart,this._panSouthWestButton.onselectstart=this._wireSelectStart,this._panWestButton.onselectstart=this._wireSelectStart,this._panNorthWestButton.onselectstart=this._wireSelectStart,this.map.view.moved.addListener(this,this._wireMoved),this.map.view.sizeChanged.addListener(this,this._wireSizeChanged),this.map.view.zoomed.addListener(this,this._wireZoomed),this.map.view.started.addListener(this,this._wireStarted),this.map.view.stopped.addListener(this,this._wireStopped)},b.prototype.unregister=function(){a.removeEventListener(this._panNorthButton,"mousedown",this._wirePanNorthButtonMouseDown),a.removeEventListener(this._panNorthButton,"mouseup",this._wirePanNorthButtonMouseUp),a.removeEventListener(this._panNorthEastButton,"mousedown",this._wirePanNorthEastButtonMouseDown),a.removeEventListener(this._panNorthEastButton,"mouseup",this._wirePanNorthEastButtonMouseUp),a.removeEventListener(this._panEastButton,"mousedown",this._wirePanEastButtonMouseDown),a.removeEventListener(this._panEastButton,"mouseup",this._wirePanEastButtonMouseUp),a.removeEventListener(this._panSouthEastButton,"mousedown",this._wirePanSouthEastButtonMouseDown),a.removeEventListener(this._panSouthEastButton,"mouseup",this._wirePanSouthEastButtonMouseUp),a.removeEventListener(this._panSouthButton,"mousedown",this._wirePanSouthButtonMouseDown),a.removeEventListener(this._panSouthButton,"mouseup",this._wirePanSouthButtonMouseUp),a.removeEventListener(this._panSouthWestButton,"mousedown",this._wirePanSouthWestButtonMouseDown),a.removeEventListener(this._panSouthWestButton,"mouseup",this._wirePanSouthWestButtonMouseUp),a.removeEventListener(this._panWestButton,"mousedown",this._wirePanWestButtonMouseDown),a.removeEventListener(this._panWestButton,"mouseup",this._wirePanWestButtonMouseUp),a.removeEventListener(this._panNorthWestButton,"mousedown",this._wirePanNorthWestButtonMouseDown),a.removeEventListener(this._panNorthWestButton,"mouseup",this._wirePanNorthWestButtonMouseUp),a.removeEventListener(this._panNorthButton,"mouseover",this._wirePanNorthButtonMouseOver),a.removeEventListener(this._panNorthButton,"mouseout",this._wirePanNorthButtonMouseOut),a.removeEventListener(this._panNorthEastButton,"mouseover",this._wirePanNorthEastButtonMouseOver),a.removeEventListener(this._panNorthEastButton,"mouseout",this._wirePanNorthEastButtonMouseOut),a.removeEventListener(this._panEastButton,"mouseover",this._wirePanEastButtonMouseOver),a.removeEventListener(this._panEastButton,"mouseout",this._wirePanEastButtonMouseOut),a.removeEventListener(this._panSouthEastButton,"mouseover",this._wirePanSouthEastButtonMouseOver),a.removeEventListener(this._panSouthEastButton,"mouseout",this._wirePanSouthEastButtonMouseOut),a.removeEventListener(this._panSouthButton,"mouseover",this._wirePanSouthButtonMouseOver),a.removeEventListener(this._panSouthButton,"mouseout",this._wirePanSouthButtonMouseOut),a.removeEventListener(this._panSouthWestButton,"mouseover",this._wirePanSouthWestButtonMouseOver),a.removeEventListener(this._panSouthWestButton,"mouseout",this._wirePanSouthWestButtonMouseOut),a.removeEventListener(this._panWestButton,"mouseover",this._wirePanWestButtonMouseOver),a.removeEventListener(this._panWestButton,"mouseout",this._wirePanWestButtonMouseOut),a.removeEventListener(this._panNorthWestButton,"mouseover",this._wirePanNorthWestButtonMouseOver),a.removeEventListener(this._panNorthWestButton,"mouseout",this._wirePanNorthWestButtonMouseOut),a.removeEventListener(this._opacityInput,"blur",this._wireOpacityInputBlur),a.removeEventListener(this._decreaseOpacityButton,"click",this._wireDecreaseOpacityButtonClick),a.removeEventListener(this._increaseOpacityButton,"click",this._wireIncreaseOpacityButtonClick),a.removeEventListener(this._zoomInButton,"click",this._wireZoomInButtonClick),a.removeEventListener(this._zoomOutButton,"click",this._wireZoomOutButtonClick),a.removeEventListener(this._scaleInButton,"click",this._wireScaleInButtonClick),a.removeEventListener(this._scaleOutButton,"click",this._wireScaleOutButtonClick),a.removeEventListener(this._viewportLatLonButton,"click",this._wireViewportLatLonButtonClick),a.removeEventListener(this._viewportWidthHeightButton,"click",this._wireViewportWidthHeightButtonClick),a.removeEventListener(window,"mouseup",this._wireWindowMouseUp),this._panNorthButton.onselectstart=null,this._panNorthEastButton.onselectstart=null,this._panEastButton.onselectstart=null,this._panSouthEastButton.onselectstart=null,this._panSouthButton.onselectstart=null,this._panSouthWestButton.onselectstart=null,this._panWestButton.onselectstart=null,this._panNorthWestButton.onselectstart=null,this.map.view.moved.removeListener(this._wireMoved),this.map.view.sizeChanged.removeListener(this._wireSizeChanged),this.map.view.zoomed.removeListener(this._wireZoomed)},b.prototype.bindPosition=function(){var a=this.map.view.getGeoCenter();this._viewportLongitude.value=a.longitude.getDegrees().toFixed(2)+"&deg;",this._viewportLatitude.value=a.latitude.getDegrees().toFixed(2)+"&deg;";var b=this.map.view.getScreenCenter();this._viewportX.value=b.x,this._viewportY.value=b.y},b.prototype.bindBounds=function(){var a=this.map.view.getGeoBoundingBox();this._viewportNorth.value=a.north.getDegrees().toFixed(2)+"N",this._viewportEast.value=a.east.getDegrees().toFixed(2)+"E",this._viewportSouth.value=a.south.getDegrees().toFixed(2)+"S",this._viewportWest.value=a.west.getDegrees().toFixed(2)+"W"},b.prototype.bindSize=function(){var a=this.map.view.getSize();this._viewportWidth.value=a.width+"w",this._viewportHeight.value=a.height+"h"},b.prototype.bindScale=function(){this._viewportZoom.value=this.map.view.getZoomLevel().toFixed(0),this._viewportScale.value=this.map.view.getScale().toFixed(2),this._maxZoom.value=this.map.view.getMaximumZoomLevel(),this._minZoom.value=this.map.view.getMinimumZoomLevel()},b.prototype.bindTimeouts=function(){this._sliding.value=this.map.view.getSlidingTimeout(),this._absolute.value=this.map.view.getAbsoluteTimeout()},b.prototype.onWindowMouseUp=function(a){this._isMouseDown=!1},b.prototype.onSelectStart=function(){return!1},b.prototype.onPanNorthButtonMouseDown=function(a){this._isPanningNorth=!0,this._isMouseDown=!0,this.startPanningNorth()},b.prototype.onPanNorthButtonMouseUp=function(a){this._isPanningNorth=!1,this._isMouseDown=!1,this.stopPanningNorth()},b.prototype.onPanNorthEastButtonMouseDown=function(a){this._isPanningNorthEast=!0,this._isMouseDown=!0,this.startPanningNorthEast()},b.prototype.onPanNorthEastButtonMouseUp=function(a){this._isPanningNorthEast=!1,this._isMouseDown=!1,this.stopPanningNorthEast()},b.prototype.onPanEastButtonMouseDown=function(a){this._isPanningEast=!0,this._isMouseDown=!0,this.startPanningEast()},b.prototype.onPanEastButtonMouseUp=function(a){this._isPanningEast=!1,this._isMouseDown=!1,this.stopPanningEast()},b.prototype.onPanSouthEastButtonMouseDown=function(a){this._isPanningSouthEast=!0,this._isMouseDown=!0,this.startPanningSouthEast()},b.prototype.onPanSouthEastButtonMouseUp=function(a){this._isPanningSouthEast=!1,this._isMouseDown=!1,this.stopPanningSouthEast()},b.prototype.onPanSouthButtonMouseDown=function(a){this._isPanningSouth=!0,this._isMouseDown=!0,this.startPanningSouth()},b.prototype.onPanSouthButtonMouseUp=function(a){this._isPanningSouth=!1,this._isMouseDown=!1,this.stopPanningSouth()},b.prototype.onPanSouthWestButtonMouseDown=function(a){this._isPanningSouthWest=!0,this._isMouseDown=!0,this.startPanningSouthWest()},b.prototype.onPanSouthWestButtonMouseUp=function(a){this._isPanningSouthWest=!1,this._isMouseDown=!1,this.stopPanningSouthWest()},b.prototype.onPanWestButtonMouseDown=function(a){this._isPanningWest=!0,this._isMouseDown=!0,this.startPanningWest()},b.prototype.onPanWestButtonMouseUp=function(a){this._isPanningWest=!1,this._isMouseDown=!1,this.stopPanningWest()},b.prototype.onPanNorthWestButtonMouseDown=function(a){this._isPanningNorthWest=!0,this._isMouseDown=!0,this.startPanningNorthWest()},b.prototype.onPanNorthWestButtonMouseUp=function(a){this._isPanningNorthWest=!1,this._isMouseDown=!1,this.stopPanningNorthWest()},b.prototype.onPanNorthButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningNorth=!0,this.startPanningNorth())},b.prototype.onPanNorthButtonMouseOut=function(a){this._isPanningNorth=!1,this.stopPanningNorth()},b.prototype.onPanNorthEastButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningNorthEast=!0,this.startPanningNorthEast())},b.prototype.onPanNorthEastButtonMouseOut=function(a){this._isPanningNorthEast=!1,this.stopPanningNorthEast()},b.prototype.onPanEastButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningEast=!0,this.startPanningEast())},b.prototype.onPanEastButtonMouseOut=function(a){this._isPanningEast=!1,this.stopPanningEast()},b.prototype.onPanSouthEastButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningSouthEast=!0,this.startPanningSouthEast())},b.prototype.onPanSouthEastButtonMouseOut=function(a){this._isPanningSouthEast=!1,this.stopPanningSouthEast()},b.prototype.onPanSouthButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningSouth=!0,this.startPanningSouth())},b.prototype.onPanSouthButtonMouseOut=function(a){this._isPanningSouth=!1,this.stopPanningSouth()},b.prototype.onPanSouthWestButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningSouthWest=!0,this.startPanningSouthWest())},b.prototype.onPanSouthWestButtonMouseOut=function(a){this._isPanningSouthWest=!1,this.stopPanningSouthWest()},b.prototype.onPanWestButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningWest=!0,this.startPanningWest())},b.prototype.onPanWestButtonMouseOut=function(a){this._isPanningWest=!1,this.stopPanningWest()},b.prototype.onPanNorthWestButtonMouseOver=function(a){this._isMouseDown&&(this._isPanningNorthWest=!0,this.startPanningNorthWest())},b.prototype.onPanNorthWestButtonMouseOut=function(a){this._isPanningNorthWest=!1,this.stopPanningNorthWest()},b.prototype.onZoomInButtonClick=function(a){this.map.view.zoomIn()},b.prototype.onZoomOutButtonClick=function(a){this.map.view.zoomOut()},b.prototype.onScaleInButtonClick=function(a){this.map.view.zoomIn()},b.prototype.onScaleOutButtonClick=function(a){this.map.view.zoomOut()},b.prototype.onOpacityInputBlur=function(a){this.map.view.setOpacity(this._opacityInput.value)},b.prototype.onDecreaseOpacityButtonClick=function(a){var b=parseFloat(this._opacityInput.value),c=Math.max(b-.1,0);this._opacityInput.value=c.toFixed(1),this.map.view.setOpacity(c)},b.prototype.onIncreaseOpacityButtonClick=function(a){var b=parseFloat(this._opacityInput.value),c=Math.min(b+.1,1);this._opacityInput.value=c.toFixed(1),this.map.view.setOpacity(c)},b.prototype.onMoved=function(a){this.bindPosition(),this.bindBounds()},b.prototype.onSizeChanged=function(a){this.dashboard.outputPanel.queueEvent("SizeChanged"),this.bindSize()},b.prototype.onZoomed=function(a){this.dashboard.outputPanel.queueEvent("Zoomed"),this.bindScale()},b.prototype.onViewportLatLonButtonClick=function(a){var b=parseInt(this._viewportZoom.value,10),c=parseFloat(this._viewportLongitude.value),d=parseFloat(this._viewportLatitude.value);parseFloat(this._viewportX.value),parseFloat(this._viewportY.value);this.map.view.move(c,d,b)},b.prototype.onViewportWidthHeightButtonClick=function(a){var b=parseInt(this._viewportWidth.value,10),c=parseInt(this._viewportHeight.value,10),d=document.getElementById(this.map.getId());d.style.height=c+"px",d.style.width=b+"px"},b.prototype.onStopped=function(a){this.dashboard.outputPanel.queueEvent("View Stopped")},b.prototype.onStarted=function(a){this.dashboard.outputPanel.queueEvent("View Started")},b}();b.ViewportPanel=c}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.src=a,this.href=b,this.parentElementId=c,this.parentElement=document.getElementById(this.parentElementId),this.render()}return a.prototype.render=function(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("img");c.src=this.src;var d=this.parentElement.querySelector("#__wxMap_maptainer");if(a.id="__wxMap_logo",this.href){var e=document.createElement("a");e.href=this.href,e.target="_blank",e.appendChild(c),b.appendChild(e)}else b.appendChild(c);a.appendChild(b),d.appendChild(a)},a}();a.Logo=b}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){var b=this;this._enableMenuItem=function(a,c){b._view.enableItem(c)},this._disableMenuItem=function(a,c){b._view.disableItem(c)},this._onTimeModeChanged=function(a){b._view.onTimeModeChanged(a)},this.tense="pastId",this.$=new a.wxQuery}return b.prototype.registerEvents=function(){this._template.map.menuItemEnabled.addListener(this,this._enableMenuItem),this._template.map.menuItemDisabled.addListener(this,this._disableMenuItem),this._template.state.timeModeChanged.addListener(this,this._onTimeModeChanged)},b}();a.MenuController=b}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(c){var d=function(){function d(a,b,d,e,f){var g=this;this.startMapId="_wxMap_startID",this._isPrepped=!1,this._ns={svg:"http://www.w3.org/2000/svg"},this._isLocal=!1,this._onResize=function(a){g.onResize(a)},this._mapClick=function(a){g.onMapClick(a)},this._onSlidingTimeout=function(a,b){g.onSlidingTimeout(b)},this._onTimeModeChanged=function(a){g.onTimeModeChanged(a)},this._handleCSSLoaded=function(){g.handleCSSLoaded()},this.$=new c.Library(this),this.initSettings=b,this.uiElementId=a,this.uiElement=document.getElementById(a),this.mapElementId=a+"_Map",this.initParams=this.treatInitParams(e),this.memberId=e&&e.memberId?e.memberId:"NA",this.mapId=e&&e.mapId?e.mapId:"NA",this.initCapabilities=d,this.args=f,this._isLocal="localhost"===window.location.hostname,this.treatMenuItems(),e.orientation&&(this._orientation=e.orientation.indexOf("top")>-1?"top-orientation":""),f.orientation&&(this._orientation=f.orientation.indexOf("top")>-1?"top-orientation":""),this.detectFeatures(),document.ondragstart=function(a){return!1},this.injectUI(),this.ui=document.getElementById("responsive_wxMap_UI");try{this.loadMap()}catch(h){}try{this.insertGoogleAnalytics()}catch(h){}}return d.prototype.getState=function(){return this.state},d.prototype.svg=function(){return this._supportsSVG},d.prototype.gethost=function(){return"http://tessera.intellicast.com/Assets/UI/0009/"},d.prototype.loadMap=function(){this.loadSavedLocation(),this.map=new a.Client.Control(this.mapElementId,this.initSettings,this.initCapabilities,this.initParams),this.map.getIsLoadable()&&(this.settings=this.map.settings,this.load())},d.prototype.loadSavedLocation=function(){for(var b,c=a.Storage.retrieveMaps(),d=a.Storage.retrieve(this.startMapId),e=0,f=c.length;f>e;e++)if(c[e].id===d){b=c[e];break}b&&(b.location&&(this.initParams.longitude=b.location.longitude.toString(),this.initParams.latitude=b.location.latitude.toString()),this.initParams.zoomLevel=this.deriveZoomFromScale(b.scale).toString(),this.initParams.persistLocation="false",this.initParams.persistZoomLevel="false")},d.prototype.adjustScrubberHandle=function(){this.map&&(!this.map.animator.getIsPlaying()||this.map.animator.getIsPaused())&&this.animationScrubberControl.updateScrubberPosition(this.map.animator.getCurrentFrame())},d.prototype.adjustForCalc=function(){var a=parseInt(this.$.g("#timeLinks").css("width"),10),b=parseInt(this.$.g(".playerContainer").css("width"),10),c=parseInt(this.$.g("#timestamp").css("width"),10),d=this.$.g(".btnControls"),e=this.$.g("#sliderContainer"),f=Math.floor(parseInt(this.$.prop(this.uiElement,"width"),10)),g=100,h=90;640>f&&(g=h=35);var i=f-g-h-2;d.css("width",i+"px");var j=.95*i-a-b-c-30;e.css("width",j+"px")},d.prototype.closeAllMenus=function(){this.locationSearch.closeSearchModal(),this.layersControl.closeMenu(),this.saveLocation.closeSaveLocationMenu()},d.prototype.registerMapEvents=function(){this.map.view.mouseClick.addListener(this,this._mapClick),this.map.view.touchTap.addListener(this,this._mapClick),this.map.view.slidingTimeout.addListener(this,this._onSlidingTimeout)},d.prototype.registerUIEvents=function(){a.addEventListener(window,"resize",this._onResize),this.state.timeModeChanged.addListener(this,this._onTimeModeChanged)},d.prototype.load=function(){var d=this;this.map.animator.setTotalFrames(24);var e=new a.TimeSpan;e.addMilliseconds(150),this.map.animator.setPlayRate(e),this.layerConfig=new c.LayerConfig(this),this.state=new c.State(this),this.locationSearch=new c.LocationSearchControl(this),this.saveLocation=new c.SaveLocationControl(this),this.layersControl=new c.LayerMenuControl(this,this.initSettings.menu),this.animationScrubberControl=new c.AnimationScrubberControl(this),this.pastFutureStateControl=new c.PastFutureStateControl(this),this.animationControl=new c.AnimationControl(this),this.zoomControls=new c.ZoomControls(this),this.opacityControls=new c.OpacityControls(this),this.legendControl=new c.LegendControl(this),this.attributionController=new b.AttributionController(this.map),this.args.fullScreen&&"true"==this.args.fullScreen.toLowerCase()&&(this.fullScreenControl=new c.FullScreenControl(this)),this.attributionController.getHasWsiLayers()&&this.addWsiAttribution(),this.registerMapEvents(),this.registerUIEvents();var f=function(){d.map.enableActiveMenuItems(),d.attributionController.initializeMapAttribution(),d.map.capabilityClient.polled.removeListener(f)};this.map.capabilityClient.polled.addListener(null,f,!1)},d.prototype.addWsiAttribution=function(){var a=this.attributionController.createWsiAttribution(),b=document.createElement("div");b.setAttribute("id","__wxMap_wsiAttribution"),b.innerHTML=a;var c=this.$.g("#notice");c.append(b)},d.prototype.insertGoogleAnalytics=function(){var a,b,c,d=this;window._gat?this.onGoogleAnalyticsLoaded(null,null):(a="https:"==document.location.protocol?"https://ssl.":"http://www.",b=document.getElementsByTagName("head")[0],c=document.createElement("script"),c.src=a+"google-analytics.com/ga.js",c.type="text/javascript",c.async="async",c.readyState?c.onreadystatechange=function(a,b){("loaded"==c.readyState||"complete"==c.readyState)&&(c.onreadystatechange=null,d.onGoogleAnalyticsLoaded(a,b))}:c.onload=function(a,b){d.onGoogleAnalyticsLoaded(a,b)},b.insertBefore(c,b.firstChild))},d.prototype.onGoogleAnalyticsLoaded=function(a,b){var c=this.memberId+"_"+this.mapId+"_0011";this.track(c)},d.prototype.track=function(a){var b;b=window._gat._getTracker("UA-7991343-1"),b._setDomainName("none"),b._setAllowLinker(!0),b._setVar(a)},d.prototype.detectFeatures=function(){this._supportsSVG=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,this._supportsCalc=this.testForCalc()},d.prototype.testForCalc=function(){var a=["-webkit-","-moz-","-o-","-ms-"],b="width:",c="calc(10px);",d=document.createElement("div");return d.style.cssText=b+a.join(c+b),!!d.style.length},d.prototype.injectUI=function(){function a(a,b){setTimeout(function c(){var d=document.getElementById(a),e=d.currentStyle||getComputedStyle(d,null),f=parseInt(e.height,10);f>0?b():setTimeout(c,50)},50)}var b=(document.styleSheets.length,new c.Markup),d=b.html,e="png",f=document.getElementsByTagName("head")[0],g=document.createElement("style"),h=document.createTextNode(b.css);g.type="text/css",g.styleSheet?g.styleSheet.cssText=h.nodeValue:g.appendChild(h),f.insertBefore(g,f.firstChild),d=d.replace(/{ext}/g,e),d=d.replace(/{elementId}/g,this.uiElementId),d=d.replace(/{orientation}/g,this._orientation),this.uiElement.innerHTML=d,a("timeLinks",this._handleCSSLoaded)},d.prototype.handleCSSLoaded=function(){if(this.onResize(null),!this._supportsCalc){var a=document.createEvent("UIEvents");a.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(a)}},d.prototype.deriveZoomFromScale=function(b){return a.Gis.TmsTileSystem.deriveZoomLevel(b)},d.prototype.treatInitParams=function(a){return a.layers="",a.basemap="",a},d.prototype.showTimeoutMessage=function(){var a=this.$.m("div"),b=this.$.m("div");a.className="__wxMap_overlay",b.className="__wxMap_timeoutMessage",b.innerHTML="<h2>The <b>WeatherActive</b> Map session has expired</h2>",b.innerHTML+="<span style='display: block;text-align: center;'>Please <b>refresh</b> the page to continue</div></span>";var c=this.$.g("#responsive_wxMap_UI",this.uiElement);c.insertBefore(b,c.firstChild),c.insertBefore(a,c.firstChild)},d.prototype.treatMenuItems=function(){var a,b,c,d,e,f,g,h=this.args.menuItems?decodeURIComponent(this.args.menuItems).split(","):[],i=this.initSettings.menu,j=!1;if(i)for(a=i.trees,d=0,e=a.length;e>d;d++){for(b=a[d].children,f=0,g=b.length;g>f;f++)c=b[f],h.indexOf(c.id)>-1&&(this.initSettings.menu.trees[d].children[f].isActive=!0,j=!0);if(j&&/single/gi.test(a[d].mode))for(f=0,g=b.length;g>f;f++)c=b[f],c.isActive&&-1===h.indexOf(c.id)&&(this.initSettings.menu.trees[d].children[f].isActive=!1);j=!1}},d.prototype.onResize=function(a){this.$.removeClass(this.ui);var b=parseInt(window.getComputedStyle(this.uiElement,null).getPropertyValue("width"),10),c=null;switch(!0){case 300>=b:c="sub300";break;case 350>=b:c="sub350";break;case 400>=b:c="sub400";break;case 525>=b:c="sub450";break;case 640>=b:c="sub640";break;case 910>=b:c="sub900";break;case 950>=b:c="sub950"}null!==c&&this.$.addClass(this.ui,c),this._orientation&&this.$.addClass(this.ui,this._orientation),this._supportsCalc||this.adjustForCalc(),this.adjustScrubberHandle()},d.prototype.onMapClick=function(a){this.closeAllMenus()},d.prototype.onTimeModeChanged=function(b){for(var c=this.map.view.getLayerOrder(),d=0,e=c.length;e>d;d++){var f,g=c[d];switch(b.newMode){case a.TimeMode.Past:f=this.layerConfig.getPastId(g);break;case a.TimeMode.Future:f=this.layerConfig.getFutureId(g)}f&&(this.map.view.removeLayer(g),this.map.view.insertLayer(f,d))}var h=this.map.animator;switch(h.stop(),h.minimizeRange(),b.newMode){case a.TimeMode.Past:h.setEndTime(a.DateTime.utcFromNow());break;case a.TimeMode.Future:h.setStartTime(a.DateTime.utcFromNow())}h.skipToNow(),this.animationScrubberControl.updateTimeLabel()},d.prototype.onSlidingTimeout=function(a){this.closeAllMenus(),this.animationControl.unregisterMapEvents(),this.animationScrubberControl.unregisterEvents(),this.showTimeoutMessage()},d}();c.Template=d}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.mappings={map:"_Map"},this.css="@font-face {  font-family: 'Segoe UI';  src: url('http://images.intellicast.com/Styles/Fonts/segoeui-webfont.eot');  src: url('http://images.intellicast.com/Styles/Fonts/segoeui-webfont.eot?#iefix') format('embedded-opentype'), url('http://images.intellicast.com/Styles/Fonts/segoeui-webfont.woff') format('woff'), url('http://images.intellicast.com/Styles/Fonts/segoeui-webfont.ttf') format('truetype'), url('http://images.intellicast.com/Styles/Fonts/segoeui-webfont.svg#segoe_uiregular') format('svg');  font-weight: 100;  font-style: normal;}@font-face {  font-family: 'segoe_uilight';  src: url('http://tessera.intellicast.com/Assets/UI/0009/Styles/Fonts/segoeuil-webfont.eot');  src: url('http://tessera.intellicast.com/Assets/UI/0009/Styles/Fonts/segoeuil-webfont.eot?#iefix') format('embedded-opentype'), url('http://tessera.intellicast.com/Assets/UI/0009/Styles/Fonts/segoeuil-webfont.ttf') format('truetype'), url('http://tessera.intellicast.com/Assets/UI/0009/Styles/Fonts/segoeuil-webfont.svg#segoe_uilight') format('svg');  font-weight: 100;  font-style: normal;}.border-box-sizing {  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  box-sizing: border-box;}.PlayerBtns {  padding-right: 4px;  cursor: pointer;  width: 90px;  background-color: #000000;  background-color: rgba(0, 0, 0, 0.3);}.leaflet-popup-close-button {  z-index: 1;}#responsive_wxMap_UI {  width: 100%;  height: 100%;  /*width: 977px;	height: 770px;*/  min-width: 285px;  font-size: 12px;  font-family: 'segoe_uilight', Tahoma, sans-serif !important;  font-weight: 100;  position: relative;  top: 0;  left: 0;}#responsive_wxMap_UI #__bingtainer {  display: block;  clear: both;}#responsive_wxMap_UI #__wxMap_maptainer {  position: absolute;  bottom: 40px;}#responsive_wxMap_UI .input-group {  font-size: 24px;}#responsive_wxMap_UI.noCalc #sliderContainer {  display: none;}#responsive_wxMap_UI * {  margin: 0px;  padding: 0px;  font-family: 'segoe_uilight', Tahoma, sans-serif !important;  font-weight: 100;  background: none;  position: relative;  left: auto;  right: auto;  top: auto;  bottom: auto;  -webkit-touch-callout: none;  -webkit-user-select: none;  -khtml-user-select: none;  -moz-user-select: none;  -ms-user-select: none;  user-select: none;}#responsive_wxMap_UI .leaflet-popup {  color: #000;}#responsive_wxMap_UI input[type='text'] {  -webkit-touch-callout: auto !important;  -webkit-user-select: auto !important;  -khtml-user-select: auto !important;  -moz-user-select: auto !important;  -ms-user-select: auto !important;  user-select: auto !important;}#responsive_wxMap_UI .modal-content h5,#responsive_wxMap_UI .clearfix:before,#responsive_wxMap_UI .clearfix:after,#responsive_wxMap_UI .container:before,#responsive_wxMap_UI .container:after,#responsive_wxMap_UI .container-fluid:before,#responsive_wxMap_UI .container-fluid:after,#responsive_wxMap_UI .row:before,#responsive_wxMap_UI .row:after,#responsive_wxMap_UI .form-horizontal .form-group:before,#responsive_wxMap_UI .form-horizontal .form-group:after,#responsive_wxMap_UI .btn-toolbar:before,#responsive_wxMap_UI .btn-toolbar:after,#responsive_wxMap_UI .btn-group-vertical > .btn-group:before,#responsive_wxMap_UI .btn-group-vertical > .btn-group:after,#responsive_wxMap_UI .nav:before,#responsive_wxMap_UI .nav:after,#responsive_wxMap_UI .navbar:before,#responsive_wxMap_UI .navbar:after,#responsive_wxMap_UI .navbar-header:before,#responsive_wxMap_UI .navbar-header:after,#responsive_wxMap_UI .navbar-collapse:before,#responsive_wxMap_UI .navbar-collapse:after,#responsive_wxMap_UI .pager:before,#responsive_wxMap_UI .pager:after,#responsive_wxMap_UI .panel-body:before,#responsive_wxMap_UI .panel-body:after,#responsive_wxMap_UI .modal-footer:before,#responsive_wxMap_UI .modal-footer:after {  content: ' ';  display: table;}#responsive_wxMap_UI li li {  list-style-type: none;}#responsive_wxMap_UI ul {  margin: 0px;  list-style-type: none;  -webkit-padding-start: 0px;}#responsive_wxMap_UI ul li {  list-style-type: none;}#responsive_wxMap_UI #notice {  clear: both;  display: block;  padding: 10px;  color: white;  font-size: 8pt;  width: 250px;  margin: 0 auto;}#responsive_wxMap_UI .slider-handle {  left: 95%;  left: -webkit-calc(100% - 20px);  left: calc(100% - 20px);}#responsive_wxMap_UI .clearfix:after {  clear: both;}#responsive_wxMap_UI .slider {  -webkit-border-radius: 4px;  -moz-border-radius: 4px;  border-radius: 4px;  border: 1px solid white;  height: 4px;  background: #ffffff;  background: rgba(255, 255, 255, 0.4);  position: relative;}#responsive_wxMap_UI .slider .slider-filler {  -webkit-border-radius: 4px;  -moz-border-radius: 4px;  border-radius: 4px;  position: absolute;  left: 0;  top: 0;  bottom: 0;  background: white;}#responsive_wxMap_UI .slider .slider-handle {  -webkit-border-radius: 10px;  -moz-border-radius: 10px;  border-radius: 10px;  height: 20px;  width: 20px;  background-color: white;  display: block;  position: absolute;  top: -8px;}#responsive_wxMap_UI .closeBtn {  text-indent: -9999px;  display: block;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/ClosePanelIconOnDark.png') no-repeat center center;  float: left;  width: 20px;  height: 20px;  cursor: pointer;}#responsive_wxMap_UI #zoomIn,#responsive_wxMap_UI #zoomOut,#responsive_wxMap_UI #fullScreenBtn {  position: relative;  top: 10px;  z-index: 1001;  text-indent: -9999px;  background-color: transparent;  border: none;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/ZoomIn.png') top center no-repeat;  height: 32px;  width: 32px;  display: block;  cursor: pointer;  -webkit-user-select: none;  -moz-user-select: none;  -ms-user-select: none;  user-select: none;}#responsive_wxMap_UI #zoomOut {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/ZoomOut.png') top center no-repeat;  margin-top: 10px;}#responsive_wxMap_UI #fullScreenBtn {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/FullScreen_32x32.png') top center no-repeat;  margin-top: 10px;  display: none;}#responsive_wxMap_UI #wxMap_Map {  top: 0;  left: 0;  right: 0;  bottom: 0;  width: 100%;  height: 100% !important;  min-width: 280px;  min-height: 240px;}#responsive_wxMap_UI #controls {  position: absolute;  top: 0px;  left: 10px;  width: 0;  height: 0;}#responsive_wxMap_UI .container {  margin-right: auto;  margin-left: auto;  width: 100%;  min-width: 240px;}#responsive_wxMap_UI .btn {  border: 1px solid #ccc;  -webkit-border-radius: 6px;  -moz-border-radius: 6px;  border-radius: 6px;  margin: 0 5px 0 0;  float: none;  text-align: center;  width: 100px;  font-size: 12pt;  height: 18px;  padding: 0;  line-height: 13pt;  cursor: pointer;  color: white;}#responsive_wxMap_UI .alert {  background-color: rgba(255, 0, 0, 0.4);  display: block;  border-top: 1px solid white;  border-bottom: 1px solid white;  margin-bottom: 10px;  padding: 5px;}#responsive_wxMap_UI #legendWrap {  position: relative;  left: -10px;  height: 25px;  z-index: 1001;  min-width: 300px;}#responsive_wxMap_UI #legendWrap #legendBtn {  display: block;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/LegendOpenClose.png') no-repeat;  cursor: pointer;  height: 25px;  width: 17px;  float: left;}#responsive_wxMap_UI #legendWrap #legend {  float: left;  display: block;}#responsive_wxMap_UI #legendWrap #legend img {  display: block;}#responsive_wxMap_UI #legendWrap #legend span {  display: block;  height: 25px;  line-height: 25px;  padding: 0 10px;  color: white;  background: rgba(0, 0, 0, 0.8);}#responsive_wxMap_UI #modal {  z-index: 1001;  display: none;  min-height: 113px;  min-width: 196px;  background-color: rgba(0, 0, 0, 0.8);  color: white;  width: 196px;  height: 113px;  font-size: 16px;  position: absolute;  -webkit-border-radius: 10px;  -moz-border-radius: 10px;  border-radius: 10px;  padding: 0 10px;  top: -webkit-calc(50% - 56px);  top: calc(50% - 56px);  left: -webkit-calc(50% - 98px);  left: calc(50% - 98px);}#responsive_wxMap_UI #modal .modal-dialog {  height: 80px;  margin: auto;  width: 100%;  position: absolute;  top: 0;  bottom: 0;  right: 0;  text-align: center;}#responsive_wxMap_UI #modal button {  position: absolute;  bottom: 10px;  left: -webkit-calc(50% - 35px);  left: calc(50% - 35px);  background-color: transparent;  border: 1px solid white;  width: 70px;  height: 20px;  -webkit-border-radius: 5px;  -moz-border-radius: 5px;  border-radius: 5px;  color: white;}#responsive_wxMap_UI .modal {  overflow-y: hidden;}#responsive_wxMap_UI .modal-dialog {  width: 100%;  height: 100%;}#responsive_wxMap_UI .modal-content {  height: inherit;}#responsive_wxMap_UI .layersDialog,#responsive_wxMap_UI .search.dialog,#responsive_wxMap_UI .save.dialog {  box-sizing: border-box;  display: none;  position: absolute;  bottom: 35px;  overflow-y: auto;  overflow-x: hidden;  z-index: 1001;}#responsive_wxMap_UI .layersDialog header,#responsive_wxMap_UI .search.dialog header,#responsive_wxMap_UI .save.dialog header {  height: 26px;  border-bottom: 1px solid rgba(255, 255, 255, 0.2);  /*border-bottom: 1px solid #ccc;*/  padding: 5px 0 0 0;  width: 100%;}#responsive_wxMap_UI .layersDialog header .hContainer,#responsive_wxMap_UI .search.dialog header .hContainer,#responsive_wxMap_UI .save.dialog header .hContainer {  float: left;  width: 355px;}#responsive_wxMap_UI .layersDialog header .btn,#responsive_wxMap_UI .search.dialog header .btn,#responsive_wxMap_UI .save.dialog header .btn {  margin: 0 auto;  width: 120px;}#responsive_wxMap_UI .layersDialog article,#responsive_wxMap_UI .search.dialog article,#responsive_wxMap_UI .save.dialog article {  overflow: hidden;  overflow-y: auto;  width: -webkit-calc(100% - 10px);  width: calc(100% - 10px);  padding-left: 10px;  height: 138px;}#responsive_wxMap_UI .layersDialog article h5,#responsive_wxMap_UI .search.dialog article h5,#responsive_wxMap_UI .save.dialog article h5 {  font-size: 13pt;  font-weight: 100;  margin-bottom: 3px;  line-height: 15pt;}#responsive_wxMap_UI .layersDialog article header,#responsive_wxMap_UI .search.dialog article header,#responsive_wxMap_UI .save.dialog article header {  padding: 5px 0px 0px 0px;  border: none;  height: 52px;}#responsive_wxMap_UI .layersDialog article header input,#responsive_wxMap_UI .search.dialog article header input,#responsive_wxMap_UI .save.dialog article header input {  background-color: rgba(255, 255, 255, 0.6);  border: 1px solid #ccc;  padding-left: 2px;  width: 180px;  height: 20px;  font-style: italic;  /*font-size: 13pt;*/  font-size: 14px;  font-weight: 100;  top: -12px;}#responsive_wxMap_UI .layersDialog article .zContainer,#responsive_wxMap_UI .search.dialog article .zContainer,#responsive_wxMap_UI .save.dialog article .zContainer {  max-height: 87px;  overflow-x: hidden;  overflow-y: auto;  width: -webkit-calc(100% - 10px);  width: calc(100% - 10px);}#responsive_wxMap_UI .search.dialog header .hContainer {  width: 190px;}#responsive_wxMap_UI .search.dialog .zContainer {  margin-top: -6px;}#responsive_wxMap_UI .search.dialog .savedLocation {  cursor: pointer;}#responsive_wxMap_UI .search.dialog ul#searchResults,#responsive_wxMap_UI .search.dialog ul#savedLocales {  margin-left: -10px;  background-color: rgba(255, 255, 255, 0.2);}#responsive_wxMap_UI .search.dialog ul#searchResults li,#responsive_wxMap_UI .search.dialog ul#savedLocales li {  border-top: 1px solid rgba(255, 255, 255, 0.2);  /*border-top: 1px solid #ccc;*/  height: 28px;  margin-right: 5px;  font-size: 13pt;  width: 165px;  text-overflow: ellipsis;  white-space: nowrap;  overflow: hidden;  margin-left: 10px;  padding-left: 10px;  cursor: pointer;}#responsive_wxMap_UI .search.dialog ul#searchResults li .first,#responsive_wxMap_UI .search.dialog ul#savedLocales li .first {  border: none;}#responsive_wxMap_UI .search.dialog ul#searchResults li div,#responsive_wxMap_UI .search.dialog ul#savedLocales li div {  float: left;  text-overflow: ellipsis;  width: 145px;  font-size: 13pt;  overflow: hidden;}#responsive_wxMap_UI .search.dialog ul#searchResults li div:after,#responsive_wxMap_UI .search.dialog ul#savedLocales li div:after {  clear: both;}#responsive_wxMap_UI .search.dialog ul#searchResults li button,#responsive_wxMap_UI .search.dialog ul#savedLocales li button {  text-indent: -9999px;  border: none;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/ModalControlSmallCloseIcon.png') no-repeat center center;  width: 16px;  height: 21px;  float: right;  margin-top: 5px;  cursor: pointer;}#responsive_wxMap_UI .search.dialog ul#searchResults li button:after,#responsive_wxMap_UI .search.dialog ul#savedLocales li button:after {  clear: both;}#responsive_wxMap_UI ul#savedLocales li {  width: 190px !important;  padding-left: 0px !important;}#responsive_wxMap_UI ul#savedLocales li span.star {  float: left;  text-indent: -9999px;  width: 20px;  height: 20px;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/SaveViewPopupStarIcon.png') no-repeat center center;  margin: 2px 5px 0 0;}#responsive_wxMap_UI ul#savedLocales li span.star.selected {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/SaveViewPopupStarIconSelected.png') no-repeat center center;}#responsive_wxMap_UI #searchIcon,#responsive_wxMap_UI #layerIcon {  width: 18px;  height: 35px;  overflow: hidden;  float: left;  position: relative;}#responsive_wxMap_UI .search.dialog,#responsive_wxMap_UI .save.dialog {  width: 220px;  min-width: 175px;  background-color: rgba(0, 0, 0, 0.8);  color: white;  /*top: -205px;*/  left: 0px;  height: 170px;  overflow: hidden;}#responsive_wxMap_UI .layersDialog {  width: 400px;  height: 80%;  /*.calcMixin(left,~'100% - 400px'); */  height: -webkit-calc(100% - 35px);  height: calc(100% - 35px);  position: absolute;  bottom: 35px;  right: 0px;  background-color: rgba(0, 0, 0, 0.8);}#responsive_wxMap_UI .layersDialog .closeBtn {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/ClosePanelIconOnLight.png') no-repeat center center;}#responsive_wxMap_UI .layersDialog #opacityControls {  width: 80%;  margin: 0 auto;  margin-bottom: 15px;  text-align: center;  color: white;}#responsive_wxMap_UI .layersDialog #opacityControls span {  display: block;  padding-bottom: 10px;}#responsive_wxMap_UI .layersDialog .modal-content h5 {  color: white;  height: 25px;  width: 100%;  font-size: 13pt;  line-height: 25px;  padding: 0 0 0 5px;  margin: 0 0 8px 0;  clear: both;}#responsive_wxMap_UI .layersDialog .modal-content ul.iconContainer {  padding: 0 0 0 5px;  width: 100%;}#responsive_wxMap_UI .layersDialog .modal-content ul.iconContainer:after {  clear: both;}#responsive_wxMap_UI .layersDialog .layerOption {  width: 90px;  height: 40px;  padding-top: 28px;  margin: 0 3px 4px 0;  text-align: center;  font-size: 9pt;  color: #fff;  cursor: pointer;  float: left;  border: 1px solid rgba(204, 204, 204, 0);}#responsive_wxMap_UI .layersDialog .layerOption.on {  border: 1px solid rgba(204, 204, 204, 0.5);  -webkit-border-radius: 10px;  -moz-border-radius: 10px;  border-radius: 10px;  background-color: rgba(0, 0, 0, 0.4);}#responsive_wxMap_UI .layersDialog .layerIcon {  height: 19px;  width: 25px;  display: block;}#responsive_wxMap_UI .layersDialog header {  padding: 0;  height: 25px;  background-color: rgba(255, 255, 255, 0.6);}#responsive_wxMap_UI .layersDialog header h5 {  margin: 0;  background: none !important;}#responsive_wxMap_UI .layersDialog header .closeBtn {  margin-top: 3px;}#responsive_wxMap_UI .layersDialog header .hContainer {  width: 355px;}#responsive_wxMap_UI .layersDialog header .hContainer h5 {  margin: 0;}#responsive_wxMap_UI .layersDialog h5 {  background-color: rgba(255, 255, 255, 0.6);}#responsive_wxMap_UI .save.dialog {  height: 147px;  width: 206px;}#responsive_wxMap_UI .save.dialog header {  height: 25px;}#responsive_wxMap_UI .save.dialog .hContainer {  padding-left: 10px;  width: 166px !important;  font-size: 13pt;  line-height: 13pt;}#responsive_wxMap_UI .save.dialog article h5 {  padding-top: 3px;}#responsive_wxMap_UI .save.dialog article div {  height: 21px;}#responsive_wxMap_UI .save.dialog article div label {  font-size: 13pt;  /*border-bottom: 1px solid #c3c3c3;*/  border-bottom: 1px solid rgba(255, 255, 255, 0.2);  width: 95%;  display: block;  line-height: 13pt;  padding-bottom: 10px;}#responsive_wxMap_UI .save.dialog article div #startMap {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/sprite.png') no-repeat -36px -199px;  width: 20px;  height: 19px;  vertical-align: middle;}#responsive_wxMap_UI .save.dialog article input[type='text'] {  background-color: rgba(255, 255, 255, 0.6);  /*border: 1px solid #ccc;*/  border: 1px solid rgba(255, 255, 255, 0.2);  padding-left: 2px;  width: 180px;  height: 20px;  font-style: italic;  font-size: 13px;  font-weight: 100;  margin-bottom: 5px;}#responsive_wxMap_UI .save.dialog article .pull-right {  height: 30px;  padding: 5px 0 0 0;  margin: 9px auto 0 auto;  width: 155px;}#responsive_wxMap_UI .save.dialog article .pull-right .btn {  width: 70px;  float: left;}#responsive_wxMap_UI .navbar {  position: absolute;  bottom: 0px;  height: 35px;  /*margin-top: -35px;*/  color: white;  width: 100%;  background-color: rgba(0, 0, 0, 0.8);  z-index: 1002;}#responsive_wxMap_UI .navbar .nav {  margin-bottom: 0;  padding-left: 0;  list-style: none;  margin-top: 0;  width: 100%;}#responsive_wxMap_UI .navbar .nav > li {  position: relative;  display: block;}#responsive_wxMap_UI .navbar .nav-pills > li {  float: left;}#responsive_wxMap_UI .btnSearch {  padding-right: 4px;  cursor: pointer;  width: 90px;  background-color: #000000;  background-color: rgba(0, 0, 0, 0.3);  width: 100px;  padding: 0;  border-right: 1px solid #dddddd;  height: 35px;  line-height: 35px;}#responsive_wxMap_UI .btnSearch .btnCenter {  margin: 0 auto;  width: 95px;}#responsive_wxMap_UI .btnSearch .label {  margin-left: 4px;  float: left;  font-size: 13pt;  line-height: 24pt;  color: white;}#responsive_wxMap_UI .btnSearch #searchIcon {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlPinIcon.png') no-repeat center center;}#responsive_wxMap_UI .btnControls {  text-align: center;  color: white;  width: 70%;  width: -webkit-calc(100% - 192px);  width: calc(100% - 192px);  background: #000000;  background: rgba(255, 255, 255, 0.2);}#responsive_wxMap_UI .btnControls #centerControls {  width: 95%;  height: 35px;  margin-left: auto;  margin-right: auto;}#responsive_wxMap_UI .btnControls #timeLinks {  width: 114px;  height: 35px;  float: left;  line-height: 35px;}#responsive_wxMap_UI .btnControls #timeLinks span {  font-size: 13pt;  cursor: pointer;}#responsive_wxMap_UI .btnControls #timeLinks .past {  padding-right: 11px;  position: relative;  border-right: 1px solid #fff;  /*&:after {          content: '';          height: 21px;          width: 1px;          background: white;          position: absolute;          top: 3px;          margin-left: 10px;        }*/}#responsive_wxMap_UI .btnControls #timeLinks .future {  padding-left: 10px;}#responsive_wxMap_UI .btnControls #timeLinks .active {  text-decoration: underline;}#responsive_wxMap_UI .btnControls #timeLinks .disabled {  color: #686868;}#responsive_wxMap_UI .btnControls #timestamp {  width: 110px;  float: left;  font-size: 13pt;  margin-top: 10px;  margin-left: 10px;  line-height: 11pt;}#responsive_wxMap_UI .btnControls .playerContainer {  height: 31px;  width: 88px;  overflow: hidden;  float: left;  margin-top: 4px;}#responsive_wxMap_UI .btnControls .playerButton {  margin-right: 10px;  float: left;  cursor: pointer;}#responsive_wxMap_UI .btnControls .reverse {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlBackIcon.png') no-repeat center center;  width: 21px;  height: 21px;  margin-top: 3px;}#responsive_wxMap_UI .btnControls .play {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlPlayIcon.png') no-repeat center center;  width: 26px;  height: 26px;}#responsive_wxMap_UI .btnControls .pause {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlPauseIcon.png') no-repeat center center;}#responsive_wxMap_UI .btnControls .forward {  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlForwardIcon.png') no-repeat center center;  width: 21px;  height: 21px;  margin: 3px 0 0 0;}#responsive_wxMap_UI .btnControls #sliderContainer {  float: left;  width: -webkit-calc(100% - 340px);  width: calc(100% - 340px);  margin: 0 4px 0 10px;}#responsive_wxMap_UI .btnControls #slider {  margin-top: 15px;  width: 100%;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  box-sizing: border-box;}#responsive_wxMap_UI .btnLayers {  padding-right: 4px;  cursor: pointer;  width: 90px;  background-color: #000000;  background-color: rgba(0, 0, 0, 0.3);  padding: 0;  border-left: 1px solid #dddddd;  height: 35px;  line-height: 35px;}#responsive_wxMap_UI .btnLayers .btnCenter {  margin: 0 auto;  width: 77px;}#responsive_wxMap_UI .btnLayers .label {  float: left;  margin-right: 5px;  font-size: 13pt;  line-height: 24pt;  color: white;}#responsive_wxMap_UI .btnLayers #layerIcon {  width: 25px;  display: block;  background: url('http://tessera.intellicast.com/Assets/UI/0009/img/png/MapControlLayerIcon.png') no-repeat center center;}#responsive_wxMap_UI.sub300 .layersDialog {  width: 212px;  left: -webkit-calc(100% - 212px);  left: calc(100% - 212px);}#responsive_wxMap_UI.sub300 .layersDialog #notice {  width: 135px;}#responsive_wxMap_UI.sub300 .layersDialog header .hContainer {  width: 167px;}#responsive_wxMap_UI.sub300 .nav .label {  display: none;}#responsive_wxMap_UI.sub300 .btnControls {  width: -webkit-calc(100% - 72px);  width: calc(100% - 72px);}#responsive_wxMap_UI.sub300 .btnControls #centerControls {  width: 210px;}#responsive_wxMap_UI.sub300 .btnControls .playerContainer {  width: 27px;}#responsive_wxMap_UI.sub300 .btnControls .playerContainer .play {  margin: 0;}#responsive_wxMap_UI.sub300 .btnControls .playerContainer .forward,#responsive_wxMap_UI.sub300 .btnControls .playerContainer .reverse {  display: none;}#responsive_wxMap_UI.sub300 .btnControls #timeLinks {  width: 80px;  padding-left: 3px;}#responsive_wxMap_UI.sub300 .btnControls #timeLinks span {  font-size: 12pt !important;}#responsive_wxMap_UI.sub300 .btnControls #timeLinks .future {  padding-left: 3px;}#responsive_wxMap_UI.sub300 .btnControls #timeLinks .past {  padding-right: 4px;}#responsive_wxMap_UI.sub300 .btnControls #timeLinks .past:after {  margin-left: 3px;}#responsive_wxMap_UI.sub300 #timestamp {  margin-left: 0px;  font-size: 12pt !important;  width: 95px;}#responsive_wxMap_UI.sub300 .btnLayers {  width: 35px;}#responsive_wxMap_UI.sub300 .btnLayers .btnCenter {  width: 25px;}#responsive_wxMap_UI.sub300 .btnSearch {  width: 35px;}#responsive_wxMap_UI.sub300 .btnSearch .btnCenter {  width: 18px;}#responsive_wxMap_UI.sub300 #sliderContainer {  display: none;}#responsive_wxMap_UI.sub350 .layersDialog {  width: 212px;  left: -webkit-calc(100% - 212px);  left: calc(100% - 212px);}#responsive_wxMap_UI.sub350 .layersDialog #notice {  width: 135px;}#responsive_wxMap_UI.sub350 .layersDialog header .hContainer {  width: 167px;}#responsive_wxMap_UI.sub350 .nav .label {  display: none;}#responsive_wxMap_UI.sub350 .btnControls {  width: -webkit-calc(100% - 72px);  width: calc(100% - 72px);}#responsive_wxMap_UI.sub350 .btnControls #centerControls {  width: 245px;}#responsive_wxMap_UI.sub350 .btnControls .playerContainer {  width: 36px;}#responsive_wxMap_UI.sub350 .btnControls .playerContainer .play {  margin: 0 5px;}#responsive_wxMap_UI.sub350 .btnControls .playerContainer .forward,#responsive_wxMap_UI.sub350 .btnControls .playerContainer .reverse {  display: none;}#responsive_wxMap_UI.sub350 .btnControls #timeLinks {  width: 95px;}#responsive_wxMap_UI.sub350 .btnControls #timeLinks .past {  padding-right: 6px;}#responsive_wxMap_UI.sub350 .btnControls #timeLinks .past:after {  margin-left: 5px;}#responsive_wxMap_UI.sub350 .btnControls #timeLinks .future {  padding-left: 5px;}#responsive_wxMap_UI.sub350 #timestamp {  margin-left: 0px;}#responsive_wxMap_UI.sub350 .btnLayers {  width: 35px;}#responsive_wxMap_UI.sub350 .btnLayers .btnCenter {  width: 25px;}#responsive_wxMap_UI.sub350 .btnSearch {  width: 35px;}#responsive_wxMap_UI.sub350 .btnSearch .btnCenter {  width: 18px;}#responsive_wxMap_UI.sub350 #sliderContainer {  display: none;}#responsive_wxMap_UI.sub400 .layersDialog {  width: 212px;  left: -webkit-calc(100% - 212px);  left: calc(100% - 212px);}#responsive_wxMap_UI.sub400 .layersDialog #notice {  width: 135px;}#responsive_wxMap_UI.sub400 .layersDialog header .hContainer {  width: 167px;}#responsive_wxMap_UI.sub400 .nav .label {  display: none;}#responsive_wxMap_UI.sub400 .btnControls {  width: -webkit-calc(100% - 72px);  width: calc(100% - 72px);}#responsive_wxMap_UI.sub400 .btnControls #centerControls {  width: 256px;}#responsive_wxMap_UI.sub400 .btnControls .playerContainer {  width: 46px;}#responsive_wxMap_UI.sub400 .btnControls .play {  margin: 0 10px;}#responsive_wxMap_UI.sub400 .btnControls .forward,#responsive_wxMap_UI.sub400 .btnControls .reverse {  display: none;}#responsive_wxMap_UI.sub400 .btnControls #timestamp {  margin-left: 0px;}#responsive_wxMap_UI.sub400 .btnControls #timeLinks {  width: 100px;}#responsive_wxMap_UI.sub400 .btnControls #timeLinks .future {  padding-right: 10px;}#responsive_wxMap_UI.sub400 .btnLayers {  width: 35px;}#responsive_wxMap_UI.sub400 .btnLayers .btnCenter {  width: 25px;}#responsive_wxMap_UI.sub400 .btnSearch {  width: 35px;}#responsive_wxMap_UI.sub400 .btnSearch .btnCenter {  width: 18px;}#responsive_wxMap_UI.sub400 #sliderContainer {  display: none;}#responsive_wxMap_UI.sub450 .layersDialog {  width: 305px;  left: -webkit-calc(100% - 305px);  left: calc(100% - 305px);}#responsive_wxMap_UI.sub450 .layersDialog header .hContainer {  width: 260px;}#responsive_wxMap_UI.sub450 .nav .label {  display: none;}#responsive_wxMap_UI.sub450 .btnControls {  width: -webkit-calc(100% - 72px);  width: calc(100% - 72px);}#responsive_wxMap_UI.sub450 .btnControls #centerControls {  width: 325px;}#responsive_wxMap_UI.sub450 .btnControls #timeLinks {  width: 114px;}#responsive_wxMap_UI.sub450 .btnControls #timeLinks .future {  padding-right: 10px;}#responsive_wxMap_UI.sub450 .btnLayers {  width: 35px;}#responsive_wxMap_UI.sub450 .btnLayers .btnCenter {  width: 25px;}#responsive_wxMap_UI.sub450 .btnSearch {  width: 35px;}#responsive_wxMap_UI.sub450 .btnSearch .btnCenter {  width: 18px;}#responsive_wxMap_UI.sub450 #sliderContainer {  display: none;}#responsive_wxMap_UI.sub640 .nav .label {  display: none;}#responsive_wxMap_UI.sub640 .btnControls {  width: -webkit-calc(100% - 72px);  width: calc(100% - 72px);}#responsive_wxMap_UI.sub640 .btnLayers {  width: 35px;}#responsive_wxMap_UI.sub640 .btnLayers .btnCenter {  width: 25px;}#responsive_wxMap_UI.sub640 .btnSearch {  width: 35px;}#responsive_wxMap_UI.sub640 .btnSearch .btnCenter {  width: 18px;}#responsive_wxMap_UI.sub640 .layersDialog {  width: 305px;  left: -webkit-calc(100% - 305px);  left: calc(100% - 305px);}#responsive_wxMap_UI.sub640 .layersDialog header .hContainer {  width: 260px;}#responsive_wxMap_UI.sub900 {  /*    #timeLinks {			.future {				padding-right: 20px;			}		}		.layersDialog {			width: 307px;			.calcMixin(width,~'100% - 307px');			header {				.hContainer {					width: 262px;				}			}		}*/}#responsive_wxMap_UI.sub900 #sliderContainer {  width: -webkit-calc(100% - 342px);  width: calc(100% - 342px);}#responsive_wxMap_UI.top-orientation #controls {  height: 100%;}#responsive_wxMap_UI.top-orientation #controls #legendWrap {  position: absolute;  bottom: 0;  left: -10px;}#responsive_wxMap_UI.top-orientation #controls #zoomIn,#responsive_wxMap_UI.top-orientation #controls #zoomOut,#responsive_wxMap_UI.top-orientation #controls #fullScreenBtn {  top: 45px;}#responsive_wxMap_UI.top-orientation .search.dialog header {  height: auto;}#responsive_wxMap_UI.top-orientation .search.dialog header .hContainer {  width: 180px;}#responsive_wxMap_UI.top-orientation .search.dialog article .zContainer {  max-height: none;  margin-top: 0;}#responsive_wxMap_UI.top-orientation .search.dialog ul#searchResults li,#responsive_wxMap_UI.top-orientation .search.dialog ul#savedLocales li {  color: #fff;}#responsive_wxMap_UI.top-orientation .search.dialog,#responsive_wxMap_UI.top-orientation .save.dialog {  top: 35px;}#responsive_wxMap_UI.top-orientation .search.dialog,#responsive_wxMap_UI.top-orientation .save.dialog,#responsive_wxMap_UI.top-orientation .search.dialog article,#responsive_wxMap_UI.top-orientation .save.dialog article {  height: auto;  bottom: 0;  overflow-x: hidden;  overflow-y: auto;  clear: both;}#responsive_wxMap_UI.top-orientation .layersDialog {  bottom: auto;  top: 35px;}#responsive_wxMap_UI.top-orientation .layersDialog .layerOption {  height: 32px;  padding-top: 38px;  background-position-y: 5px !important;}#responsive_wxMap_UI.top-orientation .container {  position: static;}#responsive_wxMap_UI.top-orientation .navbar {  top: 0;}#responsive_wxMap_UI.top-orientation .nav {  float: none;}#responsive_wxMap_UI.top-orientation #legendWrap {  left: 7px;}#responsive_wxMap_UI .__wxMap_overlay {  position: absolute;  top: 0;  left: 0;  right: 0;  bottom: 0;  background: #000;  width: 100%;  z-index: 10000;  -webkit-opacity: 0.5;  -moz-opacity: 0.5;  -o-opacity: 0.5;  -ms-opacity: 0.5;  opacity: 0.5;  filter: alpha(opacity=50);}#responsive_wxMap_UI .__wxMap_timeoutMessage {  -webkit-opacity: 0.9;  -moz-opacity: 0.9;  -o-opacity: 0.9;  -ms-opacity: 0.9;  opacity: 0.9;  filter: alpha(opacity=90);  position: absolute;  left: 50%;  top: 148px;  background: #fff;  width: 230px;  margin-left: -115px;  z-index: 10001;  padding: 20px;  font: normal 14px/1.2em Tahoma, Arial, sans-serif;}#responsive_wxMap_UI .__wxMap_timeoutMessage h2 {  margin: 0 0 20px 0;  font-weight: normal;  font-size: 18px;  line-height: 20px;  text-align: center;}#responsive_wxMap_UI .__wxMap_timeoutMessage b {  font-weight: bold;}#responsive_wxMap_UI .__wxMap_timeoutMessage .__wxMap_btn {  float: right;}#responsive_wxMap_UI .__wxMap_timeoutMessage .__wxMap_refresh {  border: 0;  height: 32px;  line-height: 32px;  background-color: #000;  color: #fff;  padding: 0 8px;  cursor: pointer;}",
this.html = "		<style>			#responsive_wxMap_UI, #responsive_wxMap_UI  #{elementId}_Map{				width: 100%;				height: 100%;			}		</style><div id='responsive_wxMap_UI' class='over_900 {orientation}'>	<div id='{elementId}_Map'>	</div>		<div id='controls'>			<div id='legendWrap' class='clearfix'>        <span id='legendBtn'></span>        <div id='legend'></div>      </div>			<span id='zoomIn'>+</span>			<span id='zoomOut'>-</span>      <span id='fullScreenBtn'>^</span>	</div>	<span id='__wxMap_maptainer'></span>		<div class ='container'>			<nav class='navbar'>					<ul class='nav nav-pills'>							<li id='{elementId}_btnSearch' class='btnSearch'>									<div class='btnCenter'><span id='searchIcon' class='icon-search-{ext}'></span><span class='label'>Locations</span></div>							</li>							<li class='btnControls'>									<div id='centerControls'>											<span id='timeLinks'><span class='past active'>Past</span><span class='future'>Future</span></span>											<div class='playerContainer'>													<div id='btnBack' class='playerButton reverse'></div>													<div id='btnPlay' class='playerButton play'></div>													<div id='btnFwd' class='playerButton forward'></div>											</div>											<div id='sliderContainer'>													<div id='slider' class='slider'>                              <div class='slider-filler'></div>															<a class='slider-handle' href='#'></a>													</div>											</div>											<div id='timestamp'></div>									</div>							</li>							<li id='{elementId}_btnLayers' class='btnLayers'>									<div class='btnCenter'><span class='label'>Layers</span><span id='layerIcon' class='icon-layer-{ext}'></span></div>							</li>					</ul>			</nav>	</div>		<!-- end container -->		<!-- Message Modal -->		<div id='modal'></div>	<!-- Search Modal -->	<div id='{elementId}_searchDialog' class='search dialog'>		<div class='modal-dialog modal-lg'>			<div class='modal-content'>				<header>					<div class='hContainer'>						<div class = 'btn savemapview'> Save Map View </div>					</div>						<span class='closeBtn'>X</span>				</header>				<article>					<header>						<h5> Enter a location </h5>						<div class='input-group'>							<input id='locationSearch' value='Enter City, state, or zip' type='text'>						</div><!-- /input-group -->					</header>					<div class='zContainer'>						<ul id='searchResults'></ul>					</div>					<h5>Saved locations</h5>					<ul id='savedLocales'>					<li>No saved locations.</li>					</ul>				</article>			</div>		</div>	</div>	<!-- Save Modal -->	<div id='{elementId}_saveDialog' class='save dialog'>		<div class='modal-dialog'>			<div class='modal-content'>				<header>					<div class='hContainer'>						<div> Save Map View </div>					</div>						<span class='closeBtn'>X</span>				</header>				<article>					<h5>Location Name</h5>					<input type='text' id='saveName' class='form-control'>					<div>						<label><input id='startMap' type='checkbox'>Map Default Location</label>					</div>					<div class='pull-right'>						<div class='btn btnCancel'> Cancel </div>  						<div class='btn btnSave'> Save </div>					</div>				</article>			</div>		</div>	</div>	<!-- Layers Modal -->	<div id='{elementId}_layersDialog' class='layersDialog dialog'>		<div class='modal-dialog'>			<div class='modal-content'>				<header>					<div class='hContainer'>						<h5>Layers </h5>					</div>						<span class='closeBtn'>X</span>				</header>				<div id='opacityControls'>						<span>Opacity</span>					<div id='opacitySlider' class='slider'>            <div class='slider-filler'></div>						<a class='slider-handle' href='#'></a>					</div>				</div>				<div class='content'> 				</div> 				<span id='__bingtainer'></span>		<span id='notice'></span>			</div>		</div>	</div></div > "
} return a
}(); a.Markup = b
}(b = a.DynamicMenu || (a.DynamicMenu = {}))
}(b = a.UI || (a.UI = {}))
}(WxMap || (WxMap = {})); var WxMap; !function (WxMap) { var UI; !function (UI) { var DynamicMenu; !function (DynamicMenu) { var Library = function () { function Library(a) { this._proto = { html: function (a) { this.innerHTML = a }, attr: function (a, b) { return b ? void this.setAttribute(a, b) : this.getAttribute(a) }, append: function (a) { this.appendChild(a) }, css: function (a, b) { return void 0 === b && (b = null), null !== b && (this.style[a] = b), this.ownerDocument.defaultView.getComputedStyle(this, null).getPropertyValue(a) }, prop: function (a) { return getComputedStyle(this).getPropertyValue(a) }, hide: function () { this.style.display = "none" }, show: function () { this.style.display = "block" }, addClass: function (a) { this.classList ? this.classList.add(a) : this.className += " " + a }, removeClass: function (a) { void 0 === a && (this.className = " "), this.classList ? this.classList.remove(a) : this.className = this.className.replace(new RegExp("(^|\\b)" + a.split(" ").join("|") + "(\\b|$)", "gi"), " ") }, closest: function (a) { if (null === this) return !1; var b; if ("." === a[0] && (b = a.slice(1), -1 !== this.className.indexOf(b))) return this; if ("#" === a[0] && (b = a.slice(1), this.getAttribute("id") === b)) return this; if (this.nodeName.toLowerCase() === a.toLowerCase()) return this; var c = this.parentNode; return this.closest(c, a) } }, this.template = a } return Library.prototype.extend = function (a, b) { for (var c in b) a[c] = b[c]; return a }, Library.prototype.m = function () { for (var a = [], b = 0; b < arguments.length; b++) a[b - 0] = arguments[b]; for (var c, d = {}.toString, e = /(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g, f = "[object Object]" == d.call(a[1]), g = f ? a[1] : {}, h = f ? a[2] || "" : a[1] || "", i = [], j = "div"; i = e.exec(a[0]) ;) "" === i[1] ? j = i[2] : "#" === i[1] && (g.id = i[2]); c = document.createElement(j); for (var k in g) c.setAttribute(k, g[k]); return c.innerHTML = h, c = this.extend(c, this._proto) }, Library.prototype.g = function (a, b) { for (var c = b || this.template.ui, d = c.querySelectorAll(a), e = 0; e < d.length; e++) d[e] = this.extend(d[e], this._proto); return 0 === d.length ? null : 1 === d.length ? d[0] : d }, Library.prototype.addClass = function (a, b) { a.classList ? a.classList.add(b) : a.className += " " + b }, Library.prototype.html = function (a, b) { a.innerHTML = b }, Library.prototype.attr = function (a, b, c) { return c ? void a.setAttribute(b, c) : a.getAttribute(b) }, Library.prototype.prop = function (a, b) { return getComputedStyle(a).getPropertyValue(b) }, Library.prototype.prepend = function (a, b) { a.parentNode.insertBefore(b, a) }, Library.prototype.removeClass = function (a, b) { return void 0 === b ? void (a.className = "") : void (a.classList ? a.classList.remove(b) : a.className = a.className.replace(new RegExp("(^|\\b)" + b.split(" ").join("|") + "(\\b|$)", "gi"), " ")) }, Library.prototype.toggleClass = function (a, b) { if (a.classList) a.classList.toggle(b); else { for (var c = a.className.split(" "), d = -1, e = c.length; e--;) c[e] === b && (d = e); d >= 0 ? c.splice(d, 1) : c.push(b), a.className = c.join(" ") } }, Library.prototype.hide = function (a) { a.style.display = "none" }, Library.prototype.show = function (a) { a.style.display = "block" }, Library.prototype.ajax = function (cfg) { var request = new XMLHttpRequest, data, callBackName = "__wxMap" + "xxxxxx_xxxxxx4xxxyx_xxxxxxxxxxxx".replace(/[xy]/g, function (a) { var b = 16 * Math.random() | 0, c = "x" == a ? b : 3 & b | 8; return c.toString(16) }), url; if ("jsonp" === cfg.dataType) { if (window[callBackName] = function () { arguments[0]; cfg.success(arguments[0]) }, url = cfg.url, null != cfg.data && "object" == typeof cfg.data) { url += "?q="; for (var k in cfg.data) url += "&" + k + "=" + cfg.data[k]; url += "&" } else url += null !== cfg.data ? "?" + cfg.data + "&" : "?"; url += "callback=" + callBackName, request.open("GET", url, !0), request.onreadystatechange = function () { 4 === this.readyState && (this.status >= 200 && this.status < 400 ? eval(this.responseText) : cfg.error()) }, request.send(), request = null } if ("json" === cfg.dataType) try { request.open("GET", cfg.url, !0), request.onload = function () { request.status >= 200 && request.status < 400 ? (data = JSON.parse(request.responseText), cfg.success(data)) : cfg.error() }, request.onerror = function () { cfg.error() }, request.send() } catch (e) { throw new Error(e) } }, Library }(); DynamicMenu.Library = Library }(DynamicMenu = UI.DynamicMenu || (UI.DynamicMenu = {})) }(UI = WxMap.UI || (WxMap.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (a) { var b; !function (a) { var b = function () { function a(a) { var b = this; this._handleWidth = 20, this._handlerFunc = function (a) { b.handlerFunc(a) }, this.template = a, this.$ = this.template.$ } return a.prototype.getOffset = function (a) { var b = 0, c = 0; if (a.offsetParent) do b += a.offsetLeft, c += a.offsetTop; while (a = a.offsetParent); return [b, c] }, a.prototype.positionSlider = function (a) { var b = parseInt(getComputedStyle(this._wrapper).getPropertyValue("width")), c = a * (b - 20) / 100; this._handle.style.left = c + "px", this._filler.style.right = b - (c + 10) + "px" }, a.prototype.setSlider = function (a, b) { this._wrapper = this.$.g(a), this._handle = this.$.g("a", this._wrapper), this._filler = this.$.g(".slider-filler", this._wrapper), this._callback = b, this._filler.style.right = this._handleWidth / 2 + "px", this.registerEvents() }, a.prototype.registerEvents = function () { this._handle.addEventListener("mousedown", this._handlerFunc), this._handle.addEventListener("touchstart", this._handlerFunc) }, a.prototype.unregisterEvents = function () { this._handle.removeEventListener("mousedown", this._handlerFunc), this._handle.removeEventListener("touchstart", this._handlerFunc) }, a.prototype.handlerFunc = function (a) { a.preventDefault(), a.stopPropagation(); var b = this.getOffset(this._wrapper), c = parseInt(getComputedStyle(this._wrapper).getPropertyValue("width")), d = this; c -= this._handleWidth; var e = function (a) { var e; a.preventDefault(), e = navigator.userAgent.match(/Android/i) ? a.targetTouches[0].pageX : a.pageX; var f = e - b[0]; 0 > f && (f = 0), f > c && (f = c), d._handle.style.left = f + "px", d._filler.style.right = d._handleWidth / 2 + c - f + "px", d._callback(Math.round(f / c * 100)) }; document.addEventListener("mousemove", e), document.addEventListener("touchmove", e), document.addEventListener("mouseup", function () { document.removeEventListener("mousemove", e, !1), document.removeEventListener("touchmove", e, !1) }), document.addEventListener("touchend", function () { document.removeEventListener("touchmove", e, !1), document.removeEventListener("mousemove", e, !1) }) }, a }(); a.SliderControl = b }(b = a.DynamicMenu || (a.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (b) { var c; !function (b) { var c = function () { function b(b) { var c = this; this._defaultValue = "Enter City, state, or zip", this._storage = a.Storage, this._menuOpen = !1, this._dialogId = "_searchDialog", this._savedMaps = new Array, this._searchResults = "", this._toggleMenu = function (a) { c.toggleMenu() }, this._closeSearchMenu = function (a) { c.closeSearchModal() }, this._onFocus = function (a) { c.onFocus(a) }, this._onBlur = function (a) { c.onBlur(a) }, this._onSearch = function (a) { c.onSearch(a) }, this._onSelect = function (a) { c.onSelect(a) }, this._onSearchResults = function (a) { c.handleSearchResults(a) }, this._selectSavedLocation = function (a) { c.onSelectSavedLocation(a) }, this._removeSavedLocation = function (a) { c.onRemoveSavedLocation(a) }, this._updateDefaultStart = function (a) { c.updateDefaultStart(a) }, this.template = b, this.$ = b.$, this._input = this.$.g("#locationSearch"), this._menu = this.$.g("#" + b.uiElementId + this._dialogId), this._btn = this.$.g("#" + b.uiElementId + "_btnSearch"), this._closeBtn = this.$.g(".closeBtn", this._menu), this._trigger = this.$.g("#searchButton"), this.registerEvents(), this.loadSavedSearches() } return b.prototype.toggleMenu = function () { this._menuOpen ? (this.template.closeAllMenus(), this.closeSearchModal()) : this.openSearchModal() }, b.prototype.updateDefaultStart = function (a) { var b = a.target.parentNode.getAttribute("data-idx"), c = this._savedMaps[b]; this._storage.remove(this.template.startMapId), this._storage.save(this.template.startMapId, c.id); for (var d = this.$.g("#savedLocales li span"), e = 0; e < d.length; e++) d[e].removeClass("selected"); this.$.addClass(a.target, "selected") }, b.prototype.onRemoveSavedLocation = function (b) { var c = b.target.parentNode.getAttribute("data-idx"), d = this._savedMaps[c]; this._savedMaps.splice(c, 1), a.Storage.removeMap(d.id), this.loadSavedSearches() }, b.prototype.onSelectSavedLocation = function (b) { var c = b.target.getAttribute("data-idx"), d = this._savedMaps[c], e = this.template.map.view; if (this.layersControl = this.template.layersControl, d.basemap && d.layerOrder) { this.layersControl.turnOffAllLayers(!0); var f = d.layerOrder; e.addLayer(d.basemap); for (var g = 0; g < f.length; g++) this.layersControl.toggleLayer(f[g]) } if (d.location) { var h = d.location.longitude, i = d.location.latitude; if (d.scale) { var j = a.Gis.TmsTileSystem.deriveZoomLevel(d.scale); e.move(h, i, j) } else e.move(h, i) } this.toggleMenu() }, b.prototype.loadSavedSearches = function () { this._savedMaps = a.Storage.retrieveMaps(); var b, c, d = a.Storage.retrieve(this.template.startMapId), e = this.$.g("#savedLocales"); if (e.html(""), !this._savedMaps.length) return void e.html("<li>No saved locations.</li>"); for (var f = 0; f < this._savedMaps.length; f++) { b = this._savedMaps[f]; var g = this.$.m("button", { "class": "close" }, "X"), h = this.$.m("span", { "class": "star" }, "*"); d == b.id && h.addClass("selected"), c = this.$.m("li", { "class": "savedLocation", "data-idx": f }); var i = this.$.m("div", { "data-idx": f }, b.id); c.append(g), c.append(h), c.append(i), a.addEventListener(h, "click", this._updateDefaultStart), a.addEventListener(g, "click", this._removeSavedLocation), a.addEventListener(i, "click", this._selectSavedLocation), e.append(c) } }, b.prototype.registerEvents = function () { this._menu.querySelector(".savemapview"); a.addEventListener(this._closeBtn, "click", this._closeSearchMenu), a.addEventListener(this._btn, "click", this._toggleMenu), a.addEventListener(this._input, "focus", this._onFocus), a.addEventListener(this._input, "blur", this._onBlur), a.addEventListener(this._input, "keyup", this._onSearch) }, b.prototype.openSearchModal = function () { this.template.closeAllMenus(), this._menuOpen = !0, this._menu.style.display = "block" }, b.prototype.closeSearchModal = function () { this.$.g("#searchResults").html(""), this._input.value = this._defaultValue, this._menuOpen = !1, this._menu.style.display = "none" }, b.prototype.onFocus = function (a) { this.clear(), a.target.value = "" }, b.prototype.onBlur = function (a) { var b = a.target.value; "" === b && (a.target.value = this._defaultValue) }, b.prototype.onSearch = function (b) { var c = "https://wsidata.weather.com/Locations/Search.axd?q=" + this._input.value; this._searchResults = a.Net.createCorsRequest("GET", c), this._searchResults && (this._searchResults.onload = this._onSearchResults, this._searchResults.send()) }, b.prototype.handleSearchResults = function (b) { if (a.Console.log("result: ", this._searchResults), this._searchResults.responseText) { var c, d = JSON.parse(this._searchResults.responseText), e = {}, f = this.$.g("#searchResults"); f.html(""); for (var g = 0; g < d.results.count; g++) { c = d.results.locations.location[g], e[c.id] = c; var h = this.$.m("li", { id: c.id, "class": 0 == g ? "first" : "", "data-lat": c.lat, "data-lon": c.lon }, c.name); f.append(h), a.addEventListener(f, "click", this._onSelect) } this.$.g("#searchResults", this._menu).show() } }, b.prototype.clear = function () { this.$.g("#searchResults").html(""); var a = this._input.value; "" === a && (this._input.value = this._defaultValue) }, b.prototype.onSelect = function (a) { this.clear(); var b = a.target, c = (this.$.attr(b, "id"), parseFloat(this.$.attr(b, "data-lon"))), d = parseFloat(this.$.attr(b, "data-lat")); this.template.map.view.move(c, d), this.template.map.view.zoom(8), this.closeSearchModal() }, b }(); b.LocationSearchControl = c }(c = b.DynamicMenu || (b.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (a) { var b; !function (b) { var c = function (a) { function c(c, d) { a.call(this), this._template = c, this.registerEvents(), this._view = new b.AdaptiveMenuView(c) } return __extends(c, a), c.prototype.turnOffAllLayers = function (a) { }, c.prototype.toggleLayer = function (a) { }, c.prototype.registerEvents = function () { a.prototype.registerEvents.call(this) }, c.prototype.closeMenu = function () { this._view.closeLayersMenu() }, c }(a.MenuController); b.LayerMenuControl = c }(b = a.DynamicMenu || (a.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (b) { var c; !function (b) { var c = function () { function c(c) { var d = this; this._dialogId = "_saveDialog", this._storage = a.Storage, this._crazyChars = /[^a-zA-Z0-9\s\,\.\:\\\/]/gi, this._onlyWhitespace = /^\s+$/, this._storageEnabled = this._storage.isEnabled, this._openSaveLocationModal = function (a) { d.openSaveLocationMenu() }, this._closeSaveLocationMenu = function (a) { d.closeSaveLocationMenu() }, this._saveMapLocation = function (a) { d.onSaveMapLocation(a) }, this.template = c, this._modal = new b.ModalControl(c), this.$ = c.$, this._input = c.$.g("#saveName"), this._menu = c.$.g("#" + c.uiElementId + this._dialogId, c.ui), this._btn = c.$.g(".savemapview", c.ui), this._closeBtn = c.$.g(".closeBtn", this._menu), this._cancelBtn = c.$.g(".btnCancel", this._menu), this._saveBtn = c.$.g(".btnSave", this._menu), this._startMapCheckbox = c.$.g("#startMap", this._menu), this.registerEvents() } return c.prototype.save = function (a) { var b = this.template.map.getState(); this._storage.saveMap(a + "", b) }, c.prototype.removeSavedMap = function (a) { this._storage.remove(a) }, c.prototype.onSaveMapLocation = function (a) { var b = this._input.value; return this._crazyChars.test(b) ? void this.alert("please use only alphabetic or numeric characters.") : "" === b || this._onlyWhitespace.test(b) ? void this.alert("location name cannot be blank") : this._storage.retrieveMap(b) ? void this.alert("A location with that name already exists.") : (this._startMapCheckbox.checked && (this._storage.remove(this.template.startMapId), this._storage.save(this.template.startMapId, b)), this.save(b), this.template.locationSearch.loadSavedSearches(), void this.closeSaveLocationMenu()) }, c.prototype.alert = function (a) { this._modal.show(a) }, c.prototype.openSaveLocationMenu = function () { this._storageEnabled ? (this.template.closeAllMenus(), this._menu.style.display = "block") : this.alert("Cookies must be enabled to save locations") }, c.prototype.closeSaveLocationMenu = function () { this._modal.close(), this._input.value = "", this._menu.style.display = "none", this._startMapCheckbox.checked = !1 }, c.prototype.registerEvents = function () { a.addEventListener(this._cancelBtn, "click", this._closeSaveLocationMenu), a.addEventListener(this._closeBtn, "click", this._closeSaveLocationMenu), a.addEventListener(this._saveBtn, "click", this._saveMapLocation), a.addEventListener(this._btn, "click", this._openSaveLocationModal) }, c }(); b.SaveLocationControl = c }(c = b.DynamicMenu || (b.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (b) { var c; !function (b) { var c = function () { function b(a) { var b = this; this._isAnimationDisabled = !1, this._playPauseToggle = function (a) { b.onPlayPauseToggle(a) }, this._skipForward = function (a) { b.onSkipForward(a) }, this._skipBackward = function (a) { b.onSkipBackward(a) }, this._layerChanged = function (a) { b.checkCanAnimate() }, this._onTimeChanged = function (a) { b.onTimeChanged() }, this._onPlay = function () { b.onPlay() }, this._onPause = function () { b.onPause() }, this.template = a, this._animator = a.map.animator, this._playPauseBtn = a.$.g("#btnPlay"), this._skipBackBtn = a.$.g("#btnBack"), this._skipForwardBtn = a.$.g("#btnFwd"), this._scrubber = a.animationScrubberControl, this._pastFutureState = a.pastFutureStateControl, this.registerUIEvents(), this.registerMapEvents() } return b.prototype.checkCanAnimate = function () { var b, c = this.template.map.view.getLayers(), d = this.template.state.getActiveLayersTimeMode(); if (this.template.map.capabilityClient.getPollCount() < 1) return void this.disableAnimator(); for (var e in c) { if (b = c[e].info, d === a.TimeMode.Past && b.isAnimate && b.validTimes) return void this.enableAnimator(); if (d === a.TimeMode.Future && b.isAnimate && b.issueTimes) return void this.enableAnimator() } this.disableAnimator() }, b.prototype.disableAnimator = function () { this._isAnimationDisabled || (this._animator.stop(), this.unregisterUIEvents(), this._scrubber.unregisterEvents(), this.blurElements(), this._isAnimationDisabled = !0) }, b.prototype.enableAnimator = function () { this._isAnimationDisabled && (this.registerUIEvents(), this._scrubber.registerEvents(), this.focusElements(), this._isAnimationDisabled = !1) }, b.prototype.blurElements = function () { var a = this.template.$.g("#sliderContainer", this.template.uiElement); a.style.opacity = this._playPauseBtn.style.opacity = this._skipBackBtn.style.opacity = this._skipForwardBtn.style.opacity = "0.25" }, b.prototype.focusElements = function () { var a = this.template.$.g("#sliderContainer", this.template.uiElement); a.style.opacity = this._playPauseBtn.style.opacity = this._skipBackBtn.style.opacity = this._skipForwardBtn.style.opacity = "" }, b.prototype.registerUIEvents = function () { a.addEventListener(this._skipBackBtn, "click", this._skipBackward), a.addEventListener(this._skipForwardBtn, "click", this._skipForward), a.addEventListener(this._playPauseBtn, "click", this._playPauseToggle) }, b.prototype.registerMapEvents = function () { this.template.map.view.layerAdded.addListener(this, this._layerChanged), this.template.map.view.layerRemoved.addListener(this, this._layerChanged), this.template.map.clock.timeChanged.addListener(this, this._onTimeChanged), this.template.map.capabilityClient.polled.addListener(this, this._layerChanged), this.template.map.animator.started.addListener(this, this._onPlay), this.template.map.animator.paused.addListener(this, this._onPause), this.template.map.animator.stopped.addListener(this, this._onPause) }, b.prototype.unregisterUIEvents = function () { a.removeEventListener(this._skipBackBtn, "click", this._skipBackward), a.removeEventListener(this._skipForwardBtn, "click", this._skipForward), a.removeEventListener(this._playPauseBtn, "click", this._playPauseToggle) }, b.prototype.unregisterMapEvents = function () { this.template.map.view.layerAdded.removeListener(this._layerChanged), this.template.map.view.layerRemoved.removeListener(this._layerChanged), this.template.map.clock.timeChanged.removeListener(this._onTimeChanged), this.template.map.capabilityClient.polled.removeListener(this._layerChanged), this.template.map.animator.started.removeListener(this._onPlay), this.template.map.animator.paused.removeListener(this._onPause), this.template.map.animator.stopped.removeListener(this._onPause) }, b.prototype.onTimeChanged = function () { this._scrubber.updateTimeLabel() }, b.prototype.onSkipBackward = function (a) { this._animator.pause(), this._animator.backward() }, b.prototype.onSkipForward = function (a) { this._animator.pause(), this._animator.forward() }, b.prototype.onPlay = function () { this.template.$.addClass(this._playPauseBtn, "pause") }, b.prototype.onPause = function () { this.template.$.removeClass(this._playPauseBtn, "pause") }, b.prototype.onPlayPauseToggle = function (a) { var b = this._animator.getIsPlaying(), c = this._animator.getIsPaused(); b && !c ? this._animator.stop() : this._animator.play() }, b }(); b.AnimationControl = c }(c = b.DynamicMenu || (b.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (b) { var c; !function (b) { var c = function () { function b(a) { var b = this; this._zoomInClick = function (a) { b.onZoomInClick() }, this._zoomOutClick = function (a) { b.onZoomOutClick() }, this.template = a, this.$ = a.$, this._zoomInBtn = a.$.g("#zoomIn"), this._zoomOutBtn = a.$.g("#zoomOut"), this.registerEvents() } return b.prototype.registerEvents = function () { a.addEventListener(this._zoomInBtn, "click", this._zoomInClick), a.addEventListener(this._zoomOutBtn, "click", this._zoomOutClick) }, b.prototype.onZoomInClick = function () { this.template.map.view.getZoomLevel() >= 16 || this.template.map.view.zoomIn() }, b.prototype.onZoomOutClick = function () { this.template.map.view.zoomOut() }, b }(); b.ZoomControls = c }(c = b.DynamicMenu || (b.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (a) { var b; !function (a) { var b = function () { function b(a) { var b = this; this._setOpacity = function (a) { b.setOpacity(a) }, this.template = a, this.$ = a.$, this.bind() } return b.prototype.setPosition = function () { var a = this.template.map.view.getOpacity() || 1, b = 100 * a; this._slider.positionSlider(b) }, b.prototype.setOpacity = function (a) { this.template.map.view.setOpacity(a / 100) }, b.prototype.bind = function () { this._slider = new a.SliderControl(this.template), this._slider.setSlider("#opacitySlider", this._setOpacity) }, b }(); a.OpacityControls = b }(b = a.DynamicMenu || (a.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (a) { var b; !function (a) { var b = function () { function b(b) { var c = this; this._onScrubAnimation = function (a) { c.onScrubAnimation(a) }, this._onIsPlayingChanged = function (a) { c.onIsPlayingChanged() }, this._onFrameChanged = function (a, b) { c.onFrameChanged(a, b) }, this._onTotalFramesChanged = function (a, b) { c.onFrameChanged(a, b) }, this.template = b, this._timestamp = b.$.g("#timestamp"), this.updateTimeLabel(), this._slider = new a.SliderControl(b), this._slider.setSlider("#slider", this._onScrubAnimation), this.registerEvents() } return b.prototype.onIsPlayingChanged = function () { }, b.prototype.onScrubAnimation = function (a) { var b = this.template.map.animator, c = this.template.map.animator.getTotalFrames(), d = Math.round(a / 100 * c); b.pause(), b.skipToFrame(d), this.updateTimeLabel() }, b.prototype.formatTime = function (a) { var b = a.getHours(), c = a.getMinutes(), d = a.getSeconds(), e = b >= 12 ? "PM" : "AM"; b %= 12, b = b ? b : 12, c = 10 > c ? "0" + c : c, d = 10 > d ? "0" + d : d; var f = b + ":" + c + " " + e; return f }, b.prototype.updateTimeLabel = function () { var a = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g, b = /[^-+\dA-Z]/g, c = this.template.map.clock.getTime().getTime(), d = (new Date).getTimezoneOffset() / 60, e = new Date(c); e.getHours(); e.setHours(e.getHours() - d), this._timestamp.innerHTML = this.formatTime(e) + " " + String(e).match(a).pop().replace(b, "") }, b.prototype.updateScrubberPosition = function (a) { var b = this.template.map.animator.getTotalFrames(), a = a || this.template.map.animator.getCurrentFrame(), c = Math.round(--a / --b * 100); this._slider.positionSlider(c) }, b.prototype.registerEvents = function () { this.template.map.animator.isPlayingChanged.addListener(this, this._onIsPlayingChanged), this.template.map.animator.frameChanged.addListener(this, this._onFrameChanged), this.template.map.animator.totalFramesChanged.addListener(this, this._onTotalFramesChanged), this._slider.registerEvents() }, b.prototype.unregisterEvents = function () { this.template.map.animator.isPlayingChanged.removeListener(this._onIsPlayingChanged), this.template.map.animator.frameChanged.removeListener(this._onFrameChanged), this.template.map.animator.totalFramesChanged.removeListener(this._onTotalFramesChanged), this._slider.unregisterEvents() }, b.prototype.onFrameChanged = function (a, b) { this.updateScrubberPosition(b.frame) }, b }(); a.AnimationScrubberControl = b }(b = a.DynamicMenu || (a.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (b) { var c; !function (b) { var c = function () { function b(a) { var b = this; this._pastButtonClick = function (a) { b.onPastButtonClick(a) }, this._futureButtonClick = function (a) { b.onFutureButtonClick(a) }, this._timeModeChanged = function (a, c) { b.onTimeModeChanged(a, c) }, this._layerAdded = function (a, c) { b.onLayerAdded(a, c) }, this._layerRemoved = function (a, c) { b.onLayerRemoved(a, c) }, this.template = a, this.$ = a.$, this._container = this.$.g("#timeLinks"), this._pastButton = this.$.g(".past", this._container), this._futureButton = this.$.g(".future", this._container), this.applyVisualState(this.template.state.getTimeMode()), this.registerEvents(), this.updateControlVisibility() } return b.prototype.getPastButton = function () { return this._pastButton }, b.prototype.getFutureButton = function () { return this._futureButton }, b.prototype.updateControlVisibility = function () { var a, b = !1, c = this.template.map.view.getLayers(); for (var d in c) if (a = this.template.layerConfig.getLayer(d)) for (var e = 0; e < a.layers.length; e++) if (a.layers[e].futureId && a.layers[e].pastId) { b = !0; break } this._container.style.visibility = b ? "visible" : "hidden" }, b.prototype.applyVisualState = function (b) { b === a.TimeMode.Past ? (this.$.removeClass(this._futureButton, "active"), this.$.addClass(this._pastButton, "active")) : (this.$.removeClass(this._pastButton, "active"), this.$.addClass(this._futureButton, "active")) }, b.prototype.registerEvents = function () { a.addEventListener(this._pastButton, "click", this._pastButtonClick, !1), a.addEventListener(this._futureButton, "click", this._futureButtonClick, !1), this.template.map.view.layerAdded.addListener(this, this._layerAdded), this.template.map.view.layerRemoved.addListener(this, this._layerRemoved), this.template.state.timeModeChanged.addListener(this, this._timeModeChanged, !1), this.applyVisualState(this.template.state.getTimeMode()) }, b.prototype.onPastButtonClick = function (b) { this.template.state.setTimeMode(a.TimeMode.Past) }, b.prototype.onFutureButtonClick = function (b) { this.template.state.setTimeMode(a.TimeMode.Future) }, b.prototype.onTimeModeChanged = function (a, b) { this.applyVisualState(this.template.state.getTimeMode()) }, b.prototype.onLayerAdded = function (a, b) { this.updateControlVisibility() }, b.prototype.onLayerRemoved = function (a, b) { this.updateControlVisibility() }, b }(); b.PastFutureStateControl = c }(c = b.DynamicMenu || (b.DynamicMenu = {})) }(b = a.UI || (a.UI = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) { var b; !function (a) { var b = function () { function a(a) { this.control = a } return a.prototype.getCenterGeoPoint = function () { return this.control.view.getGeoCenter() }, a.prototype.getZoomLevel = function () { return this.control.view.getZoomLevel() }, a.prototype.getActiveLayers = function () { return this.control.view.getLayers() }, a.prototype.getInactiveLayers = function () { var a = {}, b = this.control.view.getLayers(); for (var c in this.control.settings.layers) { var d = this.control.settings.layers[c]; void 0 == b[d.info.id] && (a[c] = d) } return a }, a }(); a.Bridge = b }(b = a.Client || (a.Client = {})) }(WxMap || (WxMap = {})); var WxMap; !function (a) {
  var b; !function (a) {
    var b = function (a) {
      function b(b, c, d, e) { var f = this; a.call(this, b, c, d, e), this._isRegistered = !1, this._zIndex = -1, this._surface = null, this._isLoading = !1, this._wireViewStarted = function (a, b) { f.onViewStarted(a, b) }, this._wireViewStopped = function (a, b) { f.onViewStopped(a, b) }, this._wireLayerUpdated = function (a, b) { f.onLayerUpdated(a, b) }, this._wireLoading = function (a) { f.onLoading(a) }, this._wireLoaded = function (a) { f.onLoaded(a) }; var g = this.view.getControl().clock.getTime(); this.info.deriveCurrentTimes(g); var h = this.info.deriveUrl(), i = this.info.deriveOptions(); this._surface = new L.TileLayer(h, i), this.setOpacity(d), this.map.addLayer(this._surface) } return __extends(b, a), b.prototype.getSurface = function () { return this._surface }, b.prototype.getZIndex = function () { return this._zIndex }, b.prototype.setZIndex = function (a) { this._zIndex = a, this._surface && this._surface.setZIndex(a) }, b.prototype.getIsLoading = function () { return this._isLoading }, b.prototype.getOpacity = function () { return this.info.opacity }, b.prototype.setOpacity = function (a) { var b = this.view.getOpacity(), c = null != b ? b : a; null != a && void 0 != a && this._surface && (this.info.opacity = c, this._surface.setOpacity(c)) }, b.prototype.register = function () { this._isRegistered || (this.view.started.addListener(this, this._wireViewStarted), this.view.stopped.addListener(this, this._wireViewStopped), this.info.updated.addListener(this, this._wireLayerUpdated), this._surface && (this._surface.addEventListener("loading", this._wireLoading), this._surface.addEventListener("load", this._wireLoaded), this._isRegistered = !0)) }, b.prototype.unregister = function () { this._isRegistered && (this.view.started.removeListener(this._wireViewStarted), this.view.stopped.removeListener(this._wireViewStopped), this.info.updated.removeListener(this._wireLayerUpdated), this._surface.removeEventListener("loading", this._wireLoading), this._surface.removeEventListener("load", this._wireLoaded), this._isRegistered = !1) }, b.prototype.initialize = function () { this.map.addLayer(this._surface) }, b.prototype.update = function () { var a = this.info.deriveUrl(); this._surface.setUrl(a); var b = this.info.deriveOptions(); this._surface.options = b }, b.prototype.start = function () { this.register() }, b.prototype.stop = function () { this.map.removeLayer(this._surface), this.unregister() }, b.prototype.onLoading = function (a) { this._isLoading = !0, this.loading.trigger(this) }, b.prototype.onLoaded = function (a) { this._isLoading = !1, this.loaded.trigger(this) }, b.prototype.onViewStarted = function (a, b) { this.register() }, b.prototype.onViewStopped = function (a, b) { var c = this; setTimeout(function () { c.unregister() }, 1) }, b.prototype.onLayerUpdated = function (a, b) { var c = this.info.getCurrentValidTime(); this.info.deriveCurrentTimes(this.view.getControl().clock.getTime()), c != this.info.getCurrentValidTime() && (this.update(), this.updated.trigger(this, { id: this.info.id })) }, b.Extension = L.TileLayer.extend({
        getTileUrl: function (a) {
          var b = this; return L.Util.template(b._url, {
            s: b._getSubdomain(a),
q:b._deriveQuadKey(a.x,a.y,b._getZoomForUrl())})},_deriveQuadKey:function(a,b,c){for(var d=[],e=c;e>0;e--){var f="0",g=1<<e-1;0!=(a&g)&&f++,0!=(b&g)&&(f++,f++),d.push(f)}return d.join("")}}),b}(a.Layer);a.MapboxLayer=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(c){function d(d){if(c.call(this,d),this.blankTileUri=b.Settings.assetHost+"/Assets/blank.gif",this.brokenTileUri=b.Settings.assetHost+"/Assets/broken.gif",this.isBasemap=!0,this.isBasemap){var e=new a.DateTime(new Date),f=e.toChronoString(),g=new b.ValidTime(f,"");this.validTimes=[g]}}return __extends(d,c),d.prototype.getType=function(){return"MapboxLayerInfo"},d.prototype.deriveUrl=function(a,b,c){var e=d.href;return e="0086"==this.id?e.replace("{style}","weather.cwcbac5j"):e.replace("{style}","weather.73o4i8z1")},d.prototype.deriveOptions=function(){var a={subdomains:d.cacheModifiers,tms:!1,reuseTiles:!1,errorTileUrl:this.brokenTileUri,maxZoom:this.maximumZoom,minZoom:this.minimumZoom};return a},d.cacheModifiers=new Array("a","b"),d.href="http://{s}.tiles.mapbox.com/v4/{style}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoid2VhdGhlciIsImEiOiJjaW4wbzllcjkwYWtrd2JsdWl3dG1hZjZ1In0.AdcjoWQiVfvjHfOB0nsyeQ",d}(b.LayerInfo);b.MapboxLayerInfo=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(b){function c(a,c,d,e){b.call(this,a,c,d,e),this._features=null,this._surface=null,this._surface=new L.LayerGroup,this.map.addLayer(this._surface),this.requestData()}return __extends(c,b),c.prototype.getSurface=function(){return this._surface},c.prototype.requestData=function(){var b=this,c="http://stationdata.wunderground.com/cgi-bin/stationdata?maxlat=43.819228&minlat=37.714388&maxlon=-73.139211&minlon=-79.337005&type=PWS&iconsize=30&format=json&height=1064&width=768&maxage=10800&rand=6223&maxstations=200&station=",d=a.Net.createCorsRequest("GET",c,!0);d.onerror=function(){},d.timeout=function(){},d.onabort=function(){},d.onprogress=function(){},d.onload=function(){var c=JSON.parse(d.responseText);b._features=a.Geo.Formatter.fromStation(c,b.view.getProjection())},d.send()},c}(b.Layer);b.StationLayer=c}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.getType=function(){return"StationLayerInfo"},b}(a.LayerInfo);a.StationLayerInfo=b}(b=a.Client||(a.Client={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){function b(){var a='<div id="__wxMapProfiler">	<div id="__wxMap_overlay"></div>	<div id="__wxMap_modalStyle">		<div style="margin:10px;outline:solid 1px #aaa;overflow:hidden;">			<div class="Chrome"><a style="float:right;" href="#" id="__wxMap_styleLayerClose">Close &raquo;</a>Layer Style</div>			<div class="Container Content" style="position:relative;height:458px;background:#FFF;padding:0;">				<textarea id="__wxMap_styleLayerText" style="resize:none;width:278px;height:439px;border:none;padding:0;margin:0;display:block;overflow:auto;"></textarea>				<div style="margin:0;height:18px;border-top:solid 1px #AAA;">					<div id="__wxMap_styleLayerId" style="float:left;line-height:18px;padding-left:5px;font-size:10px;">Id - Name</div>					<span id="__wxMap_styleLayerUpdate" class="button text" style="width:auto;float:right;border-top:none;border-right:none;border-bottom:none;height:18px;padding:0 4px;" title="Update">Update</span>				</div>			</div>		</div>	</div>	<div id="__wxMap_modalData">		<div style="margin:10px;outline:solid 1px #aaa;overflow:hidden;">			<div class="Chrome"><a href="#" style="float:right;" id="__wxMap_dataLayerClose">Close &raquo;</a>Layer Data</div>			<div class="Container Content" style="position:relative;height:458px;background:#FFF;padding:0;">				<textarea id="__wxMap_dataLayerText" style="resize:none;width:278px;height:439px;border:none;padding:0;margin:0;display:block;overflow:auto;"></textarea>				<div style="margin:0;height:18px;border-top:solid 1px #AAA;">					<div id="__wxMap_dataLayerId" style="float:left;line-height:18px;padding-left:5px;font-size:10px;">Id - Name</div>					<span id="__wxMap_dataLayerUpdate" class="button text" style="width:auto;border-top:none;border-right:none;border-bottom:none;float:right;height:18px;padding:0 4px;" title="Update">Update</span>					<span id="__wxMap_dataLayerAdd" class="button text" style="width:auto;border-top:none;border-right:none;border-bottom:none;float:right;height:18px;padding:0 4px;" title="Add">Add</span>				</div>			</div>		</div>	</div>	<div class="Chrome">		<a href="#" id="__wxMap_toggleControls">Disable &raquo;</a>		<strong>Profiler - </strong><span id="__wxMap_Version"></span>&nbsp;<img src="http://tessera.intellicast.com/Assets/Icons/loader_black.gif" id="__wxMap_Loading" alt="Loading" />	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger">Viewport:<img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></div>		<div class="Content">			<div class="Row">				<table>					<tr>						<td>Geo:</td>						<td><input id="__wxMap_viewportLongitude" type="text" /></td>						<td><input id="__wxMap_viewportLatitude" type="text" style="border-left:none;" /></td>						<td rowspan="2"><span id="__wxMap_viewportLatLonButton" class="button" style="border-left:none;height:34px;line-height:34px;" title="Geo"><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></span></td>					</tr>					<tr>						<td>Screen:</td>						<td><input id="__wxMap_viewportX" type="text" style="border-top:none;height:17px;" /></td>						<td><input id="__wxMap_viewportY" type="text" style="border-top:none;border-left:none;height:17px;" /></td>						<!--<td><span id="__wxMap_viewportXYButton" class="button" style="border-top:none;border-left:none;" title="Screen"><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></span></td>-->					</tr>					<tr>						<td>Size:</td>						<td><input type="text" id="__wxMap_viewportWidth" style="border-top:none;" /></td>						<td><input type="text" id="__wxMap_viewportHeight" style="border-top:none;border-left:none;" /></td>						<td><span id="__wxMap_viewportWidthHeightButton" class="button" style="border-top:none;border-left:none;" title="Size"><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></span></td>					</tr>				</table>				<table style="float:right;margin-right:0;">					<tr>						<td>Zoom:</td>						<td><span class="button" title="Zoom In" id="__wxMap_zoomInButton"><img src="http://tessera1.intellicast.com/Images/icon_arrow_up.png" alt="" /></span></td>						<td><input style="border-left:none;" type="text" id="__wxMap_viewportZoom" /></td>						<td><span class="button" style="border-left:none;" title="Zoom Out" id="__wxMap_zoomOutButton"><img src="http://tessera3.intellicast.com/Images/icon_arrow_down.png" alt="" /></span></td>					</tr>					<tr>						<td>Scale:</td>						<td><span class="button" style="border-top:none;" title="Scale In" id="__wxMap_scaleInButton"><img src="http://tessera1.intellicast.com/Images/icon_arrow_up.png" alt="" /></span></td>						<td><input style="border-left:none;border-top:none;" type="text" id="__wxMap_viewportScale" /></td>						<td><span class="button" style="border-left:none;border-top:none;" title="Scale Out" id="__wxMap_scaleOutButton"><img src="http://tessera3.intellicast.com/Images/icon_arrow_down.png" alt="" /></span></td>					</tr>					<tr>						<td>Opacity:</td>						<td><span class="button" title="Increase Opacity" style="border-top:none;" id="__wxMap_increaseOpacityButton"><img src="http://tessera1.intellicast.com/Images/icon_arrow_up.png" alt="" /></span></td>						<td><input style="border-top:none;border-left:none;" type="text" id="__wxMap_opacityInput" value="1.0" /></td>						<td><span class="button" style="border-top:none;border-left:none;" title="Decrease Opacity" id="__wxMap_decreaseOpacityButton" style="border-left:none;"><img src="http://tessera3.intellicast.com/Images/icon_arrow_down.png" alt="" /></span></td>					</tr>				</table>			</div>			<div class="Row">				<div style="width:166px;">					<strong>Bounding Box:</strong><br />					<div class="BoundingBox">						<input type="text" readonly="true" id="__wxMap_viewportNorth" value="" />						<input type="text" readonly="true" id="__wxMap_viewportEast" value="" />						<input type="text" readonly="true" id="__wxMap_viewportSouth" value="" />						<input type="text" readonly="true" id="__wxMap_viewportWest" value="" />						<table>							<tr>								<td><span class="button pan_nw" id="__wxMap_panNorthWestButton" title="Pan Northwest" style="border-right:none;border-bottom:none;"></span></td>								<td><span class="button pan_n" id="__wxMap_panNorthButton" title="Pan North" style="border-bottom:none;"></span></td>								<td><span class="button pan_ne" id="__wxMap_panNorthEastButton" title="Pan Northeast" style="border-left:none;border-bottom:none;"></span></td>							</tr>							<tr>								<td><span class="button pan_w" id="__wxMap_panWestButton" title="Pan West" style="border-right:none;"></span></td>								<td><input type="text" id="__wxMap_panInterval" value="10" style="width:16px;text-align:center;" /></td>								<td><span class="button pan_e" id="__wxMap_panEastButton" title="Pan East" style="border-left:none;"></span></td>							</tr>							<tr>								<td><span class="button pan_sw" id="__wxMap_panSouthWestButton" title="Pan Southwest" style="border-right:none;border-top:none;"></span></td>								<td><span class="button pan_s" id="__wxMap_panSouthButton" title="Pan South" style="border-top:none;"></span></td>								<td><span class="button pan_se" id="__wxMap_panSouthEastButton" title="Pan Southeast" style="border-left:none;border-top:none;"></span></td>							</tr>						</table>					</div>				</div>				<div class="Viewport-Output">					<ul>						<li><strong>Zoom Range:</strong></li>						<li><label>Maximum:</label><input type="text" id="__wxMap_maxZoom" readonly="true" style="border:none;" /></li>						<li><label>Minimum:</label><input type="text" id="__wxMap_minZoom" readonly="true" style="border:none;" /></li>					</ul>					<ul>						<li><strong>Timeout:</strong></li>						<li><label>Sliding:</label><input type="text" id="__wxMap_sliding" readonly="true" style="border:none;" /></li>						<li><label>Absolute:</label><input type="text" id="__wxMap_absolute" readonly="true" style="border:none;" /></li>					</ul>				</div>			</div>		</div>	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger">Diagnostics:<img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></div>		<div class="Content">			<table class="Diagnostics-Input">				<tr>					<td>						<input type="checkbox" id="__wxMap_graticuleCheckbox" /><label for="__wxMap_graticuleCheckbox">Graticule</label><br />						<input type="checkbox" id="__wxMap_gridCheckbox" /><label for="__wxMap_gridCheckbox">Tile Grid</label>					</td>					<td>						<label>Tracing:</label><br />						<select id="__wxMap_tracingModeInput" style="width:55px;height:18px;">							<option value="None">None</option>							<option value="Normal">Normal</option>							<option value="Verbose">Verbose</option>						</select>					</td>					<td>						<label>Move:</label><br />						<input type="text" id="__wxMap_testMoveRate" style="float:left;" value="500" /><span class="button" id="__wxMap_moveButton" title="Move" style="display:inline-block;border-left:none;"><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></span>					</td>					<td style="padding-right:0;width:60px;">					</td>				</tr>			</table>			<div class="Row">				<table class="Diagnostics-Output">					<tr>						<td colspan="2"><strong>Mouse:</strong></td>					</tr>					<tr>						<td>Geo:</td>						<td><input type="text" readonly="true" id="__wxMap_mouseGeo" /></td>					</tr>					<tr>						<td>Screen:</td>						<td><input type="text" readonly="true" id="__wxMap_mouseScreen" /></td>					</tr>					<tr>						<td>Tile:</td>						<td><input type="text" readonly="true" id="__wxMap_mouseTile" /></td>					</tr>					<tr>						<td>QuadKey:</td>						<td><input type="text" readonly="true" id="__wxMap_mouseQuadKey" /></td>					</tr>				</table>				<table class="Diagnostics-Output">					<tr>						<td colspan="2"><strong>Touch:</strong></td>					</tr>					<tr>						<td>Geo:</td>						<td><input type="text" readonly="true" id="__wxMap_touchGeo" /></td>					</tr>					<tr>						<td>Screen:</td>						<td><input type="text" readonly="true" id="__wxMap_touchScreen" /></td>					</tr>					<tr>						<td>Tile:</td>						<td><input type="text" readonly="true" id="__wxMap_touchTile" /></td>					</tr>					<tr>						<td>QuadKey:</td>						<td><input type="text" readonly="true" id="__wxMap_touchQuadKey" /></td>					</tr>				</table>			</div>		</div>	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger"><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" />Layers:</div>		<div class="Content">			<div class="Row">				<span>Active:</span><br />				<table class="Layers">					<tr>						<td rowspan="4">							<div style="height:54px;">								<select id="__wxMap_activeLayersInput" multiple="multiple" style="height:100%;border-right:none;"></select>							</div>						</td>					</tr>					<tr class="TopRow">						<td><span class="button" style="border-bottom:none;height:17px;" title="Arrange Layer Up" id="__wxMap_arrangeLayerUpButton"><img src="http://tessera0.intellicast.com/Images/icon_arrow_up.png" alt="" /></span></td>						<td>&nbsp;</td>						<td><span style="border-bottom:none;height:17px;" id="__wxMap_activeLayersButton" class="button text" title="Hide Layer">Hide</span></td>					</tr>					<tr>						<td><input id="__wxMap_layerIndexInput" type="text" /></td>						<td style="padding-left:14px;"><input style="border-right:none;width:30px;" id="__wxMap_opacityLayerInput" type="text" /></td>						<td><span id="__wxMap_opacityLayerButton" class="button text" title="Layer Opacity Level">Level</span></td>					</tr>					<tr class="BottomRow">						<td><span class="button" title="Arrange Layer Down" id="__wxMap_arrangeLayerDownButton" style="border-top:none;height:17px;"><img src="http://tessera0.intellicast.com/Images/icon_arrow_down.png" alt="" /></span></td>						<td style="padding-left:14px;"><span class="button text" id="__wxMap_styleLayerButton" title="Style Layer" style="border-right:none;border-top:none;height:17px;padding:0;" class="text">Style</span></td>						<td><span id="__wxMap_dataLayerButton" class="button text" style="border-top:none;height:17px;" title="Layer Data">Data</span></td>					</tr>				</table>			</div>			<div class="Row">				<table style="margin-bottom:0;">          <tr>            <td>              <div style="margin-bottom:10px;overflow:hidden;">              <span>Filter:</span><br />              <input type="text" id="__wxMap_inactiveLayersFilterInput" style="float:left;width:203px;height:18px;" />              <span class="button text" id="__wxMap_inactiveLayersFilterClearButton" style="float:right;width:35px;border-left:none;height:18px;line-height:16px;">Clear</span>              <span class="button text" id="__wxMap_inactiveLayersFilterButton" style="float:right;width:35px;border-left:none;height:18px;line-height:16px;">Filter</span>              </div>            </td>          </tr>					<tr>						<td>							<span>Inactive:</span><br />							<select id="__wxMap_inactiveLayersInput" style="float:left;width:242px;">								<option>None</option>							</select>							<span class="button text" id="__wxMap_inactiveLayersButton" style="float:right;width:35px;border-left:none;height:18px;line-height:16px;">Show</span>						</td>					</tr>				</table>			</div>		</div>	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger">Animation:&nbsp;<span style="font-weight:normal;" id="__wxMap_loadingPercentage"></span><img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></div>		<div class="Content">			<div class="Row">				<input id="__wxMap_skipToStartButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_skip_backward_black.png" title="Skip to Start" />									<input id="__wxMap_backwardButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_rewind_black.png" title="Backward" />				<input id="__wxMap_stopButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_stop_black.png" title="Stop" />				<input id="__wxMap_pauseButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_pause_black.png" title="Pause" />				<input id="__wxMap_playButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_play_black.png" title="Play" />				<input id="__wxMap_forwardButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_fastforward_black.png" title="Forward" />				<input id="__wxMap_skipToEndButton" type="image" class="Button" src="http://tessera0.intellicast.com/Images/icon_skip_forward_black.png" title="Skip to End" />				<span style="margin:0 10px;float:left;">					<input id="__wxMap_maximizeRangeButton" type="image" class="Button no-right-border" src="http://tessera0.intellicast.com/Images/icon_maximize_black.png" title="Maximize" />					<input id="__wxMap_minimizeRangeButton" type="image" class="Button" src="http://tessera0.intellicast.com/Images/icon_minimize_black.png" title="Minimize" />				</span>				<label for="__wxMap_slidingCheckbox"><input type="checkbox" id="__wxMap_slidingCheckbox" />Slide</label>				<label for="__wxMap_loopingCheckbox"><input type="checkbox" id="__wxMap_loopingCheckbox" />Loop</label>			</div>			<div class="Row Animation-Output">				<table>					<tr>						<td><label>Count:</label></td>						<td><input type="text" id="__wxMap_frameCountInput" /></td>					</tr>					<tr>						<td><label>Period:</label></td>						<td><input type="text" id="__wxMap_framePeriodInput" style="border-top:none;" /></td>					</tr>				</table>				<table>					<tr>						<td><label>Rate:</label></td>						<td><input type="text" id="__wxMap_frameRateInput" /></td>					</tr>					<tr>						<td><label>Dwell:</label></td>						<td><input type="text" id="__wxMap_frameDwellInput" style="border-top:none;" /></td>					</tr>				</table>				<table style="margin-bottom:0;">					<tr>						<td><label>Start:</label></td>						<td><input type="text" id="__wxMap_startTimeInput" /></td>					</tr>					<tr>						<td><label>End:</label></td>						<td><input type="text" id="__wxMap_endTimeInput" style="border-top:none;" /></td>					</tr>				</table>				<table style="margin-bottom:0;">					<tr>						<td><label>Frame:</label></td>						<td><input type="text" id="__wxMap_currentFrameInput" /></td>					</tr>					<tr>						<td><label>Time:</label></td>						<td><input type="text" id="__wxMap_currentTimeInput" style="border-top:none;" /></td>					</tr>				</table>			</div>		</div>	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger">Parameters:<img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></div>		<div class="Content">				<div class="Row Parameters-Output">				<table>					<tr>						<td colspan="2"><strong>Startup:</strong></td>					</tr>					<tr>						<td>Zoom:</td>						<td><input type="text" id="__wxMap_initZoom" /></td>					</tr>					<tr>						<td>Longitude:</td>						<td><input type="text" id="__wxMap_initLongitude" style="border-top:none;" /></td>					</tr>					<tr>						<td>Latitude:</td>						<td><input type="text" id="__wxMap_initLatitude" style="border-top:none;" /></td>					</tr>				</table>				<table>					<tr>						<td colspan="2"><strong>&nbsp;</strong></td>					</tr>					<tr>						<td>Basemap:</td>						<td><input type="text" id="__wxMap_initBasemap" /></td>					</tr>					<tr>						<td>Layers:</td>						<td><input type="text" id="__wxMap_initLayers" style="border-top:none;" /></td>					</tr>					<tr>						<td>Opacity:</td>						<td><input type="text" id="__wxMap_initOpacity" style="border-top:none;" /></td>					</tr>				</table>			</div>			<div class="Row Parameters-Output">				<table>					<tr>						<td colspan="4"><strong>Persist:</strong></td>					</tr>					<tr>						<td>Zoom:</td>						<td><input type="checkbox" id="__wxMap_persistZoom" /></td>						<td style="padding-left:8px;">Basemap:</td>						<td><input type="checkbox" id="__wxMap_persistBasemap" /></td>					</tr>					<tr>						<td>Location:</td>						<td><input type="checkbox" id="__wxMap_persistLocation" style="border-top:none;" /></td>						<td style="padding-left:8px;">Layers:</td>						<td><input type="checkbox" id="__wxMap_persistLayers" /></td>					</tr>					<tr>						<td>Animator:</td>						<td><input type="checkbox" id="__wxMap_persistAnimator" style="border-top:none;" /></td>						<td style="padding-left:8px;">Opacity:</td>						<td><input type="checkbox" id="__wxMap_persistOpacity" /></td>					</tr>				</table>				<table>					<tr>						<td colspan="2"><strong>Page:</strong></td>					</tr>					<tr>						<td style="width:48px;">Script Id:</td>						<td><input type="text" id="__wxMap_paramScriptId" readonly="true" /></td>					</tr>					<tr>						<td>Callback:</td>						<td><input type="text" id="__wxMap_paramCallback" readonly="true" style="border-top:none;" /></td>					</tr>					<tr>						<td>&nbsp;</td>						<td><span class="button text" style="width:81px;border-top:none;" id="__wxMap_paramAlternateHtml" title="Alternate HTML">Alternate HTML</span></td>					</tr>				</table>			</div>			<div class="Row">				<strong>Arguments:</strong><br/>				<textarea id="__wxMap_paramArguments" style="resize:none;width:276px;height:60px;padding:0;margin:0;display:block;overflow:auto;"></textarea>			</div>			<div class="Row" style="margin-top:10px;">				<span class="button text" style="width:81px;float:right;" id="__wxMap_paramRefresh" title="Refresh">Refresh</span>				<span class="button text" style="width:81px;" id="__wxMap_paramClear" title="Clear">Clear</span>			</div>		</div>	</div>	<div class="Section">		<div class="Chrome Collapse-Trigger">Output:<img src="http://tessera0.intellicast.com/Images/icon_play_black.png" alt="" /></div>		<div class="Content">			<div>				<strong>Events:</strong><br />				<div id="__wxMap_eventsList"></div>			</div>			<div style="margin-top:10px;">				<strong>Tracing:</strong><br />				<div id="__wxMap_traceList"></div>			</div>		</div>	</div></div>';return a}a.Markup=b}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){function b(){var a="#__wxMapProfiler {width:298px;white-space:nowrap;overflow:hidden;border:solid 1px #aaa;position:relative;}#__wxMapProfiler .InfoSection table{clear:left;}#__wxMapProfiler div,#__wxMapProfiler td,#__wxMapProfiler p,#__wxMapProfiler a,#__wxMapProfiler li,#__wxMapProfiler input,#__wxMapProfiler select,#__wxMapProfiler textarea{font:normal 11px/16px Tahoma, Verdana, Arial, Helvetica, Sans-Serif;color:#000;}#__wxMapProfiler ul,#__wxMapProfiler li {margin:0;padding:0;}#__wxMapProfiler select, #__wxMapProfiler input[type=text] {border:#AAA solid 1px;font-size:10px;padding:0;margin:0;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0;-o-border-radius:0;}#__wxMapProfiler input[type=text]{height:16px;line-height:14px;width:42px;display:block;padding-left:1px;}#__wxMapProfiler select{height:20px;width:180px;}#__wxMapProfiler a,#__wxMapProfiler a:visited,#__wxMapProfiler a:active { text-decoration: none; color: #000; }#__wxMapProfiler table,#__wxMapProfiler img{border:none;margin:0;padding:0;}#__wxMapProfiler table{border-collapse:collapse;float:left;margin:0 0 10px 0;padding:0;border:none;}#__wxMapProfiler tr{word-break:break-all;padding:0;margin:0;border:none;}#__wxMapProfiler td{empty-cells:show;padding:0;margin:0;vertical-align:top;border:none;}#__wxMapProfiler .button {padding:0;margin:0;display:block;background-color:#ebebeb;border:solid 1px #aaa;line-height:16px;font-size:11px;height:16px;width:16px;cursor:pointer;text-align:center;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none;-ms-user-select:none;user-select:none;}#__wxMapProfiler .button.text {width:100%;font-size:10px;line-height:16px;}#__wxMapProfiler .button img {display:inline-block;height:8px;}#__wxMapProfiler .Button {border:solid 1px #AAA;cursor:pointer;color:black;background-color:#EBEBEB;font-size:11px;padding:5px;display:block;margin:0;float:left;border-radius:0;-webkit-border-radius:0;-moz-border-radius:0;-o-border-radius:0;}#__wxMapProfiler input.Button[type=image]{height:8px;padding:4px 5px;}#__wxMapProfiler input[type=checkbox]{margin:0 5px 0 0;}#__wxMapProfiler input[type=radio]{margin:0 5px;}#__wxMapProfiler .Chrome{line-height:25px;background:#EBEBEB 0 repeat-x;height:25px;padding:0 10px;}#__wxMapProfiler .Chrome * {line-height:25px;}#__wxMapProfiler .Section > .Chrome{line-height:17px;height:17px;}#__wxMapProfiler .Section > .Chrome * {line-height:17px;}#__wxMapProfiler .Section {border-top:solid 1px #aaa;clear:both;}#__wxMapProfiler .Collapse-Trigger {font-weight:bold;display:block;cursor:pointer;position:relative;}#__wxMapProfiler .Collapse-Trigger img {position:absolute;right:10px;top:4px;display:block;height:9px;transform:rotate(90deg);-ms-transform:rotate(90deg);-moz-transform:rotate(90deg);-webkit-transform:rotate(90deg);-o-transform:rotate(90deg);}#__wxMapProfiler .Collapse-Trigger.Collapsed img {transform:rotate(180deg);-ms-transform:rotate(180deg);-moz-transform:rotate(180deg);-webkit-transform:rotate(180deg);-o-transform:rotate(180deg);}#__wxMapProfiler .Content {padding:10px;width:278px;float:left;}#__wxMapProfiler .Row {width:100%;float:left;}#__wxMapProfiler .Row > div,#__wxMapProfiler .Row > table {float:left;}#__wxMapProfiler .no-float {float:none !important;}#__wxMapProfiler .no-right-border {border-right:none !important;}#__wxMapProfiler .BoundingBox {position:relative;width:156px;height:87px;}#__wxMapProfiler .BoundingBox:before{content:url(http://images.intellicast.com/App_Images/WxMap/boundingbox_left.gif);display:block;position:absolute;left:0;top:0;z-index:1;}#__wxMapProfiler .BoundingBox:after{content:url(http://images.intellicast.com/App_Images/WxMap/boundingbox_right.gif);display:block;position:absolute;right:0;top:0;z-index:1;}#__wxMapProfiler .BoundingBox input[type=text] {display:block;padding:0;margin:0;}#__wxMapProfiler .BoundingBox table {position:absolute;top:18px;left:55px;margin:0;}#__wxMapProfiler .BoundingBox > input[type=text] {border:none;background-color:#fff;position:absolute;text-align:center;width:45px;height:12px;font-size:10px;z-index:2;}#__wxMapProfiler .BoundingBox .button {position:relative;overflow:hidden;}#__wxMapProfiler .BoundingBox .pan_n { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_up.png) no-repeat center center; }#__wxMapProfiler .BoundingBox .pan_e { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_right.png) no-repeat center center; }#__wxMapProfiler .BoundingBox .pan_s { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_down.png) no-repeat center center; }#__wxMapProfiler .BoundingBox .pan_w { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_left.png) no-repeat center center; }#__wxMapProfiler .BoundingBox .pan_ne:before,#__wxMapProfiler .BoundingBox .pan_se:before,#__wxMapProfiler .BoundingBox .pan_sw:before,#__wxMapProfiler .BoundingBox .pan_nw:before {content:'';position:absolute;width:100%;height:100%;top:0;left:0;}#__wxMapProfiler .BoundingBox .pan_ne:before { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_up.png) no-repeat center center;transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-o-transform:rotate(45deg); }#__wxMapProfiler .BoundingBox .pan_se:before { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_down.png) no-repeat center center;transform:rotate(315deg);-ms-transform:rotate(315deg);-moz-transform:rotate(315deg);-webkit-transform:rotate(315deg);-o-transform:rotate(315deg); }#__wxMapProfiler .BoundingBox .pan_sw:before { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_down.png) no-repeat center center;transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-o-transform:rotate(45deg); }#__wxMapProfiler .BoundingBox .pan_nw:before { background:#EBEBEB url(http://tessera1.intellicast.com/Images/icon_arrow_up.png) no-repeat center center;transform:rotate(315deg);-ms-transform:rotate(315deg);-moz-transform:rotate(315deg);-webkit-transform:rotate(315deg);-o-transform:rotate(315deg); }#__wxMap_viewportNorth {top:0;left:58px;}#__wxMap_viewportEast {top:38px;right:0;}#__wxMap_viewportSouth {bottom:0;left:58px;}#__wxMap_viewportWest {top:38px;left:0;}#__wxMapProfiler .Viewport-Output {width:112px;}#__wxMapProfiler .Viewport-Output * {line-height:15px;}#__wxMapProfiler .Viewport-Output ul,#__wxMapProfiler .Viewport-Output li {clear:both;float:none;width:112px;overflow:hidden;list-style:none;}#__wxMapProfiler .Viewport-Output ul:first-of-type {margin-bottom:10px;}#__wxMapProfiler .Viewport-Output label {float:left;width:50px;}#__wxMapProfiler .Viewport-Output input{float:left;width:60px;background-color:#fff;}#__wxMapProfiler .Diagnostics-Input {margin-right:0;width:100%;}#__wxMapProfiler .Diagnostics-Input td {padding-right:10px;vertical-align:bottom;}#__wxMapProfiler .Diagnostics-Input input[type=text] {width:44px;}#__wxMapProfiler .Diagnostics-Output {width:139px;margin:0;}#__wxMapProfiler .Diagnostics-Output td {vertical-align:bottom;line-height:14px;}#__wxMapProfiler .Diagnostics-Output input {border:none;width:74px;line-height:14px;height:14px;}#__wxMapProfiler .Layers {height:48px;}#__wxMapProfiler .Layers input[type=text]{width:16px;height:16px;padding:0;margin:0;display:block;text-align:center;}#__wxMapProfiler .Layers .TopRow button {border-bottom:none !important;}#__wxMapProfiler .Layers .BottomRow button {border-top:none !important;}#__wxMapProfiler .Layers td {vertical-align:top;padding:0;margin:0;border:none;}#__wxMapProfiler .Layers .button.text {padding:0 2px;}#__wxMapProfiler .Animation-Output {margin-top:10px;}#__wxMapProfiler .Animation-Output table {width:134px;}#__wxMapProfiler .Animation-Output table:nth-child(2n) {margin-left:10px;}#__wxMapProfiler .Animation-Output label {display:block;width:40px;}#__wxMapProfiler .Animation-Output input[type=text] {width:90px;}#__wxMapProfiler .Parameters-Output table {/*width:134px;*/}#__wxMapProfiler .Parameters-Output table:nth-child(2n) {margin-left:10px;}#__wxMapProfiler .Parameters-Output td {vertical-align:bottom;line-height:14px;}#__wxMapProfiler .Parameters-Output input[type=text] {width:80px;line-height:14px;height:14px;}#__wxMapProfiler .Parameters-Output input[type=checkbox] {width:16px;margin:0;padding:0;}#__wxMapProfiler .Message-List {margin:0 10px;padding:0 5px;}#__wxMapProfiler .Message-List li {list-style-type:square;}#__wxMap_toggleControls {float:right;}#__wxMap_Loading {visibility:hidden;}#__wxMap_overlay {visibility:hidden;display:block;position:absolute;background:rgba(235, 235, 235, .5);top: 25px;left: 0;bottom: 0;right: 0;z-index:1000;}#__wxMap_modalStyle {visibility:hidden;display:block;position:absolute;background:rgba(235, 235, 235, .5);top: 25px;left: 0;bottom: 0;right: 0;z-index:1000;}#__wxMap_modalData {visibility:hidden;display:block;position:absolute;background:rgba(235, 235, 235, .5);top:25px;left:0;bottom:0;right:0;z-index:1000;}#__wxMap_eventsList {white-space:normal;}#__wxMap_traceList {white-space:normal;}";return a}a.Style=b}(b=a.Profiler||(a.Profiler={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){
var b=function(){function a(a,b,c){this.html=a,this.feature=b,this.layerId=c}return a}();a.Tooltip=b}(b=a.Style||(a.Style={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function b(){this._tense="pastId",this.Zones={0:0,1:1,2:2,3:3},this._$=new a.wxQuery}return b.prototype.toggleMenu=function(){},b.prototype.cleanUp=function(){},b.prototype.render=function(a){},b.prototype.enableItem=function(a){var b=a.menuItem,c=this._$.g("#m"+b.id);c.addClass("on")},b.prototype.disableItem=function(a){var b=a.menuItem,c=this._$.g("#m"+b.id);c.removeClass("on")},b.prototype.menuContainer=function(a){return this._$.m("ul")},b.prototype.menuItem=function(a,b){var c="single"===b.mode.toLowerCase()?!0:!1,d=c?"radio":"checkbox",e=this._$.m("li",{"class":"__wxMap_input __wxMap_"+d});return e.append(this._$.m("input",{type:d,name:b.label.replace(" ",""),id:"__wxMap_menu_"+a.label.toLowerCase().replace(" ","_"),value:a.label.toLowerCase().replace(" ","_")})),e.append(this._$.m("label",{"for":"__wxMap_menu_"+a.label.toLowerCase().replace(" ","_")},a.label)),e},b.prototype.onTimeModeChanged=function(a){this._template.map.updateMenuItemTense(a.newMode)},b.prototype.checkForMenuItems=function(){var a=this._template.args;if(a.menuItems)for(var b=a.menuItems.split(","),c=0,d=b.length;d>c;c++)this._template.map.enableMenuItem(b[c])},b}();a.MenuView=b}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){var e=this;this._isSmallScreen=!1,this._isEnabled=!1,this._layerId="0789",this._loadingImageId="__wxMap_loadingImage",this._loadingImage="http://tessera0.intellicast.com/Assets/Icons/loader_black.gif",this._pollingFunctionId=0,this._isImagePolling=!1,this._isValidImage=!0,this._noContentElementId="__wxMap_noImageId",this._noContentElement=null,this._wireTooltipOpened=function(a,b){e.onTooltipOpened(a,b)},this._wireTooltipClosed=function(a,b){e.onTooltipClosed(a,b)},this._layerId=a,this._uiElementId=b,this._map=c,this._imageId=d,this.load()}return a.prototype.getLayerId=function(){return this._layerId},a.prototype.load=function(){this.registerEvents(),this.createNoImageElement(),this._map.view.getHeight()<500&&this._map.view.getWidth()<500&&(this._isSmallScreen=!0)},a.prototype.registerEvents=function(){var a=this;this._map.view.tooltipOpened.addListener(this,this._wireTooltipOpened),this._map.view.tooltipClosed.addListener(this,this._wireTooltipClosed),this._map.view.getMap().on("popupopen",function(b){var c=a;c.onLeafletPopupOpened()})},a.prototype.unRegisterEvents=function(){this._map.view.loading.removeListener(this._wireTooltipOpened),this._map.view.loading.removeListener(this._wireTooltipClosed)},a.prototype.refreshImage=function(){var a=document.getElementById(this._imageId),b=a.attributes.src.value,c=(a.clientHeight,a.clientWidth),d=new Image;d.id=this._loadingImageId,d.src=this._loadingImage,d.style.position="absolute",d.style.top=c/2+"px",d.style.left=c/2+"px",a.parentNode.insertBefore(d);var e=this;a.onload=function(){e.displayImage(a)},a.onerror=function(){e.displayNoImageMessage(this)},a.onabort=function(){e.displayNoImageMessage(this)},-1!=b.indexOf("?t=")&&this._isValidImage&&(b=b.substring(0,b.indexOf("?t="))),a.attributes.src.value=b+"?t="+(new Date).getTime()},a.prototype.displayImage=function(a){this._isValidImage=!0,a.style.padding="0px",this._noContentElement.style.display="none",document.getElementById(this._noContentElementId)&&a.parentNode.removeChild(this._noContentElement),a.style.display="inline";var b=document.getElementById(this._loadingImageId);a.parentElement.removeChild(b)},a.prototype.displayNoImageMessage=function(a){this._isValidImage=!1,a.style.padding="0px",a.style.display="none",a.parentNode.appendChild(this._noContentElement),this._noContentElement.style.display="block";var b=document.getElementById(this._loadingImageId);a.parentElement.removeChild(b)},a.prototype.createNoImageElement=function(){var a=document.createElement("div");a.innerHTML="No Image Available",a.setAttribute("id",this._noContentElementId),a.setAttribute("style","font-size:12px;font-family:Tahoma;background-color:black;color:white;padding:25%;display:none;"),this._noContentElement=a},a.prototype.startImagePolling=function(){this._pollingFunctionId=setInterval(this.refreshImage.bind(this),15e3),this._isImagePolling=!0},a.prototype.stopImagePolling=function(){clearInterval(this._pollingFunctionId),this._isImagePolling=!1},a.prototype.showMapControls=function(){var a=document.getElementById(this._map.view.getControl().getId());a.style.zIndex="0";var b=document.getElementById("__wxMap_Cntrls");b.style.zIndex="1002"},a.prototype.hideMapControls=function(){var a=document.getElementById(this._map.view.getControl().getId());a.style.zIndex="1005";var b=document.getElementById("__wxMap_Cntrls");b.style.zIndex="0"},a.prototype.enable=function(){this._isEnabled=!0,this._map.view.setTooltipLimit(1),this.registerEvents()},a.prototype.disable=function(){this._isEnabled=!1,this.stopImagePolling(),this._map.view.setTooltipLimit(null),this.unRegisterEvents()},a.prototype.addPopupStyle=function(){this._map.view.setTooltipTitle(""),this._map.view.setTooltipBorderRadius("0px"),this._map.view.setTooltipPadding("0px"),this._map.view.setTooltipBackground("#7f7f7f");var a=document.getElementById("crosshair");a.style.display="none";var b="#"+this._uiElementId+" .leaflet-popup-tip-container { margin-top:-1px; }";this._map.view.getControl().injectCss(b);var c=document.querySelector(".leaflet-popup-content");c.firstChild.firstChild.style.maxHeight="none"},a.prototype.removePopupStyle=function(){var a=document.getElementById("crosshair");a.style.display="block";var b="#"+this._uiElementId+" .leaflet-popup-tip-container { margin-top:0px; }";this._map.view.getControl().injectCss(b)},a.prototype.onTooltipOpened=function(a,b){this._map.view.getTooltipLayerId()==this._layerId&&(this.addPopupStyle(),this._isImagePolling||this.startImagePolling())},a.prototype.onTooltipClosed=function(a,b){this._map.view.getTooltipLayerId()==this._layerId&&(this.removePopupStyle(),this._isImagePolling&&this.stopImagePolling())},a.prototype.onLeafletPopupOpened=function(){this._map.view.getTooltipLayerId()==this._layerId?(this.addPopupStyle(),this._isImagePolling||this.startImagePolling()):this._isSmallScreen},a}();a.TrafficCam=b}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(WxMap){var UI;!function(UI){var wxQuery=function(){function wxQuery(){this.defaultUI=document.querySelectorAll("body")[0],this._proto={html:function(a){this.innerHTML=a},attr:function(a,b){return b?void this.setAttribute(a,b):this.getAttribute(a)},append:function(a){this.appendChild(a)},css:function(a,b){return void 0===b&&(b=null),null!==b&&(this.style[a]=b),this.ownerDocument.defaultView.getComputedStyle(this,null).getPropertyValue(a)},prop:function(a){return getComputedStyle(this).getPropertyValue(a)},hide:function(){this.style.display="none"},show:function(){this.style.display="block"},hasClass:function(a){var b=!1;return b=this.classList?this.classList.contains(a):new RegExp("(^| )"+a+"( |$)","gi").test(this.className)},addClass:function(a){this.classList?this.classList.add(a):this.className+=" "+a},removeClass:function(a){void 0===a&&(this.className=" "),this.classList?this.classList.remove(a):this.className=this.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")},closest:function(a){if(null===this)return!1;var b;if("."===a[0]&&(b=a.slice(1),-1!==this.className.indexOf(b)))return this;if("#"===a[0]&&(b=a.slice(1),this.getAttribute("id")===b))return this;if(this.nodeName.toLowerCase()===a.toLowerCase())return this;var c=this.parentNode;return this.closest(c,a)}}}return wxQuery.prototype.extend=function(a,b){for(var c in b)a[c]=b[c];return a},wxQuery.prototype.m=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];for(var c,d={}.toString,e=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,f="[object Object]"==d.call(a[1]),g=f?a[1]:{},h=f?a[2]||"":a[1]||"",i=[],j="div";i=e.exec(a[0]);)""===i[1]?j=i[2]:"#"===i[1]&&(g.id=i[2]);c=document.createElement(j);for(var k in g)c.setAttribute(k,g[k]);return c.innerHTML=h,c=this.extend(c,this._proto)},wxQuery.prototype.g=function(a,b){for(var c=b||this.defaultUI,d=c.querySelectorAll(a),e=0;e<d.length;e++)d[e]=this.extend(d[e],this._proto);return 0===d.length?null:1===d.length?d[0]:d},wxQuery.prototype.addClass=function(a,b){a.classList?a.classList.add(b):a.className+=" "+b},wxQuery.prototype.html=function(a,b){a.innerHTML=b},wxQuery.prototype.attr=function(a,b,c){return c?void a.setAttribute(b,c):a.getAttribute(b)},wxQuery.prototype.prop=function(a,b){return getComputedStyle(a).getPropertyValue(b)},wxQuery.prototype.prepend=function(a,b){a.parentNode.insertBefore(b,a)},wxQuery.prototype.removeClass=function(a,b){return void 0===b?void(a.className=""):void(a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))},wxQuery.prototype.toggleClass=function(a,b){if(a.classList)a.classList.toggle(b);else{for(var c=a.className.split(" "),d=-1,e=c.length;e--;)c[e]===b&&(d=e);d>=0?c.splice(d,1):c.push(b),a.className=c.join(" ")}},wxQuery.prototype.hide=function(a){a.style.display="none"},wxQuery.prototype.show=function(a){a.style.display="block"},wxQuery.prototype.ajax=function(cfg){var request=new XMLHttpRequest,data,callBackName="__wxMap"+"xxxxxx_xxxxxx4xxxyx_xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)}),url;if("jsonp"===cfg.dataType){if(window[callBackName]=function(){arguments[0];cfg.success(arguments[0])},url=cfg.url,null!=cfg.data&&"object"==typeof cfg.data){url+="?q=";for(var k in cfg.data)url+="&"+k+"="+cfg.data[k];url+="&"}else url+=null!==cfg.data?"?"+cfg.data+"&":"?";url+="callback="+callBackName,request.open("GET",url,!0),request.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?eval(this.responseText):cfg.error())},request.send(),request=null}if("json"===cfg.dataType)try{request.open("GET",cfg.url,!0),request.onload=function(){request.status>=200&&request.status<400?(data=JSON.parse(request.responseText),cfg.success(data)):cfg.error()},request.onerror=function(){cfg.error()},request.send()}catch(e){throw new Error(e)}},wxQuery}();UI.wxQuery=wxQuery}(UI=WxMap.UI||(WxMap.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c=function(){function b(a){var b=this;this._hasWsiLayers=!1,this._hasBingLayers=!1,this._hasMapboxLayers=!1,this._isMapboxAttributionCreated=!1,this._isAttributionOn=!1,this._mapAttributionElementId="__wxMap_mapAttribution",this._mapAttributionImgElementId="__wxMap_mapAttributionImg",this._wireLayerAdded=function(a,c){b.onLayerAdded(a,c)},this._wireLayerRemoved=function(a,c){b.onLayerRemoved(a,c)},this._map=a,this._settings=a.settings,this.createMapAttributionElement(),this.load()}return b.prototype.getMapAttributionElement=function(){return this._mapAttributionElement},b.prototype.getHasWsiLayers=function(){return this._hasWsiLayers},b.prototype.getHasBingLayers=function(){return this._hasBingLayers},b.prototype.getHasMapboxLayers=function(){return this._hasMapboxLayers},b.prototype.determineWsiLayers=function(){for(var a in this._settings.layers){var a=this._settings.layers[a];if(a.isBasemap&&"wsi"==a.hostId){this._hasWsiLayers=!0;break}}},b.prototype.determineBingLayers=function(){for(var a in this._settings.layers){var a=this._settings.layers[a];if("bing"==a.hostId){this._hasBingLayers=!0;break}}},b.prototype.determineMapboxLayers=function(){for(var a in this._settings.layers){var a=this._settings.layers[a];if("bing"==a.hostId){this._hasMapboxLayers=!0;break}}},b.prototype.registerEvents=function(){this._map.view.layerAdded.addListener(this,this._wireLayerAdded),this._map.view.layerRemoved.addListener(this,this._wireLayerRemoved)},b.prototype.unRegisterEvents=function(){this._map.view.layerAdded.removeListener(this._wireLayerAdded),this._map.view.layerRemoved.removeListener(this._wireLayerRemoved)},b.prototype.createMapAttributionElement=function(){this._mapAttributionElement=document.createElement("div"),this._mapAttributionElement.setAttribute("id",this._mapAttributionElementId),this._mapAttributionElement.style.position="absolute",this._mapAttributionElement.style.zIndex="1001",this._mapAttributionElement.style.height="0",this._mapAttributionElement.style.left="10px",this._mapAttributionElement.style.bottom="35px",this._mapAttributionElement.style.overflow="visible",this._mapAttributionElement.style.display="none",this._mapAttributionImgElement=document.createElement("img"),this._mapAttributionImgElement.setAttribute("id",this._mapAttributionImgElementId),this._mapAttributionImgElement.style.verticalAlign="middle",this._mapAttributionImgElement.style.marginRight="7px",this._mapAttributionElement.appendChild(this._mapAttributionImgElement);var a=document.getElementById("__wxMap_maptainer");a.appendChild(this._mapAttributionElement)},b.prototype.addMapAttribution=function(a){this._mapAttributionImgElement.setAttribute("src",a),this.showMapAttribution()},b.prototype.addMapboxAttribution=function(){if(!this._isMapboxAttributionCreated){var a=this.createMapboxAttributionElement();this._mapAttributionElement.appendChild(a)}this.showMapAttribution()},b.prototype.showMapAttribution=function(){this._mapAttributionElement.style.display="inline",this._isAttributionOn=!0},b.prototype.removeMapAttribution=function(){this._mapAttributionElement.style.display="none",this._isAttributionOn=!1},b.prototype.determineMapAttribution=function(){for(var a in this._map.view.getLayers()){var b=this._settings.layers[a];this._isAttributionOn||(b.isBasemap&&"bing"==b.hostId?this.addMapboxAttribution():b.attributionSource&&this.addMapAttribution(b.attributionSource))}},b.prototype.createWsiAttribution=function(){var b=new a.StringBuilder;return b.append("<div id='__wxMap_openStreetMapAttribution'>"),b.append("Map data(c) OpenStreetMap contributors, CC - BY -SA.<br />"),b.append("Canadian radar data provided by Environment Canada."),b.append("</div>"),b.toString()},b.prototype.createBingAttribution=function(){var b=new a.StringBuilder;return b.append("<div id='_wxMap_bingFooter' style='margin-top:5px;background-color:black;color:white;padding:5px 2px 5px 5px;font-size:11px;vertical-align:middle;'>"),b.append("<img src='http://images.intellicast.com/App_Images/WxMap/bing_logo_white_50x19.png' style='margin-right:7px;vertical-align:middle;' />"),b.append("<span style='font-size:11px;float:right;margin-right:1px;height:20px;line-height:20px'>"),b.append("<a style='color:white;font-size:11px;' href='http://www.microsoft.com/maps/assets/docs/terms.aspx' target='_blank'>Terms</a>"),b.append(", "),b.append("<a style='color:white;font-size:11px;' href='http://privacy.microsoft.com/en-us/default.mspx' target='_blank'>Privacy</a>"),b.append(", "),b.append("<a style='color:white;font-size:11px;' href='http://tessera.intellicast.com/content/BingDataProviders.aspx"),b.append("?zoom=").append(this._map.view.getZoomLevel()),b.append("&lat=").append(this._map.view.getGeoCenter().latitude.getDegrees()),b.append("&lon=").append(this._map.view.getGeoCenter().longitude.getDegrees()),b.append("' target='_blank'>Map Data</a>"),b.append("</span>"),b.append("</div>"),b.toString()},b.prototype.createMapboxAttributionElement=function(){var b=document.createElement("div");b.id="__wxmap_mapboxAttribution",b.style.padding="2px 5px",b.style.backgroundColor="rgba(255,255,255,.7)",b.style.fontWeight="400",b.style.fontSize="12px",b.style.lineHeight="20px",b.style.fontFamily="Helvetica Neue,Arial,Helvetica,sans-serif !important",b.style.position="relative",b.style.bottom="7px",b.style.right="10px",b.style.whiteSpace="nowrap";var c=new a.StringBuilder;return c.append("<a href='//www.mapbox.com/about/maps/' target='_blank' style='color:rgb(64,64,64);text-decoration:none;'>&copy; Mapbox</a>&nbsp;"),c.append("<a href='//www.openstreetmap.org/copyright' target='_blank' style='color:rgb(64,64,64);text-decoration:none;'>&copy; OpenStreetMap</a>&nbsp;|&nbsp;"),c.append("<a href='//www.mapbox.com/map-feedback/' target='_blank' style='color:rgb(64,64,64);text-decoration:none;'>Improve this map</a>"),b.innerHTML=c.toString(),this._isMapboxAttributionCreated=!0,b},b.prototype.initializeMapAttribution=function(){this.determineMapAttribution()},b.prototype.load=function(){this.registerEvents(),this.determineWsiLayers(),this.determineMapboxLayers(),this.determineMapAttribution()},b.prototype.onLayerAdded=function(a,b){var c=b.id,d=this._map.view.getLayers(),e=d[c],f=this._settings.layers[c];this._isAttributionOn||(e.info.isBasemap&&"bing"==f.hostId?this.addMapboxAttribution():e.info.attributionSource&&this.addMapAttribution(e.info.attributionSource))},b.prototype.onLayerRemoved=function(a,b){var c=b.id,d=this._settings.layers[c],e=this._settings.layers[c];this._isAttributionOn&&(d.attributionSource||d.info.isBasemap&&"bing"==e.hostId)&&this.removeMapAttribution()},b}();b.AttributionController=c}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(c){var d=function(c){function d(a){var d=this;c.call(this),this._menuOpen=!1,this._toggleMenu=function(a){d.toggleMenu()},this._closeLayersMenu=function(a){d.closeLayersMenu()},this._selectMenuItem=function(a){d.selectMenuItem(a)},this._template=a,this.$=new b.wxQuery,this._container=this.$.g("#"+a.uiElementId+"_layersDialog"),this._toggleButton=this.$.g("#"+a.uiElementId+"_btnLayers"),this._closeBtn=this.$.g(".closeBtn",this._container),this.register(),this.render(a.initSettings.menu)}return __extends(d,c),d.prototype.inject=function(a,b){},d.prototype.render=function(b){if(b)for(var c=this.$.g(".content",this._container),d=0;d<b.trees.length;d++){var e=b.trees[d],f=this.menuContainer(e.label.toLowerCase()+"_container"),g=e.children;if(g)for(var h=0;h<g.length;h++){var i=this.menuItem(g[h]);a.addEventListener(i,"click",this._selectMenuItem),f.append(i)}var j=this.$.m("h5",e.label);d>0&&c.append(j),c.append(f)}},d.prototype.menuContainer=function(a){return this.$.m("ul",{"class":"iconContainer",id:a})},d.prototype.menuItem=function(a){var b=a.id,c=this.$.m("li",{id:"m"+b,"class":"layerOption",style:"list-style-type: none; background: url("+a.icon+") 50% 12% no-repeat"},a.label);return c},d.prototype.selectMenuItem=function(a){var b=a.target,c=b.id.substr(1);b.hasClass("on")?this._template.map.disableMenuItem(c):this._template.map.enableMenuItem(c)},d.prototype.openLayersMenu=function(){this._container.show(),this._template.opacityControls.setPosition(),this._menuOpen=!0},d.prototype.closeLayersMenu=function(){this._container.hide(),this._menuOpen=!1},d.prototype.toggleMenu=function(){this._menuOpen?this.closeLayersMenu():this.openLayersMenu()},d.prototype.register=function(){a.addEventListener(this._toggleButton,"click",this._toggleMenu),a.addEventListener(this._closeBtn,"click",this._closeLayersMenu)},d}(b.MenuView);c.AdaptiveMenuView=d}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a){var b=this;this._fullScreenClick=function(a){b.onFullScreenToggle()},this._template=a,this.$=a.$,this._mapElement=this._template.uiElement,this.isSupported()&&this.initialize()}return b.prototype.isSupported=function(){var a=!1;return(this._mapElement.requestFullscreen||this._mapElement.msRequestFullscreen||this._mapElement.mozRequestFullScreen||this._mapElement.webkitRequestFullscreen)&&(a=!0),a},b.prototype.initialize=function(){this._btn=this._template.$.g("#fullScreenBtn"),this._template.args.standalone&&"true"==this._template.args.standalone.toLowerCase()&&(window.frameElement.allowFullscreen=!0),this.registerEvents(),this.render()},b.prototype.render=function(){this._btn.style.display="block"},b.prototype.registerEvents=function(){a.addEventListener(this._btn,"click",this._fullScreenClick)},b.prototype.onFullScreenToggle=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?this.exitFullScreenMode():this.enterFullScreenMode()},b.prototype.enterFullScreenMode=function(){this._mapElement.requestFullscreen?this._mapElement.requestFullscreen():this._mapElement.webkitRequestFullscreen?this._mapElement.webkitRequestFullscreen():this._mapElement.mozRequestFullScreen?this._mapElement.mozRequestFullScreen():this._mapElement.msRequestFullscreen&&this._mapElement.msRequestFullscreen()},b.prototype.exitFullScreenMode=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},b}();b.FullScreenControl=c}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this._layerConfig={LR:{key:"LR",id:"0140",futureId:null,type:"layer",icon:"LayerIconRadar.png",label:"Local Radar",state:""},"0783":{key:"0783",id:"0783",futureId:"0067",type:"layer",icon:"LayerIconRadar.png",label:"Radar<br />(Precipitation)",state:""},R__S:{key:"R__S",id:"0783 0784",futureId:"0067 0034",type:"layer",icon:"LayerIconsSatRad.png",label:"Radar/<br />Satellite",state:""},"0784":{key:"0784",id:"0784",futureId:"0034",type:"layer",icon:"LayerIconSatellite.png",label:"Satellite",state:""},"0055":{key:"0055",id:"0055",futureId:"0062",type:"layer",icon:"LayerIconsTemperature.png",label:"Temperature",state:""},"0059":{key:"0059",id:"0059",futureId:"0035",type:"layer",icon:"LayerIconsWindSpeed.png",label:"Wind Speed",state:""},"0052":{key:"0052",id:"0052",futureId:null,type:"layer",icon:"LayerIconsRoadWx.png",label:"Road<br />Weather",state:""},"0053":{key:"0053",id:"0053",futureId:null,type:"layer",icon:"LayerIconsSnowCover.png",label:"Snow Cover",state:""},"0056":{key:"0056",id:"0056",futureId:null,type:"layer",icon:"LayerIconsWildfireIndex.png",label:"Wildfire<br /> Index",state:""},"0144":{key:"0144",id:"0144",futureId:null,type:"overlay",icon:"OverlayIconsStormTracks.png",label:"Storm Tracks",state:""},"0119":{key:"0119",id:"0119",futureId:null,type:"overlay",icon:"OverlayIconsCurrentConditions.png",label:"Current<br />Conditions",state:""},"0120":{key:"0120",id:"0120",futureId:null,type:"overlay",icon:"OverlayIconsTempPlots.png",label:"Temperature<br />Plots",state:""},"0117":{key:"0117",id:"0117",futureId:null,type:"overlay",icon:"OverlayIconsEarthQuake.png",label:"Earthquakes",state:""},"0115":{key:"0115",id:"0115",futureId:null,type:"overlay",icon:"OverlayIconsWildfireDetection.png",label:"Wildfire<br />Detection",state:""},"0118":{key:"0118",id:"0118",futureId:null,type:"overlay",icon:"OverlayIconsLightning.png",label:"Lightning<br />Summary",state:""},"0112":{key:"0112",id:"0112",futureId:null,type:"overlay",icon:"OverlayIconsActiveTropTracks.png",label:"Active<br />Tropical Track",state:""},"0113":{key:"0113",id:"0113",futureId:null,type:"overlay",icon:"OverlayIconsActiveModelTracks.png",label:"Active<br />Model Track",state:""},"0123":{key:"0123",id:"0123",futureId:null,type:"alert",icon:"AlertSevere.png",label:"Tornado/<br />Severe Storms",state:""},"0124":{key:"0124",id:"0124",futureId:null,type:"alert",icon:"AlertFlood.png",label:"Flood",state:""},"0125":{key:"0125",id:"0125",futureId:null,type:"alert",icon:"AlertWinter.png",label:"Winter",state:""},"0126":{key:"0126",id:"0126",futureId:null,type:"alert",icon:"AlertMarine.png",label:"Marine",state:""},"0121":{key:"0121",id:"0121",futureId:null,type:"alert",icon:"AlertTropical.png",label:"Tropical",state:""},"0127":{key:"0127",id:"0127",futureId:null,type:"alert",icon:"AlertOther.png",label:"Other",state:""}},this._hasLR=!0,this._pastAliases={},this.template=a,this.$=a.$,this._menu=a.initSettings.menu}return a.prototype.getConfig=function(){return this._layerConfig},a.prototype.getPastId=function(a){try{for(var b=this.findMenuItem(a),c=b.layers,d=0;d<c.length;d++)if(c[d].futureId&&c[d].futureId===a)return c[d].pastId}catch(e){return this._pastAliases[a]||a}},a.prototype.getFutureId=function(a){try{for(var b=this.findMenuItem(a),c=b.layers,d=0;d<c.length;d++)if(c[d].pastId===a&&c[d].futureId)return c[d].futureId}catch(e){return a}},a.prototype.getLayer=function(a){return this.findMenuItem(a)},a.prototype.findMenuItem=function(a){for(var b,c,d,e=this._menu,f=0,g=e.trees.length;g>f;f++){b=e.trees[f].children;for(var h=0,i=b.length;i>h;h++){c=b[h],d=c.layers;for(var j=0;j<d.length;j++)if(d[j].pastId===a||d[j].futureId===a)return c}}},a}();a.LayerConfig=b}(b=a.DynamicMenu||(a.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a){var b=this;this._isVisible=!0,this._onLayerChanged=function(a,c){b.onLayerChanged(a,c)},this._onClick=function(a){b.onClick(a)},this._legendReference={"0783":"LegendsPrecip.png","0794":"LegendsPrecip.png","0140":"LegendsPrecip.png","0808":"LegendsPrecipForecast.png","0052":"LegendsRoads.png","0053":"LegendsSnow.png","0055":"LegendsTemps.png","0807":"LegendsNowNetTempsFandC.png","0110":"LegendsWaterTemp.png","0056":"LegendsWildfire.png","0059":"LegendsWindSpeeds.png","0809":"LegendsWindSpeedMphandKmh.png"},this.template=a,this._element=a.$.g("#legend",this.template.uiElement),this._btn=a.$.g("#legendBtn",this.template.uiElement),this._host=a.gethost(),this.bind(),this.render(),this.register()}return b.prototype.bind=function(){var b;a.Storage.isEnabled&&(b=a.Storage.retrieve("__wxMap_isLegendVisible"),b&&(this._isVisible=/true/gi.test(b))),this.toggle()},b.prototype.render=function(){var b,c,d,e,f=this.template.map.view.getLayers(),g=[];for(var h in f)e=this.template.state.getTimeMode()===a.TimeMode.Future?this.template.layerConfig.getPastId(h)||h:h,this._legendReference[e]&&(b=this.template.layerConfig.getLayer(e),d=this._host+"img/png/"+this._legendReference[e],c=b&&b.label?b.label.replace("<br />"," "):"",g.push("<img src='"+d+"' title='"+c+"' />"));0===g.length?this._element.innerHTML="<span>No legends available for current map view</span>":this._element.innerHTML=g.join("")},b.prototype.toggle=function(){this._element.style.display=this._isVisible?"block":"none",a.Storage.isEnabled&&a.Storage.save("__wxMap_isLegendVisible",this._isVisible?"TRUE":"FALSE"),this._isVisible=!this._isVisible},b.prototype.register=function(){this.template.map.menuItemEnabled.addListener(this,this._onLayerChanged),this.template.map.menuItemDisabled.addListener(this,this._onLayerChanged),this._btn.addEventListener("click",this._onClick)},b.prototype.unregister=function(){this.template.map.menuItemEnabled.removeListener(this._onLayerChanged),this.template.map.menuItemDisabled.removeListener(this._onLayerChanged),this._btn.removeEventListener("click",this._onClick)},b.prototype.onLayerChanged=function(a,b){this.render()},b.prototype.onClick=function(a){this.toggle()},b}();b.LegendControl=c}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(a){var b=this;this._closeModal=function(a){return b.onCloseModal()},this._template=a,this.$=a.$}return b.prototype.onCloseModal=function(){var a=this.$.g("#modal");a.hide()},b.prototype.show=function(b){var c=this.$.g("#modal");c.html("");var d=this.$.m("div",{"class":"modal-dialog"},b);c.append(d);var e=this.$.m("button","OK");a.addEventListener(e,"click",this._closeModal),c.append(e),c.show()},b.prototype.close=function(){this.onCloseModal()},b}();b.ModalControl=c}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));var WxMap;!function(a){var b;!function(b){var c;!function(b){var c=function(){function b(b){var c=this;this._timeMode=a.TimeMode.Past,this._wireLayerAdded=function(a,b){c.onLayerAdded(a,b)},this._wireLayerRemoved=function(a,b){c.onLayerRemoved(a,b)},this._wireMenuItemChanged=function(a){c.onMenuItemChanged(a)},this.radSatEnabled=new a.Event,this.radSatDisabled=new a.Event,this.timeModeChanged=new a.Event,this.template=b,this._timeMode=this.getActiveLayersTimeMode(),this.register()}return b.prototype.getActiveLayersTimeMode=function(){var b,c=this.template.map.view.getLayers(),d=a.TimeMode.Past;for(var e in c)if(b=this.template.layerConfig.getLayer(e))for(var f=0;f<b.layers.length;f++)if(b.layers[f].futureId&&e===b.layers[f].futureId){d=a.TimeMode.Future;break}return d},b.prototype.getTimeMode=function(){return this._timeMode},b.prototype.setTimeMode=function(a){if((0===a||1===a||2===a)&&this._timeMode!==a){var b={oldMode:this._timeMode,newMode:a};this._timeMode=a,this.timeModeChanged.trigger(b)}},b.prototype.register=function(){this.template.map.view.layerAdded.addListener(this,this._wireLayerAdded),this.template.map.view.layerRemoved.addListener(this,this._wireLayerRemoved),this.template.map.menuItemEnabled.addListener(this,this._wireMenuItemChanged),this.template.map.menuItemDisabled.addListener(this,this._wireMenuItemChanged)},b.prototype.unregister=function(){this.template.map.view.layerAdded.removeListener(this._wireLayerAdded),this.template.map.view.layerRemoved.removeListener(this._wireLayerRemoved),this.template.map.menuItemEnabled.removeListener(this._wireMenuItemChanged),this.template.map.menuItemDisabled.removeListener(this._wireMenuItemChanged)},b.prototype.determineAnimator=function(){if(!(this.template.map.capabilityClient.getPollCount()<1)){this.template.map.animator.stop(),this.template.map.animator.minimizeRange();try{switch(this._timeMode){case a.TimeMode.Past:this.template.map.animator.setEndTime(a.DateTime.utcFromNow());break;case a.TimeMode.Future:this.template.map.animator.setStartTime(a.DateTime.utcFromNow())}this.template.map.animator.skipToNow()}catch(b){}}},b.prototype.onLayerAdded=function(a,b){},b.prototype.onLayerRemoved=function(a,b){},b.prototype.onMenuItemChanged=function(a){var b=this.getActiveLayersTimeMode();this.setTimeMode(b),this.determineAnimator()},b}();b.State=c}(c=b.DynamicMenu||(b.DynamicMenu={}))}(b=a.UI||(a.UI={}))}(WxMap||(WxMap={}));
; var wxMap = {};(function() {var args = {}, data; var collection = document.getElementById('__wxMap').getAttribute('data-args').split('&');for (var i = 0; i < collection.length; i++) {
				data = collection[i].split('=');
				args[data[0]] = data[1];
			}

			if (args.traceMode === 'Normal' || args.traceMode === 'Verbose') {
        try {
					var traceListener = WxMap.deriveFunctionFromName(args.traceListener, window);
					WxMap.Console.logged.addListener(traceListener);
					WxMap.Console.warned.addListener(traceListener);
					WxMap.Console.errored.addListener(traceListener);
				}
        catch (error) {}
      }
			
			var callback = args.callback;  delete args['callback'];
			var initParams = {};
			if (args.layers) { initParams.layers = args.layers; delete args['layers']; }	
      if (args.basemap) { initParams.basemap = args.basemap; delete args['basemap']; }
			if (args.longitude) { initParams.longitude = args.longitude;	delete args['longitude']; } else initParams.longitude = '-97';
			if (args.latitude) { initParams.latitude = args.latitude;	delete args['latitude']; } else initParams.latitude = '39';
			if (args.zoomLevel) { initParams.zoomLevel = args.zoomLevel;	delete args['zoomLevel']; } else initParams.zoomLevel = '4';
			if (args.opacity) { initParams.opacity = args.opacity;	delete args['opacity']; } else initParams.opacity = '1';
			if (args.persistLocation) { initParams.persistLocation = args.persistLocation;	delete args['persistLocation']; } else initParams.persistLocation = false;
			if (args.persistAnimation) { initParams.persistAnimation = args.persistAnimation;	delete args['persistAnimation']; } else initParams.persistAnimation = false;
			if (args.persistLayers) { initParams.persistLayers = args.persistLayers;	delete args['persistLayers']; } else initParams.persistLayers = false;
      if (args.persistBasemap) { initParams.persistBasemap = args.persistBasemap;	delete args['persistBasemap']; } else initParams.persistBasemap = false;
			if (args.persistOpacity) { initParams.persistOpacity = args.persistOpacity;	delete args['persistOpacity']; } else initParams.persistOpacity = false;
			if (args.persistZoomLevel) { initParams.persistZoomLevel = args.persistZoomLevel;	delete args['persistZoomLevel']; } else initParams.persistZoomLevel = false;
      initParams.memberId = '1167';
      initParams.mapId = '0023';
			var settings = {"maximumActiveLayers":8,"minimumZoom":1.0,"maximumZoom":16.0,"slidingTimeout":1800000.0,"absoluteTimeout":10800000.0,"bingMapKey":"AkHjtkHzuH0hXgN1PL3htEU2yaR19wCL9YQtA9S47fmU1DOmzz74XQTJ0N_Hi0cs","layers":[{"_":"tile","id":"0034","extension":"png","label":"Cloud Cover","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0035","extension":"png","label":"Wind Speed","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0039","extension":"png","label":"Radar (CONUS)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","validForward":750000.0,"validBackward":750000.0,"legend":"http://images.intellicast.com/App_Images/Legends/radar5.png","tags":""},{"_":"tile","id":"0040","extension":"png","label":"Satellite (N America)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0041","extension":"png","label":"Satellite (Europe)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0044","extension":"png","label":"Alaska Radar","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0046","extension":"png","label":"Hawaii Radar","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0048","extension":"png","label":"Radar (Europe)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0049","extension":"png","label":"Satellite (Tropics)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0052","extension":"png","label":"Road Weather Index","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","legend":"http://images.intellicast.com/App_Images/Legends/drivecast2.png","tags":""},{"_":"tile","id":"0053","extension":"png","label":"Snow Cover (CONUS)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","legend":"http://images.intellicast.com/App_Images/Legends/snow2.png","tags":""},{"_":"tile","id":"0055","extension":"png","label":"Temperature (N America)","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","legend":"http://images.intellicast.com/App_Images/Legends/temps2.png","tags":""},{"_":"tile","id":"0056","extension":"png","label":"Fire Weather Index","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","tags":""},{"_":"tile","id":"0059","extension":"png","label":"NOWnet Wind Speed","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","legend":"http://images.intellicast.com/App_Images/Legends/winds2.png","tags":""},{"_":"tile","id":"0062","extension":"png","label":"Vortex RPM CONUS 4km - Temperature","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0067","extension":"png","label":"Forecast Radar","maxZoom":16,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","endOffset":90000000.0,"validForward":4500000.0,"validBackward":900000.0,"legend":"http://images.intellicast.com/App_Images/Legends/radar5.png","tags":""},{"_":"tile","id":"0110","extension":"png","label":"Water Temps (World)","maxZoom":16,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","tags":""},{"_":"geo","id":"0112","extension":"gml","label":"Official Tracks","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-3600000.0,"endOffset":600000.0,"validForward":3600000.0,"validBackward":3600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0112/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0113","extension":"gml","label":"Model Tracks","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-3600000.0,"endOffset":600000.0,"validForward":3600000.0,"validBackward":3600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0113/20120626/style.json","isLocalOnly":false},{"_":"geotile","id":"0115","extension":"gml","label":"Wild Fire Detection","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-3600000.0,"endOffset":600000.0,"validForward":3600000.0,"validBackward":3600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0115/20120626/style.json","isLocalOnly":false,"pyramidPolicy":[{"StartZoom":0,"DataZoom":0},{"StartZoom":1,"DataZoom":1},{"StartZoom":2,"DataZoom":2},{"StartZoom":3,"DataZoom":3},{"StartZoom":4,"DataZoom":4},{"StartZoom":5,"DataZoom":5},{"StartZoom":6,"DataZoom":6},{"StartZoom":7,"DataZoom":7},{"StartZoom":8,"DataZoom":8}]},{"_":"geo","id":"0117","extension":"gml","label":"Earthquakes","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"validForward":10800000.0,"validBackward":10800000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0117/20120626/style.json","isLocalOnly":false},{"_":"geotile","id":"0118","extension":"gml","label":"Lightning Summary","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-900000.0,"endOffset":600000.0,"validForward":900000.0,"validBackward":900000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0118/20120626/style.json","isLocalOnly":false,"pyramidPolicy":[{"StartZoom":0,"DataZoom":0},{"StartZoom":1,"DataZoom":1},{"StartZoom":3,"DataZoom":3},{"StartZoom":4,"DataZoom":4},{"StartZoom":5,"DataZoom":5},{"StartZoom":6,"DataZoom":6},{"StartZoom":7,"DataZoom":7},{"StartZoom":8,"DataZoom":8},{"StartZoom":9,"DataZoom":9}]},{"_":"geotile","id":"0119","extension":"gml","label":"Current Conditions","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-5400000.0,"endOffset":600000.0,"validForward":5400000.0,"validBackward":5400000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0119/20120626/style.json","isLocalOnly":false,"pyramidPolicy":[{"StartZoom":0,"DataZoom":0},{"StartZoom":1,"DataZoom":1},{"StartZoom":3,"DataZoom":3},{"StartZoom":4,"DataZoom":4},{"StartZoom":5,"DataZoom":5},{"StartZoom":6,"DataZoom":6},{"StartZoom":7,"DataZoom":7},{"StartZoom":8,"DataZoom":8},{"StartZoom":9,"DataZoom":9},{"StartZoom":10,"DataZoom":10},{"StartZoom":11,"DataZoom":11},{"StartZoom":12,"DataZoom":12}]},{"_":"geotile","id":"0120","extension":"gml","label":"Temperature Plots","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-5400000.0,"endOffset":600000.0,"validForward":5400000.0,"validBackward":5400000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0120/20120626/style.json","isLocalOnly":false,"pyramidPolicy":[{"StartZoom":0,"DataZoom":0},{"StartZoom":1,"DataZoom":1},{"StartZoom":3,"DataZoom":3},{"StartZoom":4,"DataZoom":4},{"StartZoom":5,"DataZoom":5},{"StartZoom":6,"DataZoom":6},{"StartZoom":7,"DataZoom":7},{"StartZoom":8,"DataZoom":8},{"StartZoom":9,"DataZoom":9},{"StartZoom":10,"DataZoom":10}]},{"_":"geo","id":"0121","extension":"gml","label":"Alerts: Tropical","maxZoom":16,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0121/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0123","extension":"gml","label":"Alerts: Severe","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0123/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0124","extension":"gml","label":"Alerts: Flood","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0124/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0125","extension":"gml","label":"Alerts: Winter","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0125/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0126","extension":"gml","label":"Alerts: Marine","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0126/20120626/style.json","isLocalOnly":false},{"_":"geo","id":"0127","extension":"gml","label":"Alerts: Other","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-10800000.0,"endOffset":600000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0127/20120626/style.json","isLocalOnly":false},{"_":"geotile","id":"0144","extension":"gml","label":"Titan Storm Tracking","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"wsi","direction":"Past","startOffset":-1800000.0,"endOffset":600000.0,"validForward":1800000.0,"validBackward":1800000.0,"tags":"","stylePath":"/201212/en-US/1167/0023/0144/20120626/style.json","isLocalOnly":false,"pyramidPolicy":[{"StartZoom":0,"DataZoom":0},{"StartZoom":1,"DataZoom":1},{"StartZoom":2,"DataZoom":2},{"StartZoom":3,"DataZoom":3},{"StartZoom":4,"DataZoom":4},{"StartZoom":5,"DataZoom":5},{"StartZoom":6,"DataZoom":6},{"StartZoom":7,"DataZoom":7}]},{"_":"tile","id":"0783","extension":"png","label":"Nowrad Radar Mosaic","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","validForward":750000.0,"validBackward":750000.0,"legend":"http://images.intellicast.com/App_Images/Legends/radar5.png","tags":""},{"_":"tile","id":"0784","extension":"png","label":"Satellite Mosaic","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","legend":"http://images.intellicast.com/App_Images/Legends/radar5.png","tags":""},{"_":"tile","id":"0794","extension":"png","label":"250m Radar - Media","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Past","validForward":750000.0,"validBackward":750000.0,"legend":"http://images.intellicast.com/App_Images/Legends/radar5.png","tags":""},{"_":"tile","id":"0806","extension":"png","label":"Cloud Cover","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0807","extension":"png","label":"Temperature","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0808","extension":"png","label":"Forecast Radar","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"tile","id":"0809","extension":"png","label":"Wind Speed","maxZoom":20,"minZoom":0,"isAnimate":true,"hostId":"wsi","direction":"Future","tags":""},{"_":"bing","id":"0078","extension":"png","label":"Bing Road","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"bing","direction":"Past","attributionSource":"http://images.intellicast.com/App_Images/WxMap/bing_logo_gray_70x27.png","tags":"","alias":"r","shading":"hill","isBaseMap":true},{"_":"bing","id":"0086","extension":"png","label":"Bing Satellite","maxZoom":20,"minZoom":0,"isAnimate":false,"hostId":"bing","direction":"Past","attributionSource":"http://images.intellicast.com/App_Images/WxMap/bing_logo_white_70x27.png","tags":"","alias":"a","isBaseMap":true}],"menu":{"_":"MenuInfo","id":"0109","name":"Adaptive Template Defaults - Bing Version","trees":[{"_":"MenuTree","label":"Layers","icon":null,"hoverIcon":null,"activeIcon":null,"id":"","isActive":true,"zone":null,"mode":"Single","requirement":"Optional","children":[{"_":"LayerMenuItem","label":"Radar<br />(Precipitation)","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconRadar.png","hoverIcon":null,"activeIcon":null,"id":"0001","isActive":true,"zone":null,"layers":[{"pastId":"0794","futureId":"0067"}],"children":[]},{"_":"LayerMenuItem","label":"Radar /<br />Satellite","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsSatRad.png","hoverIcon":null,"activeIcon":null,"id":"0002","isActive":false,"zone":null,"layers":[{"pastId":"0784","futureId":"0034"},{"pastId":"0794","futureId":"0067"}],"children":[]},{"_":"LayerMenuItem","label":"Satellite","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconSatellite.png","hoverIcon":null,"activeIcon":null,"id":"0003","isActive":false,"zone":null,"layers":[{"pastId":"0784","futureId":"0034"}],"children":[]},{"_":"LayerMenuItem","label":"Temperature","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsTemperature.png","hoverIcon":null,"activeIcon":null,"id":"0004","isActive":false,"zone":null,"layers":[{"pastId":"0055","futureId":"0062"}],"children":[]},{"_":"LayerMenuItem","label":"Wind Speed","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsWindSpeed.png","hoverIcon":null,"activeIcon":null,"id":"0005","isActive":false,"zone":null,"layers":[{"pastId":"0059","futureId":"0035"}],"children":[]},{"_":"LayerMenuItem","label":"Road<br />Weather","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsRoadWx.png","hoverIcon":null,"activeIcon":null,"id":"0006","isActive":false,"zone":null,"layers":[{"pastId":"0052","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Snow Cover","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsSnowCover.png","hoverIcon":null,"activeIcon":null,"id":"0007","isActive":false,"zone":null,"layers":[{"pastId":"0053","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Wildfire<br />Index","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/LayerIconsWildfireIndex.png","hoverIcon":null,"activeIcon":null,"id":"0008","isActive":false,"zone":null,"layers":[{"pastId":"0056","futureId":null}],"children":[]}]},{"_":"MenuTree","label":"Overlays","icon":null,"hoverIcon":null,"activeIcon":null,"id":"","isActive":true,"zone":null,"mode":"Multiple","requirement":"Optional","children":[{"_":"LayerMenuItem","label":"Storm Tracks","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsStormTracks.png","hoverIcon":null,"activeIcon":null,"id":"0009","isActive":false,"zone":null,"layers":[{"pastId":"0144","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Current<br />Conditions","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsCurrentConditions.png","hoverIcon":null,"activeIcon":null,"id":"0010","isActive":false,"zone":null,"layers":[{"pastId":"0119","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Temperature<br />Plots","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsTempPlots.png","hoverIcon":null,"activeIcon":null,"id":"0011","isActive":false,"zone":null,"layers":[{"pastId":"0120","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Earthquakes","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsEarthQuake.png","hoverIcon":null,"activeIcon":null,"id":"0012","isActive":false,"zone":null,"layers":[{"pastId":"0117","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Wildfire<br />Detection","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsWildfireDetection.png","hoverIcon":null,"activeIcon":null,"id":"0013","isActive":false,"zone":null,"layers":[{"pastId":"0115","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Lightning<br />Summary","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsLightning.png","hoverIcon":null,"activeIcon":null,"id":"0014","isActive":false,"zone":null,"layers":[{"pastId":"0118","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Active<br />Tropical Track","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsActiveTropTracks.png","hoverIcon":null,"activeIcon":null,"id":"0015","isActive":false,"zone":null,"layers":[{"pastId":"0112","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Active<br />Model Track","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/OverlayIconsActiveModelTracks.png","hoverIcon":null,"activeIcon":null,"id":"0016","isActive":false,"zone":null,"layers":[{"pastId":"0113","futureId":null}],"children":[]}]},{"_":"MenuTree","label":"Alerts","icon":null,"hoverIcon":null,"activeIcon":null,"id":"","isActive":true,"zone":null,"mode":"Multiple","requirement":"Optional","children":[{"_":"LayerMenuItem","label":"Tornado /<br />Severe Storms","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertSevere.png","hoverIcon":null,"activeIcon":null,"id":"0017","isActive":false,"zone":null,"layers":[{"pastId":"0123","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Flood","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertFlood.png","hoverIcon":null,"activeIcon":null,"id":"0018","isActive":false,"zone":null,"layers":[{"pastId":"0124","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Winter","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertWinter.png","hoverIcon":null,"activeIcon":null,"id":"0019","isActive":false,"zone":null,"layers":[{"pastId":"0125","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Marine","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertMarine.png","hoverIcon":null,"activeIcon":null,"id":"0020","isActive":false,"zone":null,"layers":[{"pastId":"0126","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Tropical","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertTropical.png","hoverIcon":null,"activeIcon":null,"id":"0021","isActive":false,"zone":null,"layers":[{"pastId":"0121","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Other","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/AlertOther.png","hoverIcon":null,"activeIcon":null,"id":"0022","isActive":false,"zone":null,"layers":[{"pastId":"0127","futureId":null}],"children":[]}]},{"_":"MenuTree","label":"Map Type","icon":null,"hoverIcon":null,"activeIcon":null,"id":"","isActive":true,"zone":null,"mode":"Single","requirement":"Required","children":[{"_":"LayerMenuItem","label":"Earth","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/IconEarth.png","hoverIcon":null,"activeIcon":null,"id":"1101","isActive":true,"zone":"0","layers":[{"pastId":"0086","futureId":null}],"children":[]},{"_":"LayerMenuItem","label":"Roads","icon":"http://tessera.intellicast.com/Assets/UI/0009/img/png/IconRoads.png","hoverIcon":null,"activeIcon":null,"id":"1102","isActive":false,"zone":"0","layers":[{"pastId":"0078","futureId":null}],"children":[]}]}]},"capabilityHost":"http://tessera.intellicast.com/201212/en-US/1167/0023/capability.json?t=1429535369308","styleHost":"http://tessera.intellicast.com","assetHost":"http://tessera.intellicast.com"};
var capabilities = {"mode":"Standard","layers":[{"n":"0078","v":[]},{"n":"0086","v":[]}],"hosts":{"wsi":{"uri":"http://tessera{s}.intellicast.com/201212/{l}/1167/0023/{c}/{n}/{m}/{v}/{i}/{z}/{x}/{y}/layer.{e}","s":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"]},"bing":{"uri":"http://r{s}.ortho.tiles.virtualearth.net/tiles/{a}{quadkey}.png?g=266&shading=hill&mkt=en-us","s":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"]},"trafficcams":{"uri":"https://d362j5dsdy0j0n.cloudfront.net/{k}_{w}.gml","s":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"]}}};
var wxMapUI=new WxMap.UI.DynamicMenu.Template('__wxMap',settings,capabilities,initParams,args);
var map=wxMapUI.map;
wxMap=wxMapUI.map;wxMap.ui=wxMapUI;
				var delegate;
				try {
					delegate = WxMap.deriveFunctionFromName(callback, window);
					if (delegate && typeof(delegate) != undefined) {
						map.view.resize();
						if (map.capabilityClient.getPollCount() < 1) {
							var onPolled = function() {
								if (map.capabilityClient.getPollCount() === 1) {
									delegate.call();	
								}
							}
							map.capabilityClient.polled.addListener(this, onPolled);
						}
						else {
							delegate.call();
						}
					}
				}
				catch (error) {
          if (console && console.log) {
            console.log(error);
          }
        }
			}());